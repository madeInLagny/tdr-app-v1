!function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),m=tinymce.util.Tools.resolve("tinymce.Env"),l=tinymce.util.Tools.resolve("tinymce.util.Tools");e.add("preview",function(e){var d,t;(d=e).addCommand("mcePreview",function(){var e,t,n,i,o,a,r,c,s;n="",i=(t=e=d).dom.encode,o=t.getParam("content_style","","string"),n+='<base href="'+i(t.documentBaseURI.getURI())+'">',a=t.getParam("content_css_cors",!1,"boolean")?' crossorigin="anonymous"':"",l.each(t.contentCSS,function(e){n+='<link type="text/css" rel="stylesheet" href="'+i(t.documentBaseURI.toAbsolute(e))+'"'+a+">"}),o&&(n+='<style type="text/css">'+o+"</style>"),s=-1===(s=(o=t).getParam("body_id","tinymce","string")).indexOf("=")?s:(o=(s=o).getParam("body_id","","hash"))[s.id]||o,o=-1===(r=(o=t).getParam("body_class","","string")).indexOf("=")?r:(r=o).getParam("body_class","","hash")[r.id]||"",r='<script>document.addEventListener && document.addEventListener("click", function(e) {for (var elm = e.target; elm; elm = elm.parentNode) {if (elm.nodeName === "A" && !('+(m.mac?"e.metaKey":"e.ctrlKey && !e.altKey")+")) {e.preventDefault();}}}, false);<\/script> ",c=(c=t.getBody().dir)?' dir="'+i(c)+'"':"",s="<!DOCTYPE html><html><head>"+n+'</head><body id="'+i(s)+'" class="mce-content-body '+i(o)+'"'+c+">"+t.getContent()+r+"</body></html>",e.windowManager.open({title:"Preview",size:"large",body:{type:"panel",items:[{name:"preview",type:"iframe",sandboxed:!0}]},buttons:[{type:"cancel",name:"close",text:"Close",primary:!0}],initialData:{preview:s}}).focus("close")}),(t=e).ui.registry.addButton("preview",{icon:"preview",tooltip:"Preview",onAction:function(){return t.execCommand("mcePreview")}}),t.ui.registry.addMenuItem("preview",{icon:"preview",text:"Preview",onAction:function(){return t.execCommand("mcePreview")}})})}();