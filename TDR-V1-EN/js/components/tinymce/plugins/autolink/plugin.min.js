!function(){"use strict";function o(e,t){return t<0&&(t=0),t=3===e.nodeType&&(e=e.data.length)<t?e:t}function i(e,t,n){var o,i,r,a=e.getParam("autolink_pattern",/^(https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.|(?:mailto:)?[A-Z0-9._%+\-]+@(?!.*@))(.+)$/i),s=e.getParam("default_link_target",!1);if("A"!==e.selection.getNode().tagName){var d=e.selection.getRng().cloneRange();if(d.startOffset<5){if(!(l=d.endContainer.previousSibling)){if(!d.endContainer.firstChild||!d.endContainer.firstChild.nextSibling)return;l=d.endContainer.firstChild.nextSibling}if(f=l.length,c(d,l,f),g(d,l,f),d.endOffset<5)return;o=d.endOffset,i=l}else{if(3!==(i=d.endContainer).nodeType&&i.firstChild){for(;3!==i.nodeType&&i.firstChild;)i=i.firstChild;3===i.nodeType&&(c(d,i,0),g(d,i,i.nodeValue.length))}o=1===d.endOffset?2:d.endOffset-1-t}for(var f=o;c(d,i,2<=o?o-2:0),g(d,i,1<=o?o-1:0),--o," "!==(r=d.toString())&&""!==r&&160!==r.charCodeAt(0)&&0<=o-2&&r!==n;);(l=d.toString())===n||" "===l||160===l.charCodeAt(0)?(c(d,i,o),g(d,i,f),o+=1):(0===d.startOffset?c(d,i,0):c(d,i,o),g(d,i,f)),"."===(t=d.toString()).charAt(t.length-1)&&g(d,i,f-1);var l=(t=d.toString().trim()).match(a),f=e.getParam("link_default_protocol","http","string");l&&("www."===l[1]?l[1]=f+"://www.":/@$/.test(l[1])&&!/^mailto:/.test(l[1])&&(l[1]="mailto:"+l[1]),t=e.selection.getBookmark(),e.selection.setRng(d),e.execCommand("createlink",!1,l[1]+l[2]),!1!==s&&e.dom.setAttrib(e.selection.getNode(),"target",s),e.selection.moveToBookmark(t),e.nodeChanged())}}var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),r=tinymce.util.Tools.resolve("tinymce.Env"),c=function(e,t,n){1!==t.nodeType||t.hasChildNodes()?e.setStart(t,o(t,n)):e.setStartBefore(t)},g=function(e,t,n){1!==t.nodeType||t.hasChildNodes()?e.setEnd(t,o(t,n)):e.setEndAfter(t)};e.add("autolink",function(e){var t,n;(t=e).on("keydown",function(e){13===e.keyCode&&i(t,-1,"")}),r.browser.isIE()?t.on("focus",function(){if(!n){n=!0;try{t.execCommand("AutoUrlDetect",!1,!0)}catch(e){}}}):(t.on("keypress",function(e){41===e.keyCode&&i(t,-1,"(")}),t.on("keyup",function(e){32===e.keyCode&&i(t,0,"")}))})}();