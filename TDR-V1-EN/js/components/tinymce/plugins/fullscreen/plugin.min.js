!function(){"use strict";function l(n){var e=n;return{get:function(){return e},set:function(n){e=n}}}function n(t){return function(n){return e=typeof(n=n),(null===n?"null":"object"==e&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"==e&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":e)===t;var e}}function e(e){return function(n){return typeof n===e}}function o(){}function u(n){return function(){return n}}function t(){return F}function i(t){function n(){return o}function e(n){return n(t)}var r=u(t),o={fold:function(n,e){return e(t)},is:function(n){return t===n},isSome:E,isNone:y,getOr:r,getOrThunk:r,getOrDie:r,getOrNull:r,getOrUndefined:r,or:n,orThunk:n,map:function(n){return i(n(t))},each:function(n){n(t)},bind:e,exists:e,forall:e,filter:function(n){return n(t)?o:F},toArray:function(){return[t]},toString:function(){return"some("+t+")"},equals:function(n){return n.is(t)},equals_:function(n,e){return n.fold(y,function(n){return e(t,n)})}};return o}function c(){return n=function(n){return n.unbind()},e=l(T.none()),t=function(){return e.get().each(n)},{clear:function(){t(),e.set(T.none())},isSet:function(){return e.get().isSome()},set:function(n){t(),e.set(T.some(n))}};var n,e,t}function f(n,e){for(var t=[],r=0,o=n.length;r<o;r++){var u=n[r];e(u,r)&&t.push(u)}return t}function m(n){return void 0!==n.style&&v(n.style.getPropertyValue)}function r(n){if(null==n)throw new Error("Node cannot be null or undefined");return{dom:n}}function a(e){return function(n){return n.dom.nodeType===e}}function H(n){return x(n.dom.childNodes,k.fromDom)}function s(n){var e,t,r,o=$(n)?n.dom.parentNode:n.dom;return null!=o&&null!==o.ownerDocument&&(r=o.ownerDocument,A(k.fromDom(o)).fold(function(){return r.body.contains(o)},(e=s,t=N,function(n){return e(t(n))})))}function w(n,e){n.dom.removeAttribute(e)}function d(n){function e(){return n.stopPropagation()}function t(){return n.preventDefault()}var r,o,u=k.fromDom(function(n){if(rn()&&p(n.target)){var e=k.fromDom(n.target);if(Z(e)&&un(e)&&n.composed&&n.composedPath){e=n.composedPath();if(e)return J(e)}}return T.from(n.target)}(n).getOr(n.target));return r=t,o=e,{target:u,x:n.clientX,y:n.clientY,stop:e,prevent:t,kill:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return r(o.apply(null,n))},raw:n}}function R(n,e,t,r){n.dom.removeEventListener(e,t,r)}function h(t,r){return{left:t,top:r,translate:function(n,e){return h(t+n,r+e)}}}function g(t,r,n){return P(n).map(function(n){function e(n){return r(d(n))}return n.addEventListener(t,e),{unbind:function(){return n.removeEventListener(t,e)}}}).getOrThunk(function(){return{unbind:o}})}function b(n,e){n.fire("FullscreenStateChanged",{state:e})}function S(n){return n.getParam("fullscreen_native",!1,"boolean")}function V(n){var e=k.fromDom(n.getElement());return A(e).map(N).getOrThunk(function(){var n=C(e).dom.body;if(null==n)throw new Error("Body is not available yet");return k.fromDom(n)})}function W(n){return n.dom===(void 0!==(n=C(n).dom).fullscreenElement?n.fullscreenElement:void 0!==n.msFullscreenElement?n.msFullscreenElement:void 0!==n.webkitFullscreenElement?n.webkitFullscreenElement:null)}function B(r,n,e){function t(t){return function(n){var e=cn(n,"style"),e=void 0===e?"no-styles":e.trim();e!==t&&(ln(n,q,e),M(n,r.parseStyle(t)))}}var o=gn(n,function(n){return tn(n,"*")},void 0),u=G(o,function(n){return pn(n,"*:not(.tox-silver-sink)")}),e=bn(e);D(u,t("display:none!important;")),D(o,t(vn+yn+e)),t((!0===wn?"":vn)+yn+e)(n)}function j(o,u){function i(e){e(f,"tox-fullscreen"),e(a,"tox-fullscreen"),e(s,"tox-fullscreen"),A(m).map(function(n){return N(n).dom}).each(function(n){e(n,"tox-fullscreen"),e(n,"tox-shadowhost")})}function n(){var t,n,e,r;p&&(t=o.dom,n="["+q+"]",e=1!==(e=r=document).nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount?[]:x(r.querySelectorAll(n),k.fromDom),D(e,function(n){var e=cn(n,q);"no-styles"!==e?M(n,t.parseStyle(e)):w(n,"style"),w(n,q)})),i(Sn.removeClass),En.unbind(),T.from(u.get()).each(function(n){return n.fullscreenChangeHandler.unbind()})}var e,t,r,l,c,f=document.body,a=document.documentElement,s=o.getContainer(),m=k.fromDom(s),d=V(o),h=u.get(),g=k.fromDom(o.getBody()),p=dn.deviceType.isTouch(),v=s.style,y=o.iframeElement.style;h?(h.fullscreenChangeHandler.unbind(),S(o)&&W(d)&&((c=C(d).dom).exitFullscreen?c.exitFullscreen():c.msExitFullscreen?c.msExitFullscreen():c.webkitCancelFullScreen&&c.webkitCancelFullScreen()),y.width=h.iframeWidth,y.height=h.iframeHeight,v.width=h.containerWidth,v.height=h.containerHeight,v.top=h.containerTop,v.left=h.containerLeft,c=h.scrollPos,window.scrollTo(c.x,c.y),u.set(null),b(o,!1),n(),o.off("remove",n)):(h=C(d),c=void 0!==document.fullscreenElement?"fullscreenchange":void 0!==document.msFullscreenElement?"MSFullscreenChange":void 0!==document.webkitFullscreenElement?"webkitfullscreenchange":"fullscreenchange",h=fn(h,c,an,function(n){!S(o)||W(d)||null===u.get()||j(o,u)},!1),e={scrollPos:{x:(e=window,r=void 0===e?window:e,e=r.document,t=(e=void 0!==(e=k.fromDom(e))?e.dom:document).body.scrollLeft||e.documentElement.scrollLeft,e=e.body.scrollTop||e.documentElement.scrollTop,l=sn(t,e),(t=P(r).fold(function(){var n=r.document.documentElement,e=n.clientWidth,n=n.clientHeight;return mn(l.left,l.top,e,n)},function(n){return mn(Math.max(n.pageLeft,l.left),Math.max(n.pageTop,l.top),n.width,n.height)})).x),y:t.y},containerWidth:v.width,containerHeight:v.height,containerTop:v.top,containerLeft:v.left,iframeWidth:y.width,iframeHeight:y.height,fullscreenChangeHandler:h},p&&B(o.dom,m,g),y.width=y.height="100%",v.width=v.height="",i(Sn.addClass),En.bind(m),o.on("remove",n),u.set(e),S(o)&&((t=d.dom).requestFullscreen?t.requestFullscreen():t.msRequestFullscreen?t.msRequestFullscreen():t.webkitRequestFullScreen&&t.webkitRequestFullScreen()),b(o,!0))}function z(t,r){return function(e){e.setActive(null!==r.get());function n(n){return e.setActive(n.state)}return t.on("FullscreenStateChanged",n),function(){return t.off("FullscreenStateChanged",n)}}}var I=tinymce.util.Tools.resolve("tinymce.PluginManager"),U=n("string"),_=n("array"),K=e("boolean"),p=function(n){return!(null==n)},v=e("function"),X=e("number"),y=u(!1),E=u(!0),F={fold:function(n,e){return n()},is:y,isSome:y,isNone:E,getOr:L=function(n){return n},getOrThunk:O=function(n){return n()},getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:u(null),getOrUndefined:u(void 0),or:L,orThunk:O,map:t,each:o,bind:t,exists:y,forall:E,filter:t,equals:L=function(n){return n.isNone()},equals_:L,toArray:function(){return[]},toString:u("none()")},T={some:i,none:t,from:function(n){return null==n?F:i(n)}},Y=Array.prototype.push,x=function(n,e){for(var t=n.length,r=new Array(t),o=0;o<t;o++){var u=n[o];r[o]=e(u,o)}return r},D=function(n,e){for(var t=0,r=n.length;t<r;t++)e(n[t],t)},G=function(n,e){for(var t=x(n,e),r=[],o=0,u=t.length;o<u;++o){if(!_(t[o]))throw new Error("Arr.flatten item "+o+" was not an array, input: "+t);Y.apply(r,t[o])}return r},J=function(n){return 0<n.length?T.some(n[0]):T.none()},Q=Object.keys,k={fromHtml:function(n,e){e=(e||document).createElement("div");if(e.innerHTML=n,!e.hasChildNodes()||1<e.childNodes.length)throw console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return r(e.childNodes[0])},fromTag:function(n,e){e=(e||document).createElement(n);return r(e)},fromText:function(n,e){e=(e||document).createTextNode(n);return r(e)},fromDom:r,fromPoint:function(n,e,t){return T.from(n.dom.elementFromPoint(e,t)).map(r)}},Z=("undefined"==typeof window&&Function("return this;")(),a(1)),$=a(3),nn=a(9),en=a(11),tn=function(n,e){n=n.dom;if(1!==n.nodeType)return!1;if(void 0!==n.matches)return n.matches(e);if(void 0!==n.msMatchesSelector)return n.msMatchesSelector(e);if(void 0!==n.webkitMatchesSelector)return n.webkitMatchesSelector(e);if(void 0!==n.mozMatchesSelector)return n.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")},C=function(n){return k.fromDom(n.dom.ownerDocument)},O=v(Element.prototype.attachShadow)&&v(Node.prototype.getRootNode),rn=u(O),on=O?function(n){return k.fromDom(n.dom.getRootNode())}:function(n){return nn(n)?n:C(n)},A=function(n){var e,n=on(n);return en(e=n)&&p(e.dom.host)?T.some(n):T.none()},N=function(n){return k.fromDom(n.dom.host)},un=function(n){return p(n.dom.shadowRoot)},ln=function(n,e,t){n=n.dom;if(!(U(t)||K(t)||X(t)))throw console.error("Invalid call to Attribute.set. Key ",e,":: Value ",t,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(e,t+"")},cn=function(n,e){n=n.dom.getAttribute(e);return null===n?void 0:n},M=function(n,e){for(var t=n.dom,r=e,o=Q(r),u=0,i=o.length;u<i;u++){var l=o[u],c=(s=a=f=void 0,r[l]),f=t,a=l,s=c;if(!U(s))throw console.error("Invalid call to CSS.set. Property ",a,":: Value ",s,":: Element ",f),new Error("CSS value must be a string: "+s);m(f)&&f.style.setProperty(a,s)}},fn=function(n,e,t,r,o){function u(n){i(n)&&l(d(n))}var i,l;i=t,l=r;return n.dom.addEventListener(e,u,o),{unbind:function(r){for(var o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=o.concat(n);return r.apply(null,t)}}(R,n,e,u,o)}},an=E,sn=h,P=function(n){n=void 0===n?window:n;return T.from(n.visualViewport)},mn=function(n,e,t,r){return{x:n,y:e,width:t,height:r,right:n+t,bottom:e+r}},L=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),dn=tinymce.util.Tools.resolve("tinymce.Env"),hn=tinymce.util.Tools.resolve("tinymce.util.Delay"),gn=function(n,e,t){return f(function(n,e){for(var t=v(e)?e:y,r=n.dom,o=[];null!==r.parentNode&&void 0!==r.parentNode;){var u=r.parentNode,i=k.fromDom(u);if(o.push(i),!0===t(i))break;r=u}return o}(n,t),e)},pn=function(n,e){return r=function(n){return tn(n,e)},f((t=n,T.from(t.dom.parentNode).map(k.fromDom).map(H).map(function(n){return f(n,function(n){return t.dom!==n.dom})}).getOr([])),r);var t,r},q="data-ephox-mobile-fullscreen-style",vn="position:absolute!important;",yn="top:0!important;left:0!important;margin:0!important;padding:0!important;width:100%!important;height:100%!important;overflow:visible!important;",wn=dn.os.isAndroid(),bn=function(n){r="background-color",e=(n=n).dom;var e,t,r=""!==(t=window.getComputedStyle(e).getPropertyValue(r))||s(n)?t:(n=r,m(t=e)?t.style.getPropertyValue(n):"");return void 0!==r&&""!==r?"background-color:"+r+"!important":"background-color:rgb(255,255,255)!important;"},Sn=L.DOM,En=P().fold(function(){return{bind:o,unbind:o}},function(e){t=l(T.none());var t,r={clear:function(){return t.set(T.none())},set:function(n){return t.set(T.some(n))},isSet:function(){return t.get().isSome()},on:function(n){return t.get().each(n)}},o=c(),u=c(),i=hn.throttle(function(){document.body.scrollTop=0,document.documentElement.scrollTop=0,window.requestAnimationFrame(function(){r.on(function(n){return M(n,{top:e.offsetTop+"px",left:e.offsetLeft+"px",height:e.height+"px",width:e.width+"px"})})})},50);return{bind:function(n){r.set(n),i(),o.set(g("resize",i)),u.set(g("scroll",i))},unbind:function(){r.on(function(){o.clear(),u.clear()}),r.clear()}}});I.add("fullscreen",function(n){var e,t,r,o,u,i=l(null);return n.inline||(t=i,(e=n).addCommand("mceFullScreen",function(){j(e,t)}),(r=n).ui.registry.addToggleMenuItem("fullscreen",{text:"Fullscreen",icon:"fullscreen",shortcut:"Meta+Shift+F",onAction:function(){return r.execCommand("mceFullScreen")},onSetup:z(r,o=i)}),r.ui.registry.addToggleButton("fullscreen",{tooltip:"Fullscreen",icon:"fullscreen",onAction:function(){return r.execCommand("mceFullScreen")},onSetup:z(r,o)}),n.addShortcut("Meta+Shift+F","","mceFullScreen")),u=i,{isFullscreen:function(){return null!==u.get()}}})}();