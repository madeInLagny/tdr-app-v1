!function(){"use strict";function e(u){u.ui.registry.addButton("quickimage",{icon:"image",tooltip:"Insert image",onAction:function(){var i=u;new s(function(n){var r=document.createElement("input"),o=(r.type="file",r.accept="image/*",r.style.position="fixed",r.style.left="0",r.style.top="0",r.style.opacity="0.001",document.body.appendChild(r),r.addEventListener("change",function(t){n(Array.prototype.slice.call(t.target.files))}),function(t){function e(){n([]),r.parentNode.removeChild(r)}f.os.isAndroid()&&"remove"!==t.type?d.setEditorTimeout(i,e,0):e(),i.off("focusin remove",o)});i.on("focusin remove",o),r.click()}).then(function(t){var i,n;0<t.length&&(i=t[0],n=i,new s(function(t){var e=new FileReader;e.onloadend=function(){t(e.result.split(",")[1])},e.readAsDataURL(n)}).then(function(t){var e,n,r,o;t=t,n=i,r=(e=u).editorUpload.blobCache,o=r.create((o=(new Date).getTime(),"mceu_"+Math.floor(1e9*Math.random())+ ++l+String(o)),n,t),r.add(o),e.insertContent(e.dom.createHTML("img",{src:o.blobUri()}))}))})}}),u.ui.registry.addButton("quicktable",{icon:"table",tooltip:"Insert table",onAction:function(){var t,e;(t=u).plugins.table?t.plugins.table.insertTable(2,2):(e=t).undoManager.transact(function(){e.insertContent(function(){var t,e,n='<table data-mce-id="mce" style="width: 100%">';for(n+="<tbody>",e=0;e<2;e++){for(n+="<tr>",t=0;t<2;t++)n+="<td><br></td>";n+="</tr>"}return(n+="</tbody>")+"</table>"}());var t=e.dom.select("*[data-mce-id]")[0],t=(t.removeAttribute("data-mce-id"),e.dom.select("td,th",t));e.selection.setCursorLocation(t[0],0)})}})}function t(n){return function(t){return e=typeof(t=t),(null===t?"null":"object"==e&&(Array.prototype.isPrototypeOf(t)||t.constructor&&"Array"===t.constructor.name)?"array":"object"==e&&(String.prototype.isPrototypeOf(t)||t.constructor&&"String"===t.constructor.name)?"string":e)===n;var e}}function n(e){return function(t){return typeof t===e}}function i(t){return function(){return t}}function r(){return k}function u(n){function t(){return o}function e(t){return t(n)}var r=i(n),o={fold:function(t,e){return e(n)},is:function(t){return n===t},isSome:v,isNone:h,getOr:r,getOrThunk:r,getOrDie:r,getOrNull:r,getOrUndefined:r,or:t,orThunk:t,map:function(t){return u(t(n))},each:function(t){t(n)},bind:e,exists:e,forall:e,filter:function(t){return t(n)?o:k},toArray:function(){return[n]},toString:function(){return"some("+n+")"},equals:function(t){return t.is(n)},equals_:function(t,e){return t.fold(h,function(t){return e(n,t)})}};return o}var o,c,a=tinymce.util.Tools.resolve("tinymce.PluginManager"),l=0,s=tinymce.util.Tools.resolve("tinymce.util.Promise"),f=tinymce.util.Tools.resolve("tinymce.Env"),d=tinymce.util.Tools.resolve("tinymce.util.Delay"),m=t("string"),g=t("object"),b=t("array"),p=n("boolean"),y=n("function"),h=i(!1),v=i(!void 0),k={fold:function(t,e){return t()},is:h,isSome:h,isNone:v,getOr:c=function(t){return t},getOrThunk:o=function(t){return t()},getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:i(null),getOrUndefined:i(void 0),or:c,orThunk:o,map:r,each:function(){},bind:r,exists:h,forall:v,filter:r,equals:c=function(t){return t.isNone()},equals_:c,toArray:function(){return[]},toString:i("none()")},w={some:u,none:r,from:function(t){return null==t?k:u(t)}};function T(t,e,n,r,o){return t(n,r)?w.some(n):y(o)&&o(n)?w.none():e(n,r,o)}function q(t){if(null==t)throw new Error("Node cannot be null or undefined");return{dom:t}}function S(t,e,n){return x(t,function(t){return A(t,e)},n)}function E(t,e,n){if(!C(n))throw new Error("Default value doesn't match requested type.");if(t=t.getParam(e,n),e=n,b(t)||g(t))throw new Error("expected a string but found: "+t);return void 0===t?e:p(t)?!1===t?"":e:t}function N(o){var t=E(o,"quickbars_insert_toolbar","quickimage quicktable");0<t.trim().length&&o.ui.registry.addContextToolbar("quickblock",{predicate:function(t){function e(t){return t.dom===o.getBody()}var n=M(t),r=o.schema.getTextBlockElements();return T(A,S,n,"table",e).fold(function(){return T(function(t,e){return e(t)},x,n,function(t){return t.dom.nodeName.toLowerCase()in r&&o.dom.isEmpty(t.dom)},e).isSome()},h)},items:t,position:"line",scope:"editor"})}function O(e){function n(t){return"IMG"===t.nodeName||"FIGURE"===t.nodeName&&/image/i.test(t.className)}var t=E(e,"quickbars_image_toolbar","alignleft aligncenter alignright");0<t.trim().length&&e.ui.registry.addContextToolbar("imageselection",{predicate:n,items:t,position:"node"}),0<(t=E(e,"quickbars_selection_toolbar","bold italic | quicklink h2 h3 blockquote")).trim().length&&e.ui.registry.addContextToolbar("textselection",{predicate:function(t){return!n(t)&&!e.selection.isCollapsed()&&"false"!==e.dom.getContentEditableParent(t)},items:t,position:"selection",scope:"editor"})}var C,M=q,A=function(t,e){t=t.dom;if(1!==t.nodeType)return!1;if(void 0!==t.matches)return t.matches(e);if(void 0!==t.msMatchesSelector)return t.msMatchesSelector(e);if(void 0!==t.webkitMatchesSelector)return t.webkitMatchesSelector(e);if(void 0!==t.mozMatchesSelector)return t.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")},x=("undefined"==typeof window&&Function("return this;")(),function(t,e,n){for(var r=t.dom,o=y(n)?n:h;r.parentNode;){var r=r.parentNode,i=M(r);if(e(i))return w.some(i);if(o(i))break}return w.none()});C=m;a.add("quickbars",function(t){e(t),N(t),O(t)})}();