!function(){"use strict";var y=function(){return(y=Object.assign||function(n){for(var e,t=1,o=arguments.length;t<o;t++)for(var r in e=arguments[t])Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}).apply(this,arguments)};function o(n,e){var t={};for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,r=Object.getOwnPropertySymbols(n);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(n,r[o])&&(t[r[o]]=n[r[o]]);return t}function c(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var o=Array(n),r=0,e=0;e<t;e++)for(var i=arguments[e],u=0,c=i.length;u<c;u++,r++)o[r]=i[u];return o}function r(t){return function(n){return e=typeof(n=n),(null===n?"null":"object"==e&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"==e&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":e)===t;var e}}function a(e){return function(n){return typeof n===e}}var l=r("string"),z=r("object"),L=r("array"),G=a("boolean"),$=function(n){return!(null==n)},U=a("function"),W=a("number"),F=function(){},X=function(t,o){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return t(o.apply(null,n))}},h=function(n){return function(){return n}},R=function(n){return n};function q(o){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=r.concat(n);return o.apply(null,t)}}function Y(e){return function(n){return!e(n)}}function K(n){return function(){throw new Error(n)}}function J(){return $n}function Q(t){function n(){return r}function e(n){return n(t)}var o=h(t),r={fold:function(n,e){return e(t)},is:function(n){return t===n},isSome:b,isNone:v,getOr:o,getOrThunk:o,getOrDie:o,getOrNull:o,getOrUndefined:o,or:n,orThunk:n,map:function(n){return Q(n(t))},each:function(n){n(t)},bind:e,exists:e,forall:e,filter:function(n){return n(t)?r:$n},toArray:function(){return[t]},toString:function(){return"some("+t+")"},equals:function(n){return n.is(t)},equals_:function(n,e){return n.fold(v,function(n){return e(t,n)})}};return r}function Z(n,e,t){return x(n,function(n){t=e(t,n)}),t}function nn(n,e){return Kn(n,function(n){return!qn(e,n)})}function en(n){return[n]}function tn(n,e){for(var t=0;t<n.length;t++){var o=e(n[t],t);if(o.isSome())return o}return V.none()}function on(){return rn(0,0)}function rn(n,e){return{major:n,minor:e}}function un(n,e){return-1!==n.indexOf(e)}function cn(n){return n.replace(Pn,"")}function an(e){return function(n){return un(n,e)}}function sn(n){function e(n){return function(){return t===n}}var t=n.current,n=n.version;return{current:t,version:n,isEdge:e("Edge"),isChrome:e("Chrome"),isIE:e("IE"),isOpera:e("Opera"),isFirefox:e(fe),isSafari:e("Safari")}}function fn(n){function e(n){return function(){return t===n}}var t=n.current,n=n.version;return{current:t,version:n,isWindows:e(me),isiOS:e("iOS"),isAndroid:e(ge),isOSX:e("OSX"),isLinux:e("Linux"),isSolaris:e(pe),isFreeBSD:e(he),isChromeOS:e(ve)}}function ln(n,e){var t,o,r,i,u,c,a=se.browsers(),s=se.oses(),a=ie(a,c=n).map(function(n){var e=re.detect(n.versionRegexes,c);return{current:n.name,version:e}}).fold(le,de),s=ie(s,u=n).map(function(n){var e=re.detect(n.versionRegexes,u);return{current:n.name,version:e}}).fold(ye,be);return{browser:a,os:s,deviceType:(a=a,n=n,e=e,t=(s=s).isiOS()&&!0===/ipad/i.test(n),o=s.isiOS()&&!t,r=(i=s.isiOS()||s.isAndroid())||e("(pointer:coarse)"),e=t||!o&&i&&e("(min-device-width:768px)"),i=o||i&&!e,a=a.isSafari()&&s.isiOS()&&!1===/safari/i.test(n),n=!i&&!e&&!a,{isiPad:h(t),isiPhone:h(o),isTablet:h(e),isPhone:h(i),isTouch:h(r),isAndroid:s.isAndroid,isiOS:s.isiOS,isWebView:h(a),isDesktop:h(n)})}}function dn(n){return window.matchMedia(n).matches}function mn(n){return h("alloy."+n)}function gn(n){Ye(n,He())}function pn(n,e,t){Je(n,e,t,{})}function hn(n){if(null==n)throw new Error("Node cannot be null or undefined");return{dom:n}}function vn(n){return 1!==n.nodeType&&9!==n.nodeType&&11!==n.nodeType||0===n.childElementCount}function yn(e){return function(n){return n.dom.nodeType===e}}function bn(n){return A.fromDom(n.dom.ownerDocument)}function xn(n){return rt(n)?n:bn(n)}function wn(n,e){return n=n.dom.childNodes,V.from(n[e]).map(A.fromDom)}function Sn(n,e){V.from(n.dom.nextSibling).map(A.fromDom).fold(function(){ut(n).each(function(n){st(n,e)})},function(n){at(n,e)})}function On(e,t){wn(e,0).fold(function(){st(e,t)},function(n){e.dom.insertBefore(t.dom,n.dom)})}function Tn(e,n){x(n,function(n){st(e,n)})}function kn(n){n.dom.textContent="",x(ct(n),function(n){ft(n)})}function En(n){return it(n)&&$(n.dom.host)}function Cn(n){return A.fromDom(n.dom.host)}function Dn(){var n=A.fromDom(document).dom.body;if(null==n)throw new Error("Body is not available yet");return A.fromDom(n)}function Mn(n,e){st(n.element,e.element)}function _n(n,e,t){n.getSystem().addToWorld(e),t(n.element,e.element),mt(n.element)&&pt(e),n.syncComponents()}function In(e){var n,t=ut(e.element).bind(function(n){return e.getSystem().getByDom(n).toOptional()});gt(n=e),ft(n.element),n.getSystem().removeFromWorld(n),t.each(function(n){n.syncComponents()})}function Fn(n,t){var o=[];return yt(n,function(n,e){o.push(t(n,e))}),o}function Rn(n,e){var t=n.dom;yt(e,function(n,e){Ot(t,e,n)})}function Vn(n,e){return!(!(n=n.dom)||!n.hasAttribute)&&n.hasAttribute(e)}function Bn(n,e){return void 0===(n=O(n,e))||""===n?[]:n.split(" ")}function An(n,e){return Et(n)&&n.dom.classList.contains(e)}function jn(n,e,t){It(n,t),Mt(n,e)}function Nn(t){return{is:function(n){return t===n},isValue:b,isError:v,getOr:h(t),getOrThunk:h(t),getOrDie:h(t),or:function(n){return Nn(t)},orThunk:function(n){return Nn(t)},fold:function(n,e){return e(t)},map:function(n){return Nn(n(t))},mapError:function(n){return Nn(t)},each:function(n){n(t)},bind:function(n){return n(t)},exists:function(n){return n(t)},forall:function(n){return n(t)},toOptional:function(){return V.some(t)}}}function Hn(t){return{is:v,isValue:v,isError:b,getOr:R,getOrThunk:function(n){return n()},getOrDie:function(){return K(String(t))()},or:function(n){return n},orThunk:function(n){return n()},fold:function(n,e){return n(t)},map:function(n){return Hn(t)},mapError:function(n){return Hn(n(t))},each:F,bind:function(n){return Hn(t)},exists:v,forall:b,toOptional:V.none}}var Pn,zn,Ln=function(n){return n()},v=h(!1),b=h(!0),Gn=function(t){var o,r=!1;return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return r||(r=!0,o=t.apply(null,n)),o}},$n=(ae=function(n){return n.isNone()},{fold:function(n,e){return n()},is:v,isSome:v,isNone:b,getOr:n=function(n){return n},getOrThunk:ce=function(n){return n()},getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:h(null),getOrUndefined:h(void 0),or:n,orThunk:ce,map:J,each:F,bind:J,exists:v,forall:b,filter:J,equals:ae,equals_:ae,toArray:function(){return[]},toString:h("none()")}),V={some:Q,none:J,from:function(n){return null==n?$n:Q(n)}},Un=Array.prototype.slice,Wn=Array.prototype.indexOf,Xn=Array.prototype.push,qn=function(n,e){return-1<Wn.call(n,e)},Yn=function(n,e){for(var t=0,o=n.length;t<o;t++)if(e(n[t],t))return!0;return!1},B=function(n,e){for(var t=n.length,o=new Array(t),r=0;r<t;r++){var i=n[r];o[r]=e(i,r)}return o},x=function(n,e){for(var t=0,o=n.length;t<o;t++)e(n[t],t)},Kn=function(n,e){for(var t=[],o=0,r=n.length;o<r;o++){var i=n[o];e(i,o)&&t.push(i)}return t},Jn=function(n,e,t){for(var o,r=n,i=r.length-1;0<=i;i--)o=r[i],t=e(t,o);return t},Qn=function(n,e){for(var t=n,o=e,r=v,i=0,u=t.length;i<u;i++){var c=t[i];if(o(c,i))return V.some(c);if(r(c,i))break}return V.none()},Zn=function(n,e){for(var t=0,o=n.length;t<o;t++)if(e(n[t],t))return V.some(t);return V.none()},ne=function(n){for(var e=[],t=0,o=n.length;t<o;++t){if(!L(n[t]))throw new Error("Arr.flatten item "+t+" was not an array, input: "+n);Xn.apply(e,n[t])}return e},ee=function(n,e){return ne(B(n,e))},te=function(n,e){for(var t=0,o=n.length;t<o;++t)if(!0!==e(n[t],t))return!1;return!0},oe=function(n){n=Un.call(n,0);return n.reverse(),n},re={nu:rn,detect:function(n,e){var t,o,e=String(e).toLowerCase();return 0===n.length?on():(o=function(n,e){for(var t=0;t<n.length;t++){var o=n[t];if(o.test(e))return o}}(n=n,t=e))?rn((n=function(n){return Number(t.replace(o,"$"+n))})(1),n(2)):{major:0,minor:0}},unknown:on},ie=function(n,e){var t=String(e).toLowerCase();return Qn(n,function(n){return n.search(t)})},ue=function(n,o){return n.replace(/\$\{([^{}]*)\}/g,function(n,e){var t,e=o[e];return"string"==(t=typeof e)||"number"==t?e.toString():n})},n=(Pn=/^\s+|\s+$/g,/.*?version\/\ ?([0-9]+)\.([0-9]+).*/),ce=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(n){return un(n,"edge/")&&un(n,"chrome")&&un(n,"safari")&&un(n,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,n],search:function(n){return un(n,"chrome")&&!un(n,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(n){return un(n,"msie")||un(n,"trident")}},{name:"Opera",versionRegexes:[n,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:an("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:an("firefox")},{name:"Safari",versionRegexes:[n,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(n){return(un(n,"safari")||un(n,"mobile/"))&&un(n,"applewebkit")}}],ae=[{name:"Windows",search:an("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(n){return un(n,"iphone")||un(n,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:an("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:an("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:an("linux"),versionRegexes:[]},{name:"Solaris",search:an("sunos"),versionRegexes:[]},{name:"FreeBSD",search:an("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:an("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],se={browsers:h(ce),oses:h(ae)},fe="Firefox",le=function(){return sn({current:void 0,version:re.unknown()})},de=sn,me=(h("Edge"),h("Chrome"),h("IE"),h("Opera"),h(fe),h("Safari"),"Windows"),ge="Android",pe="Solaris",he="FreeBSD",ve="ChromeOS",ye=function(){return fn({current:void 0,version:re.unknown()})},be=fn,xe=(h(me),h("iOS"),h(ge),h("Linux"),h("OSX"),h(pe),h(he),h(ve),Gn(function(){return ln(navigator.userAgent,dn)})),n=h,we=n("touchstart"),Se=n("touchmove"),Oe=n("touchend"),Te=n("mousedown"),ke=n("mousemove"),Ee=n("mouseup"),Ce=n("mouseover"),De=n("keydown"),Me=n("keyup"),_e=n("input"),Ie=n("change"),Fe=n("click"),Re=n("transitionend"),Ve=n("selectstart"),ce={tap:mn("tap")},Be=mn("focus"),Ae=mn("blur.post"),je=mn("paste.post"),Ne=mn("receive"),He=mn("execute"),Pe=mn("focus.item"),ze=ce.tap,Le=mn("longpress"),Ge=mn("system.init"),$e=mn("system.attached"),Ue=mn("system.detached"),We=mn("focusmanager.shifted"),Xe=mn("highlight"),qe=mn("dehighlight"),Ye=function(n,e){Je(n,n.element,e,{})},Ke=function(n,e,t){Je(n,n.element,e,t)},Je=function(n,e,t,o){o=y({target:e},o);n.getSystem().triggerEvent(t,e,o)},A={fromHtml:function(n,e){e=(e||document).createElement("div");if(e.innerHTML=n,!e.hasChildNodes()||1<e.childNodes.length)throw console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return hn(e.childNodes[0])},fromTag:function(n,e){e=(e||document).createElement(n);return hn(e)},fromText:function(n,e){e=(e||document).createTextNode(n);return hn(e)},fromDom:hn,fromPoint:function(n,e,t){return V.from(n.dom.elementFromPoint(e,t)).map(hn)}},Qe=function(n,e){n=n.dom;if(1!==n.nodeType)return!1;if(void 0!==n.matches)return n.matches(e);if(void 0!==n.msMatchesSelector)return n.msMatchesSelector(e);if(void 0!==n.webkitMatchesSelector)return n.webkitMatchesSelector(e);if(void 0!==n.mozMatchesSelector)return n.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")},Ze=function(n,e){e=void 0===e?document:e.dom;return vn(e)?[]:B(e.querySelectorAll(n),A.fromDom)},nt=function(n,e){e=void 0===e?document:e.dom;return vn(e)?V.none():V.from(e.querySelector(n)).map(A.fromDom)},w=function(n,e){return n.dom===e.dom},et=("undefined"==typeof window&&Function("return this;")(),function(n){return n.dom.nodeName.toLowerCase()}),tt=yn(1),ot=yn(3),rt=yn(9),it=yn(11),ut=function(n){return V.from(n.dom.parentNode).map(A.fromDom)},ct=function(n){return B(n.dom.childNodes,A.fromDom)},at=function(e,t){ut(e).each(function(n){n.dom.insertBefore(t.dom,e.dom)})},st=function(n,e){n.dom.appendChild(e.dom)},ft=function(n){n=n.dom;null!==n.parentNode&&n.parentNode.removeChild(n)},ae=U(Element.prototype.attachShadow)&&U(Node.prototype.getRootNode),lt=h(ae),dt=ae?function(n){return A.fromDom(n.dom.getRootNode())}:xn,mt=function(n){var e,t,o,r=ot(n)?n.dom.parentNode:n.dom;return null!=r&&null!==r.ownerDocument&&(o=r.ownerDocument,n=A.fromDom(r),n=dt(n),(En(n)?V.some(n):V.none()).fold(function(){return o.body.contains(r)},(e=mt,t=Cn,function(n){return e(t(n))})))},gt=function(n){Ye(n,Ue());n=n.components();x(n,gt)},pt=function(n){var e=n.components();x(e,pt),Ye(n,$e())},ht=Object.keys,vt=Object.hasOwnProperty,yt=function(n,e){for(var t=ht(n),o=0,r=t.length;o<r;o++){var i=t[o];e(n[i],i)}},bt=function(n,t){return xt(n,function(n,e){return{k:e,v:t(n,e)}})},xt=function(n,t){var o={};return yt(n,function(n,e){n=t(n,e);o[n.k]=n.v}),o},p=function(n,e){return wt(n,e)?V.from(n[e]):V.none()},wt=function(n,e){return vt.call(n,e)},St=function(n,e){return wt(n,e)&&void 0!==n[e]&&null!==n[e]},Ot=function(n,e,t){if(!(l(t)||G(t)||W(t)))throw console.error("Invalid call to Attribute.set. Key ",e,":: Value ",t,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(e,t+"")},S=function(n,e,t){Ot(n.dom,e,t)},O=function(n,e){n=n.dom.getAttribute(e);return null===n?void 0:n},Tt=function(n,e){return V.from(O(n,e))},kt=function(n,e){n.dom.removeAttribute(e)},Et=function(n){return void 0!==n.dom.classList},Ct=function(n,e){return e=e,e=Bn(n=n,"class").concat([e]),S(n,"class",e.join(" ")),!0},Dt=function(n,e){return t=e,0<(n=Kn(Bn(e=n,"class"),function(n){return n!==t})).length?S(e,"class",n.join(" ")):kt(e,"class"),!1;var t},Mt=function(n,e){Et(n)?n.dom.classList.add(e):Ct(n,e)},_t=function(n){0===(Et(n)?n.dom.classList:Bn(n,"class")).length&&kt(n,"class")},It=function(n,e){Et(n)?n.dom.classList.remove(e):Dt(n,e),_t(n)},n=Object.freeze({__proto__:null,toAlpha:function(n,e,t){jn(n.element,e.alpha,e.omega)},toOmega:function(n,e,t){jn(n.element,e.omega,e.alpha)},isAlpha:function(n,e,t){return An(n.element,e.alpha)},isOmega:function(n,e,t){return An(n.element,e.omega)},clear:function(n,e,t){It(n.element,e.alpha),It(n.element,e.omega)}}),T={value:Nn,error:Hn,fromOption:function(n,e){return n.fold(function(){return Hn(e)},Nn)}};(ce=zn=zn||{})[ce.Error=0]="Error",ce[ce.Value=1]="Value";function Ft(n,e,t){return n.stype===zn.Error?e(n.serror):t(n.svalue)}function Rt(n){var e=[],t=[];return x(n,function(n){Ft(n,function(n){return t.push(n)},function(n){return e.push(n)})}),{values:e,errors:t}}function Vt(n,e){return n.stype===zn.Value?{stype:zn.Value,svalue:e(n.svalue)}:n}function Bt(u){if(!L(u))throw new Error("cases must be an array");if(0===u.length)throw new Error("there must be at least one case");var c=[],t={};return x(u,function(n,o){var e=ht(n);if(1!==e.length)throw new Error("one and only one name per case");var r=e[0],i=n[r];if(void 0!==t[r])throw new Error("duplicate key detected:"+r);if("cata"===r)throw new Error("cannot have a case named cata (sorry)");if(!L(i))throw new Error("case arguments must be an array");c.push(r),t[r]=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var e=t.length;if(e!==i.length)throw new Error("Wrong number of arguments to case "+r+". Expected "+i.length+" ("+i+"), got "+e);return{fold:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];if(n.length!==u.length)throw new Error("Wrong number of arguments to fold. Expected "+u.length+", got "+n.length);return n[o].apply(null,t)},match:function(n){var e=ht(n);if(c.length!==e.length)throw new Error("Wrong number of arguments to match. Expected: "+c.join(",")+"\nActual: "+e.join(","));if(te(c,function(n){return qn(e,n)}))return n[r].apply(null,t);throw new Error("Not all branches were specified when using match. Specified: "+e.join(", ")+"\nRequired: "+c.join(", "))},log:function(n){console.log(n,{constructors:c,constructor:r,params:t})}}}}),t}function At(u){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];if(0===n.length)throw new Error("Can't merge zero objects");for(var t={},o=0;o<n.length;o++){var r,i=n[o];for(r in i)zo.call(i,r)&&(t[r]=u(t[r],i[r]))}return t}}function jt(n){return $o.defaultedThunk(h(n))}function Nt(n,e){var t={};return t[n]=e,t}function Ht(n){return X(Ho,ne)(n)}function Pt(n,e,t){return e=p(n,e).fold(function(){return t(n)},R),No(e)}function zt(a,s){return{extract:function(e,t,o){var n,r,i,u,c=ht(o),c=(n=e,c=c,u=tr(a),r=n,i=R,n=B(c,function(n,e){return u.extract(r.concat(["["+e+"]"]),i,n)}),Jo(n));return Po(c,function(n){n=B(n,function(n){return nr.field(n,n,Uo(),s)});return rr(n).extract(e,t,o)})},toString:function(){return"setOf("+s.toString()+")"}}}function Lt(e,n){return zt(function(n){return e(n).fold(jo,Ao)},n)}function Gt(n){return"Errors: \n"+(e=10<(e=n.errors).length?e.slice(0,10).concat([{path:[],getErrorInfo:function(){return"... (only showing first ten failures)"}}]):e,B(e,function(n){return"Failed path: ("+n.path.join(" > ")+")\n"+n.getErrorInfo()}).join("\n"))+"\n\nInput object: "+Qo(n.input);var e}function $t(n,e){return r=n,i=bt(e,rr),{extract:function(e,t,o){return p(o,r).fold(function(){return n=r,Zo(e,function(){return'Choice schema did not contain choice key: "'+n+'"'});var n},function(n){return ar(e,t,o,i,n)})},toString:function(){return"chooseOn("+r+"). Possible values: "+ht(i)}};var r,i}function Ut(n,e){return cr(n,n,Uo(),e)}function Wt(n,e){return pr(n,rr(e))}function Xt(n,e){return pr(n,or(e))}function qt(n,e){return ur(n,e)}function Yt(n){return U(n)?n:v}function Kt(i,u,n){var e=u(i),c=Yt(n);return e.orThunk(function(){if(!c(i))for(var n=u,e=i.dom,t=Yt(c);e.parentNode;){var e=e.parentNode,o=A.fromDom(e),r=n(o);if(r.isSome())return r;if(t(o))break}return V.none()})}function Jt(n,e){return{key:n,value:br({abort:e})}}function Qt(n,t,o){return{key:n,value:br({run:function(n,e){t.apply(void 0,[n,e].concat(o))}})}}function Zt(n){return function(t){return{key:n,value:br({run:function(n,e){yr(n,e)&&t(n,e)}})}}}function no(n,e,t){var i,o,e=e.partUids[t];return o=e,E(i=n,function(n,r){n.getSystem().getByUid(o).each(function(n){var e=n.element,t=i,o=r;n.getSystem().triggerEvent(t,e,o.event)})})}function eo(n){return E(n,function(n,e){e.cut()})}function to(n){return E(Vo,n)}function oo(t,o,r){return Sr(function(n,e){r(n,t,o)})}function ro(t,n,o,r,e,i,u){function c(n){return St(n,o)?n[o]():V.none()}var e=bt(e,function(n,e){return Er(o,n,e)}),i=bt(i,Tr),a=y(y(y({},i),e),{revoke:q(Cr,o),config:function(n){var e=dr(o+"-config",t,n);return{key:o,value:{config:e,me:a,configAsRaw:Gn(function(){return dr(o+"-config",t,n)}),initialConfig:n,state:u}}},schema:h(n),exhibit:function(n,t){return c(n).bind(function(e){return p(r,"exhibit").map(function(n){return n(t,e.config,e.state)})}).getOr(kr({}))},name:h(o),handlers:function(n){return c(n).map(function(n){return p(r,"events").getOr(function(){return{}})(n.config,n.state)}).getOr({})}});return a}function io(n){n.dom.focus()}function uo(n){return n.dom.blur()}function co(n){return void 0===n&&(n=A.fromDom(document)),V.from(n.dom.activeElement).map(A.fromDom)}function ao(e){return co(dt(e)).filter(function(n){return e.dom.contains(n.dom)})}function so(n){return n.dom.innerHTML}function fo(n){var e;return En(n)?"#shadow-root":(n=A.fromDom(n.dom.cloneNode(!1)),e=A.fromTag("div"),n=A.fromDom(n.dom.cloneNode(!0)),st(e,n),so(e))}function lo(e,n,t){var o,r,i,u;switch(p(Lr.get(),e).orThunk(function(){var n=ht(Lr.get());return tn(n,function(n){return-1<e.indexOf(n)?V.some(Lr.get()[n]):V.none()})}).getOr(Bo.NORMAL)){case Bo.NORMAL:return t($r());case Bo.LOGGING:o=e,r=n,i=[],u=(new Date).getTime();var c={logEventCut:function(n,e,t){i.push({outcome:"cut",target:e,purpose:t})},logEventStopped:function(n,e,t){i.push({outcome:"stopped",target:e,purpose:t})},logNoParent:function(n,e,t){i.push({outcome:"no-parent",target:e,purpose:t})},logEventNoHandlers:function(n,e){i.push({outcome:"no-handlers-left",target:e})},logEventResponse:function(n,e,t){i.push({outcome:"response",purpose:t,target:e})},write:function(){var n=(new Date).getTime();qn(["mousemove","mouseover","mouseout",Ge()],o)||console.log(o,{event:o,time:n-u,target:r.dom,sequence:B(i,function(n){return qn(["cut","stopped","response"],n.outcome)?"{"+n.purpose+"} "+n.outcome+" at ("+fo(n.target)+")":n.outcome})})}},a=t(c);return c.write(),a;case Bo.STOP:return!0}}function mo(n,e,t){var o;return void 0!==(o=new Error).stack&&(o=o.stack.split("\n"),Qn(o,function(e){return 0<e.indexOf("alloy")&&!Yn(Gr,function(n){return-1<e.indexOf(n)})}).getOr(zr)),cr(e,e,t,sr(function(t){return T.value(function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return t.apply(void 0,n)})}))}function go(n){return mo(0,n,jt(F))}function po(n){return mo(0,n,jt(V.none))}function ho(n){return mo(0,n,Uo())}function vo(n){return mo(0,n,Uo())}function yo(n,e,t){(e=e.aria).update(n,e,t.get())}function bo(e,n,t){n.toggleClass.each(function(n){(t.get()?Mt:It)(e.element,n)})}function xo(n,e,t){wo(n,e,t,!t.get())}function wo(n,e,t,o){(o?Jr:Qr)(n,e,t)}function So(n,e,t){wo(n,e,t,e.selected)}function Oo(n,e,t){S(n.element,"aria-expanded",t)}function To(t,o){return Kr.config({channels:qo(Nr,{onReceive:function(n,e){e.command===t&&o(n,e.state)}})})}function ko(){function n(n,e){e.stop(),gn(n)}return[E(Fe(),n),E(ze(),n),eo(we()),eo(Te())]}function Eo(n,e){e.ignore||(io(n.element),e.onFocus(n))}function Co(n,e,t){if(!l(t))throw console.error("Invalid call to CSS.set. Property ",e,":: Value ",t,":: Element ",n),new Error("CSS value must be a string: "+t);oi(n)&&n.style.setProperty(e,t)}function Do(n,e){var t=n.dom;yt(e,function(n,e){Co(t,e,n)})}function Mo(n,e){var t=n.dom,o=window.getComputedStyle(t).getPropertyValue(e);return""!==o||mt(n)?o:ri(t,e)}function _o(n,e){return n=n.dom,n=ri(n,e),V.from(n).filter(function(n){return 0<n.length})}function Io(t,o){function n(n){var e=o(n);return e<=0||null===e?(n=Mo(n,t),parseFloat(n)||0):e}function r(t,n){return Z(n,function(n,e){e=Mo(t,e),e=void 0===e?0:parseInt(e,10);return isNaN(e)?n:n+e},0)}return{set:function(n,e){if(!W(e)&&!e.match(/^[0-9]+$/))throw new Error(t+".set accepts only positive integer values. Value was "+e);n=n.dom;oi(n)&&(n.style[t]=e+"px")},get:n,getOuter:n,aggregate:r,max:function(n,e,t){n=r(n,t);return n<e?e-n:0}}}function Fo(n){return ci.get(n)}var Ro,Vo,Bo,Ao=function(n){return{stype:zn.Value,svalue:n}},jo=function(n){return{stype:zn.Error,serror:n}},No=Ao,Ho=jo,Po=function(n,e){return n.stype===zn.Value?e(n.svalue):n},zo=Object.prototype.hasOwnProperty,Lo=At(function(n,e){return z(n)&&z(e)?Lo(n,e):e}),Go=At(function(n,e){return e}),$o=Bt([{strict:[]},{defaultedThunk:["fallbackThunk"]},{asOption:[]},{asDefaultedOptionThunk:["fallbackThunk"]},{mergeWithThunk:["baseThunk"]}]),Uo=$o.strict,Wo=$o.asOption,ae=$o.defaultedThunk,Xo=($o.asDefaultedOptionThunk,$o.mergeWithThunk),qo=(Bt([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),Nt),Yo=function(n){return e={},x(n,function(n){e[n.key]=n.value}),e;var e},Ko=function(n,e){var n=Rt(n);return 0<n.errors.length?Ht(n.errors):(e=e,0<(n=n.values).length?No(Lo(e,Go.apply(void 0,n))):No(e))},Jo=function(n){n=Rt(n);return 0<n.errors.length?Ht(n.errors):No(n.values)},Qo=function(n){return z(n)&&100<ht(n).length?" removed due to size":JSON.stringify(n,null,2)},Zo=function(n,e){return Ho([{path:n,getErrorInfo:e}])},nr=Bt([{field:["key","okey","presence","prop"]},{state:["okey","instantiator"]}]),er=function(c,a,n,r){return n.fold(function(i,e,n,t){function u(n){return n=t.extract(c.concat([i]),r,n),Vt(n,function(n){return Nt(e,r(n))})}function o(n){return n.fold(function(){var n=Nt(e,r(V.none()));return No(n)},function(n){n=t.extract(c.concat([i]),r,n);return Vt(n,function(n){return Nt(e,r(V.some(n)))})})}return n.fold(function(){return Po((t=c,p(o=a,r=i).fold(function(){return n=r,e=o,Zo(t,function(){return'Could not find valid *strict* value for "'+n+'" in '+Qo(e)});var n,e},No)),u);var t,o,r},function(n){return Po(Pt(a,i,n),u)},function(){return Po(No(p(a,i)),o)},function(n){return Po((t=n,n=p(e=a,i).map(function(n){return!0===n?t(e):n}),No(n)),o);var e,t},function(n){var e=n(a),n=Vt(Pt(a,i,h({})),function(n){return Lo(e,n)});return Po(n,u)})},function(n,e){e=e(a);return No(Nt(n,r(e)))})},tr=function(o){return{extract:function(t,n,e){return e=o(e,n),n=function(n){return e=n,Zo(t,function(){return e});var e},e.stype===zn.Error?n(e.serror):e},toString:function(){return"val"}}},or=function(n){var f=rr(n),l=Jn(n,function(e,n){return n.fold(function(n){return Lo(e,qo(n,!0))},h(e))},{});return{extract:function(n,e,t){var o,r,i,u,c,a=G(t)?[]:ht((r=function(n){return null!=n},i=a={},u=function(n,e){i[e]=n},c=F,yt(t,function(n,e){(r(n,e)?u:c)(n,e)}),a)),s=Kn(a,function(n){return!St(l,n)});return 0===s.length?f.extract(n,e,t):(o=s,Zo(n,function(){return"There are unsupported fields: ["+o.join(", ")+"] specified"}))},toString:f.toString}},rr=function(u){return{extract:function(n,e,t){return o=n,r=t,i=e,n=B(u,function(n){return er(o,r,n,i)}),Ko(n,{});var o,r,i},toString:function(){return"obj{\n"+B(u,function(n){return n.fold(function(n,e,t,o){return n+" -> "+o.toString()},function(n,e){return"state("+n+")"})}).join("\n")+"}"}}},ir=h(tr(No)),ur=nr.state,cr=nr.field,ar=function(t,e,o,r,i){return p(r,i).fold(function(){return n=r,e=i,Zo(t,function(){return'The chosen schema: "'+e+'" did not exist in branches: '+Qo(n)});var n,e},function(n){return n.extract(t.concat(["branch: "+i]),e,o)})},ce=tr(No),sr=function(e){return tr(function(n){return e(n).fold(Ho,No)})},fr=function(n,e,t){return o=R,e=e.extract([n],o,r=t),n=function(n){return{input:r,errors:n}},t=(o=e).stype===zn.Error?{stype:zn.Error,serror:n(o.serror)}:o,Ft(t,T.error,T.value);var o,r},lr=function(n){return n.fold(function(n){throw new Error(Gt(n))},R)},dr=function(n,e,t){return lr(fr(n,e,t))},mr=h(ce),ce=(Ro=U,tr(function(n){var e=typeof n;return Ro(n)?No(n):Ho("Expected type: function but got: "+e)})),d=function(n){return cr(n,n,Uo(),ir())},gr=function(n,e){return cr(n,n,Uo(),rr(e))},m=function(n){return cr(n,n,Wo(),ir())},pr=function(n,e){return cr(n,n,Wo(),e)},g=function(n,e){return cr(n,n,jt(e),ir())},hr=function(n,e,t){return cr(n,n,jt(e),t)},vr=[d("alpha"),d("omega")],yr=function(n,e){return w(n.element,e.event.target)},br=function(n){if(St(n,"can")||St(n,"abort")||St(n,"run"))return dr("Extracting event.handler",or([g("can",b),g("abort",v),g("run",F)]),n);throw new Error("EventHandler defined by: "+JSON.stringify(n,null,2)+" does not have can, abort, or run!")},k=Yo,E=function(n,e){return{key:n,value:br({run:e})}},xr=Zt($e()),wr=Zt(Ue()),Sr=Zt(Ge()),Or=(Vo=He(),function(n){return B(n,function(n){return 0,e=n.length-"/*".length,n.length>="/*".length&&"/*"===n.substr(e,e+"/*".length)?n.substring(0,n.length-"/*".length):n;var e})}),Tr=function(n,e){var t=n.toString(),o=t.indexOf(")")+1,r=t.indexOf("("),i=t.substring(r+1,o-1).split(/,\s*/);return n.toFunctionAnnotation=function(){return{name:e,parameters:Or(i)}},n},kr=function(n){return{classes:void 0!==n.classes?n.classes:[],attributes:void 0!==n.attributes?n.attributes:{},styles:void 0!==n.styles?n.styles:{}}},Er=function(r,i,u){var n=function(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];var o=[t].concat(n);return t.config({name:h(r)}).fold(function(){throw new Error("We could not find any behaviour configuration for: "+r+". Using API: "+u)},function(n){var e=Array.prototype.slice.call(o,1);return i.apply(void 0,[t,n.config,n.state].concat(e))})},e=u,t=i.toString(),o=t.indexOf(")")+1,c=t.indexOf("("),a=t.substring(c+1,o-1).split(/,\s*/);return n.toFunctionAnnotation=function(){return{name:e,parameters:Or(a.slice(0,1).concat(a.slice(3)))}},n},Cr=function(n){return{key:n,value:void 0}},Dr={init:function(){return Mr({readState:function(){return"No State required"}})}},Mr=function(n){return n},C=Yo,_r=or([d("fields"),d("name"),g("active",{}),g("apis",{}),g("state",Dr),g("extra",{})]),Ir=function(n){var n=dr("Creating behaviour: "+n.name,_r,n),e=n.fields,t=n.name,o=n.active,r=n.apis,i=n.extra,n=n.state,u=or(e),e=Wt(t,[Xt("config",e)]);return ro(u,e,t,o,r,i,n)},Fr=or([d("branchKey"),d("branches"),d("name"),g("active",{}),g("apis",{}),g("state",Dr),g("extra",{})]),Rr=h(void 0),Vr=Ir({fields:vr,name:"swapping",apis:n}),j=function(n){var e=n;return{get:function(){return e},set:function(n){e=n}}},Br=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),vr=tinymce.util.Tools.resolve("tinymce.ThemeManager"),Ar=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",icon:"bold",format:"bold"},{title:"Italic",icon:"italic",format:"italic"},{title:"Underline",icon:"underline",format:"underline"},{title:"Strikethrough",icon:"strikethrough",format:"strikethrough"},{title:"Superscript",icon:"superscript",format:"superscript"},{title:"Subscript",icon:"subscript",format:"subscript"},{title:"Code",icon:"code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Alignment",items:[{title:"Left",icon:"alignleft",format:"alignleft"},{title:"Center",icon:"aligncenter",format:"aligncenter"},{title:"Right",icon:"alignright",format:"alignright"},{title:"Justify",icon:"alignjustify",format:"alignjustify"}]}],jr=["undo","bold","italic","link","image","bullist","styleselect"],Nr="formatChanged",Hr="orientationChanged",Pr="dropupDismissed",n=Object.freeze({__proto__:null,events:function(u){return k([E(Ne(),function(o,n){var e,r=u.channels,t=ht(r),i=n,n=(e=i).universal?t:Kn(t,function(n){return qn(e.channels,n)});x(n,function(n){var e=r[n],t=e.schema,n=dr("channel["+n+"] data\nReceiver: "+fo(o.element),t,i.data);e.onReceive(o,n)})})])}}),zr="unknown",Lr=(Bo={STOP:0,0:"STOP",NORMAL:1,1:"NORMAL",LOGGING:2,2:"LOGGING"},j({})),Gr=["alloy/data/Fields","alloy/debugging/Debugging"],$r=h({logEventCut:F,logEventStopped:F,logNoParent:F,logEventNoHandlers:F,logEventResponse:F,write:F}),Ur=h([d("menu"),d("selectedMenu")]),Wr=h([d("item"),d("selectedItem")]),Xr=(h(rr(Wr().concat(Ur()))),h(rr(Wr()))),qr=gr("initSize",[d("numColumns"),d("numRows")]),i=function(n,e){return qt(n,h(e))},Yr=function(n){return qt(n,R)},qr=h(qr),e=[Ut("channels",Lt(T.value,or([ho("onReceive"),g("schema",mr())])))],Kr=Ir({fields:e,name:"receiving",active:n}),Jr=function(n,e,t){t.set(!0),bo(n,e,t),yo(n,e,t)},Qr=function(n,e,t){t.set(!1),bo(n,e,t),yo(n,e,t)},e=Object.freeze({__proto__:null,onLoad:So,toggle:xo,isOn:function(n,e,t){return t.get()},on:Jr,off:Qr,set:wo}),n=Object.freeze({__proto__:null,exhibit:function(){return kr({})},events:function(n,e){t=n,o=e,r=xo;var t,o,r,i=to(function(n){r(n,t,o)}),e=oo(n,e,So);return k(ne([n.toggleOnExecute?[i]:[],[e]]))}}),t=[g("selected",!1),m("toggleClass"),g("toggleOnExecute",!0),hr("aria",{mode:"none"},$t("mode",{pressed:[g("syncWithExpanded",!1),i("update",function(n,e,t){S(n.element,"aria-pressed",t),e.syncWithExpanded&&Oo(n,0,t)})],checked:[i("update",function(n,e,t){S(n.element,"aria-checked",t)})],expanded:[i("update",Oo)],selected:[i("update",function(n,e,t){S(n.element,"aria-selected",t)})],none:[i("update",F)]}))],D=Ir({fields:t,name:"toggling",active:n,apis:e,state:{init:function(){var e=j(!1);return{get:function(){return e.get()},set:function(n){return e.set(n)},clear:function(){return e.set(!1)},readState:function(){return e.get()}}}}}),Zr=function(n){return Kr.config({channels:qo(Hr,{onReceive:n})})},ni=function(n,e){return{key:n,value:{onReceive:e}}},ei="tinymce-mobile",N=function(n){return ei+"-"+n},t=Object.freeze({__proto__:null,focus:Eo,blur:function(n,e){e.ignore||uo(n.element)},isFocused:function(n){return n=n.element,e=dt(n).dom,n.dom===e.activeElement;var e}}),n=Object.freeze({__proto__:null,exhibit:function(n,e){e=e.ignore?{}:{attributes:{tabindex:"-1"}};return kr(e)},events:function(t){return k([E(Be(),function(n,e){Eo(n,t),e.stop()})].concat(t.stopMousedown?[E(Te(),function(n,e){e.event.prevent()})]:[]))}}),e=[go("onFocus"),g("stopMousedown",!1),g("ignore",!1)],ti=Ir({fields:e,name:"focusing",active:n,apis:t}),oi=function(n){return void 0!==n.style&&U(n.style.getPropertyValue)},H=function(n,e,t){n=n.dom;Co(n,e,t)},ri=function(n,e){return oi(n)?n.style.getPropertyValue(e):""},ii=function(n,e){var t=n.dom;oi(t=t)&&t.style.removeProperty(e),Tt(n,"style").map(cn).is("")&&kt(n,"style")},ui=function(n){return n.dom.offsetWidth},ci=Io("height",function(n){var e=n.dom;return mt(n)?e.getBoundingClientRect().height:e.offsetHeight}),ai=function(n,e){return Ze(e,n)};function si(n,e,t,o,r){return n(t,o)?V.some(t):U(r)&&r(t)?V.none():e(t,o,r)}function fi(n,e,t){for(var o=n.dom,r=U(t)?t:v;o.parentNode;){var o=o.parentNode,i=A.fromDom(o);if(e(i))return V.some(i);if(r(i))break}return V.none()}function li(n,e){return nt(e,n)}function di(n,e,t){var o=oe(n.slice(0,e)),n=oe(n.slice(e+1));return Qn(o.concat(n),t)}function mi(n,e,t){return n=oe(n.slice(0,e)),Qn(n,t)}function gi(n,e,t){var o=n.slice(0,e),n=n.slice(e+1);return Qn(n.concat(o),t)}function pi(n,e,t){return n=n.slice(e+1),Qn(n,t)}function hi(n){return function(e){return te(n,function(n){return n(e)})}}function vi(n){return!0===n.raw.shiftKey}function yi(n){return!0===n.raw.ctrlKey}function u(n,e){return{matches:n,classification:e}}function bi(n,e,t){return Math.min(Math.max(n,e),t)}function xi(n){for(var e=[],t=function(n){e.push(n)},o=0;o<n.length;o++)n[o].each(t);return e}function wi(t,o,n,r){var e=ai(t.element,"."+o.highlightClass);x(e,function(e){Yn(r,function(n){return n.element===e})||(It(e,o.highlightClass),t.getSystem().getByDom(e).each(function(n){o.onDehighlight(t,n),Ye(n,qe())}))})}function Si(n,e,t,o){wi(n,e,0,[o]),Oi(0,e,0,o)||(Mt(o.element,e.highlightClass),e.onHighlight(n,o),Ye(o,Xe()))}function Oi(n,e,t,o){return An(o.element,e.highlightClass)}function Ti(e,n,t){return li(e.element,"."+n.itemClass).bind(function(n){return e.getSystem().getByDom(n).toOptional()})}function ki(e,n,t){return(0<(n=ai(e.element,"."+n.itemClass)).length?V.some(n[n.length-1]):V.none()).bind(function(n){return e.getSystem().getByDom(n).toOptional()})}function Ei(e,t,n,o){var r=ai(e.element,"."+t.itemClass);return Zn(r,function(n){return An(n,t.highlightClass)}).bind(function(n){n=Li(n,o,0,r.length-1);return e.getSystem().getByDom(r[n]).toOptional()})}function Ci(e,n,t){return n=ai(e.element,"."+n.itemClass),xi(B(n,function(n){return e.getSystem().getByDom(n).toOptional()}))}function Di(n,e,t){e.exists(function(e){return t.exists(function(n){return w(n,e)})})||Ke(n,We(),{prevFocus:e,newFocus:t})}var Mi,_i=function(n,e,t){return fi(n,function(n){return Qe(n,e)},t)},Ii=function(n,e,t){return si(Qe,_i,n,e,t)},Fi=[8],Ri=[9],Vi=[13],Bi=[27],Ai=[32],ji=[37],Ni=[38],Hi=[39],Pi=[40],s=function(e){return function(n){n=n.raw;return qn(e,n.which)}},zi=Y(vi),Li=function(n,e,t,o){n+=e;return o<n?t:n<t?o:n},e=Object.freeze({__proto__:null,dehighlightAll:function(n,e,t){return wi(n,e,0,[])},dehighlight:function(n,e,t,o){Oi(0,e,0,o)&&(It(o.element,e.highlightClass),e.onDehighlight(n,o),Ye(o,qe()))},highlight:Si,highlightFirst:function(e,t,o){Ti(e,t).each(function(n){Si(e,t,o,n)})},highlightLast:function(e,t,o){ki(e,t).each(function(n){Si(e,t,o,n)})},highlightAt:function(e,t,o,n){!function(n,e,t){e=ai(n.element,"."+e.itemClass);return V.from(e[t]).fold(function(){return T.error(new Error("No element found with index "+t))},n.getSystem().getByDom)}(e,t,n).fold(function(n){throw n},function(n){Si(e,t,o,n)})},highlightBy:function(e,t,o,n){var r=Ci(e,t);Qn(r,n).each(function(n){Si(e,t,o,n)})},isHighlighted:Oi,getHighlighted:function(e,n,t){return li(e.element,"."+n.highlightClass).bind(function(n){return e.getSystem().getByDom(n).toOptional()})},getFirst:Ti,getLast:ki,getPrevious:function(n,e,t){return Ei(n,e,0,-1)},getNext:function(n,e,t){return Ei(n,e,0,1)},getCandidates:Ci}),n=[d("highlightClass"),d("itemClass"),go("onHighlight"),go("onDehighlight")],M=Ir({fields:n,name:"highlighting",apis:e}),Gi=function(){function o(n){return ao(n.element)}return{get:o,set:function(n,e){var t=o(n),e=(n.getSystem().triggerFocus(e,n.element),o(n));Di(n,t,e)}}};(t=Mi=Mi||{}).OnFocusMode="onFocus",t.OnEnterOrSpaceMode="onEnterOrSpace",t.OnApiMode="onApi";function $i(n,e,t,o,c){function a(e,t,n,o,r){var n=n(e,t,o,r),i=t.event;return Qn(n,function(n){return n.matches(i)}).map(function(n){return n.classification}).bind(function(n){return n(e,t,o,r)})}var r={schema:function(){return n.concat([g("focusManager",Gi()),hr("focusInside","onFocus",sr(function(n){return qn(["onFocus","onEnterOrSpace","onApi"],n)?T.value(n):T.error("Invalid value for focusInside")})),i("handler",r),i("state",e),i("sendFocusIn",c)])},processKey:a,toEvents:function(i,u){var n=i.focusInside!==Mi.OnFocusMode?V.none():c(i).map(function(t){return E(Be(),function(n,e){t(n,i,u),e.stop()})}),e=[E(De(),function(o,r){a(o,r,t,i,u).fold(function(){var e=o,t=r,n=s(Ai.concat(Vi))(t.event);i.focusInside===Mi.OnEnterOrSpaceMode&&n&&yr(e,t)&&c(i).each(function(n){n(e,i,u),t.stop()})},function(n){r.stop()})}),E(Me(),function(n,e){a(n,e,o,i,u).each(function(n){e.stop()})})];return k(n.toArray().concat(e))}};return r}function Ui(n){function e(e,t,n){var o=t,r=ai(e.element,o.selector),r=Kn(r,function(n){return c(o,n)});V.from(r[o.firstTabstop]).each(function(n){t.focusManager.set(e,n)})}function r(o,n,r,i){var e,u=ai(o.element,r.selector);return(e=r).focusManager.get(o).bind(function(n){return Ii(n,e.selector)}).bind(function(n){return Zn(u,q(w,n)).bind(function(n){return e=o,t=r,i(u,n,function(n){return c(e=t,n=n)&&e.useTabstopAt(n);var e}).fold(function(){return t.cyclic?V.some(!0):V.none()},function(n){return t.focusManager.set(e,n),V.some(!0)});var e,t})})}var n=[m("onEscape"),m("onEnter"),g("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),g("firstTabstop",0),g("useTabstopAt",b),m("visibilitySelector")].concat([n]),c=function(n,e){n=n.visibilitySelector.bind(function(n){return Ii(e,n)}).getOr(e);return 0<Fo(n)},t=h([u(hi([vi,s(Ri)]),function(n,e,t){var o=t.cyclic?di:mi;return r(n,0,t,o)}),u(s(Ri),function(n,e,t){var o=t.cyclic?gi:pi;return r(n,0,t,o)}),u(s(Bi),function(e,t,n){return n.onEscape.bind(function(n){return n(e,t)})}),u(hi([zi,s(Vi)]),function(e,t,n){return n.onEnter.bind(function(n){return n(e,t)})})]),o=h([]);return $i(n,Dr.init,t,o,function(){return V.some(e)})}function Wi(n){return"input"===et(n)&&"radio"!==O(n,"type")||"textarea"===et(n)}function Xi(n,e,t){return Wi(t)&&s(Ai)(e.event)?V.none():(pn(n,t,He()),V.some(!0))}function qi(n,e){return V.some(!0)}function Yi(n,e,t){return t.execute(n,e,n.element)}function Ki(){var t=j(V.none());return Mr({readState:function(){return t.get().map(function(n){return{numRows:String(n.numRows),numColumns:String(n.numColumns)}}).getOr({numRows:"?",numColumns:"?"})},setGridSize:function(n,e){t.set(V.some({numRows:n,numColumns:e}))},getNumRows:function(){return t.get().map(function(n){return n.numRows})},getNumColumns:function(){return t.get().map(function(n){return n.numColumns})}})}function Ji(e,t){return function(n){return"rtl"===$c(n)?t:e}}function Qi(i){return function(n,e,t,o){var r=i(n.element);return Uc(r,n,e,t,o)}}function Zi(n,e){return n=Ji(n,e),Qi(n)}function nu(n,e){return e=Ji(e,n),Qi(e)}function eu(r){return function(n,e,t,o){return Uc(r,n,e,t,o)}}function tu(n,e){return Zn(n,function(n){return w(e,n)})}function ou(e,n,t,o){return o(Math.floor(n/t),n%t).bind(function(n){n=n.row*t+n.column;return 0<=n&&n<e.length?V.some(e[n]):V.none()})}function ru(o,n,r,i,u){return ou(o,n,i,function(n,e){var t=n===r-1?o.length-n*i:i,e=Li(e,u,0,t-1);return V.some({row:n,column:e})})}function iu(o,n,r,i,u){return ou(o,n,i,function(n,e){var n=Li(n,u,0,r-1),t=n===r-1?o.length-n*i:i,e=bi(e,0,t-1);return V.some({row:n,column:e})})}function uu(e,t,n){li(e.element,t.selector).each(function(n){t.focusManager.set(e,n)})}function cu(r){return function(n,e,t,o){return Kc(n,e,t.selector).bind(function(n){return r(n.candidates,n.index,o.getNumRows().getOr(t.initSize.numRows),o.getNumColumns().getOr(t.initSize.numColumns))})}}function au(n,e,t){return t.captureTab?V.some(!0):V.none()}function su(n,e,t,r){function i(n,e,t){var o;return(e=Li(e,r,0,t.length-1))===n?V.none():(o=t[e],"button"===et(o)&&"disabled"===O(o,"disabled")?i(n,e,t):V.from(t[e]))}return Kc(n,t,e).bind(function(n){var e=n.index,n=n.candidates;return i(e,e,n)})}function fu(e,t,o){return(r=o).focusManager.get(e).bind(function(n){return Ii(n,r.selector)}).bind(function(n){return o.execute(e,t,n)});var r}function lu(e,t,n){t.getInitial(e).orThunk(function(){return li(e.element,t.selector)}).each(function(n){t.focusManager.set(e,n)})}function du(n,e,t){return su(n,t.selector,e,-1)}function mu(n,e,t){return su(n,t.selector,e,1)}function gu(r){return function(n,e,t,o){return r(n,e,t,o).bind(function(){return t.executeOnMove?fu(n,e,t):V.some(!0)})}}function pu(n,e,t){return t.onEscape(n,e)}function hu(n,e,t){return V.from(n[e]).bind(function(n){return V.from(n[t]).map(function(n){return{rowIndex:e,columnIndex:t,cell:n}})})}function vu(n,e,t,o){var r=n[e].length,t=Li(t,o,0,r-1);return hu(n,e,t)}function yu(n,e,t,o){return t=Li(t,o,0,n.length-1),o=n[t].length,e=bi(e,0,o-1),hu(n,t,e)}function bu(n,e,t,o){var r=n[e].length,t=bi(t+o,0,r-1);return hu(n,e,t)}function xu(n,e,t,o){return t=bi(t+o,0,n.length-1),o=n[t].length,e=bi(e,0,o-1),hu(n,t,e)}function wu(e,t,n){t.previousSelector(e).orThunk(function(){var n=t.selectors;return li(e.element,n.cell)}).each(function(n){t.focusManager.set(e,n)})}function Su(n,e){return function(t,o,i){var u=i.cycles?n:e;return Ii(o,i.selectors.row).bind(function(n){var e=ai(n,i.selectors.cell);return tu(e,o).bind(function(o){var r=ai(t,i.selectors.row);return tu(r,n).bind(function(n){e=i;var e,t=B(r,function(n){return ai(n,e.selectors.cell)});return u(t,n,o).map(function(n){return n.cell})})})})}}function Ou(e,t,o){return o.focusManager.get(e).bind(function(n){return o.execute(e,t,n)})}function Tu(e,t,n){li(e.element,t.selector).each(function(n){t.focusManager.set(e,n)})}function ku(n,e,t){return su(n,t.selector,e,-1)}function Eu(n,e,t){return su(n,t.selector,e,1)}function Cu(o,n){return e=o,t={},n=B(n,function(n){return e=n.name(),t="Cannot configure "+n.name()+" for "+o,cr(e,e,Wo(),tr(function(n){return Ho("The field: "+e+" is forbidden. "+t)}));var e,t}).concat([qt("dump",R)]),hr(e,t,rr(n));var e,t}function Du(n,e){return y(y({},n.dump),C(e))}function Mu(n){return wt(n,"uiType")}function _u(n){var e=(new Date).getTime();return n+"_"+Math.floor(1e9*Math.random())+ ++la+String(e)}function Iu(e,t){return function(n){n=dr("Converting part type",t,n);return e(n)}}function Fu(n,e,t,o){return Lo(e.defaults(n,t,o),t,{uid:n.partUids[e.name]},e.overrides(n,t,o))}function Ru(n,e,t){return ba(n,e,t).getOrDie("Could not find part: "+t)}function Vu(o){return n=function(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return o.apply(void 0,c([n.getApis(),n],e))},t=(e=o.toString()).indexOf(")")+1,r=e.indexOf("("),i=e.substring(r+1,t-1).split(/,\s*/),n.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:Or(i.slice(1))}},n;var n,e,t,r,i}function Bu(n){return n=tt(n)?n.dom[Ta]:null,V.from(n)}function Au(n,e,t,o,r){var r=Da(r),i=ee(t,function(n){return n.fold(V.none,V.some,V.none,V.none).map(function(n){return gr(n.name,n.schema.concat([Yr(pa())]))}).toArray()}),u=xa(t),e=Ca(n,e,r,i,[u]),i=va(0,e,t);return o(e,ya(n,e,i.internals()),r,i.externals())}function ju(n){var r=dr("Sketcher for "+n.name,Ma,n),n=bt(r.apis,Vu),e=bt(r.extraApis,Tr);return y(y({name:r.name,configFields:r.configFields,sketch:function(n){return e=r.name,t=r.configFields,o=r.factory,n=Da(n),o(Ca(e,t,n,[],[]),n);var e,t,o}},n),e)}function Nu(n){var r,e,t=dr("Sketcher for "+n.name,_a,n),n=(r=t.name,n=t.partFields,e={},x(n,function(n){n.fold(V.some,V.none,V.some,V.some).each(function(t){var o=ha(r,t.pname);e[t.name]=function(n){var e=dr("Part: "+t.name+" in "+r,rr(t.schema),n);return y(y({},o),{config:n,validated:e})}})}),e),o=bt(t.apis,Vu),i=bt(t.extraApis,Tr);return y(y({name:t.name,partFields:t.partFields,configFields:t.configFields,sketch:function(n){return Au(t.name,t.configFields,t.partFields,t.factory,n)},parts:n},o),i)}function Hu(n){return{dom:f(n)}}function Pu(e){return ga({name:e+"-edge",overrides:function(n){return n.model.manager.edgeActions[e].fold(function(){return{}},function(o){return{events:k([Qt(we(),function(n,e,t){return o(n,t)},[n]),Qt(Te(),function(n,e,t){return o(n,t)},[n]),Qt(ke(),function(n,e,t){t.mouseIsDown.get()&&o(n,t)},[n])])}})}})}function zu(n,e,t){e.store.manager.onLoad(n,e,t)}function Lu(n,e,t){e.store.manager.onUnload(n,e,t)}function Gu(){var n=j(null);return Mr({set:n.set,get:n.get,isNotSet:function(){return null===n.get()},clear:function(){n.set(null)},readState:function(){return{mode:"memory",value:n.get()}}})}function $u(){var i=j({}),u=j({});return Mr({readState:function(){return{mode:"dataset",dataByValue:i.get(),dataByText:u.get()}},lookup:function(n){return p(i.get(),n).orThunk(function(){return p(u.get(),n)})},update:function(n){var e=i.get(),t=u.get(),o={},r={};x(n,function(e){o[e.value]=e,p(e,"meta").each(function(n){p(n,"text").each(function(n){r[n]=e})})}),i.set(y(y({},e),o)),u.set(y(y({},t),r))},clear:function(){i.set({}),u.set({})}})}function Uu(n,e,t,o){var r=e.store;t.update([o]),r.setValue(n,o),e.onSetValue(n,o)}function Wu(n,e){Na.set(n,e)}function Xu(n){return Na.get(n)}function qu(t,o){return{left:t,top:o,translate:function(n,e){return qu(t+n,o+e)}}}function Yu(n){return-1===(n=n.event.raw).type.indexOf("touch")?void 0!==n.clientX?V.some(n).map(function(n){return Ha(n.clientX,n.clientY)}):V.none():void 0!==n.touches&&1===n.touches.length?V.some(n.touches[0]).map(function(n){return Ha(n.clientX,n.clientY)}):V.none()}function Ku(n){return n.model.minX-1}function Ju(n){return n.model.minY-1}function Qu(n){return n.model.maxX+1}function Zu(n){return n.model.maxY+1}function nc(n){return Ua(n,Ga,za)}function ec(n){return Ua(n,$a,La)}function tc(n){return nc(n)/2}function oc(n){return ec(n)/2}function rc(n){return n.stepSize}function ic(n){return n.snapToGrid}function uc(n){return n.snapStart}function cc(n){return n.rounded}function ac(n){return Wa(n,"left")}function sc(n){return Wa(n,"right")}function fc(n){return Wa(n,"top")}function lc(n){return Wa(n,"bottom")}function dc(n){return n.model.value.get()}function mc(n,e){return{x:n,y:e}}function gc(n,e){Ke(n,Pa(),{value:e})}function pc(n){var r,e,i,u,t=n.min,o=n.max,c=n.range,a=n.value,s=n.step,f=n.snap,l=n.snapStart,d=n.rounded,m=n.hasMinEdge,g=n.hasMaxEdge,p=n.minBound,h=n.maxBound,n=n.screenRange,m=m?t-1:t,g=g?o+1:o;return a<p?m:h<a?g:(p=p,h=Math.min(h,Math.max(a,p))-p,a=Ya(h/n*c+t,m,g),f&&t<=a&&a<=o?(r=a,e=t,i=o,u=s,l.fold(function(){var n=Math.round((r-e)/u)*u;return Ya(e+n,e-1,i+1)},function(n){var e=Math.round((r-n)%u/u),t=Math.floor((r-n)/u),o=Math.floor((i-n)/u),o=n+Math.min(o,t+e)*u;return Math.max(n,o)})):d?Math.round(a):a)}function hc(n){var e=n.min,t=n.max,o=n.range,r=n.value,i=n.hasMinEdge,u=n.hasMaxEdge,c=n.maxBound,a=n.maxOffset,s=n.centerMinEdge,n=n.centerMaxEdge;return r<e?i?0:s:t<r?u?c:n:(r-e)/o*a}function vc(n){return n=Ja(n),Qa(n,Ka)}function yc(n){return n=Ja(n),Qa(n,"right")}function bc(n){return n=Ja(n),Qa(n,"top")}function xc(n){return n=Ja(n),Qa(n,"bottom")}function wc(n){return n=Ja(n),Qa(n,"width")}function Sc(n){return n=Ja(n),Qa(n,"height")}function Oc(n,e){var n=Ja(n),e=Ja(e),t=Qa(n,Ka),n=Qa(n,"right"),e=Qa(e,Ka);return Za(t,n,e)}function Tc(n,e){var n=Ja(n),e=Ja(e),t=Qa(n,"top"),n=Qa(n,"bottom"),e=Qa(e,"top");return Za(t,n,e)}function kc(n,e){Ke(n,Pa(),{value:e})}function Ec(n,e,t){return t={min:za(e),max:Ga(e),range:nc(e),value:t,step:rc(e),snap:ic(e),snapStart:uc(e),rounded:cc(e),hasMinEdge:ac(e),hasMaxEdge:sc(e),minBound:vc(n),maxBound:yc(n),screenRange:wc(n)},pc(t)}function Cc(t){return function(n,e){return n=n,e=(0<t?qa:Xa)(dc(e=e).x,za(e),Ga(e),rc(e)),kc(n,{x:e}),V.some(e).map(b)}}function Dc(n,e,t,o,r,i){i=i,t=t,o=o,r=r,c=wc(u=e),o=o.bind(function(n){return V.some(Oc(n,u))}).getOr(0),r=r.bind(function(n){return V.some(Oc(n,u))}).getOr(c),t={min:za(i),max:Ga(i),range:nc(i),value:t,hasMinEdge:ac(i),hasMaxEdge:sc(i),minBound:vc(u),minOffset:0,maxBound:yc(u),maxOffset:c,centerMinEdge:o,centerMaxEdge:r};var u,c,i=hc(t);return vc(e)-vc(n)+i}function Mc(n,e){Ke(n,Pa(),{value:e})}function _c(n,e,t){return t={min:La(e),max:$a(e),range:ec(e),value:t,step:rc(e),snap:ic(e),snapStart:uc(e),rounded:cc(e),hasMinEdge:fc(e),hasMaxEdge:lc(e),minBound:bc(n),maxBound:xc(n),screenRange:Sc(n)},pc(t)}function Ic(t){return function(n,e){return n=n,e=(0<t?qa:Xa)(dc(e=e).y,La(e),$a(e),rc(e)),Mc(n,{y:e}),V.some(e).map(b)}}function Fc(n,e,t,o,r,i){i=i,t=t,o=o,r=r,c=Sc(u=e),o=o.bind(function(n){return V.some(Tc(n,u))}).getOr(0),r=r.bind(function(n){return V.some(Tc(n,u))}).getOr(c),t={min:La(i),max:$a(i),range:ec(i),value:t,hasMinEdge:fc(i),hasMaxEdge:lc(i),minBound:bc(u),minOffset:0,maxBound:xc(u),maxOffset:c,centerMinEdge:o,centerMaxEdge:r};var u,c,i=hc(t);return bc(e)-bc(n)+i}function Rc(n,e){Ke(n,Pa(),{value:e})}function Vc(n,e){return{x:n,y:e}}function Bc(i,u){return function(n,e){return n=n,e=e,t=0<i?qa:Xa,o=(r=u)?dc(e).x:t(dc(e).x,za(e),Ga(e),rc(e)),r=r?t(dc(e).y,La(e),$a(e),rc(e)):dc(e).y,Rc(n,Vc(o,r)),V.some(o).map(b);var t,o,r}}function Ac(n){var e,t=n.selection.getStart(),t=A.fromDom(t),o=A.fromDom(n.getBody()),r=(e=function(n){return w(o,n)},(tt(n=t)?V.some(n):ut(n).filter(tt)).map(function(n){return si(function(n,e){return e(n)},fi,n,function(n){return _o(n,"font-size").isSome()},e).bind(function(n){return _o(n,"font-size")}).getOrThunk(function(){return Mo(n,"font-size")})}).getOr(""));return Qn(rs,function(n){return r===n}).getOr("medium")}function jc(n){var e=void 0!==n.uid&&St(n,"uid")?n.uid:Ea("memento");return{get:function(n){return n.getSystem().getByUid(e).getOrDie()},getOpt:function(n){return n.getSystem().getByUid(e).toOptional()},asSpec:function(){return y(y({},n),{uid:e})}}}var Nc,Hc,Pc,zc,Lc,n=Ui(qt("cyclic",v)),e=Ui(qt("cyclic",b)),t=[g("execute",Xi),g("useSpace",!1),g("useEnter",!0),g("useControlEnter",!1),g("useDown",!1)],t=$i(t,Dr.init,function(n,e,t,o){var n=t.useSpace&&!Wi(n.element)?Ai:[],r=t.useEnter?Vi:[],i=t.useDown?Pi:[],n=n.concat(r).concat(i);return[u(s(n),Yi)].concat(t.useControlEnter?[u(hi([yi,s(Vi)]),Yi)]:[])},function(n,e,t,o){return t.useSpace&&!Wi(n.element)?[u(s(Ai),qi)]:[]},function(){return V.none()}),Gc=Object.freeze({__proto__:null,flatgrid:Ki,init:function(n){return n.state(n)}}),$c=function(n){return"rtl"===Mo(n,"direction")?"rtl":"ltr"},Uc=function(e,t,n,o,r){return o.focusManager.get(t).bind(function(n){return e(t.element,n,o,r)}).map(function(n){return o.focusManager.set(t,n),!0})},Wc=eu,Xc=eu,qc=eu,Yc=function(n){return!((n=n.dom).offsetWidth<=0&&n.offsetHeight<=0)},Kc=function(n,e,t){var o,n=ai(n,t),t=Kn(n,Yc);return Zn(o=t,function(n){return w(n,e)}).map(function(n){return{index:n,candidates:o}})},Jc=[d("selector"),g("execute",Xi),po("onEscape"),g("captureTab",!1),qr()],Qc=cu(function(n,e,t,o){return ru(n,e,t,o,-1)}),Zc=cu(function(n,e,t,o){return ru(n,e,t,o,1)}),na=cu(function(n,e,t,o){return iu(n,e,t,o,-1)}),ea=cu(function(n,e,t,o){return iu(n,e,t,o,1)}),Qc=h([u(s(ji),Zi(Qc,Zc)),u(s(Hi),nu(Qc,Zc)),u(s(Ni),Wc(na)),u(s(Pi),Xc(ea)),u(hi([vi,s(Ri)]),au),u(hi([zi,s(Ri)]),au),u(s(Bi),function(n,e,t){return t.onEscape(n,e)}),u(s(Ai.concat(Vi)),function(e,t,o,n){return(r=o).focusManager.get(e).bind(function(n){return Ii(n,r.selector)}).bind(function(n){return o.execute(e,t,n)});var r})]),Zc=h([u(s(Ai),qi)]),na=$i(Jc,Ki,Qc,Zc,function(){return V.some(uu)}),ea=[d("selector"),g("getInitial",V.none),g("execute",Xi),po("onEscape"),g("executeOnMove",!1),g("allowVertical",!0)],Jc=h([u(s(Ai),qi)]),Qc=$i(ea,Dr.init,function(n,e,t,o){var r=ji.concat(t.allowVertical?Ni:[]),t=Hi.concat(t.allowVertical?Pi:[]);return[u(s(r),gu(Zi(du,mu))),u(s(t),gu(nu(du,mu))),u(s(Vi),fu),u(s(Ai),fu),u(s(Bi),pu)]},Jc,function(){return V.some(lu)}),Zc=[gr("selectors",[d("row"),d("cell")]),g("cycles",!0),g("previousSelector",V.none),g("execute",Xi)],ea=Su(function(n,e,t){return vu(n,e,t,-1)},function(n,e,t){return bu(n,e,t,-1)}),Jc=Su(function(n,e,t){return vu(n,e,t,1)},function(n,e,t){return bu(n,e,t,1)}),ta=Su(function(n,e,t){return yu(n,t,e,-1)},function(n,e,t){return xu(n,t,e,-1)}),oa=Su(function(n,e,t){return yu(n,t,e,1)},function(n,e,t){return xu(n,t,e,1)}),ea=h([u(s(ji),Zi(ea,Jc)),u(s(Hi),nu(ea,Jc)),u(s(Ni),Wc(ta)),u(s(Pi),Xc(oa)),u(s(Ai.concat(Vi)),function(e,t,o){return ao(e.element).bind(function(n){return o.execute(e,t,n)})})]),Jc=h([u(s(Ai),qi)]),Wc=$i(Zc,Dr.init,ea,Jc,function(){return V.some(wu)}),ta=[d("selector"),g("execute",Xi),g("moveOnTab",!1)],Xc=h([u(s(Ni),qc(ku)),u(s(Pi),qc(Eu)),u(hi([vi,s(Ri)]),function(n,e,t,o){return t.moveOnTab?qc(ku)(n,e,t,o):V.none()}),u(hi([zi,s(Ri)]),function(n,e,t,o){return t.moveOnTab?qc(Eu)(n,e,t,o):V.none()}),u(s(Vi),Ou),u(s(Ai),Ou)]),oa=h([u(s(Ai),qi)]),Zc=$i(ta,Dr.init,Xc,oa,function(){return V.some(Tu)}),ea=[po("onSpace"),po("onEnter"),po("onShiftEnter"),po("onLeft"),po("onRight"),po("onTab"),po("onShiftTab"),po("onUp"),po("onDown"),po("onEscape"),g("stopSpaceKeyup",!1),m("focusIn")],Jc=$i(ea,Dr.init,function(n,e,t){return[u(s(Ai),t.onSpace),u(hi([zi,s(Vi)]),t.onEnter),u(hi([vi,s(Vi)]),t.onShiftEnter),u(hi([vi,s(Ri)]),t.onShiftTab),u(hi([zi,s(Ri)]),t.onTab),u(s(Ni),t.onUp),u(s(Pi),t.onDown),u(s(ji),t.onLeft),u(s(Hi),t.onRight),u(s(Ai),t.onSpace),u(s(Bi),t.onEscape)]},function(n,e,t){return t.stopSpaceKeyup?[u(s(Ai),qi)]:[]},function(n){return n.focusIn}),ta=n.schema(),Xc=e.schema(),oa=Qc.schema(),ea=na.schema(),n=Wc.schema(),e=t.schema(),Qc=Zc.schema(),na=Jc.schema(),_=(Zc=$t((t=dr("Creating behaviour: "+(Wc={branchKey:"mode",branches:Object.freeze({__proto__:null,acyclic:ta,cyclic:Xc,flow:oa,flatgrid:ea,matrix:n,execution:e,menu:Qc,special:na}),name:"keying",active:{events:function(n,e){return n.handler.toEvents(n,e)}},apis:{focusIn:function(e,t,o){t.sendFocusIn(t).fold(function(){e.getSystem().triggerFocus(e.element,e.element)},function(n){n(e,t,o)})},setGridSize:function(n,e,t,o,r){St(t,"setGridSize")?t.setGridSize(o,r):console.error("Layout does not support setGridSize")}},state:Gc}).name,Fr,Wc)).branchKey,t.branches),Jc=t.name,ta=t.active,Xc=t.apis,oa=t.extra,ea=t.state,e=Wt(Jc,[pr("config",n=Zc)]),ro(n,e,Jc,ta,Xc,oa,ea)),Qc=Cu,ra=Du,ia="placeholder",ua=Bt([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),ca=function(o,r,i,u){return n=o,t=u,(Mu(e=i)&&e.uiType===ia?(a=e,s=t,(c=n).exists(function(n){return n!==a.owner})?ua.single(!0,h(a)):p(s,a.name).fold(function(){throw new Error("Unknown placeholder component: "+a.name+"\nKnown: ["+ht(s)+"]\nNamespace: "+c.getOr("none")+"\nSpec: "+JSON.stringify(a,null,2))},function(n){return n.replace()})):ua.single(!1,h(e))).fold(function(n,e){var e=Mu(i)?e(r,i.config,i.validated):e(r),t=p(e,"components").getOr([]),t=ee(t,function(n){return ca(o,r,n,u)});return[y(y({},e),{components:t})]},function(n,e){var t;return Mu(i)?(t=e(r,i.config,i.validated),i.validated.preprocess.getOr(R)(t)):e(r)});var n,e,t,c,a,s},aa=ua.single,sa=ua.multiple,fa=h(ia),la=0,na=Bt([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),Gc=g("factory",{sketch:R}),Fr=g("schema",[]),Wc=d("name"),t=cr("pname","pname",ae(function(n){return"<alloy."+_u(n.name)+">"}),mr()),Zc=ur("schema",function(){return[m("preprocess")]}),n=g("defaults",h({})),e=g("overrides",h({})),Jc=rr([Gc,Fr,Wc,t,n,e]),ta=rr([Gc,Fr,Wc,n,e]),Xc=rr([Gc,Fr,Wc,t,n,e]),oa=rr([Gc,Zc,Wc,d("unit"),t,n,e]),da=function(n){function e(n){return n.name}return n.fold(e,e,e,e)},ma=Iu(na.required,Jc),ga=(Iu(na.external,ta),Iu(na.optional,Xc)),ea=Iu(na.group,oa),pa=h("entirety"),ha=function(n,e){return{uiType:fa(),owner:n,name:e}},va=function(n,e,t){return o=e,i={},r={},x(t,function(n){n.fold(function(o){i[o.pname]=aa(!0,function(n,e,t){return o.factory.sketch(Fu(n,o,e,t))})},function(n){var e=o.parts[n.name];r[n.name]=h(n.factory.sketch(Fu(o,n,e[pa()]),e))},function(o){i[o.pname]=aa(!1,function(n,e,t){return o.factory.sketch(Fu(n,o,e,t))})},function(r){i[r.pname]=sa(!0,function(e,n,t){var o=e[r.name];return B(o,function(n){return r.factory.sketch(Lo(r.defaults(e,n,t),n,r.overrides(e,n)))})})})}),{internals:h(i),externals:h(r)};var o,i,r},ya=function(n,e,t){return o=V.some(n),n=(r=e).components,e=bt(e=t,function(n,e){return o=n,r=!1,{name:h(t=e),required:function(){return o.fold(function(n,e){return n},function(n,e){return n})},used:function(){return r},replace:function(){if(r)throw new Error("Trying to use the same placeholder more than once: "+t);return r=!0,o}};var t,o,r}),i=o,u=r,c=e,n=ee(n,function(n){return ca(i,u,n,c)}),yt(e,function(n){if(!1===n.used()&&n.required())throw new Error("Placeholder: "+n.name()+" was not found in components list\nNamespace: "+o.getOr("none")+"\nComponents: "+JSON.stringify(r.components,null,2))}),n;var o,r,i,u,c},ba=function(n,e,t){e=e.partUids[t];return n.getSystem().getByUid(e).toOptional()},xa=function(t){return cr("partUids","partUids",Xo(function(n){var e=n.uid,n=t;return n=B(t,da),Yo(B(n,function(n){return{key:n,value:e+"-"+n}}))}),mr())},wa=_u("alloy-premade"),Sa=function(n){return qo(wa,n)},ae=h("alloy-id-"),Fr=h("data-alloy-id"),Oa=ae(),Ta=Fr(),ka=function(n,e){Object.defineProperty(n.dom,Ta,{value:e,writable:!0})},Ea=_u,Ca=function(n,e,t,o,r){r=r;o=(0<o.length?[gr("parts",o)]:[]).concat([d("uid"),g("dom",{}),g("components",[]),Yr("originalSpec"),g("debug.sketcher",{})]).concat(r);return dr(n+" [SpecSchema]",or(o.concat(e)),t)},Da=function(n){return wt(n,"uid")?n:y(y({},n),{uid:Ea("uid")})},Ma=or([d("name"),d("factory"),d("configFields"),g("apis",{}),g("extraApis",{})]),_a=or([d("name"),d("factory"),d("configFields"),d("partFields"),g("apis",{}),g("extraApis",{})]),Ia=ju({name:"Button",factory:function(n){function e(e){return p(n.dom,"attributes").bind(function(n){return p(n,e)})}t=n.action;var t=k(ne([t.map(function(t){return to(function(n,e){t(n),e.stop()})}).toArray(),ko()])),o=n.dom.tag;return{uid:n.uid,dom:n.dom,components:n.components,events:t,behaviours:ra(n.buttonBehaviours,[ti.config({}),_.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:"button"!==o?{role:e("role").getOr("button")}:(t=e("type").getOr("button"),o=e("role").map(function(n){return{role:n}}).getOr({}),y({type:t},o))},eventOrder:n.eventOrder}},configFields:[g("uid",void 0),d("dom"),g("components",[]),Qc("buttonBehaviours",[ti,_]),m("action"),m("role"),g("eventOrder",{})]}),Fa=Ir({fields:[],name:"unselecting",active:Object.freeze({__proto__:null,events:function(){return k([Jt(Ve(),b)])},exhibit:function(){return kr({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})}})}),Ra=function(n){var n=A.fromHtml(n),e=ct(n),t=(t=void 0!==n.dom.attributes?n.dom.attributes:[],Z(t,function(n,e){return"class"===e.name?n:y(y({},n),((n={})[e.name]=e.value,n))},{})),o=Array.prototype.slice.call(n.dom.classList,0),e=0===e.length?{}:{innerHtml:so(n)};return y({tag:et(n),classes:o,attributes:t},e)},f=function(n){n=ue(n,{prefix:ei});return Ra(n)},Va=function(n){return C([D.config({toggleClass:N("toolbar-button-selected"),toggleOnExecute:!1,aria:{mode:"pressed"}}),To(n,function(n,e){(e?D.on:D.off)(n)})])},Ba=function(n,e,t,o){t=Va(t);return ja(e,o,t,n)},Aa=function(n,e){e=e.ui.registry.getAll().icons;return V.from(e[n]).fold(function(){return f('<span class="${prefix}-toolbar-button ${prefix}-toolbar-group-item ${prefix}-icon-'+n+' ${prefix}-icon"></span>')},function(n){return f('<span class="${prefix}-toolbar-button ${prefix}-toolbar-group-item">'+n+"</span>")})},ja=function(n,e,t,o){return Ia.sketch({dom:Aa(n,o),action:e,buttonBehaviours:Lo(C([Fa.config({})]),t)})},Gc=ga({schema:[d("dom")],name:"label"}),Zc=Pu("top-left"),Wc=Pu("top"),t=Pu("top-right"),n=Pu("right"),e=Pu("bottom-right"),Jc=Pu("bottom"),ta=Pu("bottom-left"),Xc=[Gc,Pu("left"),n,Wc,Jc,Zc,t,ta,e,ma({name:"thumb",defaults:h({dom:{styles:{position:"absolute"}}}),overrides:function(n){return{events:k([no(we(),n,"spectrum"),no(Se(),n,"spectrum"),no(Oe(),n,"spectrum"),no(Te(),n,"spectrum"),no(ke(),n,"spectrum"),no(Ee(),n,"spectrum")])}}}),ma({schema:[ur("mouseIsDown",function(){return j(!1)})],name:"spectrum",overrides:function(t){function o(e,n){return r.getValueFromEvent(n).map(function(n){return r.setValueFrom(e,t,n)})}var r=t.model.manager;return{behaviours:C([_.config({mode:"special",onLeft:function(n){return r.onLeft(n,t)},onRight:function(n){return r.onRight(n,t)},onUp:function(n){return r.onUp(n,t)},onDown:function(n){return r.onDown(n,t)}}),ti.config({})]),events:k([E(we(),o),E(Se(),o),E(Te(),o),E(ke(),function(n,e){t.mouseIsDown.get()&&o(n,e)})])}}})],na=Object.freeze({__proto__:null,onLoad:zu,onUnload:Lu,setValue:function(n,e,t,o){e.store.manager.setValue(n,e,t,o)},getValue:function(n,e,t){return e.store.manager.getValue(n,e,t)},getState:function(n,e,t){return t}}),oa=Object.freeze({__proto__:null,events:function(t,o){var n=t.resetOnDom?[xr(function(n,e){zu(n,t,o)}),wr(function(n,e){Lu(n,t,o)})]:[oo(t,o,zu)];return k(n)}}),ae=Object.freeze({__proto__:null,memory:Gu,dataset:$u,manual:function(){return Mr({readState:F})},init:function(n){return n.store.manager.state(n)}}),Fr=[m("initialValue"),d("getFallbackEntry"),d("getDataKey"),d("setValue"),i("manager",{setValue:Uu,getValue:function(n,e,t){var o=e.store,r=o.getDataKey(n);return t.lookup(r).fold(function(){return o.getFallbackEntry(r)},function(n){return n})},onLoad:function(e,t,o){t.store.initialValue.each(function(n){Uu(e,t,o,n)})},onUnload:function(n,e,t){t.clear()},state:$u})],Gc=[d("getValue"),g("setValue",F),m("initialValue"),i("manager",{setValue:function(n,e,t,o){e.store.setValue(n,o),e.onSetValue(n,o)},getValue:function(n,e,t){return e.store.getValue(n)},onLoad:function(e,t,n){t.store.initialValue.each(function(n){t.store.setValue(e,n)})},onUnload:F,state:Dr.init})],n=[m("initialValue"),i("manager",{setValue:function(n,e,t,o){t.set(o),e.onSetValue(n,o)},getValue:function(n,e,t){return t.get()},onLoad:function(n,e,t){e.store.initialValue.each(function(n){t.isNotSet()&&t.set(n)})},onUnload:function(n,e,t){t.clear()},state:Gu})],Wc=[hr("store",{mode:"memory"},$t("mode",{memory:n,manual:Gc,dataset:Fr})),go("onSetValue"),g("resetOnDom",!1)],I=Ir({fields:Wc,name:"representing",active:oa,apis:na,extra:{setValueFrom:function(n,e){e=I.getValue(e);I.setValue(n,e)}},state:ae}),Na=Io("width",function(n){return n.dom.offsetWidth}),Ha=qu,Pa=h("slider.change.value"),za=function(n){return n.model.minX},La=function(n){return n.model.minY},Ga=function(n){return n.model.maxX},$a=function(n){return n.model.maxY},Ua=function(n,e,t){return e(n)-t(n)},Wa=function(n,e){return void 0!==n[e+"-edge"]},Xa=function(n,e,t,o){return n<e?n:t<n?t:n===e?e-1:Math.max(e,n-o)},qa=function(n,e,t,o){return t<n?n:n<e?e:n===t?t+1:Math.min(t,n+o)},Ya=function(n,e,t){return Math.max(e,Math.min(t,n))},Ka="left",Ja=function(n){return n.element.dom.getBoundingClientRect()},Qa=function(n,e){return n[e]},Za=function(n,e,t){return(n+e)/2-t},Jc=Cc(-1),Zc=Cc(1),t=V.none,ta=V.none,e={"top-left":V.none(),top:V.none(),"top-right":V.none(),right:V.some(function(n,e){gc(n,{x:Qu(e)})}),"bottom-right":V.none(),bottom:V.none(),"bottom-left":V.none(),left:V.some(function(n,e){gc(n,{x:Ku(e)})})},n=Object.freeze({__proto__:null,setValueFrom:function(n,e,t){e=Ec(n,e,t);return kc(n,{x:e}),e},setToMin:function(n,e){e=za(e);kc(n,{x:e})},setToMax:function(n,e){e=Ga(e);kc(n,{x:e})},findValueOfOffset:Ec,getValueFromEvent:function(n){return Yu(n).map(function(n){return n.left})},findPositionOfValue:Dc,setPositionFromValue:function(n,e,t,o){var r=dc(t),r=Dc(n,o.getSpectrum(n),r.x,o.getLeftEdge(n),o.getRightEdge(n),t),o=Xu(e.element)/2;H(e.element,"left",r-o+"px")},onLeft:Jc,onRight:Zc,onUp:t,onDown:ta,edgeActions:e}),Gc=V.none,Fr=V.none,Wc=Ic(-1),oa=Ic(1),na={"top-left":V.none(),top:V.some(function(n,e){gc(n,{y:Ju(e)})}),"top-right":V.none(),right:V.none(),"bottom-right":V.none(),bottom:V.some(function(n,e){gc(n,{y:Zu(e)})}),"bottom-left":V.none(),left:V.none()},ae=Object.freeze({__proto__:null,setValueFrom:function(n,e,t){e=_c(n,e,t);return Mc(n,{y:e}),e},setToMin:function(n,e){e=La(e);Mc(n,{y:e})},setToMax:function(n,e){e=$a(e);Mc(n,{y:e})},findValueOfOffset:_c,getValueFromEvent:function(n){return Yu(n).map(function(n){return n.top})},findPositionOfValue:Fc,setPositionFromValue:function(n,e,t,o){var r=dc(t),r=Fc(n,o.getSpectrum(n),r.y,o.getTopEdge(n),o.getBottomEdge(n),t),o=Fo(e.element)/2;H(e.element,"top",r-o+"px")},onLeft:Gc,onRight:Fr,onUp:Wc,onDown:oa,edgeActions:na}),Jc=Yu,Zc=Bc(-1,!1),t=Bc(1,!1),ta=Bc(-1,!0),e=Bc(1,!0),Gc={"top-left":V.some(function(n,e){gc(n,mc(Ku(e),Ju(e)))}),top:V.some(function(n,e){gc(n,mc(tc(e),Ju(e)))}),"top-right":V.some(function(n,e){gc(n,mc(Qu(e),Ju(e)))}),right:V.some(function(n,e){gc(n,mc(Qu(e),oc(e)))}),"bottom-right":V.some(function(n,e){gc(n,mc(Qu(e),Zu(e)))}),bottom:V.some(function(n,e){gc(n,mc(tc(e),Zu(e)))}),"bottom-left":V.some(function(n,e){gc(n,mc(Ku(e),Zu(e)))}),left:V.some(function(n,e){gc(n,mc(Ku(e),oc(e)))})},Fr=Object.freeze({__proto__:null,setValueFrom:function(n,e,t){var o=Ec(n,e,t.left),e=_c(n,e,t.top),t=Vc(o,e);return Rc(n,t),t},setToMin:function(n,e){var t=za(e),e=La(e);Rc(n,Vc(t,e))},setToMax:function(n,e){var t=Ga(e),e=$a(e);Rc(n,Vc(t,e))},getValueFromEvent:Jc,setPositionFromValue:function(n,e,t,o){var r=dc(t),i=Dc(n,o.getSpectrum(n),r.x,o.getLeftEdge(n),o.getRightEdge(n),t),r=Fc(n,o.getSpectrum(n),r.y,o.getTopEdge(n),o.getBottomEdge(n),t),o=Xu(e.element)/2,n=Fo(e.element)/2;H(e.element,"left",i-o+"px"),H(e.element,"top",r-n+"px")},onLeft:Zc,onRight:t,onUp:ta,onDown:e,edgeActions:Gc}),Wc=[g("stepSize",1),g("onChange",F),g("onChoose",F),g("onInit",F),g("onDragStart",F),g("onDragEnd",F),g("snapToGrid",!1),g("rounded",!0),m("snapStart"),Ut("model",$t("mode",{x:[g("minX",0),g("maxX",100),ur("value",function(n){return j(n.mode.minX)}),d("getInitialValue"),i("manager",n)],y:[g("minY",0),g("maxY",100),ur("value",function(n){return j(n.mode.minY)}),d("getInitialValue"),i("manager",ae)],xy:[g("minX",0),g("maxX",100),g("minY",0),g("maxY",100),ur("value",function(n){return j({x:n.mode.minX,y:n.mode.minY})}),d("getInitialValue"),i("manager",Fr)]})),Cu("sliderBehaviours",[_,I]),ur("mouseIsDown",function(){return j(!1)})],ns=h("mouse.released"),es=Nu({name:"Slider",configFields:Wc,partFields:Xc,factory:function(r,n,e,t){function i(n){return Ru(n,r,"thumb")}function u(n,e){h.setPositionFromValue(n,e,r,{getLeftEdge:l,getRightEdge:d,getTopEdge:m,getBottomEdge:g,getSpectrum:f})}function o(n,e){p.value.set(e),e=i(n),u(n,e)}function c(t){var n=r.mouseIsDown.get();r.mouseIsDown.set(!1),n&&ba(t,r,"thumb").each(function(n){var e=p.value.get();r.onChoose(t,n,e)})}function a(n,e){e.stop(),r.mouseIsDown.set(!0),r.onDragStart(n,i(n))}function s(n,e){e.stop(),r.onDragEnd(n,i(n)),c(n)}var f=function(n){return Ru(n,r,"spectrum")},l=function(n){return ba(n,r,"left-edge")},d=function(n){return ba(n,r,"right-edge")},m=function(n){return ba(n,r,"top-edge")},g=function(n){return ba(n,r,"bottom-edge")},p=r.model,h=p.manager;return{uid:r.uid,dom:r.dom,components:n,behaviours:Du(r.sliderBehaviours,[_.config({mode:"special",focusIn:function(n){return ba(n,r,"spectrum").map(_.focusIn).map(b)}}),I.config({store:{mode:"manual",getValue:function(n){return p.value.get()}}}),Kr.config({channels:((n={})[ns()]={onReceive:c},n)})]),events:k([E(Pa(),function(n,e){var t;n=n,e=e.event.value,o(n,e),t=i(n),r.onChange(n,t,e),V.some(!0)}),xr(function(n,e){var t=p.getInitialValue(),t=(p.value.set(t),i(n)),o=(u(n,t),f(n));r.onInit(n,t,o,p.value.get())}),E(we(),a),E(Oe(),s),E(Te(),a),E(Ee(),s)]),apis:{resetToMin:function(n){h.setToMin(n,r)},resetToMax:function(n){h.setToMax(n,r)},setValue:o,refresh:u},domModification:{styles:{position:"relative"}}}},apis:{setValue:function(n,e,t){n.setValue(e,t)},resetToMin:function(n,e){n.resetToMin(e)},resetToMax:function(n,e){n.resetToMax(e)},refresh:function(n,e){n.refresh(e)}}}),ts=function(e,t,o,n){return ja(t,function(){var n=o();e.setContextToolbar([{label:t+" group",items:n}])},{},n)},os=function(n){return[(o=n,r=function(n){return n<0?"black":360<n?"white":"hsl("+n+", 100%, 50%)"},es.sketch({dom:f('<div class="${prefix}-slider ${prefix}-hue-slider-container"></div>'),components:[es.parts["left-edge"](Hu('<div class="${prefix}-hue-slider-black"></div>')),es.parts.spectrum({dom:f('<div class="${prefix}-slider-gradient-container"></div>'),components:[Hu('<div class="${prefix}-slider-gradient"></div>')],behaviours:C([D.config({toggleClass:N("thumb-active")})])}),es.parts["right-edge"](Hu('<div class="${prefix}-hue-slider-white"></div>')),es.parts.thumb({dom:f('<div class="${prefix}-slider-thumb"></div>'),behaviours:C([D.config({toggleClass:N("thumb-active")})])})],onChange:function(n,e,t){t=r(t.x());H(e.element,"background-color",t),o.onChange(n,e,t)},onDragStart:function(n,e){D.on(e)},onDragEnd:function(n,e){D.off(e)},onInit:function(n,e,t,o){o=r(o.x());H(e.element,"background-color",o)},stepSize:10,model:{mode:"x",minX:0,maxX:360,getInitialValue:function(){return{x:o.getInitialValue()}}},sliderBehaviours:C([Zr(es.refresh)])}))];var o,r},rs=["9px","10px","11px","12px","14px","16px","18px","20px","24px","32px","36px"],is=function(n){var e=Ac(n);return Zn(rs,function(n){return n===e}).getOr(2)},us=function(t,n){V.from(rs[n]).each(function(n){var e;Ac(e=t)!==n&&e.execCommand("fontSize",!1,n)})},oa=h(rs),cs=or([d("getInitialValue"),d("onChange"),d("category"),d("sizes")]),as=oa(),ss=function(n){return[Hu('<span class="${prefix}-toolbar-button ${prefix}-icon-small-font ${prefix}-icon"></span>'),(n={onChange:n.onChange,sizes:as,category:"font",getInitialValue:n.getInitialValue},o=dr("SizeSlider",cs,n),es.sketch({dom:{tag:"div",classes:[N("slider-"+o.category+"-size-container"),N("slider"),N("slider-size-container")]},onChange:function(n,e,t){t=t.x();0<=t&&t<o.sizes.length&&o.onChange(t)},onDragStart:function(n,e){D.on(e)},onDragEnd:function(n,e){D.off(e)},model:{mode:"x",minX:0,maxX:o.sizes.length-1,getInitialValue:function(){return{x:o.getInitialValue()}}},stepSize:1,snapToGrid:!0,sliderBehaviours:C([Zr(es.refresh)]),components:[es.parts.spectrum({dom:f('<div class="${prefix}-slider-size-container"></div>'),components:[Hu('<div class="${prefix}-slider-size-line"></div>')]}),es.parts.thumb({dom:f('<div class="${prefix}-slider-thumb"></div>'),behaviours:C([D.config({toggleClass:N("thumb-active")})])})]})),Hu('<span class="${prefix}-toolbar-button ${prefix}-icon-large-font ${prefix}-icon"></span>')];var o},fs=window.Promise||(Nc=function(n){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof n)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],Lc(n,Pc(ds,this),Pc(ms,this))},na=window,Hc=Nc.immediateFn||"function"==typeof na.setImmediate&&na.setImmediate||function(n){return setTimeout(n,1)},Pc=function(t,o){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return t.apply(o,n)}},zc=Array.isArray||function(n){return"[object Array]"===Object.prototype.toString.call(n)},Lc=function(n,e,t){var o=!1;try{n(function(n){o||(o=!0,e(n))},function(n){o||(o=!0,t(n))})}catch(n){o||(o=!0,t(n))}},Nc.prototype.catch=function(n){return this.then(null,n)},Nc.prototype.then=function(t,o){var r=this;return new Nc(function(n,e){ls.call(r,new ps(t,o,n,e))})},Nc.all=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var c=Array.prototype.slice.call(1===n.length&&zc(n[0])?n[0]:n);return new Nc(function(o,r){if(0===c.length)return o([]);for(var i=c.length,u=function(e,n){try{if(n&&("object"==typeof n||"function"==typeof n)){var t=n.then;if("function"==typeof t)return void t.call(n,function(n){u(e,n)},r)}c[e]=n,0==--i&&o(c)}catch(n){r(n)}},n=0;n<c.length;n++)u(n,c[n])})},Nc.resolve=function(e){return e&&"object"==typeof e&&e.constructor===Nc?e:new Nc(function(n){n(e)})},Nc.reject=function(t){return new Nc(function(n,e){e(t)})},Nc.race=function(r){return new Nc(function(n,e){for(var t=0,o=r;t<o.length;t++)o[t].then(n,e)})},Nc);function ls(t){var o=this;null!==this._state?Hc(function(){var n,e=o._state?t.onFulfilled:t.onRejected;if(null!==e){try{n=e(o._value)}catch(n){return void t.reject(n)}t.resolve(n)}else(o._state?t.resolve:t.reject)(o._value)}):this._deferreds.push(t)}function ds(n){try{if(n===this)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"==typeof n||"function"==typeof n)){var e=n.then;if("function"==typeof e)return void Lc(Pc(e,n),Pc(ds,this),Pc(ms,this))}this._state=!0,this._value=n,gs.call(this)}catch(n){ms.call(this,n)}}function ms(n){this._state=!1,this._value=n,gs.call(this)}function gs(){for(var n=0,e=this._deferreds;n<e.length;n++){var t=e[n];ls.call(this,t)}this._deferreds=[]}function ps(n,e,t,o){this.onFulfilled="function"==typeof n?n:null,this.onRejected="function"==typeof e?e:null,this.resolve=t,this.reject=o}function hs(n){return null==n?"":n}function vs(t,u){u.url.toOptional().filter(ul).fold(function(){var e=t;u.link.bind(R).each(function(n){e.execCommand("unlink")})},function(r){n=u,(e={}).href=r,n.title.toOptional().filter(ul).each(function(n){e.title=n}),n.target.toOptional().filter(ul).each(function(n){e.target=n});var n,e,i=e;u.link.bind(R).fold(function(){var n=u.text.toOptional().filter(ul).getOr(r);t.insertContent(t.dom.createHTML("a",i,t.dom.encode(n)))},function(e){t=e,o=r;var t,o,n=u.text.toOptional().filter(ul).fold(function(){return O(n=t,"href")===il(n)?V.some(o):V.none();var n},V.some);Rn(e,i),n.each(function(n){e.dom.textContent=n})})})}function ys(n){return n=A.fromDom(n.selection.getStart()),Ii(n,"a")}function bs(n){return n.dom.value}function xs(n,e){if(void 0===e)throw new Error("Value.set was undefined");n.dom.value=e}function ws(n,e){var t=jc(dl.sketch({inputAttributes:{placeholder:gl.translate(e)},onSetValue:function(n,e){Ye(n,_e())},inputBehaviours:C([sl.config({find:V.some}),ml.config({}),_.config({mode:"execution"})]),selectOnFocus:!1})),e=jc(Ia.sketch({dom:f('<button class="${prefix}-input-container-x ${prefix}-icon-cancel-circle ${prefix}-icon"></button>'),action:function(n){n=t.get(n);I.setValue(n,"")}}));return{name:n,spec:fl.sketch({dom:f('<div class="${prefix}-input-container"></div>'),components:[t.asSpec(),e.asSpec()],containerBehaviours:C([D.config({toggleClass:N("input-container-empty")}),sl.config({find:function(n){return V.some(t.get(n))}}),al("input-clearing",[E(_e(),function(n){var e=t.get(n);(0<I.getValue(e).length?D.off:D.on)(n)})])])})}}function Ss(n,e,t){(e.disabled()?hl:vl)(n,e)}function Os(n,e){return!0===e.useNative&&qn(pl,et(n.element))}function Ts(n){S(n.element,"disabled","disabled")}function ks(n){kt(n.element,"disabled")}function Es(n){S(n.element,"aria-disabled","true")}function Cs(n){S(n.element,"aria-disabled","false")}function Ds(n,e){return Os(n,e)?Vn(n.element,"disabled"):"true"===O(n.element,"aria-disabled")}function Ms(n){return"<alloy.field."+n+">"}function _s(o,n){return{uid:o.uid,dom:o.dom,components:n,behaviours:Du(o.formBehaviours,[I.config({store:{mode:"manual",getValue:function(n){e=o,t=n.getSystem();var e,t,n=bt(e.partUids,function(n,e){return h(t.getByUid(n))});return bt(n,function(n,o){return n().bind(function(n){var e=sl.getCurrent(n),t=new Error("Cannot find a current component to extract the value from for form part '"+o+"': "+fo(n.element));return e.fold(function(){return T.error(t)},T.value)}).map(I.getValue)})},setValue:function(t,n){yt(n,function(e,n){ba(t,o,n).each(function(n){sl.getCurrent(n).each(function(n){I.setValue(n,e)})})})}}})]),apis:{getField:function(n,e){return ba(n,o,e).bind(sl.getCurrent)}}}}function Is(){var e=j(V.none());return{clear:function(){return e.set(V.none())},set:function(n){return e.set(V.some(n))},isSet:function(){return e.get().isSome()},on:function(n){return e.get().each(n)}}}function Fs(n){function o(e,n,t){return Ia.sketch({dom:f('<span class="${prefix}-icon-'+n+' ${prefix}-icon"></span>'),action:function(n){Ke(n,u,{direction:e})},buttonBehaviours:C([yl.config({disableClass:N("toolbar-navigation-disabled"),disabled:function(){return!t}})])})}function r(n,o){var r=ai(n.element,"."+N("serialised-dialog-screen"));li(n.element,"."+N("serialised-dialog-chain")).each(function(t){0<=c.state.currentScreen.get()+o&&c.state.currentScreen.get()+o<r.length&&(_o(t,"left").each(function(n){var n=parseInt(n,10),e=Xu(r[0]);H(t,"left",n-o*e+"px")}),c.state.currentScreen.set(c.state.currentScreen.get()+o))})}function i(t){var n=ai(t.element,"input"),n=(V.from(n[c.state.currentScreen.get()]).each(function(n){t.getSystem().getByDom(n).each(function(n){var e=t,n=n.element;e.getSystem().triggerFocus(n,e.element)})}),s.get(t));M.highlightAt(n,c.state.currentScreen.get())}var t,u="navigateEvent",e=rr([d("fields"),g("maxFieldIndex",n.fields.length-1),d("onExecute"),d("getInitialValue"),ur("state",function(){return{dialogSwipeState:Is(),currentScreen:j(0)}})]),c=dr("SerialisedDialog",e,n),a=jc((t=[],e=(e=function(t){return{dom:f('<div class="${prefix}-serialised-dialog"></div>'),components:[fl.sketch({dom:f('<div class="${prefix}-serialised-dialog-chain" style="left: 0px; position: absolute;"></div>'),components:B(c.fields,function(n,e){return e<=c.maxFieldIndex?fl.sketch({dom:f('<div class="${prefix}-serialised-dialog-screen"></div>'),components:[o(-1,"previous",0<e),t.field(n.name,n.spec),o(1,"next",e<c.maxFieldIndex)]}):t.field(n.name,n.spec)})})],formBehaviours:C([Zr(function(n,e){var t=e;li(n.element,"."+N("serialised-dialog-chain")).each(function(n){H(n,"left",-c.state.currentScreen.get()*t.width+"px")})}),_.config({mode:"special",focusIn:function(n,e){i(n)},onTab:function(n,e){return r(n,1),V.some(!0)},onShiftTab:function(n,e){return r(n,-1),V.some(!0)}}),al("form-events",[xr(function(e,n){c.state.currentScreen.set(0),c.state.dialogSwipeState.clear();var t=s.get(e);M.highlightFirst(t),c.getInitialValue(e).each(function(n){I.setValue(e,n)})}),to(c.onExecute),E(Re(),function(n,e){"left"===e.event.raw.propertyName&&i(n)}),E(u,function(n,e){e=e.event.direction;r(n,e)})])])}})(n={field:function(n,e){return t.push(n),n=Ms(n),e=e,{uiType:fa(),owner:"form",name:n,config:e,validated:{}}},record:function(){return t}}),n=n.record(),n=B(n,function(n){return ma({name:n,pname:Ms(n)})}),Au("form",bl,n,_s,e))),s=jc({dom:f('<div class="${prefix}-dot-container"></div>'),behaviours:C([M.config({highlightClass:N("dot-active"),itemClass:N("dot-item")})]),components:ee(c.fields,function(n,e){return e<=c.maxFieldIndex?[Hu('<div class="${prefix}-dot-item ${prefix}-icon-full-dot ${prefix}-icon"></div>')]:[]})});return{dom:f('<div class="${prefix}-serializer-wrapper"></div>'),components:[a.asSpec(),s.asSpec()],behaviours:C([_.config({mode:"special",focusIn:function(n){n=a.get(n);_.focusIn(n)}}),al("serializer-wrapper-events",[E(we(),function(n,e){e=e.event;c.state.dialogSwipeState.set({xValue:e.raw.touches[0].clientX,points:[]})}),E(Se(),function(n,r){var i=r.event;c.state.dialogSwipeState.on(function(n){var e,t,o;r.event.prevent(),c.state.dialogSwipeState.set((n=n,(e=i.raw.touches[0].clientX)===n.xValue?n:(o={direction:t=0<e-n.xValue?1:-1,xValue:e},{xValue:e,points:(0===n.points.length?[]:n.points[n.points.length-1].direction===t?n.points.slice(0,n.points.length-1):n.points).concat([o])})))})}),E(Oe(),function(o,n){c.state.dialogSwipeState.on(function(n){var e=a.get(o),t=-1*(0===n.points.length?0:(t=n.points[0].direction,n=n.points[n.points.length-1].direction,-1===t&&-1===n?-1:1===t&&1===n?1:0));r(e,t)})})])])}}function Rs(n,r){var i={};return yt(n,function(n,o){yt(n,function(n,e){var t=p(i,e).getOr([]);i[e]=t.concat([r(o,n)])})}),i}function Vs(n){return n.cHandler}function Bs(n,e){return{name:n,handler:e}}function As(n,e,t){return(e=e[t])?function(r,i,n,u){try{t=function(n,e){var n=n[i],e=e[i],t=u.indexOf(n),o=u.indexOf(e);if(-1===t)throw new Error("The ordering for "+r+" does not have an entry for "+n+".\nOrder specified: "+JSON.stringify(u,null,2));if(-1===o)throw new Error("The ordering for "+r+" does not have an entry for "+e+".\nOrder specified: "+JSON.stringify(u,null,2));return t<o?-1:o<t?1:0},(o=Un.call(n,0)).sort(t);var e=o;return T.value(e)}catch(n){return T.error([n])}var t,o}("Event: "+t,"name",n,e).map(function(n){var e,o,r,t=B(n,function(n){return n.handler});return o=e=t,r=function(n){return n.abort},br({can:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Z(e,function(n,e){return n&&e.can.apply(void 0,t)},!0)},abort:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Z(o,function(n,e){return n||r(e).apply(void 0,t)},!1)},run:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];x(t,function(n){n.run.apply(void 0,e)})}})}):T.error(["The event ("+t+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(B(n,function(n){return n.name}),null,2)])}function js(n,i){var e,t,o,n=Fn(n,function(t,o){return(1===t.length?T.value(t[0].handler):As(t,i,o)).map(function(n){function e(n,e){for(var t=[],o=2;o<arguments.length;o++)t[o-2]=arguments[o];n=[n,e].concat(t),r.abort.apply(void 0,n)?e.stop():r.can.apply(void 0,n)&&r.run.apply(void 0,n)}r=U(n=n=n)?{can:b,abort:v,run:n}:n;var r,n=1<t.length?Kn(i[o],function(e){return Yn(t,function(n){return n.name===e})}).join(" > "):t[0].name;return qo(o,{handler:e,purpose:n})})});return e={},t=[],o=[],x(n=n,function(n){n.fold(function(n){t.push(n)},function(n){o.push(n)})}),0<(n={errors:t,values:o}).errors.length?T.error(ne(n.errors)):(e=e,0===(n=n.values).length?T.value(e):T.value(Lo(e,Go.apply(void 0,n))))}function Ns(e,n){x(n,function(n){Mt(e,n)})}function Hs(e,n){x(n,function(n){It(e,n)})}function Ps(n){e=p(n,"behaviours").getOr({}),o=Kn(ht(e),function(n){return void 0!==e[n]});var e,t,o=B(o,function(n){return e[n].me});return t=n=n,o=B(n=o=o,function(n){return Wt(n.name(),[d("config"),g("state",Dr)])}),o=fr("component.behaviours",rr(o),t.behaviours).fold(function(n){throw new Error(Gt(n)+"\nComplete spec:\n"+JSON.stringify(t,null,2))},function(n){return n}),{list:n,data:bt(o,function(n){var e=n.map(function(n){return{config:n.config,state:n.state.init(n.config)}});return function(){return e}})}}function zs(n,e,t){var o,r,i,u=y(y({},(u=n).dom),{uid:u.uid,domChildren:B(u.components,function(n){return n.element})}),c={"alloy.base.modification":n=n.domModification.fold(function(){return kr({})},kr)};function a(n){return Jn(n,function(n,e){return y(y({},e.modification),n)},{})}return e=0<e.length?(o=t,t=e,r=u,i=y({},c),x(t,function(n){i[n.name()]=n.exhibit(o,r)}),t=Rs(i,function(n,e){return{name:n,modification:e}}),e=Jn(t.classes,function(n,e){return e.modification.concat(n)},[]),c=a(t.attributes),t=a(t.styles),kr({classes:e,attributes:c,styles:t})):n,y(y({},c=u),{attributes:y(y({},c.attributes),e.attributes),styles:y(y({},c.styles),e.styles),classes:c.classes.concat(e.classes)})}function Ls(n,e,t){var o,r,i={"alloy.base.behaviour":n.events},n=n.eventOrder;return t=t,e=e,i=y(y({},i=i),(o=t,r={},x(e,function(n){r[n.name()]=n.handlers(o)}),r)),t=Rs(i,Bs),js(t,n).getOrDie()}function Gs(t){function n(){return l}var r,e=j(El),o=lr((u=t,fr("custom.definition",rr([cr("dom","dom",Uo(),rr([d("tag"),g("styles",{}),g("classes",[]),g("attributes",{}),m("value"),m("innerHtml")])),d("components"),d("uid"),g("events",{}),g("apis",{}),cr("eventOrder","eventOrder",((i={})[He()]=["disabling",Cl,"toggling","typeaheadevents"],i[Be()]=[Cl,"focusing","keying"],i[Ge()]=[Cl,"disabling","toggling","representing"],i[_e()]=[Cl,"representing","streaming","invalidating"],i[Ue()]=[Cl,"representing","item-events","tooltipping"],i[Te()]=["focusing",Cl,"item-type-events"],i[we()]=["focusing",Cl,"item-type-events"],i[Ce()]=["item-type-events","tooltipping"],i[Ne()]=["receiving","reflecting","tooltipping"],i=i,$o.mergeWithThunk(h(i))),mr()),m("domModification")]),u))),i=Ps(t),u=i.list,c=i.data,a=(i=zs(o,u,c),r=A.fromTag(i.tag),Rn(r,i.attributes),Ns(r,i.classes),Do(r,i.styles),i.innerHtml.each(function(n){return n=n,t=bn(e=r).dom,o=A.fromDom(t.createDocumentFragment()),n=n,(t=(t||document).createElement("div")).innerHTML=n,n=ct(A.fromDom(t)),Tn(o,n),kn(e),void st(e,o);var e,t,o}),s=i.domChildren,Tn(r,s),i.value.each(function(n){xs(r,n)}),i.uid,ka(r,i.uid),r),s=Ls(o,u,c),f=j(o.components),l={getSystem:e.get,config:function(n){var e=c;return(U(e[n.name()])?e[n.name()]:function(){throw new Error("Could not find "+n.name()+" in "+JSON.stringify(t,null,2))})()},hasConfigured:function(n){return U(c[n.name()])},spec:t,readState:function(n){return c[n]().map(function(n){return n.state.readState()}).getOr("not enabled")},getApis:function(){return o.apis},connect:function(n){e.set(n)},disconnect:function(){e.set(kl(n))},element:a,syncComponents:function(){var n=ct(a),n=ee(n,function(n){return e.get().getByDom(n).fold(function(){return[]},function(n){return[n]})});f.set(n)},components:f.get,events:s};return l}function $s(n){var e,t,o;return n={element:n=A.fromText(n)},e=dr("external.component",or([d("element"),m("uid")]),n),t=j(kl()),e.uid.each(function(n){ka(e.element,n)}),o={getSystem:t.get,config:V.none,hasConfigured:v,connect:function(n){t.set(n)},disconnect:function(){t.set(kl(function(){return o}))},getApis:function(){return{}},element:e.element,spec:n,readState:h("No state"),syncComponents:F,components:h([]),events:{}},Sa(o)}function Us(n){(ao(n.element).isNone()||ti.isFocused(n))&&(ti.isFocused(n)||ti.focus(n),Ke(n,Fl,{item:n}))}function Ws(n){Ke(n,Rl,{item:n})}function Xs(n,t){var o=dt(t),e=co(o).bind(function(e){function n(n){return w(e,n)}var o,r;return n(t)?V.some(t):(o=n,(r=function(n){for(var e=0;e<n.childNodes.length;e++){var t=A.fromDom(n.childNodes[e]);if(o(t))return V.some(t);t=r(n.childNodes[e]);if(t.isSome())return t}return V.none()})(t.dom))}),n=n(t);e.each(function(e){co(o).filter(function(n){return w(n,e)}).fold(function(){io(e)},F)})}function qs(n,e,t,o){o=n.getSystem().build(o),_n(n,o,t)}function Ys(n,e,t,o){n=Ks(n),Qn(n,function(n){return w(o.element,n.element)}).each(In)}function Ks(n,e){return n.components()}function Js(e,n,t,r,o){var i=Ks(e);return V.from(i[r]).map(function(n){return Ys(e,0,0,n),o.each(function(n){qs(e,0,function(n,e){var t,o=e;wn(t=n,r).fold(function(){st(t,o)},function(n){at(n,o)})},n)}),n})}function Qs(n){return"prepared"===n.type?V.some(n.menu):V.none()}function Zs(n,e,t,o){return Xl(0,e,0,o).bind(function(e){return e.transition.map(function(n){return{transition:n,route:e}})})}function nf(e,t,n){var o;ef(e,o=t).bind(function(n){return Zs(0,o,0,n)}).each(function(n){n=n.transition;It(e.element,n.transitionClass),kt(e.element,t.destinationAttr)})}function ef(e,t,n){var o=e.element;return Tt(o,t.destinationAttr).map(function(n){return{start:O(e.element,t.stateAttr),destination:n}})}function tf(n,e,t,o){nf(n,e),Vn(n.element,e.stateAttr)&&O(n.element,e.stateAttr)!==o&&e.onFinish(n,o),S(n.element,e.stateAttr,o)}function of(n){It(n,Yl)}function rf(n){return p(n,"format").getOr(n.title)}function uf(n,e,t,o,r){return{data:{value:n,text:e},type:"item",dom:{tag:"div",classes:r?[N("styles-item-is-menu")]:[]},toggling:{toggleOnExecute:!1,toggleClass:N("format-matches"),selected:t},itemBehaviours:C(r?[]:[To(n,function(n,e){(e?D.on:D.off)(n)})]),components:[{dom:{tag:"div",attributes:{style:o},innerHtml:e}}]}}function cf(n,e,t,o){return{value:n,dom:{tag:"div"},components:[Ia.sketch({dom:{tag:"div",classes:[N("styles-collapser")]},components:o?[{dom:{tag:"span",classes:[N("styles-collapse-icon")]}},$s(n)]:[$s(n)],action:function(n){o&&(n=t().get(n),Wl.collapseMenu(n))}}),{dom:{tag:"div",classes:[N("styles-menu-items-container")]},components:[Pl.parts.items({})],behaviours:C([al("adhoc-scrollable-menu",[xr(function(n,e){H(n.element,"overflow-y","auto"),H(n.element,"-webkit-overflow-scrolling","touch"),Kl(n.element)}),wr(function(n){ii(n.element,"overflow-y"),ii(n.element,"-webkit-overflow-scrolling"),of(n.element)})])])}],items:e,menuBehaviours:C([ql.config({initialState:"after",routes:ql.createTristate("before","current","after",{transition:{property:"transform",transitionClass:"transitioning"}})})])}}function af(n){return Jn(n,function(n,e){e=Ql(e);return{menus:Lo(n.menus,e.menus),items:[e.item].concat(n.items),expansions:Lo(n.expansions,e.expansions)}},{menus:{},expansions:{},items:[]})}function sf(t,r){function n(t){return function(){return ja(e=t,function(){n.execCommand(e)},{},n=r);var n,e}}function e(o){return function(){return n=r,t=Va(e=o),ja(e,function(){n.execCommand(e)},t,n);var n,e,t}}function o(n,e,t){return function(){return Ba(r,n,e,t)}}function i(){return nd(r,h,function(){r.fire("scrollIntoView")})}function u(n,e){return{isSupported:function(){var e=r.ui.registry.getAll().buttons;return n.forall(function(n){return St(e,n)})},sketch:e}}var c=n("undo"),a=n("redo"),s=e("bold"),f=e("italic"),l=e("underline"),d=n("removeformat"),m=o("unlink","link",function(){r.execCommand("unlink",null,!1)}),g=o("unordered-list","ul",function(){r.execCommand("InsertUnorderedList",null,!1)}),p=o("ordered-list","ol",function(){r.execCommand("InsertOrderedList",null,!1)}),h=Zl(r);return{undo:u(V.none(),c),redo:u(V.none(),a),bold:u(V.none(),s),italic:u(V.none(),f),underline:u(V.none(),l),removeformat:u(V.none(),d),link:u(V.none(),function(){return Sl(t,r)}),unlink:u(V.none(),m),image:u(V.none(),function(){return rl(r)}),bullist:u(V.some("bullist"),g),numlist:u(V.some("numlist"),p),fontsizeselect:u(V.none(),function(){return n={onChange:function(n){us(e,n)},getInitialValue:function(){return is(e)}},ts(t,"font-size",function(){return ss(n)},e=r);var e,n}),forecolor:u(V.none(),function(){return n={onChange:function(n,e,t){o.undoManager.transact(function(){o.formatter.apply("forecolor",{value:t}),o.nodeChanged()})},getInitialValue:function(){return-1}},ts(t,"color-levels",function(){return os(n)},o=r);var o,n}),styleselect:u(V.none(),function(){return ja("style-formats",function(n){r.fire("toReading"),t.dropup.appear(i,D.on,n)},C([D.config({toggleClass:N("toolbar-button-selected"),toggleOnExecute:!1,aria:{mode:"pressed"}}),Kr.config({channels:Yo([ni(Hr,D.off),ni(Pr,D.off)])})]),r)})}}function ff(n){function e(){return n.stopPropagation()}function t(){return n.preventDefault()}var o=A.fromDom(function(n){if(lt()&&$(n.target)){var e=A.fromDom(n.target);if(tt(e)&&$(e.dom.shadowRoot)&&n.composed&&n.composedPath){e=n.composedPath();if(e)return 0<(e=e).length?V.some(e[0]):V.none()}}return V.from(n.target)}(n).getOr(n.target)),r=X(t,e);return{target:o,x:n.clientX,y:n.clientY,stop:e,prevent:t,kill:r,raw:n}}function lf(n,e,t,o,r){function i(n){u(n)&&c(ff(n))}var u,c;return u=t,c=o,n.dom.addEventListener(e,i,r),{unbind:q(df,n,e,i,r)}}function df(n,e,t,o){n.dom.removeEventListener(e,t,o)}function mf(n,e,t){return lf(n,e,od,t,!0)}function gf(o,e){var n=A.fromDom(o),r=null,t=P(n,"orientationchange",function(){rd.clearInterval(r);var n=id(o);e.onChange(n),i(function(){e.onReady(n)})}),i=function(n){rd.clearInterval(r);var e=o.innerHeight,t=0;r=rd.setInterval(function(){e!==o.innerHeight?(rd.clearInterval(r),n(V.some(o.innerHeight))):20<t&&(rd.clearInterval(r),n(V.none())),t++},50)};return{onAdjustment:i,destroy:function(){t.unbind()}}}function pf(n,e,t){var o,r=n=n.document.createRange();return e.fold(function(n){r.setStartBefore(n.dom)},function(n,e){r.setStart(n.dom,e)},function(n){r.setStartAfter(n.dom)}),o=n,t.fold(function(n){o.setEndBefore(n.dom)},function(n,e){o.setEnd(n.dom,e)},function(n){o.setEndAfter(n.dom)}),n}function hf(n,e,t,o,r){return(n=n.document.createRange()).setStart(e.dom,t),n.setEnd(o.dom,r),n}function vf(n){return{left:n.left,top:n.top,right:n.right,bottom:n.bottom,width:n.width,height:n.height}}function yf(n,e,t){return e(A.fromDom(t.startContainer),t.startOffset,A.fromDom(t.endContainer),t.endOffset)}function bf(n,e){r=n;var r,t,n=e.match({domRange:function(n){return{ltr:h(n),rtl:V.none}},relative:function(n,e){return{ltr:Gn(function(){return pf(r,n,e)}),rtl:Gn(function(){return V.some(pf(r,e,n))})}},exact:function(n,e,t,o){return{ltr:Gn(function(){return hf(r,n,e,t,o)}),rtl:Gn(function(){return V.some(hf(r,t,o,n,e))})}}});return(t=(e=n).ltr()).collapsed?e.rtl().filter(function(n){return!1===n.collapsed}).map(function(n){return ud.rtl(A.fromDom(n.endContainer),n.endOffset,A.fromDom(n.startContainer),n.startOffset)}).getOrThunk(function(){return yf(0,ud.ltr,t)}):yf(0,ud.ltr,t)}function xf(n,e,t,o){return{start:n,soffset:e,finish:t,foffset:o}}function wf(n,e){var t=et(n);return"input"===t?ad.after(n):qn(["br","img"],t)?0===e?ad.before(n):ad.after(n):ad.on(n,e)}function Sf(n){return V.from(n.getSelection())}function Of(n,e,t,o,r){var i=hf(n,e,t,o,r);Sf(n).each(function(n){n.removeAllRanges(),n.addRange(i)})}function Tf(n,e,t,o,r){o=o,r=r,e=wf(e,t),t=wf(o,r);var a,o=fd.relative(e,t);bf(a=n,o).match({ltr:function(n,e,t,o){Of(a,n,e,t,o)},rtl:function(r,i,u,c){Sf(a).each(function(n){if(n.setBaseAndExtent)n.setBaseAndExtent(r.dom,i,u.dom,c);else if(n.extend)try{t=u,o=c,(e=n).collapse(r.dom,i),e.extend(t.dom,o)}catch(n){Of(a,u,c,r,i)}else Of(a,u,c,r,i);var e,t,o})}})}function kf(n){var e;return 0<n.rangeCount?(e=n.getRangeAt(0),n=n.getRangeAt(n.rangeCount-1),V.some(xf(A.fromDom(e.startContainer),e.startOffset,A.fromDom(n.endContainer),n.endOffset))):V.none()}function Ef(n){var e,t,o,r,i,u,c,a,s,f,l;return null!==n.anchorNode&&null!==n.focusNode&&(e=A.fromDom(n.anchorNode),t=A.fromDom(n.focusNode),o=e,r=n.anchorOffset,i=t,u=n.focusOffset,l=r,c=i,a=u,(s=bn(f=o).dom.createRange()).setStart(f.dom,l),s.setEnd(c.dom,a),f=s,l=w(o,i)&&r===u,f.collapsed)&&!l?V.some(xf(e,n.anchorOffset,t,n.focusOffset)):kf(n)}function Cf(n){return Sf(n).filter(function(n){return 0<n.rangeCount}).bind(Ef)}function Df(n,e){var i;return 0<(e=0<(e=(n=bf(i=n,e).match({ltr:function(n,e,t,o){var r=i.document.createRange();return r.setStart(n.dom,e),r.setEnd(t.dom,o),r},rtl:function(n,e,t,o){var r=i.document.createRange();return r.setStart(t.dom,o),r.setEnd(n.dom,e),r}})).getClientRects()).length?e[0]:n.getBoundingClientRect()).width||0<e.height?V.some(e).map(vf):V.none()}function Mf(n){return V.from(n.dom.contentWindow)}function _f(n){return Mf(n).bind(Cf)}function If(n){return n.getFrame()}function Ff(n,e,t,o){return n[t].getOrThunk(function(){return function(n){return P(e,o,n)}})}function Rf(n){return void 0===(n=n.raw).touches||1!==n.touches.length?V.none():V.some(n.touches[0])}function Vf(t){var o,r,i=j(V.none()),u=j(!1),c=(o=function(n){t.triggerEvent(Le(),n),u.set(!0)},r=null,{cancel:function(){null!==r&&(clearTimeout(r),r=null)},schedule:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];r=setTimeout(function(){o.apply(null,n),r=null},400)}}),a=Yo([{key:we(),value:function(e){return Rf(e).each(function(n){c.cancel();n={x:n.clientX,y:n.clientY,target:e.target};c.schedule(e),u.set(!1),i.set(V.some(n))}),V.none()}},{key:Se(),value:function(n){return c.cancel(),Rf(n).each(function(o){i.get().each(function(n){var e=o,t=Math.abs(e.clientX-n.x),e=Math.abs(e.clientY-n.y);(5<t||5<e)&&i.set(V.none())})}),V.none()}},{key:Oe(),value:function(e){return c.cancel(),i.get().filter(function(n){return w(n.target,e.target)}).map(function(n){return u.get()?(e.prevent(),!1):t.triggerEvent(ze(),e)})}}]);return{fireIfReady:function(e,n){return p(a,n).bind(function(n){return n(e)})}}}function Bf(t){var e=Vf({triggerEvent:function(n,e){t.onTapContent(e)}});return{fireTouchstart:function(n){e.fireIfReady(n,"touchstart")},onTouchend:function(){return P(t.body,"touchend",function(n){e.fireIfReady(n,"touchend")})},onTouchmove:function(){return P(t.body,"touchmove",function(n){e.fireIfReady(n,"touchmove")})}}}function Af(n,e){return n=parseInt(O(n,e),10),isNaN(n)?0:n}function jf(n){return y(y({},n),{width:2})}function Nf(n){return{left:n.left,top:n.top,right:n.right,bottom:n.bottom,width:n.width,height:n.height}}function Hf(n){var t,o;return void 0!==(n=n.getSelection())&&0<n.rangeCount?(t=n.getRangeAt(0)).collapsed?(o=A.fromDom(t.startContainer),ut(o).bind(function(n){var e,n=fd.exact(o,t.startOffset,n,"img"===et(e=n)?1:cd.getOption(e).fold(function(){return ct(e).length},function(n){return n.length}));return Df(t.startContainer.ownerDocument.defaultView,n).map(jf).map(en)}).getOr([])):B(t.getClientRects(),Nf):[]}function Pf(n,e){S(n,Sd,e)}function zf(n){return{top:n.top,bottom:n.top+n.height}}function Lf(t,o){var r=null;return{cancel:function(){null!==r&&(clearTimeout(r),r=null)},throttle:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];null!==r&&clearTimeout(r),r=setTimeout(function(){t.apply(null,n),r=null},o)}}}function Gf(n){return"true"===O(n,Dd)?0<n.dom.scrollLeft||((e=n).dom.scrollLeft=1,t=0!==e.dom.scrollLeft,e.dom.scrollLeft=0,t):0<n.dom.scrollTop||((e=n).dom.scrollTop=1,t=0!==e.dom.scrollTop,e.dom.scrollTop=0,t);var e,t}function $f(n,e){It(n.element,e.closedClass),Mt(n.element,e.openClass),ii(n.element,Ad(e))}function Uf(n,e,t,o){o=o.getOrThunk(function(){return jd(e,n.element)}),t.setCollapsed(),H(n.element,Ad(e),o),ui(n.element),t=Bd(n,e),It(t,e.growingClass),Mt(t,e.shrinkingClass),Hd(n,e),e.onStartShrink(n)}function Wf(n,e,t){return n=Bd(n,e),!0===An(n,e.growingClass)}function Xf(n,e,t){return n=Bd(n,e),!0===An(n,e.shrinkingClass)}function qf(){return xe().browser.isFirefox()}function Yf(e,n){var t,o=dr("Getting GUI events settings",Ud,n),r=Vf(o),i=B(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),function(n){return P(e,n,function(e){r.fireIfReady(e,n).each(function(n){n&&e.kill()}),o.triggerEvent(n,e)&&e.kill()})}),u=j(V.none()),c=P(e,"paste",function(e){r.fireIfReady(e,"paste").each(function(n){n&&e.kill()}),o.triggerEvent("paste",e)&&e.kill(),u.set(V.some(setTimeout(function(){o.triggerEvent(je(),e)},0)))}),a=P(e,"keydown",function(n){var e;o.triggerEvent("keydown",n)?n.kill():!0!==o.stopBackspace||(e=n).raw.which!==Fi[0]||qn(["input","textarea"],et(e.target))||(e=e.target,Ii(e,'[contenteditable="true"]',void 0).isSome())||n.prevent()}),s=(n=e,t=function(n){o.triggerEvent("focusin",n)&&n.kill()},qf()?mf(n,"focus",t):P(n,"focusin",t)),f=j(V.none()),l=(n=e,t=function(n){o.triggerEvent("focusout",n)&&n.kill(),f.set(V.some(setTimeout(function(){o.triggerEvent(Ae(),n)},0)))},qf()?mf(n,"blur",t):P(n,"focusout",t));return{unbind:function(){x(i,function(n){n.unbind()}),a.unbind(),s.unbind(),l.unbind(),c.unbind(),u.get().each(clearTimeout),f.get().each(clearTimeout)}}}function Kf(n,e){return n=p(n,"target").getOr(e),j(n)}function Jf(n,o,e,t,r,i){var u,c,n=n(o,t),a=(e=e,r=r,u=j(!1),c=j(!1),{stop:function(){u.set(!0)},cut:function(){c.set(!0)},isStopped:u.get,isCut:c.get,event:e,setSource:r.set,getSource:r.get});return n.fold(function(){return i.logEventNoHandlers(o,t),Wd.complete()},function(e){var t=e.descHandler;return Vs(t)(a),a.isStopped()?(i.logEventStopped(o,e.element,t.purpose),Wd.stopped()):a.isCut()?(i.logEventCut(o,e.element,t.purpose),Wd.complete()):ut(e.element).fold(function(){return i.logNoParent(o,e.element,t.purpose),Wd.complete()},function(n){return i.logEventResponse(o,e.element,t.purpose),Wd.resume(n)})})}function Qf(e,t,o,n,r,i){return Jf(e,t,o,n,r,i).fold(b,function(n){return Qf(e,t,o,n,r,i)},v)}function Zf(n,e,t,o,r){var i=Kf(t,o);return Qf(n,e,t,o,i,r)}function nl(){function i(n){Bu(n.element).each(function(n){delete a[n],c.unregisterId(n)})}u={};var u,c={registerId:function(o,r,n){yt(n,function(n,e){var t=void 0!==u[e]?u[e]:{};t[r]={cHandler:q.apply(void 0,[(n=n).handler].concat(o)),purpose:n.purpose},u[e]=t})},unregisterId:function(t){yt(u,function(n,e){n.hasOwnProperty(t)&&delete n[t]})},filterByType:function(n){return p(u,n).map(function(n){return Fn(n,function(n,e){return{id:e,descHandler:n}})}).getOr([])},find:function(n,e,t){var r=p(u,e);return Kt(t,function(n){return t=r,Bu(o=n).fold(function(){return V.none()},function(e){return t.bind(function(n){return p(n,e)}).map(function(n){return{element:o,descHandler:n}})});var t,o},n)}},a={};return{find:function(n,e,t){return c.find(n,e,t)},filter:function(n){return c.filterByType(n)},register:function(n){e=(t=n).element;var t,e=Bu(e).fold(function(){return n=t.element,e=_u(Oa+"uid-"),ka(n,e),e;var n,e},function(n){return n});if(St(a,e)){var o=n,r=a[e];if(r!==o)throw new Error('The tagId "'+e+'" is already used by: '+fo(r.element)+"\nCannot use it for: "+fo(o.element)+"\nThe conflicting element is"+(mt(r.element)?" ":" not ")+"already in the DOM");i(o)}c.registerId([n],e,n.events),a[e]=n},unregister:i,getById:function(n){return p(a,n)}}}var el,tl,ol,rl=function(i){var e=jc({dom:{tag:"input",attributes:{accept:"image/*",type:"file",title:""},styles:{visibility:"hidden",position:"absolute"}},events:k([eo(Fe()),E(Ie(),function(n,e){e=e.event.raw,e=e.target.files||e.dataTransfer.files;V.from(e[0]).each(function(n){var o,t,r=i;o=n,t=o,new fs(function(n){var e=new FileReader;e.onloadend=function(){n(e.result)},e.readAsDataURL(t)}).then(function(n){return n.split(",")[1]}).then(function(t){r.undoManager.transact(function(){var n=r.editorUpload.blobCache,e=n.create(_u("mceu"),o,t),n=(n.add(e),r.dom.createHTML("img",{src:e.blobUri()}));r.insertContent(n)})})})})])});return Ia.sketch({dom:Aa("image",i),components:[e.asSpec()],action:function(n){e.get(n).element.dom.click()}})},il=function(n){return n.dom.textContent},ul=function(n){return 0<n.length},cl=xe(),al=function(n,e){return{key:n,value:{config:{},me:(n=n,e=k(e),Ir({fields:[d("enabled")],name:n,active:{events:h(e)}})),configAsRaw:h({}),initialConfig:{},state:Dr}}},Jc=Object.freeze({__proto__:null,getCurrent:function(n,e,t){return e.find(n)}}),Zc=[d("find")],sl=Ir({fields:Zc,name:"composing",apis:Jc}),fl=ju({name:"Container",factory:function(n){var e=n.dom,t=e.attributes,e=o(e,["attributes"]);return{uid:n.uid,dom:y({tag:"div",attributes:y({role:"presentation"},t)},e),components:n.components,behaviours:n.containerBehaviours.dump,events:n.events,domModification:n.domModification,eventOrder:n.eventOrder}},configFields:[g("components",[]),Cu("containerBehaviours",[]),g("events",{}),g("domModification",{}),g("eventOrder",{})]}),ll=ju({name:"DataField",factory:function(t){return{uid:t.uid,dom:t.dom,behaviours:ra(t.dataBehaviours,[I.config({store:{mode:"memory",initialValue:t.getInitialValue()}}),sl.config({find:V.some})]),events:k([xr(function(n,e){I.setValue(n,t.getInitialValue())})])}},configFields:[d("uid"),d("dom"),d("getInitialValue"),Qc("dataBehaviours",[I,sl])]}),t=h([m("data"),g("inputAttributes",{}),g("inputStyles",{}),g("tag","input"),g("inputClasses",[]),go("onSetValue"),g("styles",{}),g("eventOrder",{}),Cu("inputBehaviours",[I,ti]),g("selectOnFocus",!0)]),dl=ju({name:"Input",configFields:t(),factory:function(n,e){return{uid:n.uid,dom:{tag:(t=n).tag,attributes:y({type:"text"},t.inputAttributes),styles:t.inputStyles,classes:t.inputClasses},components:[],behaviours:(t=n,y(y({},C([ti.config({onFocus:t.selectOnFocus?function(n){var n=n.element,e=bs(n);n.dom.setSelectionRange(0,e.length)}:F})])),Du(t.inputBehaviours,[I.config({store:y(y({mode:"manual"},t.data.map(function(n){return{initialValue:n}}).getOr({})),{getValue:function(n){return bs(n.element)},setValue:function(n,e){bs(n.element)!==e&&xs(n.element,e)}}),onSetValue:t.onSetValue})]))),eventOrder:n.eventOrder};var t}}),ta=Object.freeze({__proto__:null,exhibit:function(n,e){return kr({attributes:Yo([{key:e.tabAttr,value:"true"}])})}}),e=[g("tabAttr","data-alloy-tabstop")],ml=Ir({fields:e,name:"tabstopping",active:ta}),gl=tinymce.util.Tools.resolve("tinymce.util.I18n"),pl=["input","button","textarea","select"],hl=function(e,n,t){n.disableClass.each(function(n){Mt(e.element,n)}),(Os(e,n)?Ts:Es)(e),n.onDisabled(e)},vl=function(e,n,t){n.disableClass.each(function(n){It(e.element,n)}),(Os(e,n)?ks:Cs)(e),n.onEnabled(e)},Gc=Object.freeze({__proto__:null,enable:vl,disable:hl,isDisabled:Ds,onLoad:Ss,set:function(n,e,t,o){(o?hl:vl)(n,e)}}),n=Object.freeze({__proto__:null,exhibit:function(n,e){return kr({classes:e.disabled()?e.disableClass.toArray():[]})},events:function(t,n){return k([Jt(He(),function(n,e){return Ds(n,t)}),oo(t,n,Ss)])}}),ae=[hr("disabled",v,ce),g("useNative",!0),m("disableClass"),go("onDisabled"),go("onEnabled")],yl=Ir({fields:ae,name:"disabling",active:n,apis:Gc}),bl=[Cu("formBehaviours",[I])],xl=(Vu(function(n,e,t){return n.getField(e,t)}),function(){function e(){t.get().each(function(n){return n.destroy()})}var t=j(V.none());return{clear:function(){e(),t.set(V.none())},isSet:function(){return t.get().isSome()},set:function(n){e(),t.set(V.some(n))},run:function(n){return t.get().each(n)}}}),wl=Gn(function(t,o){return[{label:"the link group",items:[Fs({fields:[ws("url","Type or paste URL"),ws("text","Link text"),ws("title","Link title"),ws("target","Link target"),{name:"link",spec:ll.sketch({dom:{tag:"span",styles:{display:"none"}},getInitialValue:function(){return V.none()}})}],maxFieldIndex:["url","text","title","target"].length-1,getInitialValue:function(){return V.some(ys(n=o).fold(function(){return{url:"",text:n.selection.getContent({format:"text"}),title:"",target:"",link:V.none()}},function(n){return e=il(n=n),t=O(n,"href"),o=O(n,"title"),r=O(n,"target"),{url:hs(t),text:e!==t?hs(e):"",title:hs(o),target:hs(r),link:V.some(n)};var e,t,o,r}));var n},onExecute:function(n,e){n=I.getValue(n);vs(o,n),t.restoreToolbar(),o.focus()}})]}]}),Sl=function(t,o){return Ba(o,"link","link",function(){var n,e=wl(t,o);t.setContextToolbar(e),e=o,n=function(){t.focusToolbar()},(cl.os.isAndroid()?function(n,e){var t=e.selection.getRng();n(),e.selection.setRng(t)}:Ln)(n,e),ys(o).each(function(n){o.selection.select(n.dom)})})},Fr=k([{key:Be(),value:br({can:function(n,e){var t,e=e.event,o=e.originator,e=e.target,r=e;return!(w(t=o,n.element)&&!w(t,r)&&(console.warn(Be()+" did not get interpreted by the desired target. \nOriginator: "+fo(o)+"\nTarget: "+fo(e)+"\nCheck the "+Be()+" event handlers"),1))}})}]),Ol=Object.freeze({__proto__:null,events:Fr}),Tl=R,kl=function(e){function n(n){return function(){throw new Error("The component must be in a context to send: "+n+(e?"\n"+fo(e().element)+" is not in context.":""))}}return{debugInfo:h("fake"),triggerEvent:n("triggerEvent"),triggerFocus:n("triggerFocus"),triggerEscape:n("triggerEscape"),build:n("build"),addToWorld:n("addToWorld"),removeFromWorld:n("removeFromWorld"),addToGui:n("addToGui"),removeFromGui:n("removeFromGui"),getByUid:n("getByUid"),getByDom:n("getByDom"),broadcast:n("broadcast"),broadcastOn:n("broadcastOn"),broadcastEvent:n("broadcastEvent"),isConnected:v}},El=kl(),Cl="alloy.base.behaviour",Dl=function(n){var n=Tl(n),e=n.events,n=o(n,["events"]),t=(t=p(n,"components").getOr([]),B(t,_l)),n=y(y({},n),{events:y(y({},Ol),e),components:t});return T.value(Gs(n))},Ml=Ea,_l=function(e){return p(e,wa).fold(function(){var n=e.hasOwnProperty("uid")?e:y({uid:Ml("")},e);return Dl(n).getOrDie()},function(n){return n})},Il=Sa,Fl="alloy.item-hover",Rl="alloy.item-focus",Vl=h(Fl),Bl=h(Rl),Wc=[d("data"),d("components"),d("dom"),g("hasSubmenu",!1),m("toggling"),Qc("itemBehaviours",[D,ti,_,I]),g("ignoreFocus",!1),g("domModification",{}),i("builder",function(n){return{dom:n.dom,domModification:y(y({},n.domModification),{attributes:y(y(y({role:n.toggling.isSome()?"menuitemcheckbox":"menuitem"},n.domModification.attributes),{"aria-haspopup":n.hasSubmenu}),n.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:ra(n.itemBehaviours,[n.toggling.fold(D.revoke,function(n){return D.config(y({aria:{mode:"checked"}},n))}),ti.config({ignore:n.ignoreFocus,stopMousedown:n.ignoreFocus,onFocus:function(n){Ws(n)}}),_.config({mode:"execution"}),I.config({store:{mode:"memory",initialValue:n.data}}),al("item-type-events",c(ko(),[E(Ce(),Us),E(Pe(),ti.focus)]))]),components:n.components,eventOrder:n.eventOrder}}),g("eventOrder",{})],Xc=[d("dom"),d("components"),i("builder",function(n){return{dom:n.dom,components:n.components,events:k([(n=Pe(),E(n,function(n,e){e.stop()}))])}})],Al=h("item-widget"),jl=h([ma({name:"widget",overrides:function(e){return{behaviours:C([I.config({store:{mode:"manual",getValue:function(n){return e.data},setValue:F}})])}}})]),Nl=$t("type",{widget:[d("uid"),d("data"),d("components"),d("dom"),g("autofocus",!1),g("ignoreFocus",!1),Qc("widgetBehaviours",[I,ti,_]),g("domModification",{}),xa(jl()),i("builder",function(t){function o(n){return ba(n,t,"widget").map(function(n){return _.focusIn(n),n})}function n(n,e){return Wi(e.event.target)||t.autofocus&&e.setSource(n.element),V.none()}var e=va(Al(),t,jl()),e=ya(Al(),t,e.internals());return{dom:t.dom,components:e,domModification:t.domModification,events:k([to(function(n,e){o(n).each(function(n){e.stop()})}),E(Ce(),Us),E(Pe(),function(n,e){t.autofocus?o(n):ti.focus(n)})]),behaviours:ra(t.widgetBehaviours,[I.config({store:{mode:"memory",initialValue:t.data}}),ti.config({ignore:t.ignoreFocus,onFocus:function(n){Ws(n)}}),_.config({mode:"special",focusIn:t.autofocus?function(n){o(n)}:Rr(),onLeft:n,onRight:n,onEscape:function(n,e){return ti.isFocused(n)||t.autofocus?(t.autofocus&&e.setSource(n.element),V.none()):(ti.focus(n),V.some(!0))}})])}})],item:Wc,separator:Xc}),oa=h([ea({factory:{sketch:function(n){n=dr("menu.spec item",Nl,n);return n.builder(n)}},name:"items",unit:"item",defaults:function(n,e){return e.hasOwnProperty("uid")?e:y(y({},e),{uid:Ea("item")})},overrides:function(n,e){return{type:e.type,ignoreFocus:n.fakeFocus,domModification:{classes:[n.markers.item]}}}})]),na=h([d("value"),d("items"),d("dom"),d("components"),g("eventOrder",{}),Cu("menuBehaviours",[M,I,sl,_]),hr("movement",{mode:"menu",moveOnTab:!0},$t("mode",{grid:[qr(),i("config",function(n,e){return{mode:"flatgrid",selector:"."+n.markers.item,initSize:{numColumns:e.initSize.numColumns,numRows:e.initSize.numRows},focusManager:n.focusManager}})],matrix:[i("config",function(n,e){return{mode:"matrix",selectors:{row:e.rowSelector,cell:"."+n.markers.item},focusManager:n.focusManager}}),d("rowSelector")],menu:[g("moveOnTab",!0),i("config",function(n,e){return{mode:"menu",selector:"."+n.markers.item,moveOnTab:e.moveOnTab,focusManager:n.focusManager}})]})),Ut("markers",Xr()),g("fakeFocus",!1),g("focusManager",Gi()),go("onHighlight")]),Hl=h("alloy.menu-focus"),Pl=Nu({name:"Menu",configFields:na(),partFields:oa(),factory:function(n,e,t,o){return{uid:n.uid,dom:n.dom,markers:n.markers,behaviours:Du(n.menuBehaviours,[M.config({highlightClass:n.markers.selectedItem,itemClass:n.markers.item,onHighlight:n.onHighlight}),I.config({store:{mode:"memory",initialValue:n.value}}),sl.config({find:V.some}),_.config(n.movement.config(n,n.movement))]),events:k([E(Bl(),function(e,t){var n=t.event;e.getSystem().getByDom(n.target).each(function(n){M.highlight(e,n),t.stop(),Ke(e,Hl(),{menu:e,item:n})})}),E(Vl(),function(n,e){e=e.event.item;M.highlight(n,e)})]),components:e,eventOrder:n.eventOrder,domModification:{attributes:{role:"menu"}}}}}),zl=Ir({fields:[],name:"replacing",apis:Object.freeze({__proto__:null,append:function(n,e,t,o){qs(n,0,st,o)},prepend:function(n,e,t,o){qs(n,0,On,o)},remove:Ys,replaceAt:Js,replaceBy:function(e,n,t,o,r){var i=Ks(e);return Zn(i,o).bind(function(n){return Js(e,0,0,n,r)})},set:function(r,n,e,i){Xs(function(){var e,n,t,o=B(i,r.getSystem().build);o=o,n=(e=r).components(),x((t=e).components(),function(n){return ft(n.element)}),kn(t.element),t.syncComponents(),t=nn(n,o),x(t,function(n){gt(n),e.getSystem().removeFromWorld(n)}),x(o,function(n){n.getSystem().isConnected()?Mn(e,n):(e.getSystem().addToWorld(n),Mn(e,n),mt(e.element)&&pt(n)),e.syncComponents()})},r.element)},contents:Ks})}),Ll=function(t,o,r,n){return p(r,n).bind(function(n){return p(t,n).bind(function(n){var e=Ll(t,o,r,n);return V.some([n].concat(e))})}).getOr([])},Gl=function(){function a(n){for(var e=f.get(),t=ht(e),o=0,r=t.length;o<r;o++){var i=t[o],i=e[i];if(i===n)return V.some(i)}return V.none()}function s(n){return e(n).bind(Qs)}function e(n){return p(l.get(),n)}function t(n){return p(f.get(),n)}var f=j({}),l=j({}),d=j({}),m=j(V.none()),g=j({});return{setMenuBuilt:function(n,e){var t;l.set(y(y({},l.get()),((t={})[n]={type:"prepared",menu:e},t)))},setContents:function(n,e,t,o){m.set(V.some(n)),f.set(t),l.set(e),g.set(o);n=t,r={},yt(o,function(n,e){x(n,function(n){r[n]=e})}),u=xt(i=n,function(n,e){return{k:n,v:e}}),c=bt(u,function(n,e){return[e].concat(Ll(r,i,u,e))});var r,i,u,c,e=bt(r,function(n){return p(c,n).getOr([n])});d.set(e)},expand:function(t){return p(f.get(),t).map(function(n){var e=p(d.get(),t).getOr([]);return[n].concat(e)})},refresh:function(n){return p(d.get(),n)},collapse:function(n){return p(d.get(),n).bind(function(n){return 1<n.length?V.some(n.slice(1)):V.none()})},lookupMenu:e,lookupItem:t,otherMenus:function(n){var e=g.get();return nn(ht(e),n)},getPrimary:function(){return m.get().bind(s)},getMenus:function(){return l.get()},clear:function(){f.set({}),l.set({}),d.set({}),m.set(V.none())},isClear:function(){return m.get().isNone()},getTriggeringPath:function(n,u){var c=Kn(t(n).toArray(),function(n){return s(n).isSome()});return p(d.get(),n).bind(function(n){for(var i=oe(c.concat(n)),e=ee(i,function(n,e){return t=n,o=u,r=i.slice(0,e+1),s(t).bind(function(e){return a(t).bind(function(n){return o(n).map(function(n){return{triggeredMenu:e,triggeringItem:n,triggeringPath:r}})})}).fold(function(){return m.get().is(n)?[]:[V.none()]},function(n){return[V.some(n)]});var t,o,r}),t=[],o=0;o<e.length;o++){var r=e[o];if(!r.isSome())return V.none();t.push(r.getOrDie())}return V.some(t)})}}},$l=Qs,Ul=h("collapse-item"),Wl=ju({name:"TieredMenu",configFields:[vo("onExecute"),vo("onEscape"),ho("onOpenMenu"),ho("onOpenSubmenu"),go("onRepositionMenu"),go("onCollapseMenu"),g("highlightImmediately",!0),gr("data",[d("primary"),d("menus"),d("expansions")]),g("fakeFocus",!1),go("onHighlight"),go("onHover"),gr("markers",[d("backgroundMenu")].concat(Ur()).concat(Wr())),d("dom"),g("navigateOnHover",!0),g("stayInDom",!1),Cu("tmenuBehaviours",[_,M,sl,zl]),g("eventOrder",{})],apis:{collapseMenu:function(n,e){n.collapseMenu(e)},highlightPrimary:function(n,e){n.highlightPrimary(e)},repositionMenus:function(n,e){n.repositionMenus(e)}},factory:function(a,n){function r(o,r,n){return bt(n,function(n,e){function t(){return Pl.sketch(y(y({},n),{value:e,markers:a.markers,fakeFocus:a.fakeFocus,onHighlight:a.onHighlight,focusManager:a.fakeFocus?{get:o=function(n){return M.getHighlighted(n).map(function(n){return n.element})},set:function(e,n){var t=o(e),n=(e.getSystem().getByDom(n).fold(F,function(n){M.highlight(e,n)}),o(e));Di(e,t,n)}}:Gi()}));var o}return e===r?{type:"prepared",menu:o.getSystem().build(t())}:{type:"notbuilt",nbMenu:t}})}function s(n,t){e=n;var e,n=u.get().getOrThunk(function(){var t={},n=ai(e.element,"."+a.markers.item),n=Kn(n,function(n){return"true"===O(n,"aria-haspopup")});return x(n,function(n){e.getSystem().getByDom(n).each(function(n){var e=m(n);t[e]=n})}),u.set(V.some(t)),t});yt(n,function(n,e){e=qn(t,e);S(n.element,"aria-expanded",e)})}function f(t,o,r){return V.from(r[0]).bind(function(n){return o.lookupMenu(n).bind(function(n){var e;return"notbuilt"===n.type?V.none():(n=n.menu,e=g(o,r.slice(1)),x(e,function(n){Mt(n.element,a.markers.backgroundMenu)}),mt(n.element)||zl.append(t,Il(n)),Hs(n.element,[a.markers.backgroundMenu]),c(t,n),p(t,o,r),V.some(n))})})}function i(i,u,c){void 0===c&&(c=l.HighlightSubmenu);var n=m(u);return d.expand(n).bind(function(r){return s(i,r),V.from(r[0]).bind(function(o){return d.lookupMenu(o).bind(function(n){e=i,t=o;var e,t,n="notbuilt"!==(n=n).type?n.menu:(e=e.getSystem().build(n.nbMenu()),d.setMenuBuilt(t,e),e);return mt(n.element)||zl.append(i,Il(n)),a.onOpenSubmenu(i,u,n,oe(r)),c===l.HighlightSubmenu?(M.highlightFirst(n),f(i,d,r)):(M.dehighlightAll(n),V.some(u))})})})}function t(e,t){var n=m(t);return d.collapse(n).bind(function(n){return s(e,n),f(e,d,n).map(function(n){return a.onCollapseMenu(e,t,n),n})})}function e(t){return function(e,n){return Ii(n.getSource(),"."+a.markers.item).bind(function(n){return e.getSystem().getByDom(n).toOptional().bind(function(n){return t(e,n).map(b)})})}}function o(n){return M.getHighlighted(n).bind(M.getHighlighted)}var l,u=j(V.none()),d=Gl(),m=function(n){return I.getValue(n).value},c=function(e,n){M.highlight(e,n),M.getHighlighted(n).orThunk(function(){return M.getFirst(n)}).each(function(n){pn(e,n.element,Pe())})},g=function(e,n){return xi(B(n,function(n){return e.lookupMenu(n).bind(function(n){return"prepared"===n.type?V.some(n.menu):V.none()})}))},p=function(e,n,t){n=g(n,n.otherMenus(t));x(n,function(n){Hs(n.element,[a.markers.backgroundMenu]),a.stayInDom||zl.remove(e,n)})},h=(l={HighlightSubmenu:0,0:"HighlightSubmenu",HighlightParent:1,1:"HighlightParent"},k([E(Hl(),function(e,t){var n=t.event.item;d.lookupItem(m(n)).each(function(){var n=t.event.menu,n=(M.highlight(e,n),m(t.event.item));d.refresh(n).each(function(n){return p(e,d,n)})})}),to(function(e,n){n=n.event.target;e.getSystem().getByDom(n).each(function(n){0===m(n).indexOf("collapse-item")&&t(e,n),i(e,n,l.HighlightSubmenu).fold(function(){a.onExecute(e,n)},F)})}),xr(function(e,n){var t=r(e,a.data.primary,a.data.menus),o=bt(a.data.menus,function(n,e){return ee(n.items,function(n){return"separator"===n.type?[]:[n.data.value]})});d.setContents(a.data.primary,t,a.data.expansions,o),d.getPrimary().each(function(n){zl.append(e,Il(n)),a.onOpenMenu(e,n),a.highlightImmediately&&c(e,n)})})].concat(a.navigateOnHover?[E(Vl(),function(n,e){var e=e.event.item,t=n,o=m(e);d.refresh(o).bind(function(n){return s(t,n),f(t,d,n)}),i(n,e,l.HighlightParent),a.onHover(n,e)})]:[]))),v={collapseMenu:function(e){o(e).each(function(n){t(e,n)})},highlightPrimary:function(e){d.getPrimary().each(function(n){c(e,n)})},repositionMenus:function(t){d.getPrimary().bind(function(e){return o(t).bind(function(n){var n=m(n),e=(e=d.getMenus(),Fn(e,function(n){return n})),t=xi(B(e,$l));return d.getTriggeringPath(n,function(n){return e=n,tn(t,function(n){return n.getSystem().isConnected()?(n=M.getCandidates(n),Qn(n,function(n){return m(n)===e})):V.none()});var e})}).map(function(n){return{primary:e,triggeringPath:n}})}).fold(function(){var n=t;V.from(n.components()[0]).filter(function(n){return"menu"===O(n.element,"role")}).each(function(n){a.onRepositionMenu(t,n,[])})},function(n){var e=n.primary,n=n.triggeringPath;a.onRepositionMenu(t,e,n)})}};return{uid:a.uid,dom:a.dom,markers:a.markers,behaviours:Du(a.tmenuBehaviours,[_.config({mode:"special",onRight:e(function(n,e){return Wi(e.element)?V.none():i(n,e,l.HighlightSubmenu)}),onLeft:e(function(n,e){return Wi(e.element)?V.none():t(n,e)}),onEscape:e(function(n,e){return t(n,e).orThunk(function(){return a.onEscape(n,e).map(function(){return n})})}),focusIn:function(e,n){d.getPrimary().each(function(n){pn(e,n.element,Pe())})}}),M.config({highlightClass:a.markers.selectedMenu,itemClass:a.markers.menu}),sl.config({find:function(n){return M.getHighlighted(n)}}),zl.config({})]),eventOrder:a.eventOrder,apis:v,events:h}},extraApis:{tieredData:function(n,e,t){return{primary:n,menus:e,expansions:t}},singleData:function(n,e){return{primary:n,menus:qo(n,e),expansions:{}}},collapseItem:function(n){return{value:_u(Ul()),meta:{text:n}}}}}),Xl=function(n,e,t,o){return p(e.routes,o.start).bind(function(n){return p(n,o.destination)})},Zc=Object.freeze({__proto__:null,findRoute:Xl,disableTransition:nf,getCurrentRoute:ef,jumpTo:tf,progressTo:function(e,t,n,o){var r,i=t;Vn((r=e).element,i.destinationAttr)&&(Tt(r.element,i.destinationAttr).each(function(n){S(r.element,i.stateAttr,n)}),kt(r.element,i.destinationAttr));u=o;var u={start:O(e.element,t.stateAttr),destination:u};Zs(0,t,0,u).fold(function(){tf(e,t,0,o)},function(n){nf(e,t);n=n.transition;Mt(e.element,n.transitionClass),S(e.element,t.destinationAttr,o)})},getState:function(n,e,t){return Tt(n.element,e.stateAttr)}}),Jc=Object.freeze({__proto__:null,events:function(r,n){return k([E(Re(),function(t,n){var o=n.event.raw;ef(t,r).each(function(e){Xl(0,r,0,e).each(function(n){n.transition.each(function(n){o.propertyName===n.property&&(tf(t,r,0,e.destination),r.onTransition(t,e))})})})}),xr(function(n,e){tf(n,r,0,r.initialState)})])}}),t=[g("destinationAttr","data-transitioning-destination"),g("stateAttr","data-transitioning-state"),d("initialState"),go("onTransition"),go("onFinish"),Ut("routes",Lt(T.value,Lt(T.value,or([Xt("transition",[d("property"),d("transitionClass")])]))))],ql=Ir({fields:t,name:"transitioning",active:Jc,apis:Zc,extra:{createRoutes:function(n){var t={};return yt(n,function(n,e){e=e.split("<->");t[e[0]]=qo(e[1],n),t[e[1]]=qo(e[0],n)}),t},createBistate:function(n,e,t){return Yo([{key:n,value:qo(e,t)},{key:e,value:qo(n,t)}])},createTristate:function(n,e,t,o){return Yo([{key:n,value:Yo([{key:e,value:o},{key:t,value:o}])},{key:e,value:Yo([{key:n,value:o},{key:t,value:o}])},{key:t,value:Yo([{key:n,value:o},{key:e,value:o}])}])}}}),Yl=N("scrollable"),Kl=function(n){Mt(n,Yl)},Jl=Yl,Ql=function(n){return St(n,"items")?(r=Lo((e=n,t=["items"],o={},yt(e,function(n,e){qn(t,e)||(o[e]=n)}),o),{menu:!0}),i=af(e.items),{item:r,menus:Lo(i.menus,qo(e.title,i.items)),expansions:Lo(i.expansions,qo(e.title,e.title))}):{item:n,menus:{},expansions:{}};var t,o,e,r,i},Zl=function(t){function o(n){return function(){return t.formatter.match(n)}}function r(n){return function(){return t.formatter.getCssText(n)}}function i(n){return B(n,function(n){var e;return St(n,"items")?(e=i(n.items),Lo(Lo(n,{isSelected:v,getPreview:h("")}),{items:e})):St(n,"format")?Lo(n,{isSelected:o(n.format),getPreview:r(n.format)}):(n=_u((e=n).title),e=Lo(e,{format:n,isSelected:o(n),getPreview:r(n)}),t.formatter.register(n,e),e)})}return i(t.getParam("style_formats",Ar,"array"))},nd=function(t,n,o){e=t,n=(r=function(n){return ee(n,function(n){return void 0===n.items?!St(n,"format")||e.formatter.canApply(n.format)?[n]:[]:0<r(n.items).length?[n]:[]})})(n);var e,r,i,u,c,a,s,n=af(n);return u=(i={formats:n,handle:function(n,e){t.undoManager.transact(function(){D.isOn(n)?t.formatter.remove(e):t.formatter.apply(e)}),o()}}).formats,c=function(){return s},n=cf("Styles",[].concat(B(u.items,function(n){return uf(rf(n),n.title,n.isSelected(),n.getPreview(),St(u.expansions,rf(n)))})),c,!1),a=bt(u.menus,function(n,e){n=B(n,function(n){return uf(rf(n),n.title,void 0!==n.isSelected&&n.isSelected(),void 0!==n.getPreview?n.getPreview():"",St(u.expansions,rf(n)))});return cf(e,n,c,!0)}),a=Lo(a,qo("styles",n)),n={tmenu:Wl.tieredData("styles",a,u.expansions)},(s=jc(Wl.sketch({dom:{tag:"div",classes:[N("styles-menu")]},components:[],fakeFocus:!0,stayInDom:!0,onExecute:function(n,e){var t=I.getValue(e);return i.handle(e,t.value),V.none()},onEscape:function(){return V.none()},onOpenMenu:function(n,e){n=Xu(n.element);Wu(e.element,n),ql.jumpTo(e,"current")},onOpenSubmenu:function(n,e,t){var o=Xu(n.element),e=_i(e.element,'[role="menu"]').getOrDie("hacky"),n=n.getSystem().getByDom(e).getOrDie();Wu(t.element,o),ql.progressTo(n,"before"),ql.jumpTo(t,"after"),ql.progressTo(t,"current")},onCollapseMenu:function(n,e,t){e=_i(e.element,'[role="menu"]').getOrDie("hacky"),n=n.getSystem().getByDom(e).getOrDie();ql.progressTo(n,"after"),ql.progressTo(t,"current")},navigateOnHover:!1,highlightImmediately:!0,data:n.tmenu,markers:{backgroundMenu:N("styles-background-menu"),menu:N("styles-menu"),selectedMenu:N("styles-selected-menu"),item:N("styles-item"),selectedItem:N("styles-selected-item")}}))).asSpec()},ed=function(n){n=n.replace(/\|/g," ").trim();return 0<n.length?n.split(/\s+/):[]},td=function(n){return ee(n,function(n){return(L(n)?td:ed)(n)})},od=b,P=function(n,e,t){return lf(n,e,od,t,!1)},rd=tinymce.util.Tools.resolve("tinymce.util.Delay"),id=function(n){n=n.matchMedia("(orientation: portrait)").matches;return{isPortrait:h(n)}},ud=Bt([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),cd=(ud.ltr,ud.rtl,el=ot,{get:function(n){if(el(n))return tl(n).getOr("");throw new Error("Can only get text value of a text node")},getOption:tl=function(n){return el(n)?V.from(n.dom.nodeValue):V.none()},set:function(n,e){if(!el(n))throw new Error("Can only set raw text value of a text node");n.dom.nodeValue=e}}),e=Bt([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),ad={before:e.before,on:e.on,after:e.after,cata:function(n,e,t,o){return n.fold(e,t,o)},getStart:function(n){return n.fold(R,R,R)}},sd=Bt([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),fd={domRange:sd.domRange,relative:sd.relative,exact:sd.exact,exactFromRange:function(n){return sd.exact(n.start,n.soffset,n.finish,n.foffset)},getWin:function(n){n=n.match({domRange:function(n){return A.fromDom(n.startContainer)},relative:function(n,e){return ad.getStart(n)},exact:function(n,e,t,o){return n}});return A.fromDom(xn(n).dom.defaultView)},range:xf},ld=function(c){var a=If(c);return V.some(A.fromDom(a.dom.contentWindow.document.body)).bind(function(u){return V.some(A.fromDom(a.dom.contentWindow.document)).bind(function(i){return Mf(a).map(function(r){var n=A.fromDom(i.dom.documentElement),e=c.getCursorBox.getOrThunk(function(){return function(){return Cf(r).map(function(n){return fd.exact(n.start,n.soffset,n.finish,n.foffset)}).bind(function(n){return Df(r,n).orThunk(function(){return Cf(r).filter(function(n){return w(n.start,n.finish)&&n.soffset===n.foffset}).bind(function(n){n=n.start.dom.getBoundingClientRect();return 0<n.width||0<n.height?V.some(n):V.none()})})})}}),t=c.setSelection.getOrThunk(function(){return function(n,e,t,o){Tf(r,n,e,t,o)}}),o=c.clearSelection.getOrThunk(function(){return function(){Sf(r).each(function(n){return n.removeAllRanges()})}});return{body:u,doc:i,win:r,html:n,getSelection:q(_f,a),setSelection:t,clearSelection:o,frame:a,onKeyup:Ff(c,i,"onKeyup","keyup"),onNodeChanged:Ff(c,i,"onNodeChanged","SelectionChange"),onDomChanged:c.onDomChanged,onScrollToCursor:c.onScrollToCursor,onScrollToElement:c.onScrollToElement,onToReading:c.onToReading,onToEditing:c.onToEditing,onToolbarScrollStart:c.onToolbarScrollStart,onTouchContent:c.onTouchContent,onTapContent:c.onTapContent,onTouchToolstrip:c.onTouchToolstrip,getCursorBox:e}})})})},dd=(ol=Mf,function(e){return e.getWin.getOrThunk(function(){var n=If(e);return function(){return ol(n)}})()}),md=function(){var e=nt("head").getOrDie(),n=nt('meta[name="viewport"]').getOrThunk(function(){var n=A.fromTag("meta");return S(n,"name","viewport"),st(e,n),n}),t=O(n,"content");return{maximize:function(){S(n,"content","width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0")},restore:function(){null!=t&&0<t.length?S(n,"content",t):S(n,"content","user-scalable=yes")}}},gd="data-ephox-mobile-fullscreen-style",pd="position:absolute!important;",hd="top:0!important;left:0!important;margin:0!important;padding:0!important;width:100%!important;height:100%!important;overflow:visible!important;",vd=xe().os.isAndroid(),yd=function(n,e){function t(t){return function(n){var e=O(n,"style"),e=void 0===e?"no-styles":e.trim();e!==t&&(S(n,gd,e),S(n,"style",t))}}o=function(n){return Qe(n,"*")};var o=Kn(function(n,e){for(var t=U(e)?e:v,o=n.dom,r=[];null!==o.parentNode&&void 0!==o.parentNode;){var i=o.parentNode,u=A.fromDom(i);if(r.push(u),!0===t(u))break;o=i}return r}(n,void 0),o),r=ee(o,function(n){return e=function(n){return Qe(n,"*")},Kn(ut(t=n).map(ct).map(function(n){return Kn(n,function(n){return!w(t,n)})}).getOr([]),e);var e,t}),e=void 0!==(e=Mo(e,"background-color"))&&""!==e?"background-color:"+e+"!important":"background-color:rgb(255,255,255)!important;";x(r,t("display:none!important;")),x(o,t(pd+hd+e)),t((!0===vd?"":pd)+hd+e)(n)},bd=function(){var n=Ze("["+gd+"]");x(n,function(n){var e=O(n,gd);"no-styles"!==e?S(n,"style",e):kt(n,"style"),kt(n,gd)})},xd=6<=xe().os.version.major,wd=function(t,e,o){function r(n){return!w(n.start,n.finish)||n.soffset!==n.foffset}function n(){var n=t.doc.dom.hasFocus()&&t.getSelection().exists(r);o.getByDom(e).each(!0===(n||co(u).filter(function(n){return"input"===et(n)}).exists(function(n){return n.dom.selectionStart!==n.dom.selectionEnd}))?D.on:D.off)}var i=Bf(t),u=bn(e),c=[P(t.body,"touchstart",function(n){t.onTouchContent(),i.fireTouchstart(n)}),i.onTouchmove(),i.onTouchend(),P(e,"touchstart",function(n){t.onTouchToolstrip()}),t.onToReading(function(){uo(t.body)}),t.onToEditing(F),t.onScrollToCursor(function(n){n.preventDefault(),t.getCursorBox().each(function(n){var e=t.win,n=n.top>e.innerHeight||n.bottom>e.innerHeight?n.bottom-e.innerHeight+50:0;0!=n&&e.scrollTo(e.pageXOffset,e.pageYOffset+n)})})].concat(1==xd?[]:[P(A.fromDom(t.win),"blur",function(){o.getByDom(e).each(D.off)}),P(u,"select",n),P(t.doc,"selectionchange",n)]);return{destroy:function(){x(c,function(n){n.unbind()})}}},Sd="data-"+N("last-outer-height"),Od=function(n,t){var e=A.fromDom(t.document.body),o=P(A.fromDom(n),"resize",function(){(function(n,e){e=Af(e,Sd),n=n.innerHeight;return n<e?V.some(e-n):V.none()})(n,e).each(function(e){var n;(0<(n=Hf(t)).length?V.some(n[0]).map(zf):V.none()).each(function(n){n=n.top>t.innerHeight||n.bottom>t.innerHeight?Math.min(e,n.bottom-t.innerHeight+50):0;0!==n&&t.scrollTo(t.pageXOffset,t.pageYOffset+n)})}),Pf(e,n.innerHeight)});return Pf(e,n.innerHeight),{toEditing:function(){var n,e;(n=t).focus(),e=A.fromDom(n.document.body),(co().exists(function(n){return qn(["input","textarea"],et(n))})?function(n){rd.setTimeout(function(){n()},0)}:Ln)(function(){co().each(uo),io(e)})},destroy:function(){o.unbind()}}},Td=function(n,e){var t,o,r=jc(fl.sketch({dom:f('<div aria-hidden="true" class="${prefix}-mask-tap-icon"></div>'),containerBehaviours:C([D.config({toggleClass:N("mask-tap-icon-selected"),toggleOnExecute:!1})])})),i=(t=n,o=null,{cancel:function(){null!==o&&(clearTimeout(o),o=null)},throttle:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];null===o&&(o=setTimeout(function(){t.apply(null,n),o=null},200))}});return fl.sketch({dom:f('<div class="${prefix}-disabled-mask"></div>'),components:[fl.sketch({dom:f('<div class="${prefix}-content-container"></div>'),components:[Ia.sketch({dom:f('<div class="${prefix}-content-tap-section"></div>'),components:[r.asSpec()],action:function(n){i.throttle()},buttonBehaviours:C([D.config({toggleClass:N("mask-tap-icon-selected")})])})]})]})},ta=h({unbind:F}),kd=rr([gr("editor",[d("getFrame"),m("getBody"),m("getDoc"),m("getWin"),m("getSelection"),m("setSelection"),m("clearSelection"),m("cursorSaver"),m("onKeyup"),m("onNodeChanged"),m("getCursorBox"),d("onDomChanged"),g("onTouchContent",F),g("onTapContent",F),g("onTouchToolstrip",F),g("onScrollToCursor",ta),g("onScrollToElement",ta),g("onToEditing",ta),g("onToReading",ta),g("onToolbarScrollStart",R)]),d("socket"),d("toolstrip"),d("dropup"),d("toolbar"),d("container"),d("alloy"),ur("win",function(n){return bn(n.socket).dom.defaultView}),ur("body",function(n){return A.fromDom(n.socket.dom.ownerDocument.body)}),g("translate",R),g("setReadOnly",F),g("readOnlyOnInit",b)]),ae=h([d("dom"),g("shell",!0),Cu("toolbarBehaviours",[zl])]),n=h([ga({name:"groups",overrides:function(){return{behaviours:C([zl.config({})])}}})]),Ed=Nu({name:"Toolbar",configFields:ae(),partFields:n(),factory:function(t,n,e,o){n=t.shell?{behaviours:[zl.config({})],components:[]}:{behaviours:[],components:n};return{uid:t.uid,dom:t.dom,components:n.components,behaviours:Du(t.toolbarBehaviours,n.behaviours),apis:{setGroups:function(n,e){n=n,(t.shell?V.some(n):ba(n,t,"groups")).fold(function(){throw console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")},function(n){zl.set(n,e)})}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(n,e,t){n.setGroups(e,t)}}}),Gc=h([d("items"),gr("markers",B(["itemSelector"],d)),Cu("tgroupBehaviours",[_])]),Fr=h([ea({name:"items",unit:"item"})]),Cd=Nu({name:"ToolbarGroup",configFields:Gc(),partFields:Fr(),factory:function(n,e,t,o){return{uid:n.uid,dom:n.dom,components:e,behaviours:Du(n.tgroupBehaviours,[_.config({mode:"flow",selector:n.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}}}),Dd="data-"+N("horizontal-scroll"),Md=function(){function e(n){var e=!0===n.scrollable?"${prefix}-toolbar-scrollable-group":"";return{dom:f('<div aria-label="'+n.label+'" class="${prefix}-toolbar-group '+e+'"></div>'),tgroupBehaviours:C([al("adhoc-scrollable-toolbar",!0===n.scrollable?[Sr(function(n,e){var t;H(n.element,"overflow-x","auto"),t=n.element,S(t,Dd,"true"),Kl(n.element)})]:[])]),components:[fl.sketch({components:[Cd.parts.items({})]})],markers:{itemSelector:"."+N("toolbar-group-item")},items:n.items}}function t(){Ed.setGroups(o,r.get()),D.off(o)}var o=_l(Ed.sketch({dom:f('<div class="${prefix}-toolbar"></div>'),components:[Ed.parts.groups({})],toolbarBehaviours:C([D.config({toggleClass:N("context-toolbar"),toggleOnExecute:!1,aria:{mode:"none"}}),_.config({mode:"cyclic"})]),shell:!0})),n=_l(fl.sketch({dom:{classes:[N("toolstrip")]},components:[Il(o)],containerBehaviours:C([D.config({toggleClass:N("android-selection-context-toolbar"),toggleOnExecute:!1})])})),r=j([]);return{wrapper:n,toolbar:o,createGroups:function(n){return B(n,X(Cd.sketch,e))},setGroups:function(n){r.set(n),t()},setContextToolbar:function(n){D.on(o),Ed.setGroups(o,n)},restoreToolbar:function(){D.isOn(o)&&t()},refresh:function(){},focus:function(){_.focusIn(o)}}},_d=function(n){return _l(Ia.sketch({dom:f('<div class="${prefix}-mask-edit-icon ${prefix}-icon"></div>'),action:function(){n.run(function(n){n.setReadOnly(!1)})}}))},Id=function(){return _l(fl.sketch({dom:f('<div class="${prefix}-editor-socket"></div>'),components:[],containerBehaviours:C([zl.config({})])}))},Fd=function(n,e){zl.append(n,Il(e))},Rd=function(n,e){zl.remove(n,e)},Vd=function(n,e,t,o){(!0===t?Vr.toAlpha:Vr.toOmega)(o),(t?Fd:Rd)(n,e)},Bd=function(e,n){return n.getAnimationRoot.fold(function(){return e.element},function(n){return n(e)})},Ad=function(n){return n.dimension.property},jd=function(n,e){return n.dimension.getDimension(e)},Nd=function(n,e){n=Bd(n,e);Hs(n,[e.shrinkingClass,e.growingClass])},Hd=function(n,e){It(n.element,e.openClass),Mt(n.element,e.closedClass),H(n.element,Ad(e),"0px"),ui(n.element)},Pd=function(n,e,t,o){t.setCollapsed(),H(n.element,Ad(e),jd(e,n.element)),ui(n.element),Nd(n,e),Hd(n,e),e.onStartShrink(n),e.onShrunk(n)},zd=function(n,e,t){var o=jd(e,n.element);("0px"===o?Pd:Uf)(n,e,t,V.some(o))},Ld=function(n,e,t){var o=Bd(n,e),r=An(o,e.shrinkingClass),i=jd(e,n.element),u=($f(n,e),jd(e,n.element));(r?function(){H(n.element,Ad(e),i),ui(n.element)}:function(){Hd(n,e)})(),It(o,e.shrinkingClass),Mt(o,e.growingClass),$f(n,e),H(n.element,Ad(e),u),t.setExpanded(),e.onStartGrow(n)},Qc=Object.freeze({__proto__:null,refresh:function(n,e,t){t.isExpanded()&&(ii(n.element,Ad(e)),t=jd(e,n.element),H(n.element,Ad(e),t))},grow:function(n,e,t){t.isExpanded()||Ld(n,e,t)},shrink:function(n,e,t){t.isExpanded()&&zd(n,e,t)},immediateShrink:function(n,e,t){t.isExpanded()&&Pd(n,e,t,V.none())},hasGrown:function(n,e,t){return t.isExpanded()},hasShrunk:function(n,e,t){return t.isCollapsed()},isGrowing:Wf,isShrinking:Xf,isTransitioning:function(n,e,t){return Wf(n,e)||Xf(n,e)},toggleGrow:function(n,e,t){(t.isExpanded()?zd:Ld)(n,e,t)},disableTransitions:Nd}),Wc=Object.freeze({__proto__:null,exhibit:function(n,e,t){var o=e.expanded;return kr(o?{classes:[e.openClass],styles:{}}:{classes:[e.closedClass],styles:qo(e.dimension.property,"0px")})},events:function(t,o){return k([(n=Re(),Zt(n)(function(n,e){e.event.raw.propertyName===t.dimension.property&&(Nd(n,t),o.isExpanded()&&ii(n.element,t.dimension.property),(o.isExpanded()?t.onGrown:t.onShrunk)(n))}))]);var n}}),Xc=[d("closedClass"),d("openClass"),d("shrinkingClass"),d("growingClass"),m("getAnimationRoot"),go("onShrunk"),go("onStartShrink"),go("onGrown"),go("onStartGrow"),g("expanded",!1),Ut("dimension",$t("property",{width:[i("property","width"),i("getDimension",function(n){return Xu(n)+"px"})],height:[i("property","height"),i("getDimension",function(n){return Fo(n)+"px"})]}))],Gd=Ir({fields:Xc,name:"sliding",active:Wc,apis:Qc,state:Object.freeze({__proto__:null,init:function(n){var e=j(n.expanded);return Mr({isExpanded:function(){return!0===e.get()},isCollapsed:function(){return!1===e.get()},setCollapsed:q(e.set,!1),setExpanded:q(e.set,!0),readState:function(){return"expanded: "+e.get()}})}})}),$d=function(e,t){var o=_l(fl.sketch({dom:{tag:"div",classes:[N("dropup")]},components:[],containerBehaviours:C([zl.config({}),Gd.config({closedClass:N("dropup-closed"),openClass:N("dropup-open"),shrinkingClass:N("dropup-shrinking"),growingClass:N("dropup-growing"),dimension:{property:"height"},onShrunk:function(n){e(),t(),zl.set(n,[])},onGrown:function(n){e(),t()}}),Zr(function(n,e){r(F)})])})),r=function(n){window.requestAnimationFrame(function(){n(),Gd.shrink(o)})};return{appear:function(n,e,t){!0===Gd.hasShrunk(o)&&!1===Gd.isTransitioning(o)&&window.requestAnimationFrame(function(){e(t),zl.set(o,[n()]),Gd.grow(o)})},disappear:r,component:o,element:o.element}},Ud=or([Ut("triggerEvent",ce),g("stopBackspace",!0)]),Wd=Bt([{stopped:[]},{resume:["element"]},{complete:[]}]),Xd=function(t){function o(e){return ut(t.element).fold(b,function(n){return w(e,n)})}function a(n,e){return i.find(o,n,e)}function r(e){var n=i.filter(Ne());x(n,function(n){n=n.descHandler;Vs(n)(e)})}var i=nl(),n=Yf(t.element,{triggerEvent:function(e,t){return lo(e,t.target,function(n){return Zf(a,e,t,t.target,n)})}}),u={debugInfo:h("real"),triggerEvent:function(e,t,o){lo(e,t,function(n){return Zf(a,e,o,t,n)})},triggerFocus:function(u,c){Bu(u).fold(function(){io(u)},function(n){lo(Be(),u,function(n){var e,t,o=a,r=Be(),i=Kf(e={originator:c,kill:F,prevent:F,target:u},t=u);return Jf(o,r,e,t,i,n),!1})})},triggerEscape:function(n,e){u.triggerEvent("keydown",n.element,e.event)},getByUid:function(n){return g(n)},getByDom:function(n){return p(n)},build:_l,addToGui:function(n){s(n)},removeFromGui:function(n){f(n)},addToWorld:function(n){e(n)},removeFromWorld:function(n){c(n)},broadcast:function(n){l(n)},broadcastOn:function(n,e){d(n,e)},broadcastEvent:function(n,e){m(n,e)},isConnected:b},e=function(n){n.connect(u),ot(n.element)||(i.register(n),x(n.components(),e),u.triggerEvent(Ge(),n.element,{target:n.element}))},c=function(n){ot(n.element)||(x(n.components(),c),i.unregister(n)),n.disconnect()},s=function(n){_n(t,n,st)},f=function(n){In(n)},l=function(n){r({universal:!0,data:n})},d=function(n,e){r({universal:!1,channels:n,data:e})},m=function(n,e){var t,o,n=i.filter(n);return n=n,e=e=e,t=j(!1),o={stop:function(){t.set(!0)},cut:F,isStopped:t.get,isCut:v,event:e,setSource:K("Cannot set source of a broadcasted event"),getSource:K("Cannot get source of a broadcasted event")},x(n,function(n){n=n.descHandler;Vs(n)(o)}),o.isStopped()},g=function(n){return i.getById(n).fold(function(){return T.error(new Error('Could not find component with uid: "'+n+'" in system.'))},T.value)},p=function(n){n=Bu(n).getOr("not found");return g(n)};return e(t),{root:t,element:t.element,destroy:function(){n.unbind(),ft(t.element)},add:s,remove:f,getByUid:g,getByDom:p,addToWorld:e,removeFromWorld:c,broadcast:l,broadcastOn:d,broadcastEvent:m}},qd=N("readonly-mode"),Yd=N("edit-mode");function Kd(n){n=_l(fl.sketch({dom:{classes:[N("outer-container")].concat(n.classes)},containerBehaviours:C([Vr.config({alpha:qd,omega:Yd})])}));return Xd(n)}function Jd(n,e){var t=A.fromTag("input");Do(t,{opacity:"0",position:"absolute",top:"-1000px",left:"-1000px"}),st(n,t),io(t),e(t),ft(t)}function Qd(n){var e,t=n.getSelection();0<t.rangeCount&&(e=t.getRangeAt(0),(n=n.document.createRange()).setStart(e.startContainer,e.startOffset),n.setEnd(e.endContainer,e.endOffset),t.removeAllRanges(),t.addRange(n))}function Zd(n,e){co().each(function(n){w(n,e)||uo(n)}),n.focus(),io(A.fromDom(n.document.body)),Qd(n)}function nm(n,e,t,o){function r(){Zd(e,o)}var i=P(t,"keydown",function(n){qn(["input","textarea"],et(n.target))||r()});return{toReading:function(){Jd(n,uo)},toEditing:r,onToolbarTouch:F,destroy:function(){i.unbind()}}}function em(t,o,r,i,n){function u(){o.run(function(n){n.refreshSelection()})}function e(n,e){var t=n-i.dom.scrollTop;o.run(function(n){n.scrollIntoView(t,t+e)})}function c(){o.run(function(n){n.clearSelection()})}function a(){t.getCursorBox().each(function(n){e(n.top,n.height)}),o.run(function(n){n.syncHeight()})}var s=Bf(t),f=Lf(a,300),l=[t.onKeyup(function(){c(),f.throttle()}),t.onNodeChanged(u),t.onDomChanged(f.throttle),t.onDomChanged(u),t.onScrollToCursor(function(n){n.preventDefault(),f.throttle()}),t.onScrollToElement(function(n){n.element,e(o,i)}),t.onToEditing(function(){o.run(function(n){n.toEditing()})}),t.onToReading(function(){o.run(function(n){n.toReading()})}),P(t.doc,"touchend",function(n){w(t.html,n.target)||w(t.body,n.target)}),P(r,"transitionend",function(n){var e;"height"===n.raw.propertyName&&(e=Fo(r),o.run(function(n){n.setViewportOffset(e)}),u(),a())}),mf(r,"touchstart",function(n){var e;o.run(function(n){n.highlightSelection()}),e=n,o.run(function(n){n.onToolbarTouch(e)}),t.onTouchToolstrip()}),P(t.body,"touchstart",function(n){c(),t.onTouchContent(),s.fireTouchstart(n)}),s.onTouchmove(),s.onTouchend(),P(t.body,"click",function(n){n.kill()}),P(r,"touchmove",function(){t.onToolbarScrollStart()})];return{destroy:function(){x(l,function(n){n.unbind()})}}}var qr={},Xr={exports:qr},tm=qr,om=Xr,rm=void 0;(function(n){"object"==typeof tm&&void 0!==om?om.exports=n():("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=n()})(function(){return function o(r,i,u){function c(e,n){if(!i[e]){if(!r[e]){var t="function"==typeof rm&&rm;if(!n&&t)return t(e,!0);if(a)return a(e,!0);n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}t=i[e]={exports:{}};r[e][0].call(t.exports,function(n){return c(r[e][1][n]||n)},t,t.exports,o,r,i,u)}return i[e].exports}for(var a="function"==typeof rm&&rm,n=0;n<u.length;n++)c(u[n]);return c}({1:[function(n,e,t){var o,r,e=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}function c(e){if(o===setTimeout)return setTimeout(e,0);if((o===i||!o)&&setTimeout)return(o=setTimeout)(e,0);try{return o(e,0)}catch(n){try{return o.call(null,e,0)}catch(n){return o.call(this,e,0)}}}try{o="function"==typeof setTimeout?setTimeout:i}catch(n){o=i}try{r="function"==typeof clearTimeout?clearTimeout:u}catch(n){r=u}var a,s=[],f=!1,l=-1;function d(){f&&a&&(f=!1,a.length?s=a.concat(s):l=-1,s.length)&&m()}function m(){if(!f){var n=c(d);f=!0;for(var e=s.length;e;){for(a=s,s=[];++l<e;)a&&a[l].run();l=-1,e=s.length}a=null,f=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===u||!r)&&clearTimeout)return(r=clearTimeout)(e);try{r(e)}catch(n){try{return r.call(null,e)}catch(n){return r.call(this,e)}}}(n)}}function g(n,e){this.fun=n,this.array=e}function p(){}e.nextTick=function(n){var e=new Array(arguments.length-1);if(1<arguments.length)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];s.push(new g(n,e)),1!==s.length||f||c(m)},g.prototype.run=function(){this.fun.apply(null,this.array)},e.title="browser",e.browser=!0,e.env={},e.argv=[],e.version="",e.versions={},e.on=p,e.addListener=p,e.once=p,e.off=p,e.removeListener=p,e.removeAllListeners=p,e.emit=p,e.prependListener=p,e.prependOnceListener=p,e.listeners=function(n){return[]},e.binding=function(n){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(n){throw new Error("process.chdir is not supported")},e.umask=function(){return 0}},{}],2:[function(n,l,e){!function(e){function o(){}function i(n){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof n)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],f(n,this)}function r(t,o){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,i._immediateFn(function(){var n,e=1===t._state?o.onFulfilled:o.onRejected;if(null!==e){try{n=e(t._value)}catch(n){return void c(o.promise,n)}u(o.promise,n)}else(1===t._state?u:c)(o.promise,t._value)})):t._deferreds.push(o)}function u(e,n){try{if(n===e)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"==typeof n||"function"==typeof n)){var t=n.then;if(n instanceof i)return e._state=3,e._value=n,a(e);if("function"==typeof t)return f((o=t,r=n,function(){o.apply(r,arguments)}),e)}e._state=1,e._value=n,a(e)}catch(n){c(e,n)}var o,r}function c(n,e){n._state=2,n._value=e,a(n)}function a(n){2===n._state&&0===n._deferreds.length&&i._immediateFn(function(){n._handled||i._unhandledRejectionFn(n._value)});for(var e=0,t=n._deferreds.length;e<t;e++)r(n,n._deferreds[e]);n._deferreds=null}function s(n,e,t){this.onFulfilled="function"==typeof n?n:null,this.onRejected="function"==typeof e?e:null,this.promise=t}function f(n,e){var t=!1;try{n(function(n){t||(t=!0,u(e,n))},function(n){t||(t=!0,c(e,n))})}catch(n){t||(t=!0,c(e,n))}}var t=setTimeout;i.prototype.catch=function(n){return this.then(null,n)},i.prototype.then=function(n,e){var t=new this.constructor(o);return r(this,new s(n,e,t)),t},i.all=function(n){var c=Array.prototype.slice.call(n);return new i(function(r,i){if(0===c.length)return r([]);for(var u=c.length,n=0;n<c.length;n++)!function e(t,n){try{if(n&&("object"==typeof n||"function"==typeof n)){var o=n.then;if("function"==typeof o)return o.call(n,function(n){e(t,n)},i),0}c[t]=n,0==--u&&r(c)}catch(n){i(n)}}(n,c[n])})},i.resolve=function(e){return e&&"object"==typeof e&&e.constructor===i?e:new i(function(n){n(e)})},i.reject=function(t){return new i(function(n,e){e(t)})},i.race=function(r){return new i(function(n,e){for(var t=0,o=r.length;t<o;t++)r[t].then(n,e)})},i._immediateFn="function"==typeof e?function(n){e(n)}:function(n){t(n,0)},i._unhandledRejectionFn=function(n){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",n)},i._setImmediateFn=function(n){i._immediateFn=n},i._setUnhandledRejectionFn=function(n){i._unhandledRejectionFn=n},void 0!==l&&l.exports?l.exports=i:this.Promise||(this.Promise=i)}.call(this,n("timers").setImmediate)},{timers:3}],3:[function(a,n,s){!function(n,e){var o=a("process/browser.js").nextTick,t=Function.prototype.apply,r=Array.prototype.slice,i={},u=0;function c(n,e){this._id=n,this._clearFn=e}s.setTimeout=function(){return new c(t.call(setTimeout,window,arguments),clearTimeout)},s.setInterval=function(){return new c(t.call(setInterval,window,arguments),clearInterval)},s.clearTimeout=s.clearInterval=function(n){n.close()},c.prototype.unref=c.prototype.ref=function(){},c.prototype.close=function(){this._clearFn.call(window,this._id)},s.enroll=function(n,e){clearTimeout(n._idleTimeoutId),n._idleTimeout=e},s.unenroll=function(n){clearTimeout(n._idleTimeoutId),n._idleTimeout=-1},s._unrefActive=s.active=function(n){clearTimeout(n._idleTimeoutId);var e=n._idleTimeout;0<=e&&(n._idleTimeoutId=setTimeout(function(){n._onTimeout&&n._onTimeout()},e))},s.setImmediate="function"==typeof n?n:function(n){var e=u++,t=!(arguments.length<2)&&r.call(arguments,1);return i[e]=!0,o(function(){i[e]&&(t?n.apply(null,t):n.call(null),s.clearImmediate(e))}),e},s.clearImmediate="function"==typeof e?e:function(n){delete i[n]}}.call(this,a("timers").setImmediate,a("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(n,e,t){var n=n("promise-polyfill"),o="undefined"!=typeof window?window:Function("return this;")();e.exports={boltExport:o.Promise||n}},{"promise-polyfill":2}]},{},[4])(4)});function im(n){function o(n){e()?t(n):i.push(n)}function e(){return r.isSome()}function t(e){r.each(function(n){setTimeout(function(){e(n)},0)})}var r=V.none(),i=[];return n(function(n){e()||(r=V.some(n),x(i,t),i=[])}),{get:o,map:function(t){return im(function(e){o(function(n){e(t(n))})})},isReady:e}}function um(n){setTimeout(function(){throw n},0)}function cm(t){function n(n){t().then(n,um)}return{map:function(n){return cm(function(){return t().then(n)})},bind:function(e){return cm(function(){return t().then(function(n){return e(n).toPromise()})})},anonBind:function(n){return cm(function(){return t().then(function(){return n.toPromise()})})},toLazy:function(){return Cm(n)},toCached:function(){var n=null;return cm(function(){return n=null===n?t():n})},toPromise:t,get:n}}function am(n){return cm(function(){return new Em(n)})}function sm(n){var t,o,e=id(n).isPortrait(),r=(t=n.screen.width,o=n.screen.height,tn([{width:320,height:480,keyboard:{portrait:300,landscape:240}},{width:320,height:568,keyboard:{portrait:300,landscape:240}},{width:375,height:667,keyboard:{portrait:305,landscape:240}},{width:414,height:736,keyboard:{portrait:320,landscape:240}},{width:768,height:1024,keyboard:{portrait:320,landscape:400}},{width:1024,height:1366,keyboard:{portrait:380,landscape:460}}],function(n){return e=t<=n.width&&o<=n.height,n=n.keyboard,e?V.some(n):V.none();var e}).getOr({portrait:o/5,landscape:t/4})),r=e?r.portrait:r.landscape;return(e?n.screen.height:n.screen.width)-n.innerHeight>r?0:r}function fm(n,e){var t=bn(n).dom.defaultView;return Fo(n)+Fo(e)-sm(t)}function lm(n,e,t){var o=fm(e,t),e=Fo(e)+Fo(t)-o;H(n,"padding-bottom",e+"px")}function dm(n){return Af(n,_m)}function mm(n,e){var t=O(n,Im);return Mm.fixed(n,t,e)}function gm(n,e){return Mm.scroller(n,e)}function pm(n){var e=dm(n);return("true"===O(n,Fm)?gm:mm)(n,e)}function hm(n,e,t){var o=bn(n).dom.defaultView.innerHeight;return S(n,Rm,o+"px"),o-e-t}function vm(t,o,r,i){function n(){var n=d.innerHeight;return Af(t,Rm)<n}function e(){var n,e;y&&(n=Fo(r),e=Fo(i),e=hm(t,n,e),S(t,_m,n+"px"),H(t,"height",e+"px"),lm(o,t,i))}var u,c,a,s,f,l,d=bn(t).dom.defaultView,m=(l=O(f=r,"style"),Do(f,{position:"absolute",top:"0px"}),S(f,_m,"0px"),S(f,Im,"top"),{restore:function(){S(f,"style",l||""),kt(f,_m),kt(f,Im)}}),g=Fo(r),p=Fo(i),h=(p=hm(t,g=g,p),s=O(a=t,"style"),Kl(a),Do(a,{position:"absolute",height:p+"px",width:"100%",top:g+"px"}),S(a,_m,g+"px"),S(a,Fm,"true"),S(a,Im,"top"),{restore:function(){of(a),S(a,"style",s||""),kt(a,_m),kt(a,Fm),kt(a,Im)}}),v=(c=O(u=i,"style"),Do(u,{position:"absolute",bottom:"0px"}),S(u,_m,"0px"),S(u,Im,"bottom"),{restore:function(){S(u,"style",c||""),kt(u,_m),kt(u,Im)}}),y=!0;return lm(o,t,i),{setViewportOffset:function(n){S(t,_m,n+"px"),e()},isExpanding:n,isShrinking:Y(n),refresh:e,restore:function(){y=!1,m.restore(),h.restore(),v.restore()}}}function ym(n){return n=_o(n,"top").getOr("0"),parseInt(n,10)}function bm(n){return parseInt(n.dom.scrollTop,10)}function xm(o,r){return am(function(n){var e=q(bm,o),t=(S(o,Bm,e()),Math.abs(r-e())),t=Math.ceil(t/10);Vm.animate(e,r,t,function(n,e){Af(o,Bm)!==o.dom.scrollTop?e(o.dom.scrollTop):(o.dom.scrollTop=n,S(o,Bm,n))},function(){o.dom.scrollTop=r,S(o,Bm,r),n(r)},10)})}function wm(n,e){e=e+dm(n)+"px",H(n,"top",e)}function Sm(n,u){return n.fold(function(n,e,t){return H(n,e,u+(n=t)+"px"),o=n,cm(function(){return Em.resolve(o)});var o},function(n,e){return t=u,t+=e=e,e=_o(n=n,"top").getOr(e),e=t-parseInt(e,10),e=n.dom.scrollTop+e,o=n,r=e,i=t,am(function(n){var e=q(bm,o);Vm.animate(e,r,15,function(n){o.dom.scrollTop=n,H(o,"top",ym(o)+15+"px")},function(){o.dom.scrollTop=r,H(o,"top",i+"px"),n(r)},10)});var t,o,r,i})}function Om(n,e){n=ai(n,"["+_m+"]");var u,n=B(n,pm),n=B(n,function(n){return Sm(n,e)});return u=n,am(function(o){var r=[],i=0;0===u.length?o([]):x(u,function(n,e){var t;n.get((t=e,function(n){r[t]=n,++i>=u.length&&o(r)}))})})}function Tm(n){function e(){_.clear()}var t,o,r,i,u,c,a,s,f,l,d,m,g,p,h,v=n.cWin,y=n.ceBody,b=n.socket,x=n.toolstrip,w=n.contentElement,S=n.keyboardType,O=n.outerWindow,T=n.dropup,n=n.outerBody,k=vm(b,y,x,T),E=S(n,v,Dn(),w),C=gf(O,{onChange:F,onReady:k.refresh}),D=(C.onAdjustment(function(){k.refresh()}),P(A.fromDom(O),"resize",function(){k.isExpanding()&&k.refresh()})),M=(c=x,a=b,s=n,f=O,l=k,d=v,m=function(n){return t=a,o=n,r=bn(e=c).dom.defaultView,am(function(n){wm(e,o),wm(t,o),r.scrollTo(0,o),n(o)});var e,t,o,r},g=j(Dm({})),p={start:function(e){var n=Cm(function(n){return m(e).get(n)});g.set(n)},idle:function(n){g.get().get(function(){n()})}},h=Lf(function(){p.idle(function(){Om(s,f.pageYOffset).get(function(){var n=Hf(d);V.from(n[0]).bind(function(n){var e=n.top-a.dom.scrollTop;return e>f.innerHeight+5||e<-5?V.some({top:e,bottom:e+n.height}):V.none()}).each(function(n){a.dom.scrollTop=a.dom.scrollTop+n.top}),p.start(0),l.refresh()})})},1e3),y=P(A.fromDom(f),"scroll",function(){f.pageYOffset<0||h.throttle()}),Om(s,f.pageYOffset).get(R),{unbind:y.unbind}),_=(o=w,S=(t=v).document,r=A.fromTag("div"),Mt(r,N("unfocused-selections")),st(A.fromDom(S.documentElement),r),i=P(r,"touchstart",function(n){n.prevent(),Zd(t,o),u()}),{update:function(){u();var n=Hf(t),n=B(n,I);Tn(r,n)},isActive:function(){return 0<ct(r).length},destroy:function(){i.unbind(),ft(r)},clear:u=function(){kn(r)}});function I(n){var e=A.fromTag("span");return Ns(e,[N("layer-editor"),N("unfocused-selection")]),Do(e,{left:n.left+"px",top:n.top+"px",width:n.width+"px",height:n.height+"px"}),e}return{toEditing:function(){E.toEditing(),e()},toReading:function(){E.toReading()},onToolbarTouch:function(n){E.onToolbarTouch()},refreshSelection:function(){_.isActive()&&_.update()},clearSelection:e,highlightSelection:function(){_.update()},scrollIntoView:function(n,e){var t,o=v,r=fm(t=b,T),o=q(Qd,o);r<n||r<e?xm(t,t.dom.scrollTop-r+e).get(o):n<0&&xm(t,t.dom.scrollTop+n).get(o)},updateToolbarPadding:F,setViewportOffset:function(n){var r,i;k.setViewportOffset(n),r=b,i=n,am(function(n){function e(n){H(r,"top",n+"px")}var t=q(ym,r),o=Math.abs(i-t()),o=Math.ceil(o/10);Vm.animate(t,i,o,e,function(){e(i),n(i)},10)}).get(R)},syncHeight:function(){H(w,"height",w.dom.contentWindow.document.body.scrollHeight+"px")},refreshStructure:k.refresh,destroy:function(){k.restore(),C.destroy(),M.unbind(),D.unbind(),E.destroy(),_.destroy(),Jd(Dn(),uo)}}}var km,Em=Xr.exports.boltExport,Cm=im,Dm=function(e){return im(function(n){n(e)})},Mm=Bt([{fixed:["element","property","offsetY"]},{scroller:["element","offsetY"]}]),_m="data-"+N("position-y-fixed"),Im="data-"+N("y-property"),Fm="data-"+N("scrolling"),Rm="data-"+N("last-window-height"),Vm=(km=null,{animate:function(r,i,u,c,e,n){function a(n){f=!0,e(n)}function s(n){rd.clearInterval(km),a(n)}var f=!1;rd.clearInterval(km);km=rd.setInterval(function(){var t=r(),n=t,e=i,o=u;(Math.abs(n-e)<=o?V.none():n<e?V.some(n+o):V.some(n-o)).fold(function(){rd.clearInterval(km),a(i)},function(n){var e;c(n,s),f||((e=r())!==n||Math.abs(e-i)>Math.abs(t-i))&&(rd.clearInterval(km),a(i))})},n)}}),Bm="data-"+N("last-scroll-top"),Am=function(o,n){var r=md(),i=Is(),u=Is(),c=xl(),a=xl();return{enter:function(){n.hide();var t=A.fromDom(document);ld(o.editor).each(function(n){var e;i.set({socketHeight:_o(o.socket,"height"),iframeHeight:_o(n.frame,"height"),outerScroll:document.body.scrollTop}),u.set({exclusives:(e="."+Jl,P(t,"touchmove",function(n){Ii(n.target,e).filter(Gf).fold(function(){n.prevent()},F)}))}),Mt(o.container,N("fullscreen-maximized")),yd(o.container,n.body),r.maximize(),H(o.socket,"overflow","scroll"),H(o.socket,"-webkit-overflow-scrolling","touch"),io(n.body),c.set(Tm({cWin:n.win,ceBody:n.body,socket:o.socket,toolstrip:o.toolstrip,dropup:o.dropup.element,contentElement:n.frame,outerBody:o.body,outerWindow:o.win,keyboardType:nm})),c.run(function(n){n.syncHeight()}),a.set(em(n,c,o.toolstrip,o.socket,o.dropup))})},refreshStructure:function(){c.run(function(n){n.refreshStructure()})},exit:function(){r.restore(),a.clear(),c.clear(),n.show(),i.on(function(n){n.socketHeight.each(function(n){H(o.socket,"height",n)}),n.iframeHeight.each(function(n){H(o.editor.getFrame(),"height",n)}),document.body.scrollTop=n.scrollTop}),i.clear(),u.on(function(n){n.exclusives.unbind()}),u.clear(),It(o.container,N("fullscreen-maximized")),bd(),of(o.toolbar),ii(o.socket,"overflow"),ii(o.socket,"-webkit-overflow-scrolling"),uo(o.editor.getFrame()),ld(o.editor).each(function(n){n.clearSelection()})}}};function jm(n){var e=Kd({classes:[N("ios-container")]}),t=Md(),r=xl(),o=_d(r),i=Id(),n=$d(function(){r.run(function(n){n.refreshStructure()})},n);return e.add(t.wrapper),e.add(i),e.add(n.component),{system:e,element:e.element,init:function(n){var e,t,o;r.set((e=dr("Getting IosWebapp schema",kd,n),H(e.toolstrip,"width","100%"),H(e.container,"position","relative"),t=_l(Td(function(){e.setReadOnly(e.readOnlyOnInit()),o.enter()},e.translate)),e.alloy.add(t),o=Am(e,{show:function(){e.alloy.add(t)},hide:function(){e.alloy.remove(t)}}),{setReadOnly:e.setReadOnly,refreshStructure:o.refreshStructure,enter:o.enter,exit:o.exit,destroy:F}))},exit:function(){r.run(function(n){zl.remove(i,o),n.exit()})},setToolbarGroups:function(n){n=t.createGroups(n);t.setGroups(n)},setContextToolbar:function(n){n=t.createGroups(n);t.setContextToolbar(n)},focusToolbar:function(){t.focus()},restoreToolbar:function(){t.restoreToolbar()},updateMode:function(n){Vd(i,o,n,e.root)},socket:i,dropup:n}}function Nm(n,e,t){n.system.broadcastOn([Nr],{command:e,state:t})}function Hm(e){return function(){function n(){e._skinLoaded=!0,e.fire("SkinLoaded")}e.initialized?n():e.on("init",n)}}var Pm=tinymce.util.Tools.resolve("tinymce.EditorManager"),zm="toReading",Lm="toEditing";vr.add("mobile",function(y){return{getNotificationManagerImpl:function(){return{open:h({progressBar:{value:F},close:F,text:F,getEl:h(null),moveTo:F,moveRel:F,settings:{}}),close:F,reposition:F,getArgs:h({})}},renderUI:function(){var n,e=y.getElement(),t={content:(s=V.from(y.getParam("skin_url")).fold(function(){return Pm.baseURL+"/skins/ui/oxide"},function(n){return n}))+"/content.mobile.min.css",ui:s+"/skin.mobile.min.css"};0==(!1===y.getParam("skin"))?(n=Br.DOM.styleSheetLoader,y.contentCSS.push(t.content),n.load(t.ui,Hm(y)),y.on("remove",function(){return n.unload(t.ui)})):Hm(y)();function o(){y.fire("ScrollIntoView")}function d(n,e,t,o){!1===o&&y.selection.collapse(),n=v(n,e,t),g.setToolbarGroups(!0===o?n.readOnly:n.main),y.setMode(!0===o?"readonly":"design"),y.fire(!0===o?zm:Lm),g.updateMode(o)}function m(n,e){return y.on(n,e),{unbind:function(){y.off(n)}}}var r,i,u,c,a,g=xe().os.isAndroid()?(s=o,r=Kd({classes:[N("android-container")]}),i=Md(),u=xl(),c=_d(u),a=Id(),s=$d(F,s),r.add(i.wrapper),r.add(a),r.add(s.component),{system:r,element:r.element,init:function(n){u.set(function(n){var e=dr("Getting AndroidWebapp schema",kd,n),t=(H(e.toolstrip,"width","100%"),_l(Td(function(){e.setReadOnly(e.readOnlyOnInit()),a.enter()},e.translate))),n=(e.alloy.add(t),{show:function(){e.alloy.add(t)},hide:function(){e.alloy.remove(t)}});st(e.container,t.element);o=e,r=n,i=md(),u=xl(),c=xl();var o,r,i,u,c,a={enter:function(){r.hide(),Mt(o.container,N("fullscreen-maximized")),Mt(o.container,N("android-maximized")),i.maximize(),Mt(o.body,N("android-scroll-reload")),u.set(Od(o.win,dd(o.editor).getOrDie("no"))),ld(o.editor).each(function(n){yd(o.container,n.body),c.set(wd(n,o.toolstrip,o.alloy))})},exit:function(){i.restore(),r.show(),It(o.container,N("fullscreen-maximized")),It(o.container,N("android-maximized")),bd(),It(o.body,N("android-scroll-reload")),c.clear(),u.clear()}};return{setReadOnly:e.setReadOnly,refreshStructure:F,enter:a.enter,exit:a.exit,destroy:F}}(n))},exit:function(){u.run(function(n){n.exit(),zl.remove(a,c)})},setToolbarGroups:function(n){n=i.createGroups(n);i.setGroups(n)},setContextToolbar:function(n){n=i.createGroups(n);i.setContextToolbar(n)},focusToolbar:function(){i.focus()},restoreToolbar:function(){i.restoreToolbar()},updateMode:function(n){Vd(a,c,n,r.root)},socket:a,dropup:s}):jm(o),s=A.fromDom(e),f=g.system,l=Sn,p=(l(s,f.element),l=ct(f.element),x(l,function(n){f.getByDom(n).each(pt)}),e.ownerDocument.defaultView),h=gf(p,{onChange:function(){var n,e,t;g.system.broadcastOn([Hr],{width:(n=p,e=xe().os.isiOS(),t=id(n).isPortrait(),e&&!t?n.screen.height:n.screen.width)})},onReady:F}),v=function(n,e,t){n=n.get();return{readOnly:n.backToMask.concat(e.get()),main:n.backToMask.concat(t.get())}};return y.on("init",function(){g.init({editor:{getFrame:function(){return A.fromDom(y.contentAreaContainer.querySelector("iframe"))},onDomChanged:function(){return{unbind:F}},onToReading:function(n){return m(zm,n)},onToEditing:function(n){return m(Lm,n)},onScrollToCursor:function(e){return y.on("ScrollIntoView",function(n){e(n)}),{unbind:function(){y.off("ScrollIntoView"),h.destroy()}}},onTouchToolstrip:function(){e()},onTouchContent:function(){var n=A.fromDom(y.editorContainer.querySelector("."+N("toolbar")));ao(n).bind(function(n){return g.system.getByDom(n).toOptional()}).each(gn),g.restoreToolbar(),e()},onTapContent:function(n){var t=n.target;"img"===et(t)?(y.selection.select(t.dom),n.kill()):"a"===et(t)&&g.system.getByDom(A.fromDom(y.editorContainer)).each(function(n){var e;Vr.isAlpha(n)&&(n=t.dom,(e=document.createElement("a")).target="_blank",e.href=n.href,e.rel="noreferrer noopener",(n=document.createEvent("MouseEvents")).initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),document.body.appendChild(e),e.dispatchEvent(n),document.body.removeChild(e))})}},container:A.fromDom(y.editorContainer),socket:A.fromDom(y.contentAreaContainer),toolstrip:A.fromDom(y.editorContainer.querySelector("."+N("toolstrip"))),toolbar:A.fromDom(y.editorContainer.querySelector("."+N("toolbar"))),dropup:g.dropup,alloy:g.system,translate:F,setReadOnly:function(n){d(f,s,a,n)},readOnlyOnInit:function(){return!1}});var t,o,n,e=function(){g.dropup.disappear(function(){g.system.broadcastOn([Pr],{})})},r={label:"The first group",scrollable:!1,items:[ja("back",function(){y.selection.collapse(),g.exit()},{},y)]},i={label:"Back to read only",scrollable:!1,items:[ja("readonly-back",function(){d(f,s,a,!0)},{},y)]},u=sf(g,y),u=(t=u,u=function(n){n=n.getParam("toolbar",jr,"array");return(L(n)?td:ed)(n)}(y),o={},ee(u,function(n){var e=!St(o,n)&&St(t,n)&&t[n].isSupported()?[t[n].sketch()]:[];return o[n]=!0,e})),c={label:"The extra group",scrollable:!1,items:[]},a=j([{label:"the action group",scrollable:!0,items:u},c]),s=j([{label:"The read only mode group",scrollable:!0,items:[]},c]),f=j({backToMask:[r],backToReadOnly:[i]}),l=g,u=ht((n=y).formatter.get());x(u,function(e){n.formatter.formatChanged(e,function(n){Nm(l,e,n)})}),x(["ul","ol"],function(t){n.selection.selectorChanged(t,function(n,e){Nm(l,t,n)})})}),y.on("remove",function(){g.exit()}),y.on("detach",function(){var e=g.system,n=ct(e.element);x(n,function(n){e.getByDom(n).each(gt)}),ft(e.element),g.system.destroy()}),{iframeContainer:g.socket.element.dom,editorContainer:g.element.dom}}}})}();