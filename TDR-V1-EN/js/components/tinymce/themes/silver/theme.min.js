!function(){"use strict";function e(e){return function(t){return n=typeof(t=t),(null===t?"null":"object"==n&&(Array.prototype.isPrototypeOf(t)||t.constructor&&"Array"===t.constructor.name)?"array":"object"==n&&(String.prototype.isPrototypeOf(t)||t.constructor&&"String"===t.constructor.name)?"string":n)===e;var n}}function o(n){return function(t){return typeof t===n}}function i(e,o){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e(o.apply(null,t))}}var y=e("string"),w=e("object"),c=e("array"),S=o("boolean"),a=function(t){return!(null==t)},C=o("function"),mt=o("number"),f=function(t,n){if(c(t)){for(var e=0,o=t.length;e<o;++e)if(!n(t[e]))return!1;return!0}return!1},K=function(){},X=function(t){return function(){return t}},A=function(t){return t};function M(o){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var e=r.concat(t);return o.apply(null,e)}}function l(t){return function(){throw new Error(t)}}var O=function(n){return function(t){return!n(t)}},d=X(!1),E=X(!0),r=tinymce.util.Tools.resolve("tinymce.ThemeManager"),J=function(){return(J=Object.assign||function(t){for(var n,e=1,o=arguments.length;e<o;e++)for(var r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)};function D(t,n){var e={};for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.indexOf(r)<0&&(e[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)n.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(e[r[o]]=t[r[o]]);return e}function F(){for(var t=0,n=0,e=arguments.length;n<e;n++)t+=arguments[n].length;for(var o=Array(t),r=0,n=0;n<e;n++)for(var i=arguments[n],u=0,a=i.length;u<a;u++,r++)o[r]=i[u];return o}function I(){return j}function R(e){function t(){return r}function n(t){return t(e)}var o=X(e),r={fold:function(t,n){return n(e)},is:function(t){return e===t},isSome:E,isNone:d,getOr:o,getOrThunk:o,getOrDie:o,getOrNull:o,getOrUndefined:o,or:t,orThunk:t,map:function(t){return R(t(e))},each:function(t){t(e)},bind:n,exists:n,forall:n,filter:function(t){return t(e)?r:j},toArray:function(){return[e]},toString:function(){return"some("+e+")"},equals:function(t){return t.is(e)},equals_:function(t,n){return t.fold(d,function(t){return n(e,t)})}};return r}function V(t,n){for(var e=[],o=0;o<t.length;o+=n){var r=U.call(t,o,o+n);e.push(r)}return e}function P(t,n){return(t=U.call(t,0)).sort(n),t}function H(t){return Dt(t,0)}function z(e){return{is:function(t){return e===t},isValue:E,isError:d,getOr:X(e),getOrThunk:X(e),getOrDie:X(e),or:function(t){return z(e)},orThunk:function(t){return z(e)},fold:function(t,n){return n(e)},map:function(t){return z(t(e))},mapError:function(t){return z(e)},each:function(t){t(e)},bind:function(t){return t(e)},exists:function(t){return t(e)},forall:function(t){return t(e)},toOptional:function(){return $.some(e)}}}function N(e){return{is:d,isValue:d,isError:E,getOr:A,getOrThunk:function(t){return t()},getOrDie:function(){return l(String(e))()},or:function(t){return t},orThunk:function(t){return t()},fold:function(t,n){return t(e)},map:function(t){return N(e)},mapError:function(t){return N(t(e))},each:K,bind:function(t){return N(e)},exists:d,forall:E,toOptional:$.none}}qe=function(t){return t.isNone()};var L,j={fold:function(t,n){return t()},is:d,isSome:d,isNone:E,getOr:uo=function(t){return t},getOrThunk:Ae=function(t){return t()},getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:X(null),getOrUndefined:X(void 0),or:uo,orThunk:Ae,map:I,each:K,bind:I,exists:d,forall:E,filter:I,equals:qe,equals_:qe,toArray:function(){return[]},toString:X("none()")},$={some:R,none:I,from:function(t){return null==t?j:R(t)}},U=Array.prototype.slice,W=Array.prototype.indexOf,G=Array.prototype.push,gt=function(t,n){return W.call(t,n)},pt=function(t,n){return-1<gt(t,n)},ht=function(t,n){for(var e=0,o=t.length;e<o;e++)if(n(t[e],e))return!0;return!1},vt=function(t,n){for(var e=[],o=0;o<t;o++)e.push(n(o));return e},k=function(t,n){for(var e=t.length,o=new Array(e),r=0;r<e;r++){var i=t[r];o[r]=n(i,r)}return o},Q=function(t,n){for(var e=0,o=t.length;e<o;e++)n(t[e],e)},bt=function(t,n){for(var e=[],o=[],r=0,i=t.length;r<i;r++){var u=t[r];(n(u,r)?e:o).push(u)}return{pass:e,fail:o}},yt=function(t,n){for(var e=[],o=0,r=t.length;o<r;o++){var i=t[o];n(i,o)&&e.push(i)}return e},xt=function(t,n,e){for(var o,r=t,i=r.length-1;0<=i;i--)o=r[i],e=n(e,o);return e},wt=function(t,n,e){return Q(t,function(t){e=n(e,t)}),e},St=function(t,n){for(var e=t,o=n,r=d,i=0,u=e.length;i<u;i++){var a=e[i];if(o(a,i))return $.some(a);if(r(a,i))break}return $.none()},kt=function(t,n){for(var e=0,o=t.length;e<o;e++)if(n(t[e],e))return $.some(e);return $.none()},Ct=function(t){for(var n=[],e=0,o=t.length;e<o;++e){if(!c(t[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+t);G.apply(n,t[e])}return n},Ot=function(t,n){return Ct(k(t,n))},_t=function(t,n){for(var e=0,o=t.length;e<o;++e)if(!0!==n(t[e],e))return!1;return!0},Tt=function(t){t=U.call(t,0);return t.reverse(),t},Et=function(t,n){return yt(t,function(t){return!pt(n,t)})},Dt=function(t,n){return 0<=n&&n<t.length?$.some(t[n]):$.none()},Bt=function(t){return Dt(t,t.length-1)},At=C(Array.from)?Array.from:function(t){return U.call(t)},Mt=function(t,n){for(var e=0;e<t.length;e++){var o=n(t[e],e);if(o.isSome())return o}return $.none()},Z={value:z,error:N,fromOption:function(t,n){return t.fold(function(){return N(n)},z)}};(uo=L=L||{})[uo.Error=0]="Error",uo[uo.Value=1]="Value";function Ft(t,n,e){return t.stype===L.Error?n(t.serror):e(t.svalue)}function It(t,n){for(var e=pe(t),o=0,r=e.length;o<r;o++){var i=e[o],u=t[i];if(n(u,i,t))return $.some(u)}return $.none()}function Rt(u){if(!c(u))throw new Error("cases must be an array");if(0===u.length)throw new Error("there must be at least one case");var a=[],e={};return Q(u,function(t,o){var n=pe(t);if(1!==n.length)throw new Error("one and only one name per case");var r=n[0],i=t[r];if(void 0!==e[r])throw new Error("duplicate key detected:"+r);if("cata"===r)throw new Error("cannot have a case named cata (sorry)");if(!c(i))throw new Error("case arguments must be an array");a.push(r),e[r]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e.length;if(n!==i.length)throw new Error("Wrong number of arguments to case "+r+". Expected "+i.length+" ("+i+"), got "+n);return{fold:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(t.length!==u.length)throw new Error("Wrong number of arguments to fold. Expected "+u.length+", got "+t.length);return t[o].apply(null,e)},match:function(t){var n=pe(t);if(a.length!==n.length)throw new Error("Wrong number of arguments to match. Expected: "+a.join(",")+"\nActual: "+n.join(","));if(_t(a,function(t){return pt(n,t)}))return t[r].apply(null,e);throw new Error("Not all branches were specified when using match. Specified: "+n.join(", ")+"\nRequired: "+a.join(", "))},log:function(t){console.log(t,{constructors:a,constructor:r,params:e})}}}}),e}function Vt(u){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(0===t.length)throw new Error("Can't merge zero objects");for(var e={},o=0;o<t.length;o++){var r,i=t[o];for(r in i)Ce.call(i,r)&&(e[r]=u(e[r],i[r]))}return e}}function Pt(t){return Ee.defaultedThunk(X(t))}function Ht(t){return n={},Q(t,function(t){n[t.key]=t.value}),n;var n}function zt(t){return 0<(t=le(t)).errors.length?Re(t.errors):se(t.values)}function Nt(u,a,t,c){return t.fold(function(o,n,t,e){function r(t){return t=e.extract(u.concat([o]),c,t),me(t,function(t){return Fe(n,c(t))})}function i(t){return t.fold(function(){var t=Fe(n,c($.none()));return se(t)},function(t){t=e.extract(u.concat([o]),c,t);return me(t,function(t){return Fe(n,c($.some(t)))})})}return t.fold(function(){return de(ze(u,a,o),r)},function(t){return de(Ne(a,o,t),r)},function(){return de(se(B(a,o)),i)},function(t){return de((e=t,t=B(n=a,o).map(function(t){return!0===t?e(n):t}),se(t)),i);var n,e},function(t){var n=t(a),t=me(Ne(a,o,X({})),function(t){return Oe(n,t)});return de(t,r)})},function(t,n){n=n(a);return se(Fe(t,c(n)))})}function Lt(a){return{extract:function(t,n,e){for(var o=[],r=0,i=a;r<i.length;r++){var u=i[r].extract(t,n,e);if(u.stype===L.Value)return u;o.push(u)}return zt(o)},toString:function(){return"oneOf("+k(a,function(t){return t.toString()}).join(", ")+")"}}}function jt(n,s){return{extract:function(u,a,c){return B(c,n).fold(function(){return t=n,Pe(u,function(){return'Choice schema did not contain choice key: "'+t+'"'});var t},function(t){return e=u,n=a,o=c,B(r=s,i=t).fold(function(){return t=r,n=i,Pe(e,function(){return'The chosen schema: "'+n+'" did not exist in branches: '+Ve(t)});var t,n},function(t){return t.extract(e.concat(["branch: "+i]),n,o)});var e,n,o,r,i})},toString:function(){return"chooseOn("+n+"). Possible values: "+pe(s)}}}function Ut(t){return Ge(t)}function Wt(o){return{extract:function(t,n,e){return o().extract(t,n,e)},toString:function(){return o().toString()}}}function Gt(n,t){return i=function(t){return n(t).fold(ae,ue)},u=t,{extract:function(n,e,o){var t=pe(o),r=(r=n,t=t,Ue(Le(i)).extract(r,A,t));return de(r,function(t){t=k(t,function(t){return He.field(t,t,De(),u)});return m(t).extract(n,e,o)})},toString:function(){return"setOf("+u.toString()+")"}};var i,u}function Xt(t,n){return jt(t,be(n,m))}function Yt(e,o){return Le(function(t){var n=typeof t;return e(t)?se(t):fe("Expected type: "+o+" but got: "+n)})}function qt(n){function t(t,n){for(var e=t.next();!e.done;){if(!n(e.value))return!1;e=t.next()}return!0}if(Object(n)!==n)return!0;switch({}.toString.call(n).slice(8,-1)){case"Boolean":case"Number":case"String":case"Date":case"RegExp":case"Blob":case"FileList":case"ImageData":case"ImageBitmap":case"ArrayBuffer":return!0;case"Array":case"Object":return Object.keys(n).every(function(t){return qt(n[t])});case"Map":return t(n.keys(),qt)&&t(n.values(),qt);case"Set":return t(n.keys(),qt);default:return!1}}function Kt(n){return Ke(function(t){return pt(n,t)?Z.value(t):Z.error('Unsupported value: "'+t+'", choose one of "'+n.join(", ")+'".')})}function n(t){return ao(t,oo)}function Jt(t,n){return Ye(t,t,De(),Kt(n))}function $t(t){return ao(t,io)}function Qt(t,n){return Ye(t,t,De(),Ge(n))}function Zt(t,n){return Ye(t,t,De(),Ue(n))}function tn(t){return so(t,eo)}function nn(t){return so(t,oo)}function en(t){return so(t,io)}function on(t,n){return fo(t,n,eo)}function rn(t,n){return fo(t,n,oo)}function un(t,n,e){return fo(t,n,Kt(e))}function an(t,n){return fo(t,n,ro)}function cn(t,n){return fo(t,n,io)}function sn(t,n,e){return fo(t,n,Ue(e))}function ln(t,n,e){return fo(t,n,m(e))}function fn(t){if(null==t)throw new Error("Node cannot be null or undefined");return{dom:t}}function dn(){return mn(0,0)}function mn(t,n){return{major:t,minor:n}}function gn(t,n){return-1!==t.indexOf(n)}function pn(t,n){return e=t.length-(n=n).length,""===n||t.length>=n.length&&t.substr(e,e+n.length)===n;var e}function hn(n){return function(t){return gn(t,n)}}function vn(t){function n(t){return function(){return e===t}}var e=t.current,t=t.version;return{current:e,version:t,isEdge:n("Edge"),isChrome:n("Chrome"),isIE:n("IE"),isOpera:n("Opera"),isFirefox:n(xo),isSafari:n("Safari")}}function bn(t){function n(t){return function(){return e===t}}var e=t.current,t=t.version;return{current:e,version:t,isWindows:n(ko),isiOS:n("iOS"),isAndroid:n(Co),isOSX:n("OSX"),isLinux:n("Linux"),isSolaris:n(Oo),isFreeBSD:n(_o),isChromeOS:n(To)}}function yn(t,n){var e,o,r,i,u,a,c=yo.browsers(),s=yo.oses(),c=po(c,a=t).map(function(t){var n=go.detect(t.versionRegexes,a);return{current:t.name,version:n}}).fold(wo,So),s=po(s,u=t).map(function(t){var n=go.detect(t.versionRegexes,u);return{current:t.name,version:n}}).fold(Eo,Do);return{browser:c,os:s,deviceType:(c=c,t=t,n=n,e=(s=s).isiOS()&&!0===/ipad/i.test(t),o=s.isiOS()&&!e,r=(i=s.isiOS()||s.isAndroid())||n("(pointer:coarse)"),n=e||!o&&i&&n("(min-device-width:768px)"),i=o||i&&!n,c=c.isSafari()&&s.isiOS()&&!1===/safari/i.test(t),t=!i&&!n&&!c,{isiPad:X(e),isiPhone:X(o),isTablet:X(n),isPhone:X(i),isTouch:X(r),isAndroid:s.isAndroid,isiOS:s.isiOS,isWebView:X(c),isDesktop:X(t)})}}function xn(t){return window.matchMedia(t).matches}function wn(t,n,e){var o=n(t),r=Po(e);return o.orThunk(function(){return r(t)?$.none():Ho(t,n,r)})}function Sn(t){return X("alloy."+t)}function kn(t,n,e){Br(t,n,e,{})}function Cn(t,n,e,o){t.getSystem().triggerEvent(e,n,o.event)}function On(t,n){return{key:t,value:No({abort:n})}}function _n(t){return{key:t,value:No({run:function(t,n){n.event.prevent()}})}}function Tn(t,e,o){return{key:t,value:No({run:function(t,n){e.apply(void 0,[t,n].concat(o))}})}}function En(t){return function(e){return{key:t,value:No({run:function(t,n){zo(t,n)&&e(t,n)}})}}}function Dn(t,n,e){var o,r=n.partUids[e];return et(o=t,function(t,n){t.getSystem().getByUid(r).each(function(t){Cn(t,t.element,o,n)})})}function Bn(t,r){return et(t,function(n,t){var e=t.event,o=n.getSystem().getByDom(e.target).fold(function(){return wn(e.target,function(t){return n.getSystem().getByDom(t).toOptional()},d).getOr(n)},function(t){return t});r(n,o,t)})}function An(t){return et(t,function(t,n){n.cut()})}function Mn(n){return function(t){return t.dom.nodeType===n}}function Fn(t){return nt.fromDom(Ur(t).dom.documentElement)}function In(t,n){return t=t.dom.childNodes,$.from(t[n]).map(nt.fromDom)}function Rn(t){return nt.fromDom(t.dom.host)}function Vn(t,n){$.from(t.dom.nextSibling).map(nt.fromDom).fold(function(){Gr(t).each(function(t){ni(t,n)})},function(t){ti(t,n)})}function Pn(n,e){In(n,0).fold(function(){ni(n,e)},function(t){n.dom.insertBefore(e.dom,t.dom)})}function Hn(t){var n,e=qr(t);0<e.length&&(n=t,Q(e,function(t){ti(n,t)})),ri(t)}function zn(t,n){var e=jr(t).dom,o=nt.fromDom(e.createDocumentFragment()),n=(n=n,(e=(e||document).createElement("div")).innerHTML=n,qr(nt.fromDom(e)));ei(o,n),oi(t),ni(t,o)}function Nn(t,n){return!(!(t=t.dom)||!t.hasAttribute)&&t.hasAttribute(n)}function Ln(t){var n;return Kr(t)?"#shadow-root":(t=nt.fromDom(t.dom.cloneNode(!1)),n=nt.fromTag("div"),t=nt.fromDom(t.dom.cloneNode(!0)),ni(n,t),ii(n))}function jn(o){return t=function(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];return o.apply(void 0,F([t.getApis(),t],n))},e=(n=o.toString()).indexOf(")")+1,r=n.indexOf("("),i=n.substring(r+1,e-1).split(/,\s*/),t.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:wi(i.slice(1))}},t;var t,n,e,r,i}function Un(t,r){var i={};return ve(t,function(t,o){ve(t,function(t,n){var e=B(i,n).getOr([]);i[n]=e.concat([r(o,t)])})}),i}function Wn(t,n){return{name:t,handler:n}}function Gn(t,n,e){return(n=n[e])?function(r,t,i){try{var n=P(t,function(t,n){var t=t.name,n=n.name,e=i.indexOf(t),o=i.indexOf(n);if(-1===e)throw new Error("The ordering for "+r+" does not have an entry for "+t+".\nOrder specified: "+JSON.stringify(i,null,2));if(-1===o)throw new Error("The ordering for "+r+" does not have an entry for "+n+".\nOrder specified: "+JSON.stringify(i,null,2));return e<o?-1:o<e?1:0});return Z.value(n)}catch(t){return Z.error([t])}}("Event: "+e,t,n).map(function(t){var n,o,r,e=k(t,function(t){return t.handler});return o=n=e,r=function(t){return t.abort},No({can:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return wt(n,function(t,n){return t&&n.can.apply(void 0,e)},!0)},abort:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return wt(o,function(t,n){return t||r(n).apply(void 0,e)},!1)},run:function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];Q(e,function(t){t.run.apply(void 0,n)})}})}):Z.error(["The event ("+e+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(k(t,function(t){return t.name}),null,2)])}function Xn(t,i){var n,e,o,t=xe(t,function(e,o){return(1===e.length?Z.value(e[0].handler):Gn(e,i,o)).map(function(t){function n(t,n){for(var e=[],o=2;o<arguments.length;o++)e[o-2]=arguments[o];t=[t,n].concat(e),r.abort.apply(void 0,t)?n.stop():r.can.apply(void 0,t)&&r.run.apply(void 0,t)}r=C(t=t=t)?{can:E,abort:d,run:t}:t;var r,t=1<e.length?yt(i[o],function(n){return ht(e,function(t){return t.name===n})}).join(" > "):e[0].name;return Ie(o,{handler:n,purpose:t})})});return n={},e=[],o=[],Q(t=t,function(t){t.fold(function(t){e.push(t)},function(t){o.push(t)})}),0<(t={errors:e,values:o}).errors.length?Z.error(Ct(t.errors)):(n=n,0===(t=t.values).length?Z.value(n):Z.value(Oe(n,_e.apply(void 0,t))))}function Yn(t,n){return void 0===(t=ai(t,n))||""===t?[]:t.split(" ")}function qn(t,n,e){return t=nt.fromTag(t),rt(t,n,e),Ki(t,n).isSome()}function Kn(t,n){if(void 0===n)throw new Error("Value.set was undefined");t.dom.value=n}function Jn(t){n=B(t,"behaviours").getOr({}),o=yt(pe(n),function(t){return void 0!==n[t]});var n,e,o=k(o,function(t){return n[t].me});return e=t=t,o=k(t=o=o,function(t){return lo(t.name(),[g("config"),b("state",Oi)])}),o=Je("component.behaviours",m(o),e.behaviours).fold(function(t){throw new Error(Ze(t)+"\nComplete spec:\n"+JSON.stringify(e,null,2))},function(t){return t}),{list:t,data:be(o,function(t){var n=t.map(function(t){return{config:t.config,state:t.state.init(t.config)}});return function(){return n}})}}function $n(t,n,e){var o,r,i,u=J(J({},(u=t).dom),{uid:u.uid,domChildren:k(u.components,function(t){return t.element})}),a={"alloy.base.modification":t=t.domModification.fold(function(){return Ti({})},Ti)};function c(t){return xt(t,function(t,n){return J(J({},n.modification),t)},{})}return n=0<n.length?(o=e,e=n,r=u,i=J({},a),Q(e,function(t){i[t.name()]=t.exhibit(o,r)}),e=Un(i,function(t,n){return{name:t,modification:n}}),n=xt(e.classes,function(t,n){return n.modification.concat(t)},[]),a=c(e.attributes),e=c(e.styles),Ti({classes:n,attributes:a,styles:e})):t,J(J({},a=u),{attributes:J(J({},a.attributes),n.attributes),styles:J(J({},a.styles),n.styles),classes:a.classes.concat(n.classes)})}function Qn(t,n,e){var o,r,i={"alloy.base.behaviour":t.events},t=t.eventOrder;return e=e,n=n,i=J(J({},i=i),(o=e,r={},Q(n,function(t){r[t.name()]=t.handlers(o)}),r)),e=Un(i,Wn),Xn(e,t).getOrDie()}function Zn(e,o){function t(t){var n=o(t);return n<=0||null===n?(t=Yi(t,e),parseFloat(t)||0):n}function r(e,t){return wt(t,function(t,n){n=Yi(e,n),n=void 0===n?0:parseInt(n,10);return isNaN(n)?t:t+n},0)}return{set:function(t,n){if(!mt(n)&&!n.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+n);t=t.dom;zi(t)&&(t.style[e]=n+"px")},get:t,getOuter:t,aggregate:r,max:function(t,n,e){t=r(t,e);return t<n?n-t:0}}}function te(e,o){return{left:e,top:o,translate:function(t,n){return te(e+t,o+n)}}}function ne(t,n,e){(e=(void 0!==e?e.dom:document).defaultView)&&e.scrollTo(t,n)}function ee(t){var e=void 0===t?window:t,t=e.document,o=bu(nt.fromDom(t)),t=void 0===e?window:e;return $.from(t.visualViewport).fold(function(){var t=e.document.documentElement,n=t.clientWidth,t=t.clientHeight;return yu(o.left,o.top,n,t)},function(t){return yu(Math.max(t.pageLeft,o.left),Math.max(t.pageTop,o.top),t.width,t.height)})}function oe(e){var t=nt.fromDom(document),o=bu(t),n=(t=wu).owner(e),t=xu(t,n);return $.some(t).fold(M(lu,e),function(t){var n=fu(e),t=xt(t,function(t,n){n=fu(n);return{left:t.left+n.left,top:t.top+n.top}},{left:0,top:0});return cu(t.left+n.left+o.left,t.top+n.top+o.top)})}var re,ie,ue=function(t){return{stype:L.Value,svalue:t}},ae=function(t){return{stype:L.Error,serror:t}},ce=function(t){return Ft(t,Z.error,Z.value)},se=ue,le=function(t){var n=[],e=[];return Q(t,function(t){Ft(t,function(t){return e.push(t)},function(t){return n.push(t)})}),{values:n,errors:e}},fe=ae,de=function(t,n){return t.stype===L.Value?n(t.svalue):t},me=function(t,n){return t.stype===L.Value?{stype:L.Value,svalue:n(t.svalue)}:t},ge=function(t,n){return t.stype===L.Error?{stype:L.Error,serror:n(t.serror)}:t},pe=Object.keys,he=Object.hasOwnProperty,ve=function(t,n){for(var e=pe(t),o=0,r=e.length;o<r;o++){var i=e[o];n(t[i],i)}},be=function(t,e){return ye(t,function(t,n){return{k:n,v:e(t,n)}})},ye=function(t,e){var o={};return ve(t,function(t,n){t=e(t,n);o[t.k]=t.v}),o},xe=function(t,e){var o=[];return ve(t,function(t,n){o.push(e(t,n))}),o},we=function(t){return xe(t,function(t){return t})},B=function(t,n){return Se(t,n)?$.from(t[n]):$.none()},Se=function(t,n){return he.call(t,n)},ke=function(t,n){return Se(t,n)&&void 0!==t[n]&&null!==t[n]},Ce=Object.prototype.hasOwnProperty,Oe=Vt(function(t,n){return w(t)&&w(n)?Oe(t,n):n}),_e=Vt(function(t,n){return n}),Te=function(e){var o,r=!1;return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return r||(r=!0,o=e.apply(null,t)),o}},Ee=Rt([{strict:[]},{defaultedThunk:["fallbackThunk"]},{asOption:[]},{asDefaultedOptionThunk:["fallbackThunk"]},{mergeWithThunk:["baseThunk"]}]),De=Ee.strict,Be=Ee.asOption,Ae=Ee.defaultedThunk,Me=(Ee.asDefaultedOptionThunk,Ee.mergeWithThunk),Fe=(Rt([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),function(t,n){var e={};return e[t]=n,e}),Ie=Fe,Re=function(t){return i(fe,Ct)(t)},Ve=function(t){return w(t)&&100<pe(t).length?" removed due to size":JSON.stringify(t,null,2)},Pe=function(t,n){return fe([{path:t,getErrorInfo:n}])},He=Rt([{field:["key","okey","presence","prop"]},{state:["okey","instantiator"]}]),ze=function(e,o,r){return B(o,r).fold(function(){return t=r,n=o,Pe(e,function(){return'Could not find valid *strict* value for "'+t+'" in '+Ve(n)});var t,n},se)},Ne=function(t,n,e){n=B(t,n).fold(function(){return e(t)},A);return se(n)},Le=function(o){return{extract:function(e,t,n){return n=o(n,t),t=function(t){return n=t,Pe(e,function(){return n});var n},n.stype===L.Error?t(n.serror):n},toString:function(){return"val"}}},je=function(t){var l=m(t),f=xt(t,function(n,t){return t.fold(function(t){return Oe(n,Ie(t,!0))},X(n))},{});return{extract:function(t,n,e){var o,r,i,u,a,c=S(e)?[]:pe((r=function(t){return null!=t},i=c={},u=function(t,n){i[n]=t},a=K,ve(e,function(t,n){(r(t,n)?u:a)(t,n)}),c)),s=yt(c,function(t){return!ke(f,t)});return 0===s.length?l.extract(t,n,e):(o=s,Pe(t,function(){return"There are unsupported fields: ["+o.join(", ")+"] specified"}))},toString:l.toString}},m=function(u){return{extract:function(t,n,e){return o=t,r=e,i=n,t=k(u,function(t){return Nt(o,r,t,i)}),e={},0<(n=le(n=t)).errors.length?Re(n.errors):(e=e,0<(n=n.values).length?se(Oe(e,_e.apply(void 0,n))):se(e));var o,r,i},toString:function(){return"obj{\n"+k(u,function(t){return t.fold(function(t,n,e,o){return t+" -> "+o.toString()},function(t,n){return"state("+t+")"})}).join("\n")+"}"}}},Ue=function(r){return{extract:function(e,o,t){t=k(t,function(t,n){return r.extract(e.concat(["["+n+"]"]),o,t)});return zt(t)},toString:function(){return"array("+r.toString()+")"}}},We=X(Le(se)),Ge=i(Ue,m),Xe=He.state,Ye=He.field,qe=Le(se),Ke=function(n){return Le(function(t){return n(t).fold(fe,se)})},Je=function(t,n,e){return ce((o=A,n=n.extract([t],o,r=e),ge(n,function(t){return{input:r,errors:t}})));var o,r},$e=function(t){return t.fold(function(t){throw new Error(Ze(t))},A)},Qe=function(t,n,e){return $e(Je(t,n,e))},Ze=function(t){return"Errors: \n"+(n=10<(n=t.errors).length?n.slice(0,10).concat([{path:[],getErrorInfo:function(){return"... (only showing first ten failures)"}}]):n,k(n,function(t){return"Failed path: ("+t.path.join(" > ")+")\n"+t.getErrorInfo()}).join("\n"))+"\n\nInput object: "+Ve(t.input);var n},to=jt,no=X(qe),eo=Yt(mt,"number"),oo=Yt(y,"string"),ro=Yt(S,"boolean"),io=Yt(C,"function"),uo=Le(function(t){return qt(t)?se(t):fe("Expected value to be acceptable for sending via postMessage")}),g=function(t){return Ye(t,t,De(),We())},ao=function(t,n){return Ye(t,t,De(),n)},co=function(t,n){return Ye(t,t,De(),m(n))},p=function(t){return Ye(t,t,Be(),We())},so=function(t,n){return Ye(t,t,Be(),n)},lo=function(t,n){return so(t,m(n))},b=function(t,n){return Ye(t,t,Pt(n),We())},fo=function(t,n,e){return Ye(t,t,Pt(n),e)},mo=function(t,n){return Xe(t,n)},tt=function(t){var n=t;return{get:function(){return n},set:function(t){n=t}}},nt={fromHtml:function(t,n){n=(n||document).createElement("div");if(n.innerHTML=t,!n.hasChildNodes()||1<n.childNodes.length)throw console.error("HTML does not have a single root node",t),new Error("HTML must have a single root node");return fn(n.childNodes[0])},fromTag:function(t,n){n=(n||document).createElement(t);return fn(n)},fromText:function(t,n){n=(n||document).createTextNode(t);return fn(n)},fromDom:fn,fromPoint:function(t,n,e){return $.from(t.dom.elementFromPoint(n,e)).map(fn)}},go={nu:mn,detect:function(t,n){var e,o,n=String(n).toLowerCase();return 0===t.length?dn():(o=function(t,n){for(var e=0;e<t.length;e++){var o=t[e];if(o.test(n))return o}}(t=t,e=n))?mn((t=function(t){return Number(e.replace(o,"$"+t))})(1),t(2)):{major:0,minor:0}},unknown:dn},po=function(t,n){var e=String(n).toLowerCase();return St(t,function(t){return t.search(e)})},ho=(re=/^\s+|\s+$/g,function(t){return t.replace(re,"")}),vo=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,vo=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(t){return gn(t,"edge/")&&gn(t,"chrome")&&gn(t,"safari")&&gn(t,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,vo],search:function(t){return gn(t,"chrome")&&!gn(t,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(t){return gn(t,"msie")||gn(t,"trident")}},{name:"Opera",versionRegexes:[vo,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:hn("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:hn("firefox")},{name:"Safari",versionRegexes:[vo,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(t){return(gn(t,"safari")||gn(t,"mobile/"))&&gn(t,"applewebkit")}}],bo=[{name:"Windows",search:hn("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(t){return gn(t,"iphone")||gn(t,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:hn("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:hn("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:hn("linux"),versionRegexes:[]},{name:"Solaris",search:hn("sunos"),versionRegexes:[]},{name:"FreeBSD",search:hn("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:hn("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],yo={browsers:X(vo),oses:X(bo)},xo="Firefox",wo=function(){return vn({current:void 0,version:go.unknown()})},So=vn,ko=(X("Edge"),X("Chrome"),X("IE"),X("Opera"),X(xo),X("Safari"),"Windows"),Co="Android",Oo="Solaris",_o="FreeBSD",To="ChromeOS",Eo=function(){return bn({current:void 0,version:go.unknown()})},Do=bn,Bo=(X(ko),X("iOS"),X(Co),X("Linux"),X("OSX"),X(Oo),X(_o),X(To),Te(function(){return yn(navigator.userAgent,xn)})),Ao=function(){return Bo()},Mo=function(t,n){t=t.dom;if(1!==t.nodeType)return!1;if(void 0!==t.matches)return t.matches(n);if(void 0!==t.msMatchesSelector)return t.msMatchesSelector(n);if(void 0!==t.webkitMatchesSelector)return t.webkitMatchesSelector(n);if(void 0!==t.mozMatchesSelector)return t.mozMatchesSelector(n);throw new Error("Browser lacks native selectors")},Fo=function(t){return 1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType||0===t.childElementCount},Io=function(t,n){return t.dom===n.dom},Ro=function(t,n){return t=t.dom,n=n.dom,e=Node.DOCUMENT_POSITION_CONTAINED_BY,0!=(t.compareDocumentPosition(n)&e);var e},Vo=function(t,n){return Ao().browser.isIE()?Ro(t,n):(t=t.dom)!==(n=n.dom)&&t.contains(n)},Po=function(t){return C(t)?t:d},Ho=function(t,n,e){for(var o=t.dom,r=Po(e);o.parentNode;){var o=o.parentNode,i=nt.fromDom(o),u=n(i);if(u.isSome())return u;if(r(i))break}return $.none()},zo=function(t,n){return Io(t.element,n.event.target)},No=function(t){if(ke(t,"can")||ke(t,"abort")||ke(t,"run"))return Qe("Extracting event.handler",je([b("can",E),b("abort",d),b("run",K)]),t);throw new Error("EventHandler defined by: "+JSON.stringify(t,null,2)+" does not have can, abort, or run!")},vo=X,Lo=vo("touchstart"),jo=vo("touchmove"),Uo=vo("touchend"),Wo=vo("touchcancel"),Go=vo("mousedown"),Xo=vo("mousemove"),Yo=vo("mouseout"),qo=vo("mouseup"),Ko=vo("mouseover"),Jo=vo("focusin"),$o=vo("focusout"),Qo=vo("keydown"),Zo=vo("keyup"),tr=vo("input"),nr=vo("change"),er=vo("click"),or=vo("transitionend"),rr=vo("selectstart"),bo={tap:Sn("tap")},ir=Sn("focus"),ur=Sn("blur.post"),ar=Sn("paste.post"),cr=Sn("receive"),sr=Sn("execute"),lr=Sn("focus.item"),fr=bo.tap,dr=Sn("longpress"),mr=Sn("sandbox.close"),gr=Sn("typeahead.cancel"),pr=Sn("system.init"),hr=Sn("system.touchmove"),vr=Sn("system.touchend"),br=Sn("system.scroll"),yr=Sn("system.resize"),xr=Sn("system.attached"),wr=Sn("system.detached"),Sr=Sn("system.dismissRequested"),vo=Sn("system.repositionRequested"),kr=Sn("focusmanager.shifted"),Cr=Sn("slotcontainer.visibility"),Or=Sn("change.tab"),_r=Sn("dismiss.tab"),Tr=Sn("highlight"),Er=Sn("dehighlight"),Y=function(t,n){Br(t,t.element,n,{})},q=function(t,n,e){Br(t,t.element,n,e)},Dr=function(t){Y(t,sr())},Br=function(t,n,e,o){o=J({target:n},o);t.getSystem().triggerEvent(e,n,o)},Ar=Ht,et=function(t,n){return{key:t,value:No({run:n})}},Mr=function(t,n){return En(t)(n)},Fr=En(xr()),Ir=En(wr()),Rr=En(pr()),Vr=(ie=sr(),function(t){return et(ie,t)}),Pr=("undefined"==typeof window&&Function("return this;")(),function(t){return t.dom.nodeName.toLowerCase()}),Hr=Mn(1),zr=Mn(3),Nr=Mn(9),Lr=Mn(11),jr=function(t){return nt.fromDom(t.dom.ownerDocument)},Ur=function(t){return Nr(t)?t:jr(t)},Wr=function(t){return nt.fromDom(Ur(t).dom.defaultView)},Gr=function(t){return $.from(t.dom.parentNode).map(nt.fromDom)},Xr=Gr,Yr=function(t){return $.from(t.dom.offsetParent).map(nt.fromDom)},qr=function(t){return k(t.dom.childNodes,nt.fromDom)},Kr=function(t){return Lr(t)&&a(t.dom.host)},bo=C(Element.prototype.attachShadow)&&C(Node.prototype.getRootNode),Jr=X(bo),$r=bo?function(t){return nt.fromDom(t.dom.getRootNode())}:Ur,Qr=function(t){return Kr(t)?t:nt.fromDom(Ur(t).dom.body)},Zr=function(t){t=$r(t);return Kr(t)?$.some(t):$.none()},ti=function(n,e){Gr(n).each(function(t){t.dom.insertBefore(e.dom,n.dom)})},ni=function(t,n){t.dom.appendChild(n.dom)},ei=function(n,t){Q(t,function(t){ni(n,t)})},oi=function(t){t.dom.textContent="",Q(qr(t),function(t){ri(t)})},ri=function(t){t=t.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},ii=function(t){return t.dom.innerHTML},ui=function(t,n,e){if(!(y(e)||S(e)||mt(e)))throw console.error("Invalid call to Attribute.set. Key ",n,":: Value ",e,":: Element ",t),new Error("Attribute value was not simple");t.setAttribute(n,e+"")},ot=function(t,n,e){ui(t.dom,n,e)},ai=function(t,n){t=t.dom.getAttribute(n);return null===t?void 0:t},ci=function(t,n){return $.from(ai(t,n))},si=function(t,n){t.dom.removeAttribute(n)},bo=Ar([{key:ir(),value:No({can:function(t,n){var e,n=n.event,o=n.originator,n=n.target,r=n;return!(Io(e=o,t.element)&&!Io(e,r)&&(console.warn(ir()+" did not get interpreted by the desired target. \nOriginator: "+Ln(o)+"\nTarget: "+Ln(n)+"\nCheck the "+ir()+" event handlers"),1))}})}]),li=Object.freeze({__proto__:null,events:bo}),fi=0,_=function(t){var n=(new Date).getTime();return t+"_"+Math.floor(1e9*Math.random())+ ++fi+String(n)},bo=X("alloy-id-"),di=X("data-alloy-id"),mi=bo(),gi=di(),pi=function(t,n){Object.defineProperty(t.dom,gi,{value:n,writable:!0})},hi=function(t){t=Hr(t)?t.dom[gi]:null;return $.from(t)},vi=_,bi=A,yi=function(n){function t(t){return function(){throw new Error("The component must be in a context to send: "+t+(n?"\n"+Ln(n().element)+" is not in context.":""))}}return{debugInfo:X("fake"),triggerEvent:t("triggerEvent"),triggerFocus:t("triggerFocus"),triggerEscape:t("triggerEscape"),build:t("build"),addToWorld:t("addToWorld"),removeFromWorld:t("removeFromWorld"),addToGui:t("addToGui"),removeFromGui:t("removeFromGui"),getByUid:t("getByUid"),getByDom:t("getByDom"),broadcast:t("broadcast"),broadcastOn:t("broadcastOn"),broadcastEvent:t("broadcastEvent"),isConnected:d}},xi=yi(),wi=function(t){return k(t,function(t){return pn(t,"/*")?t.substring(0,t.length-"/*".length):t})},Si=function(t,n){var e=t.toString(),o=e.indexOf(")")+1,r=e.indexOf("("),i=e.substring(r+1,o-1).split(/,\s*/);return t.toFunctionAnnotation=function(){return{name:n,parameters:wi(i)}},t},ki=_("alloy-premade"),Ci=function(t){return Ie(ki,t)},Oi={init:function(){return _i({readState:function(){return"No State required"}})}},_i=function(t){return t},Ti=function(t){return{classes:void 0!==t.classes?t.classes:[],attributes:void 0!==t.attributes?t.attributes:{},styles:void 0!==t.styles?t.styles:{}}},Ei=function(t){return t.cHandler},Di="alloy.base.behaviour",Bi=function(t){return void 0!==t.dom.classList},Ai=function(t,n){return n=n,n=Yn(t=t,"class").concat([n]),ot(t,"class",n.join(" ")),!0},Mi=function(t,n){return e=n,0<(t=yt(Yn(n=t,"class"),function(t){return t!==e})).length?ot(n,"class",t.join(" ")):si(n,"class"),!1;var e},Fi=function(t,n){Bi(t)?t.dom.classList.add(n):Ai(t,n)},Ii=function(t){0===(Bi(t)?t.dom.classList:Yn(t,"class")).length&&si(t,"class")},Ri=function(t,n){Bi(t)?t.dom.classList.remove(n):Mi(t,n),Ii(t)},Vi=function(t,n){return Bi(t)&&t.dom.classList.contains(n)},Pi=function(n,t){Q(t,function(t){Fi(n,t)})},Hi=function(n,t){Q(t,function(t){Ri(n,t)})},zi=function(t){return void 0!==t.style&&C(t.style.getPropertyValue)},Ni=function(t){var n,e,o,r=zr(t)?t.dom.parentNode:t.dom;return null!=r&&null!==r.ownerDocument&&(o=r.ownerDocument,Zr(nt.fromDom(r)).fold(function(){return o.body.contains(r)},(n=Ni,e=Rn,function(t){return n(e(t))})))},Li=function(){return ji(nt.fromDom(document))},ji=function(t){t=t.dom.body;if(null==t)throw new Error("Body is not available yet");return nt.fromDom(t)},Ui=function(t,n,e){if(!y(e))throw console.error("Invalid call to CSS.set. Property ",n,":: Value ",e,":: Element ",t),new Error("CSS value must be a string: "+e);zi(t)&&t.style.setProperty(n,e)},Wi=function(t,n){zi(t)&&t.style.removeProperty(n)},rt=function(t,n,e){t=t.dom;Ui(t,n,e)},Gi=function(t,n){var e=t.dom;ve(n,function(t,n){Ui(e,n,t)})},Xi=function(t,n){var e=t.dom;ve(n,function(t,n){t.fold(function(){Wi(e,n)},function(t){Ui(e,n,t)})})},Yi=function(t,n){var e=t.dom,o=window.getComputedStyle(e).getPropertyValue(n);return""!==o||Ni(t)?o:qi(e,n)},qi=function(t,n){return zi(t)?t.style.getPropertyValue(n):""},Ki=function(t,n){t=t.dom,t=qi(t,n);return $.from(t).filter(function(t){return 0<t.length})},Ji=function(t,n){var e=t.dom;Wi(e,n),ci(t,"style").map(ho).is("")&&si(t,"style")},$i=function(t){return t.dom.offsetWidth},Qi=function(t){return t.dom.value},Zi=function(t){var e,n,o,r,i,u,a,c,s,l,t=bi(t),f=t.events,t=D(t,["events"]),d=(d=B(t,"components").getOr([]),k(d,ou)),t=J(J({},t),{events:J(J({},li),f),components:d});return Z.value((n=function(){return c},o=tt(xi),r=$e((f=e=t,Je("custom.definition",m([Ye("dom","dom",De(),m([g("tag"),b("styles",{}),b("classes",[]),b("attributes",{}),p("value"),p("innerHtml")])),g("components"),g("uid"),b("events",{}),b("apis",{}),Ye("eventOrder","eventOrder",((d={})[sr()]=["disabling",Di,"toggling","typeaheadevents"],d[ir()]=[Di,"focusing","keying"],d[pr()]=[Di,"disabling","toggling","representing"],d[tr()]=[Di,"representing","streaming","invalidating"],d[wr()]=[Di,"representing","item-events","tooltipping"],d[Go()]=["focusing",Di,"item-type-events"],d[Lo()]=["focusing",Di,"item-type-events"],d[Ko()]=["item-type-events","tooltipping"],d[cr()]=["receiving","reflecting","tooltipping"],d=d,Ee.mergeWithThunk(X(d))),no()),p("domModification")]),f))),d=(t=Jn(e)).list,i=t.data,f=$n(r,d,i),t=f,s=nt.fromTag(t.tag),f=t.attributes,l=s.dom,ve(f,function(t,n){ui(l,n,t)}),Pi(s,t.classes),Gi(s,t.styles),t.innerHtml.each(function(t){return zn(s,t)}),f=t.domChildren,ei(s,f),t.value.each(function(t){Kn(s,t)}),t.uid,pi(s,t.uid),u=s,f=Qn(r,d,i),a=tt(r.components),c={getSystem:o.get,config:function(t){var n=i;return(C(n[t.name()])?n[t.name()]:function(){throw new Error("Could not find "+t.name()+" in "+JSON.stringify(e,null,2))})()},hasConfigured:function(t){return C(i[t.name()])},spec:e,readState:function(t){return i[t]().map(function(t){return t.state.readState()}).getOr("not enabled")},getApis:function(){return r.apis},connect:function(t){o.set(t)},disconnect:function(){o.set(yi(n))},element:u,syncComponents:function(){var t=qr(u),t=Ot(t,function(t){return o.get().getByDom(t).fold(function(){return[]},function(t){return[t]})});a.set(t)},components:a.get,events:f}))},tu=function(t){t=nt.fromText(t);return nu({element:t})},nu=function(t){var n=Qe("external.component",je([g("element"),p("uid")]),t),e=tt(yi()),o=(n.uid.each(function(t){pi(n.element,t)}),{getSystem:e.get,config:$.none,hasConfigured:d,connect:function(t){e.set(t)},disconnect:function(){e.set(yi(function(){return o}))},getApis:function(){return{}},element:n.element,spec:t,readState:X("No state"),syncComponents:K,components:X([]),events:{}});return Ci(o)},eu=vi,ou=function(n){return B(n,ki).fold(function(){var t=n.hasOwnProperty("uid")?n:J({uid:eu("")},n);return Zi(t).getOrDie()},function(t){return t})},ru=Ci,iu=Zn("height",function(t){var n=t.dom;return Ni(t)?n.getBoundingClientRect().height:n.offsetHeight}),uu=function(t){return iu.get(t)},au=function(t){return iu.getOuter(t)},cu=te,su=function(t,n){return void 0!==t?t:void 0!==n?n:0},lu=function(t){var n,e,o=t.dom.ownerDocument,r=o.body,i=o.defaultView,o=o.documentElement;return r===t.dom?cu(r.offsetLeft,r.offsetTop):(n=su(null==i?void 0:i.pageYOffset,o.scrollTop),i=su(null==i?void 0:i.pageXOffset,o.scrollLeft),e=su(o.clientTop,r.clientTop),o=su(o.clientLeft,r.clientLeft),fu(t).translate(i-o,n-e))},fu=function(t){var n=t.dom,e=n.ownerDocument.body;return e===n?cu(e.offsetLeft,e.offsetTop):Ni(t)?(e=n.getBoundingClientRect(),cu(e.left,e.top)):cu(0,0)},du=Zn("width",function(t){return t.dom.offsetWidth}),mu=function(t){return du.get(t)},gu=function(t){return du.getOuter(t)},pu=function(t){function n(){return t.stopPropagation()}function e(){return t.preventDefault()}var o=nt.fromDom(function(t){if(Jr()&&a(t.target)){var n=nt.fromDom(t.target);if(Hr(n)&&a(n.dom.shadowRoot)&&t.composed&&t.composedPath){n=t.composedPath();if(n)return H(n)}}return $.from(t.target)}(t).getOr(t.target)),r=i(e,n);return{target:o,x:t.clientX,y:t.clientY,stop:n,prevent:e,kill:r,raw:t}},hu=function(t,n,e,o,r){function i(t){u(t)&&a(pu(t))}var u,a;u=e,a=o;return t.dom.addEventListener(n,i,r),{unbind:M(vu,t,n,i,r)}},vu=function(t,n,e,o){t.dom.removeEventListener(n,e,o)},bu=function(t){var t=void 0!==t?t.dom:document,n=t.body.scrollLeft||t.documentElement.scrollLeft,t=t.body.scrollTop||t.documentElement.scrollTop;return cu(n,t)},yu=function(t,n,e,o){return{x:t,y:n,width:e,height:o,right:t+e,bottom:n+o}},xu=function(e,t){return e.view(t).fold(X([]),function(t){var n=e.owner(t),n=xu(e,n);return[t].concat(n)})},wu=Object.freeze({__proto__:null,view:function(t){return(t.dom===document?$.none():$.from(null==(t=t.dom.defaultView)?void 0:t.frameElement)).map(nt.fromDom)},owner:jr}),Su=function(t,n,e,o){return{x:t,y:n,width:e,height:o,right:t+e,bottom:n+o}},ku=function(t){var n=lu(t),e=gu(t),t=au(t);return Su(n.left,n.top,e,t)},Cu=function(t){var n=oe(t),e=gu(t),t=au(t);return Su(n.left,n.top,e,t)},Ou=function(){return ee(window)};function _u(t,n,e,o,r){return t(e,o)?$.some(e):C(r)&&r(e)?$.none():n(e,o,r)}function Tu(t,n,e){for(var o=t.dom,r=C(e)?e:d;o.parentNode;){var o=o.parentNode,i=nt.fromDom(o);if(n(i))return $.some(i);if(r(i))break}return $.none()}function Eu(){var n=_("aria-owns");return{id:n,link:function(t){ot(t,"aria-owns",n)},unlink:function(t){si(t,"aria-owns")}}}function Du(){return co("markers",[g("backgroundMenu")].concat(ga()).concat(pa()))}function Bu(t){return co("markers",k(t,g))}function Au(t,n,e){var o;return void 0!==(o=new Error).stack&&(o=o.stack.split("\n"),St(o,function(n){return 0<n.indexOf("alloy")&&!ht(fa,function(t){return-1<n.indexOf(t)})}).getOr(sa)),Ye(n,n,e,Ke(function(e){return Z.value(function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.apply(void 0,t)})}))}function t(t){return Au(0,t,Pt(K))}function Mu(t){return Au(0,t,Pt($.none))}function Fu(t){return Au(0,t,De())}function Iu(t){return Au(0,t,De())}function Ru(t,n,e){return ba(Da(t),Fa(t),e.southeast(),xa(),Ea(t,{left:1,top:3}),"layout-se")}function Vu(t,n,e){return ba(Aa(t,n),Fa(t),e.southwest(),wa(),Ea(t,{right:0,top:3}),"layout-sw")}function Pu(t,n,e){return ba(Da(t),Ma(t,n),e.northeast(),Sa(),Ea(t,{left:1,bottom:2}),"layout-ne")}function Hu(t,n,e){return ba(Aa(t,n),Ma(t,n),e.northwest(),ka(),Ea(t,{right:0,bottom:2}),"layout-nw")}function zu(t,n,e){return ba(Ba(t,n),Ma(t,n),e.north(),Oa(),Ea(t,{bottom:2}),"layout-n")}function Nu(t,n,e){return ba(Ba(t,n),Fa(t),e.south(),Ca(),Ea(t,{top:3}),"layout-s")}function Lu(){return[Ru,Vu,Pu,Hu,Nu,zu,Ra,Va]}function ju(){return[Vu,Ru,Hu,Pu,Nu,zu,Ra,Va]}function Uu(e,o,r){return Rr(function(t,n){r(t,e,o)})}function Wu(t){var n,e,o,r,i,u,t=Qe("Creating behaviour: "+t.name,Ga,t);return n=t.fields,e=t.name,o=t.active,r=t.apis,i=t.extra,t=t.state,u=je(n),n=lo(e,[so("config",je(n))]),Wa(u,n,e,o,r,i,t)}function Gu(t){var t=Qe("Creating behaviour: "+t.name,Xa,t),n=Xt(t.branchKey,t.branches),e=t.name,o=t.active,r=t.apis,i=t.extra,t=t.state,u=lo(e,[so("config",n=n)]);return Wa(n,u,e,o,r,i,t)}function Xu(t,n,e,o,r,i){var e=n.x-e,o=n.y-o,r=r-(e+n.width),i=i-(o+n.height),u=$.some(e),a=$.some(o),c=$.some(r),s=$.some(i),l=$.none();return n.direction.fold(function(){return Za(t,u,a,l,l)},function(){return Za(t,l,a,c,l)},function(){return Za(t,u,l,l,s)},function(){return Za(t,l,l,c,s)},function(){return Za(t,u,a,l,l)},function(){return Za(t,u,l,l,s)},function(){return Za(t,u,a,l,l)},function(){return Za(t,l,a,c,l)})}function Yu(t,n){var e=M(oe,n),t=t.fold(e,e,function(){var t=bu();return oe(n).translate(-t.left,-t.top)}),e=gu(n),o=au(n);return Su(t.left,t.top,e,o)}function qu(t,n,e){var o=cu(n,e);return t.fold(X(o),X(o),function(){var t=bu();return o.translate(-t.left,-t.top)})}function Ku(t,n,e){return Math.min(Math.max(t,n),e)}function Ju(t,n){n=Math.floor(n),n=iu.max(t,n,["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"]),rt(t,"max-height",n+"px")}function $u(t,n,e){return void 0===t[n]?e:t[n]}function Qu(t,n,e,o,r,i){var u,a=$u(i,"maxHeightFunction",ac()),i=$u(i,"maxWidthFunction",K),c=t.anchorBox,t=t.origin,r={bounds:(u=t,r.fold(function(){return u.fold(Ou,Ou,Su)},function(e){return u.fold(e,e,function(){var t=e(),n=qu(u,t.x,t.y);return Su(n.left,n.top,t.width,t.height)})})),origin:t,preference:o,maxHeightFunction:a,maxWidthFunction:i};a=ic(c,t=n,e,o=r),uc(t,a,o),i=a.classes,Hi(c=t,i.off),Pi(c,i.on),(0,o.maxHeightFunction)(t,a.maxHeight),(0,o.maxWidthFunction)(t,a.maxWidth)}function Zu(){return lc(0,0,{})}function ta(n,e){return function(t){return"rtl"===fc(t)?e:n}}var na,ea,oa=function(t,n,e){return _u(function(t,n){return n(t)},Tu,t,n,e)},ra=function(t,n,e){return oa(t,n,e).isSome()},ia=function(t,n,e){return Tu(t,function(t){return Mo(t,n)},e)},ua=function(t,n){return n=n,t=void 0===t?document:t.dom,Fo(t)?$.none():$.from(t.querySelector(n)).map(nt.fromDom)},aa=function(t,n,e){return _u(Mo,ia,t,n,e)},ca=function(n,t){return ra(t,function(t){return Io(t,n.element)},d)||(e=n,oa(t,function(t){return!!Hr(t)&&void 0!==(t=ai(t,"id"))&&-1<t.indexOf("aria-owns")}).bind(function(t){var n=ai(t,"id"),t=$r(t);return ua(t,'[aria-owns="'+n+'"]')}).exists(function(t){return ca(e,t)}));var e},sa="unknown",la=(na={STOP:0,0:"STOP",NORMAL:1,1:"NORMAL",LOGGING:2,2:"LOGGING"},tt({})),fa=["alloy/data/Fields","alloy/debugging/Debugging"],da=function(n,t,e){var o,r,i,u;switch(B(la.get(),n).orThunk(function(){var t=pe(la.get());return Mt(t,function(t){return-1<n.indexOf(t)?$.some(la.get()[t]):$.none()})}).getOr(na.NORMAL)){case na.NORMAL:return e(ma());case na.LOGGING:o=n,r=t,i=[],u=(new Date).getTime();var a={logEventCut:function(t,n,e){i.push({outcome:"cut",target:n,purpose:e})},logEventStopped:function(t,n,e){i.push({outcome:"stopped",target:n,purpose:e})},logNoParent:function(t,n,e){i.push({outcome:"no-parent",target:n,purpose:e})},logEventNoHandlers:function(t,n){i.push({outcome:"no-handlers-left",target:n})},logEventResponse:function(t,n,e){i.push({outcome:"response",purpose:e,target:n})},write:function(){var t=(new Date).getTime();pt(["mousemove","mouseover","mouseout",pr()],o)||console.log(o,{event:o,time:t-u,target:r.dom,sequence:k(i,function(t){return pt(["cut","stopped","response"],t.outcome)?"{"+t.purpose+"} "+t.outcome+" at ("+Ln(t.target)+")":t.outcome})})}},c=e(a);return a.write(),c;case na.STOP:return!0}},ma=X({logEventCut:K,logEventStopped:K,logNoParent:K,logEventNoHandlers:K,logEventResponse:K,write:K}),ga=X([g("menu"),g("selectedMenu")]),pa=X([g("item"),g("selectedItem")]),bo=(X(m(pa().concat(ga()))),X(m(pa()))),di=co("initSize",[g("numColumns"),g("numRows")]),ha=function(t,n){return mo(t,X(n))},va=function(t){return mo(t,A)},di=X(di),ba=function(t,n,e,o,r,i){return{x:t,y:n,bubble:e,direction:o,boundsRestriction:r,label:i}},ya=Rt([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),xa=ya.southeast,wa=ya.southwest,Sa=ya.northeast,ka=ya.northwest,Ca=ya.south,Oa=ya.north,_a=ya.east,Ta=ya.west,Ea=function(e,t){for(var n=["left","right","top","bottom"],o={},r=0,i=n.length;r<i;r++){var u=n[r];o[String(u)]=B(t,u).map(function(t){var n=e;switch(t){case 1:return n.x;case 0:return n.x+n.width;case 2:return n.y;case 3:return n.y+n.height}})}return o},Da=function(t){return t.x},Ba=function(t,n){return t.x+t.width/2-n.width/2},Aa=function(t,n){return t.x+t.width-n.width},Ma=function(t,n){return t.y-n.height},Fa=function(t){return t.y+t.height},Ia=function(t,n){return t.y+t.height/2-n.height/2},Ra=function(t,n,e){return ba(t.x+t.width,Ia(t,n),e.east(),_a(),Ea(t,{left:0}),"layout-e")},Va=function(t,n,e){return ba(t.x-n.width,Ia(t,n),e.west(),Ta(),Ea(t,{right:1}),"layout-w")},Pa=function(){return[Pu,Hu,Ru,Vu,zu,Nu]},Ha=function(){return[Hu,Pu,Vu,Ru,zu,Nu]},za=function(){return[Ru,Vu,Pu,Hu,Nu,zu]},Na=function(){return[Vu,Ru,Hu,Pu,Nu,zu]},ya=Object.freeze({__proto__:null,events:function(u){return Ar([et(cr(),function(o,t){var n,r=u.channels,e=pe(r),i=t,t=(n=i).universal?e:yt(e,function(t){return pt(n.channels,t)});Q(t,function(t){var n=r[t],e=n.schema,t=Qe("channel["+t+"] data\nReceiver: "+Ln(o.element),e,i.data);n.onReceive(o,t)})})])}}),La=[ao("channels",Gt(Z.value,je([Fu("onReceive"),b("schema",no())])))],ja=function(r,i,u){var t=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var o=[e].concat(t);return e.config({name:X(r)}).fold(function(){throw new Error("We could not find any behaviour configuration for: "+r+". Using API: "+u)},function(t){var n=Array.prototype.slice.call(o,1);return i.apply(void 0,[e,t.config,t.state].concat(n))})},n=u,e=i.toString(),o=e.indexOf(")")+1,a=e.indexOf("("),c=e.substring(a+1,o-1).split(/,\s*/);return t.toFunctionAnnotation=function(){return{name:n,parameters:wi(c.slice(0,1).concat(c.slice(3)))}},t},Ua=function(t){return{key:t,value:void 0}},Wa=function(e,t,o,r,n,i,u){function a(t){return ke(t,o)?t[o]():$.none()}var n=be(n,function(t,n){return ja(o,t,n)}),i=be(i,Si),c=J(J(J({},i),n),{revoke:M(Ua,o),config:function(t){var n=Qe(o+"-config",e,t);return{key:o,value:{config:n,me:c,configAsRaw:Te(function(){return Qe(o+"-config",e,t)}),initialConfig:t,state:u}}},schema:X(t),exhibit:function(t,e){return a(t).bind(function(n){return B(r,"exhibit").map(function(t){return t(e,n.config,n.state)})}).getOr(Ti({}))},name:X(o),handlers:function(t){return a(t).map(function(t){return B(r,"events").getOr(function(){return{}})(t.config,t.state)}).getOr({})}});return c},it=Ht,Ga=je([g("fields"),g("name"),b("active",{}),b("apis",{}),b("state",Oi),b("extra",{})]),Xa=je([g("branchKey"),g("branches"),g("name"),b("active",{}),b("apis",{}),b("state",Oi),b("extra",{})]),Ya=X(void 0),qa=Wu({fields:La,name:"receiving",active:ya}),La=Object.freeze({__proto__:null,exhibit:function(t,n){return Ti({classes:[],styles:n.useFixed()?{}:{position:"relative"}})}}),Ka=function(t){return t.dom.focus()},Ja=function(t){return void 0===t&&(t=nt.fromDom(document)),$.from(t.dom.activeElement).map(nt.fromDom)},$a=function(n){return Ja($r(n)).filter(function(t){return n.dom.contains(t.dom)})},Qa=function(t,e){var o=$r(e),n=Ja(o).bind(function(n){function t(t){return Io(n,t)}var o,r;return t(e)?$.some(e):(o=t,(r=function(t){for(var n=0;n<t.childNodes.length;n++){var e=nt.fromDom(t.childNodes[n]);if(o(e))return $.some(e);e=r(t.childNodes[n]);if(e.isSome())return e}return $.none()})(e.dom))}),t=t(e);return n.each(function(n){Ja(o).filter(function(t){return Io(t,n)}).fold(function(){Ka(n)},K)}),t},Za=function(t,n,e,o,r){return{position:t,left:n,top:e,right:o,bottom:r}},tc=function(t,n){function e(t){return t+"px"}Xi(t,{position:$.some(n.position),left:n.left.map(e),top:n.top.map(e),right:n.right.map(e),bottom:n.bottom.map(e)})},ya=Rt([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),nc=(ya.none,ya.relative),ec=ya.fixed,oc=function(t,n,e,o){t+=n;return o<t?e:t<e?o:t},rc=Rt([{fit:["reposition"]},{nofit:["reposition","deltaW","deltaH"]}]),ic=function(t,n,e,o){Ji(n,"max-height"),Ji(n,"max-width");var n={width:gu(n=n),height:au(n)},r=o.preference,C=t,O=n,_=e,T=o.bounds,E=O.width,D=O.height,i=function(t,o,r,i){var n,e,u,a,c,s,l,f,d,m,g,p,h,v,b,y,x,w,S,k,t=t(C,O,_);return n=E,e=D,u=T,s=(t=t).x,l=t.y,f=t.bubble.offset,d=f.left,m=f.top,a=t.boundsRestriction,c=f,p=(f=function(n,e){var o="top"===n||"bottom"===n?c.top:c.left;return B(a,n).bind(A).bind(function(t){return"left"===n||"top"===n?e<=t?$.some(t):$.none():t<=e?$.some(t):$.none()}).map(function(t){return t+o}).getOr(e)})("left",(u=u).x),h=f("top",u.y),g=f("right",u.right),f=f("bottom",u.bottom),u=Su(p,h,g-p,f-h),g=u.y,p=u.bottom,f=u.x,h=u.right,l+=m,m=e,u=(e=u).x,b=e.y,k=e.width,v=e.height,S=b<=(w=l),y=(d=u<=(s=s+d))&&S,x=s+(n=n)<=u+k&&w+m<=b+v,d=Math.abs(Math.min(n,d?u+k-s:u-(s+n))),k=Math.abs(Math.min(m,S?b+v-w:b-(w+m))),u=Math.max(e.x,e.right-n),S=Math.max(e.y,e.bottom-m),v={originInBounds:y,sizeInBounds:x,limitX:Ku(s,e.x,u),limitY:Ku(w,e.y,S),deltaW:d,deltaH:k},b=v.originInBounds,n=v.sizeInBounds,m=v.limitX,x=v.deltaW,u=X((y=v.limitY)+(s=v.deltaH)-g),w=X(p-y),e=t.direction.fold(w,w,u,u,w,u,w,w),S=X(m+x-f),d=X(h-m),k={x:m,y:y,width:x,height:s,maxHeight:e,maxWidth:t.direction.fold(d,S,d,S,d,d,d,S),direction:t.direction,classes:{on:t.bubble.classesOn,off:t.bubble.classesOff},label:t.label,candidateYforTest:l},(b&&n?rc.fit(k):rc.nofit(k,x,s)).fold(rc.fit,function(t,n,e){return i<e||r<n?rc.nofit(t,n,e):rc.nofit(o,r,i)})};return wt(r,function(t,n){n=M(i,n);return t.fold(rc.fit,n)},rc.nofit({x:C.x,y:C.y,width:O.width,height:O.height,maxHeight:O.height,maxWidth:O.width,direction:xa(),classes:{on:[],off:[]},label:"none",candidateYforTest:C.y},-1,-1)).fold(A,A)},uc=function(t,n,e){var r;tc(t,(t=e.origin,r=n,t.fold(function(){return Za("absolute",$.some(r.x),$.some(r.y),$.none(),$.none())},function(t,n,e,o){return Xu("absolute",r,t,n,e,o)},function(t,n,e,o){return Xu("fixed",r,t,n,e,o)})))},ac=X(function(t,n){Ju(t,n),Gi(t,{"overflow-x":"hidden","overflow-y":"auto"})}),cc=X(function(t,n){Ju(t,n)}),sc=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right"],lc=function(t,n,e){function r(t){return B(e,t).getOr([])}function o(t,n,e){var o=Et(sc,e);return{offset:cu(t,n),classesOn:Ot(e,r),classesOff:Ot(o,r)}}return{southeast:function(){return o(-t,n,["top","alignLeft"])},southwest:function(){return o(t,n,["top","alignRight"])},south:function(){return o(-t/2,n,["top","alignCentre"])},northeast:function(){return o(-t,-n,["bottom","alignLeft"])},northwest:function(){return o(t,-n,["bottom","alignRight"])},north:function(){return o(-t/2,-n,["bottom","alignCentre"])},east:function(){return o(t,-n/2,["valignCentre","left"])},west:function(){return o(-t,-n/2,["valignCentre","right"])},innerNorthwest:function(){return o(-t,n,["top","alignRight"])},innerNortheast:function(){return o(t,n,["top","alignLeft"])},innerNorth:function(){return o(-t/2,n,["top","alignCentre"])},innerSouthwest:function(){return o(-t,-n,["bottom","alignRight"])},innerSoutheast:function(){return o(t,-n,["bottom","alignLeft"])},innerSouth:function(){return o(-t/2,-n,["bottom","alignCentre"])},innerWest:function(){return o(t,-n/2,["valignCentre","right"])},innerEast:function(){return o(-t,-n/2,["valignCentre","left"])}}},fc=function(t){return"rtl"===Yi(t,"direction")?"rtl":"ltr"};(ea=ea||{}).TopToBottom="toptobottom",ea.BottomToTop="bottomtotop";function dc(t){return ra(t,function(t){return Hr(t)&&ai(t,"data-alloy-vertical-dir")===ea.BottomToTop})}function mc(){return lo("layouts",[g("onLtr"),g("onRtl"),p("onBottomLtr"),p("onBottomRtl")])}function gc(n,t,e,o,r,i,u){var u=u.map(dc).getOr(!1),a=t.layouts.map(function(t){return t.onLtr(n)}),c=t.layouts.map(function(t){return t.onRtl(n)}),r=u?t.layouts.bind(function(t){return t.onBottomLtr.map(function(t){return t(n)})}).or(a).getOr(r):a.getOr(e),a=u?t.layouts.bind(function(t){return t.onBottomRtl.map(function(t){return t(n)})}).or(c).getOr(i):c.getOr(o);return ta(r,a)(n)}function pc(t){return t.fold(A,function(t,n,e){return t.translate(-n,-e)})}function hc(t){return t=k(t,Hs),zs(t)}function vc(t,n,e){var o,r=jr(t.element),r=bu(r),e=(o=t,t=Wr(e.root).dom,$.from(t.frameElement).map(nt.fromDom).filter(function(t){var t=jr(t),n=jr(o.element);return Io(t,n)}).map(lu).getOr(r));return Ls(e,r.left,r.top)}function bc(t,n,e,o){var r=t,i=n,u=e,a=o,e=(t<0&&(r=0,u=e+t),n<0&&(i=0,a=o+n),Ns(cu(r,i)));return $.some({point:e,width:u,height:a})}function yc(t,r,i,u,a){return t.map(function(t){var n=[r,t.point],e=u.fold(function(){return hc(n)},function(){return hc(n)},function(){return t=k(n,pc),zs(t);var t}),e={x:e.left,y:e.top,width:t.width,height:t.height},t=(i.showAbove?Pa:za)(),o=(i.showAbove?Ha:Na)(),t=gc(a,i,t,o,t,o,$.none());return{anchorBox:e,bubble:i.bubble.getOr(Zu()),overrides:i.overrides,layouts:t,placer:$.none()}})}function xc(t,n,e,o){return{start:t,soffset:n,finish:e,foffset:o}}function wc(t){return{left:t.left,top:t.top,right:t.right,bottom:t.bottom,width:t.width,height:t.height}}function Sc(t){var n;return 0<t.rangeCount?(n=t.getRangeAt(0),t=t.getRangeAt(t.rangeCount-1),$.some(xc(nt.fromDom(n.startContainer),n.startOffset,nt.fromDom(t.endContainer),t.endOffset))):$.none()}function kc(t,n){var i,r,e;return t=i=t,r=i,t=(n=n).match({domRange:function(t){return{ltr:X(t),rtl:$.none}},relative:function(t,n){return{ltr:Te(function(){return Gs(r,t,n)}),rtl:Te(function(){return $.some(Gs(r,n,t))})}},exact:function(t,n,e,o){return{ltr:Te(function(){return Xs(r,t,n,e,o)}),rtl:Te(function(){return $.some(Xs(r,e,o,t,n))})}}}),0<(n=0<(n=(t=((e=(n=t).ltr()).collapsed?n.rtl().filter(function(t){return!1===t.collapsed}).map(function(t){return Ys.rtl(nt.fromDom(t.endContainer),t.endOffset,nt.fromDom(t.startContainer),t.startOffset)}).getOrThunk(function(){return qs(0,Ys.ltr,e)}):qs(0,Ys.ltr,e)).match({ltr:function(t,n,e,o){var r=i.document.createRange();return r.setStart(t.dom,n),r.setEnd(e.dom,o),r},rtl:function(t,n,e,o){var r=i.document.createRange();return r.setStart(e.dom,o),r.setEnd(t.dom,n),r}})).getClientRects()).length?n[0]:t.getBoundingClientRect()).width||0<n.height?$.some(n).map(wc):$.none()}function Cc(t,n){return(zr(t)?el:ol)(t,n)}function Oc(t,n){return n.getSelection.getOrThunk(function(){return function(){return $.from(t.getSelection()).filter(function(t){return 0<t.rangeCount}).bind(nl)}})().map(function(t){var n=Cc(t.start,t.soffset),t=Cc(t.finish,t.foffset);return Ws.range(n.element,n.offset,t.element,t.offset)})}function _c(t,n,e){return ba(rl(t),al(t),e.southeast(),xa(),Ea(t,{left:0,top:2}),"link-layout-se")}function Tc(t,n,e){return ba(il(t,n),al(t),e.southwest(),wa(),Ea(t,{right:1,top:2}),"link-layout-sw")}function Ec(t,n,e){return ba(rl(t),ul(t,n),e.northeast(),Sa(),Ea(t,{left:0,bottom:3}),"link-layout-ne")}function Dc(t,n,e){return ba(il(t,n),ul(t,n),e.northwest(),ka(),Ea(t,{right:1,bottom:3}),"link-layout-nw")}function Bc(){return[_c,Tc,Ec,Dc]}function Ac(){return[Tc,_c,Dc,Ec]}function Mc(t,n,e,o,r,i){return i=i.map(ku),Fc(t,n,0,o,r,i)}function Fc(i,u,t,n,a,c){var s=Qe("positioning anchor.info",sl,n);Qa(function(){rt(a.element,"position","fixed");var t=Ki(a.element,"visibility");rt(a.element,"visibility","hidden");var n,e=u.useFixed()?(n=document.documentElement,ec(0,0,n.clientWidth,n.clientHeight)):(o=lu((n=i).element),n=n.element.dom.getBoundingClientRect(),nc(o.left,o.top,n.width,n.height)),o=s.placement,r=c.map(X).or(u.getBounds);o(i,s,e).each(function(t){t.placer.getOr(ll)(i,e,t,r,a)}),t.fold(function(){Ji(a.element,"visibility")},function(t){rt(a.element,"visibility",t)}),Ki(a.element,"left").isNone()&&Ki(a.element,"top").isNone()&&Ki(a.element,"right").isNone()&&Ki(a.element,"bottom").isNone()&&Ki(a.element,"position").is("fixed")&&Ji(a.element,"position")},a.element)}function Ic(t,n){ni(t.element,n.element)}function Rc(n,t){var e=n.components(),o=(Q((o=n).components(),function(t){return ri(t.element)}),oi(o.element),o.syncComponents(),Et(e,t));Q(o,function(t){dl(t),n.getSystem().removeFromWorld(t)}),Q(t,function(t){t.getSystem().isConnected()?Ic(n,t):(n.getSystem().addToWorld(t),Ic(n,t),Ni(n.element)&&ml(t)),n.syncComponents()})}function Vc(t,n,e){t.getSystem().addToWorld(n),e(t.element,n.element),Ni(t.element)&&ml(n),t.syncComponents()}function Pc(t,n){Hc(t,n,ni)}function Hc(t,n,e){e(t,n.element),e=qr(n.element),Q(e,function(t){n.getByDom(t).each(ml)})}function zc(n){var t=qr(n.element);Q(t,function(t){n.getByDom(t).each(dl)}),ri(n.element)}function Nc(n,t,e,o){return e.get().each(function(t){vl(n)}),t=t.getAttachPoint(n),gl(t,n),t=n.getSystem().build(o),gl(n,t),e.set(t),t}function Lc(t,n,e,o){return e=Nc(t,n,e,o),n.onOpen(t,e),e}function jc(n,e,o){o.get().each(function(t){vl(n),hl(n),e.onClose(n,t),o.clear()})}function Uc(t,n,e){return e.isOpen()}function Wc(t,n,e){var o,r,i=n.getAttachPoint(t);rt(t.element,"position",fl.getMode(i)),r=n.cloakVisibilityAttr,Ki((o=t).element,i="visibility").fold(function(){si(o.element,r)},function(t){ot(o.element,r,t)}),rt(o.element,i,"hidden")}function Gc(t,n,e){var o,r,i=t.element;ht(["top","left","right","bottom"],function(t){return Ki(i,t).isSome()})||Ji(t.element,"position"),r="visibility",n=n.cloakVisibilityAttr,ci((o=t).element,n).fold(function(){return Ji(o.element,r)},function(t){return rt(o.element,r,t)})}function Xc(t){var e=Qe("Dismissal",wl,t);return(t={})[bl()]={schema:je([g("target")]),onReceive:function(n,t){!h.isOpen(n)||h.isPartOf(n,t.target)||e.isExtraPart(n,t.target)||e.fireEventInstead.fold(function(){return h.close(n)},function(t){return Y(n,t.event)})}},t}function Yc(t){var e=Qe("Reposition",Sl,t);return(t={})[yl()]={onReceive:function(n){h.isOpen(n)&&e.fireEventInstead.fold(function(){return e.doReposition(n)},function(t){return Y(n,t.event)})}},t}function qc(t,n,e){n.store.manager.onLoad(t,n,e)}function Kc(t,n,e){n.store.manager.onUnload(t,n,e)}function Jc(){var t=tt(null);return _i({set:t.set,get:t.get,isNotSet:function(){return null===t.get()},clear:function(){t.set(null)},readState:function(){return{mode:"memory",value:t.get()}}})}function $c(){var i=tt({}),u=tt({});return _i({readState:function(){return{mode:"dataset",dataByValue:i.get(),dataByText:u.get()}},lookup:function(t){return B(i.get(),t).orThunk(function(){return B(u.get(),t)})},update:function(t){var n=i.get(),e=u.get(),o={},r={};Q(t,function(n){o[n.value]=n,B(n,"meta").each(function(t){B(t,"text").each(function(t){r[t]=n})})}),i.set(J(J({},n),o)),u.set(J(J({},e),r))},clear:function(){i.set({}),u.set({})}})}function Qc(t,n,e,o){var r=n.store;e.update([o]),r.setValue(t,o),n.onSetValue(t,o)}function Zc(o,t){return ln(o,{},k(t,function(t){return n=t.name(),e="Cannot configure "+t.name()+" for "+o,Ye(n,n,Be(),Le(function(t){return fe("The field: "+n+" is forbidden. "+e)}));var n,e}).concat([mo("dump",A)]))}function ts(t){return t.dump}function ns(t,n){return J(J({},t.dump),it(n))}function es(t){return Se(t,"uiType")}function os(t){return t.fold($.some,$.none,$.some,$.some)}function rs(t){function n(t){return t.name}return t.fold(n,n,n,n)}function is(n,e){return function(t){t=Qe("Converting part type",e,t);return n(t)}}function us(t,n,e,o){return Oe(n.defaults(t,e,o),e,{uid:t.partUids[n.name]},n.overrides(t,e,o))}function as(r,t){var i={};return Q(t,function(t){os(t).each(function(e){t=r,n=e.pname;var t,n,o={uiType:Bl(),owner:t,name:n};i[e.name]=function(t){var n=Qe("Part: "+e.name+" in "+r,m(e.schema),t);return J(J({},o),{config:t,validated:n})}})}),i}function cs(t,n,e){return{uiType:Bl(),owner:t,name:n,config:e,validated:{}}}function ss(t){return k(t,rs)}function ls(t,n,e){var o={},r=n.partUids,i=t.getSystem();return Q(e,function(t){o[t]=X(i.getByUid(r[t]))}),o}function fs(t,n){var e=t.getSystem();return be(n.partUids,function(t,n){return X(e.getByUid(t))})}function ds(t){return pe(t.partUids)}function ms(t,n,e){var o={},r=n.partUids,i=t.getSystem();return Q(e,function(t){o[t]=X(i.getByUid(r[t]).getOrDie())}),o}function gs(n,t){return t=ss(t),Ht(k(t,function(t){return{key:t,value:n+"-"+t}}))}function ps(t,n,e,o,r){var r=Gl(r),i=Hl(e),u=Ul(e),n=Wl(t,n,r,i,[u]),i=zl(0,n,e);return o(n,Nl(t,n,i.internals()),r,i.externals())}function hs(t){var n=Qe("Sketcher for "+t.name,Yl,t),t=as(n.name,n.partFields),e=be(n.apis,jn),o=be(n.extraApis,Si);return J(J({name:n.name,partFields:n.partFields,configFields:n.configFields,sketch:function(t){return ps(n.name,n.configFields,n.partFields,n.factory,t)},parts:t},e),o)}function vs(t){return"input"===Pr(t)&&"radio"!==ai(t,"type")||"textarea"===Pr(t)}function bs(e,o,t,r){var n=tl(e.element,"."+o.highlightClass);Q(n,function(n){ht(r,function(t){return t.element===n})||(Ri(n,o.highlightClass),e.getSystem().getByDom(n).each(function(t){o.onDehighlight(e,t),Y(t,Er())}))})}function ys(t,n,e,o){bs(t,n,0,[o]),xs(0,n,0,o)||(Fi(o.element,n.highlightClass),n.onHighlight(t,o),Y(o,Tr()))}function xs(t,n,e,o){return Vi(o.element,n.highlightClass)}function ws(n,t,e){return ua(n.element,"."+t.itemClass).bind(function(t){return n.getSystem().getByDom(t).toOptional()})}function Ss(n,t,e){return(0<(t=tl(n.element,"."+t.itemClass)).length?$.some(t[t.length-1]):$.none()).bind(function(t){return n.getSystem().getByDom(t).toOptional()})}function ks(n,e,t,o){var r=tl(n.element,"."+e.itemClass);return kt(r,function(t){return Vi(t,e.highlightClass)}).bind(function(t){t=oc(t,o,0,r.length-1);return n.getSystem().getByDom(r[t]).toOptional()})}function Cs(n,t,e){return t=tl(n.element,"."+t.itemClass),Kl(k(t,function(t){return n.getSystem().getByDom(t).toOptional()}))}function Os(t,n,e){var o=Tt(t.slice(0,n)),t=Tt(t.slice(n+1));return St(o.concat(t),e)}function _s(t,n,e){return t=Tt(t.slice(0,n)),St(t,e)}function Ts(t,n,e){var o=t.slice(0,n),t=t.slice(n+1);return St(t.concat(o),e)}function Es(t,n,e){return t=t.slice(n+1),St(t,e)}function Ds(t){return function(n){return _t(t,function(t){return t(n)})}}function Bs(t){return!0===t.raw.shiftKey}function As(t){return!0===t.raw.ctrlKey}function u(t,n){return{matches:t,classification:n}}var Ms,Fs,Is,Rs="data-alloy-vertical-dir",ya=[g("hotspot"),p("bubble"),b("overrides",{}),mc(),ha("placement",function(t,n,e){var o=n.hotspot,e=Yu(e,o.element),o=gc(t.element,n,za(),Na(),Pa(),Ha(),$.some(n.hotspot.element));return $.some({anchorBox:e,bubble:n.bubble.getOr(Zu()),overrides:n.overrides,layouts:o,placer:$.none()})})],Vs=[g("x"),g("y"),b("height",0),b("width",0),b("bubble",Zu()),b("overrides",{}),mc(),ha("placement",function(t,n,e){e=qu(e,n.x,n.y),e=Su(e.left,e.top,n.width,n.height),t=gc(t.element,n,Lu(),ju(),Lu(),ju(),$.none());return $.some({anchorBox:e,bubble:n.bubble,overrides:n.overrides,layouts:t,placer:$.none()})})],Ps=Rt([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),Hs=function(t){return t.fold(A,A)},zs=function(t){return wt(t,function(t,n){return t.translate(n.left,n.top)},cu(0,0))},Ns=Ps.screen,Ls=Ps.absolute,Ps=[g("node"),g("root"),p("bubble"),mc(),b("overrides",{}),b("showAbove",!1),ha("placement",function(e,o,r){var i=vc(e,0,o);return o.node.filter(Ni).bind(function(t){var t=t.dom.getBoundingClientRect(),t=bc(t.left,t.top,t.width,t.height),n=o.node.getOr(e.element);return yc(t,i,o,r,n)})})],js=Rt([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Us=(js.before,js.on,js.after,Rt([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}])),Ws={domRange:Us.domRange,relative:Us.relative,exact:Us.exact,exactFromRange:function(t){return Us.exact(t.start,t.soffset,t.finish,t.foffset)},getWin:function(t){t=t.match({domRange:function(t){return nt.fromDom(t.startContainer)},relative:function(t,n){return t.fold(A,A,A)},exact:function(t,n,e,o){return t}});return Wr(t)},range:xc},Gs=function(t,n,e){var o,t=t.document.createRange(),r=t;return n.fold(function(t){r.setStartBefore(t.dom)},function(t,n){r.setStart(t.dom,n)},function(t){r.setStartAfter(t.dom)}),o=t,e.fold(function(t){o.setEndBefore(t.dom)},function(t,n){o.setEnd(t.dom,n)},function(t){o.setEndAfter(t.dom)}),t},Xs=function(t,n,e,o,r){t=t.document.createRange();return t.setStart(n.dom,e),t.setEnd(o.dom,r),t},Ys=Rt([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),qs=function(t,n,e){return n(nt.fromDom(e.startContainer),e.startOffset,nt.fromDom(e.endContainer),e.endOffset)},Ks=(Ys.ltr,Ys.rtl,Ms=zr,{get:function(t){if(Ms(t))return Fs(t).getOr("");throw new Error("Can only get text value of a text node")},getOption:Fs=function(t){return Ms(t)?$.from(t.dom.nodeValue):$.none()},set:function(t,n){if(!Ms(t))throw new Error("Can only set raw text value of a text node");t.dom.nodeValue=n}}),Js=function(t){return Ks.getOption(t)},$s=["img","br"],Qs=function(t){return Js(t).filter(function(t){return 0!==t.trim().length||-1<t.indexOf("")}).isSome()||pt($s,Pr(t))},Zs=function(t,r){function i(t){for(var n=qr(t),e=n.length-1;0<=e;e--){var o=n[e];if(r(o))return $.some(o);o=i(o);if(o.isSome())return o}return $.none()}return i(t)},tl=function(t,n){return n=n,t=void 0===t?document:t.dom,Fo(t)?[]:k(t.querySelectorAll(n),nt.fromDom)},nl=function(t){var n,e,o,r,i,u,a,c,s,l,f;return null!==t.anchorNode&&null!==t.focusNode&&(n=nt.fromDom(t.anchorNode),e=nt.fromDom(t.focusNode),o=n,r=t.anchorOffset,i=e,u=t.focusOffset,f=r,a=i,c=u,(s=jr(l=o).dom.createRange()).setStart(l.dom,f),s.setEnd(a.dom,c),l=s,f=Io(o,i)&&r===u,l.collapsed)&&!f?$.some(xc(n,t.anchorOffset,e,t.focusOffset)):Sc(t)},el=function(t,n){return{element:t,offset:n}},ol=function(t,n){var e=qr(t);return 0===e.length?el(t,n):n<e.length?el(e[n],0):(t=e[e.length-1],n=(zr(t)?Ks.get(t):qr(t)).length,el(t,n))},js=[p("getSelection"),g("root"),p("bubble"),mc(),b("overrides",{}),b("showAbove",!1),ha("placement",function(t,n,e){var o=Wr(n.root).dom,r=vc(t,0,n),i=Oc(o,n).bind(function(t){return kc(o,Ws.exactFromRange(t)).orThunk(function(){var n=nt.fromText("\ufeff");return ti(t.start,n),kc(o,Ws.exact(n,0,n,1)).map(function(t){return ri(n),t})}).bind(function(t){return bc(t.left,t.top,t.width,t.height)})}),t=Oc(o,n).bind(function(t){return Hr(t.start)?$.some(t.start):Xr(t.start)}).getOr(t.element);return yc(i,r,n,e,t)})],rl=function(t){return t.x+t.width},il=function(t,n){return t.x-n.width},ul=function(t,n){return t.y-n.height+t.height},al=function(t){return t.y},cl=[g("item"),mc(),b("overrides",{}),ha("placement",function(t,n,e){e=Yu(e,n.item.element),t=gc(t.element,n,Bc(),Ac(),Bc(),Ac(),$.none());return $.some({anchorBox:e,bubble:Zu(),overrides:n.overrides,layouts:t,placer:$.none()})})],sl=Xt("anchor",{selection:js,node:Ps,hotspot:ya,submenu:cl,makeshift:Vs}),ll=function(t,n,e,o,r){n={anchorBox:e.anchorBox,origin:n};Qu(n,r.element,e.bubble,e.layouts,o,e.overrides)},js=Object.freeze({__proto__:null,position:function(t,n,e,o,r){Mc(t,n,e,o,r,$.none())},positionWithin:Mc,positionWithinBounds:Fc,getMode:function(t,n,e){return n.useFixed()?"fixed":"absolute"}}),Ps=[b("useFixed",d),p("getBounds")],fl=Wu({fields:Ps,name:"positioning",active:La,apis:js}),dl=function(t){Y(t,wr());t=t.components();Q(t,dl)},ml=function(t){var n=t.components();Q(n,ml),Y(t,xr())},gl=function(t,n){Vc(t,n,ni)},pl=function(t){dl(t),ri(t.element),t.getSystem().removeFromWorld(t)},hl=function(n){var t=Gr(n.element).bind(function(t){return n.getSystem().getByDom(t).toOptional()});pl(n),t.each(function(t){t.syncComponents()})},vl=function(t){var n=t.components();Q(n,pl),oi(t.element),t.syncComponents()},ya=Object.freeze({__proto__:null,cloak:Wc,decloak:Gc,open:Lc,openWhileCloaked:function(t,n,e,o,r){Wc(t,n),Lc(t,n,e,o),r(),Gc(t,n)},close:jc,isOpen:Uc,isPartOf:function(n,e,t,o){return Uc(0,0,t)&&t.get().exists(function(t){return e.isPartOf(n,t,o)})},getState:function(t,n,e){return e.get()},setContent:function(t,n,e,o){return e.get().map(function(){return Nc(t,n,e,o)})}}),cl=Object.freeze({__proto__:null,events:function(e,o){return Ar([et(mr(),function(t,n){jc(t,e,o)})])}}),Vs=[t("onOpen"),t("onClose"),g("isPartOf"),g("getAttachPoint"),b("cloakVisibilityAttr","data-precloak-visibility")],h=Wu({fields:Vs,name:"sandboxing",active:cl,apis:ya,state:Object.freeze({__proto__:null,init:function(){var n=tt($.none()),t=X("not-implemented");return _i({readState:t,isOpen:function(){return n.get().isSome()},clear:function(){n.set($.none())},set:function(t){n.set($.some(t))},get:function(){return n.get()}})}})}),bl=X("dismiss.popups"),yl=X("reposition.popups"),xl=X("mouse.released"),wl=je([b("isExtraPart",d),lo("fireEventInstead",[b("event",Sr())])]),Sl=je([lo("fireEventInstead",[b("event",vo())]),$t("doReposition")]),Ps=Object.freeze({__proto__:null,onLoad:qc,onUnload:Kc,setValue:function(t,n,e,o){n.store.manager.setValue(t,n,e,o)},getValue:function(t,n,e){return n.store.manager.getValue(t,n,e)},getState:function(t,n,e){return e}}),La=Object.freeze({__proto__:null,events:function(e,o){var t=e.resetOnDom?[Fr(function(t,n){qc(t,e,o)}),Ir(function(t,n){Kc(t,e,o)})]:[Uu(e,o,qc)];return Ar(t)}}),js=Object.freeze({__proto__:null,memory:Jc,dataset:$c,manual:function(){return _i({readState:K})},init:function(t){return t.store.manager.state(t)}}),Vs=[p("initialValue"),g("getFallbackEntry"),g("getDataKey"),g("setValue"),ha("manager",{setValue:Qc,getValue:function(t,n,e){var o=n.store,r=o.getDataKey(t);return e.lookup(r).fold(function(){return o.getFallbackEntry(r)},function(t){return t})},onLoad:function(n,e,o){e.store.initialValue.each(function(t){Qc(n,e,o,t)})},onUnload:function(t,n,e){e.clear()},state:$c})],cl=[g("getValue"),b("setValue",K),p("initialValue"),ha("manager",{setValue:function(t,n,e,o){n.store.setValue(t,o),n.onSetValue(t,o)},getValue:function(t,n,e){return n.store.getValue(t)},onLoad:function(n,e,t){e.store.initialValue.each(function(t){e.store.setValue(n,t)})},onUnload:K,state:Oi.init})],ya=[p("initialValue"),ha("manager",{setValue:function(t,n,e,o){e.set(o),n.onSetValue(t,o)},getValue:function(t,n,e){return e.get()},onLoad:function(t,n,e){n.store.initialValue.each(function(t){e.isNotSet()&&e.set(t)})},onUnload:function(t,n,e){e.clear()},state:Jc})],ya=[fo("store",{mode:"memory"},Xt("mode",{memory:ya,manual:cl,dataset:Vs})),t("onSetValue"),b("resetOnDom",!1)],ut=Wu({fields:ya,name:"representing",active:La,apis:Ps,extra:{setValueFrom:function(t,n){n=ut.getValue(n);ut.setValue(t,n)}},state:js}),kl=Zc,Cl=ns,Ol="placeholder",_l=Rt([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),Tl=function(o,r,i,u){return t=o,e=u,(es(n=i)&&n.uiType===Ol?(c=n,s=e,(a=t).exists(function(t){return t!==c.owner})?_l.single(!0,X(c)):B(s,c.name).fold(function(){throw new Error("Unknown placeholder component: "+c.name+"\nKnown: ["+pe(s)+"]\nNamespace: "+a.getOr("none")+"\nSpec: "+JSON.stringify(c,null,2))},function(t){return t.replace()})):_l.single(!1,X(n))).fold(function(t,n){var n=es(i)?n(r,i.config,i.validated):n(r),e=B(n,"components").getOr([]),e=Ot(e,function(t){return Tl(o,r,t,u)});return[J(J({},n),{components:e})]},function(t,n){var e;return es(i)?(e=n(r,i.config,i.validated),i.validated.preprocess.getOr(A)(e)):n(r)});var t,n,e,a,c,s},El=_l.single,Dl=_l.multiple,Bl=X(Ol),cl=Rt([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),Vs=b("factory",{sketch:A}),ya=b("schema",[]),La=g("name"),Ps=Ye("pname","pname",Ae(function(t){return"<alloy."+_(t.name)+">"}),no()),js=mo("schema",function(){return[p("preprocess")]}),Al=b("defaults",X({})),Ml=b("overrides",X({})),Fl=m([Vs,ya,La,Ps,Al,Ml]),Il=m([Vs,ya,La,Al,Ml]),ya=m([Vs,ya,La,Ps,Al,Ml]),Vs=m([Vs,js,La,g("unit"),Ps,Al,Ml]),Rl=is(cl.required,Fl),js=is(cl.external,Il),Vl=is(cl.optional,ya),La=is(cl.group,Vs),Pl=X("entirety"),Ps=Object.freeze({__proto__:null,required:Rl,external:js,optional:Vl,group:La,asNamedPart:os,name:rs,asCommon:function(t){return t.fold(A,A,A,A)},original:Pl}),Hl=function(t){return Ot(t,function(t){return t.fold($.none,$.some,$.none,$.none).map(function(t){return co(t.name,t.schema.concat([va(Pl())]))}).toArray()})},zl=function(t,n,e){return o=n,i={},r={},Q(e,function(t){t.fold(function(o){i[o.pname]=El(!0,function(t,n,e){return o.factory.sketch(us(t,o,n,e))})},function(t){var n=o.parts[t.name];r[t.name]=X(t.factory.sketch(us(o,t,n[Pl()]),n))},function(o){i[o.pname]=El(!1,function(t,n,e){return o.factory.sketch(us(t,o,n,e))})},function(r){i[r.pname]=Dl(!0,function(n,t,e){var o=n[r.name];return k(o,function(t){return r.factory.sketch(Oe(r.defaults(n,t,e),t,r.overrides(n,t)))})})})}),{internals:X(i),externals:X(r)};var o,i,r},Nl=function(t,n,e){return o=$.some(t),t=(r=n).components,n=be(n=e,function(t,n){return o=t,r=!1,{name:X(e=n),required:function(){return o.fold(function(t,n){return t},function(t,n){return t})},used:function(){return r},replace:function(){if(r)throw new Error("Trying to use the same placeholder more than once: "+e);return r=!0,o}};var e,o,r}),i=o,u=r,a=n,t=Ot(t,function(t){return Tl(i,u,t,a)}),ve(n,function(t){if(!1===t.used()&&t.required())throw new Error("Placeholder: "+t.name()+" was not found in components list\nNamespace: "+o.getOr("none")+"\nComponents: "+JSON.stringify(r.components,null,2))}),t;var o,r,i,u,a},Ll=function(t,n,e){n=n.partUids[e];return t.getSystem().getByUid(n).toOptional()},jl=function(t,n,e){return Ll(t,n,e).getOrDie("Could not find part: "+e)},Ul=function(n){return Ye("partUids","partUids",Me(function(t){return gs(t.uid,n)}),no())},Al=Object.freeze({__proto__:null,generate:as,generateOne:cs,schemas:Hl,names:ss,substitutes:zl,components:Nl,defaultUids:gs,defaultUidsSchema:Ul,getAllParts:fs,getAllPartNames:ds,getPart:Ll,getPartOrDie:jl,getParts:ls,getPartsOrDie:ms}),Wl=function(t,n,e,o,r){r=r;o=(0<o.length?[co("parts",o)]:[]).concat([g("uid"),b("dom",{}),b("components",[]),va("originalSpec"),b("debug.sketcher",{})]).concat(r);return Qe(t+" [SpecSchema]",je(o.concat(n)),e)},Gl=function(t){return Se(t,"uid")?t:J(J({},t),{uid:vi("uid")})},Xl=je([g("name"),g("factory"),g("configFields"),b("apis",{}),b("extraApis",{})]),Yl=je([g("name"),g("factory"),g("configFields"),g("partFields"),b("apis",{}),b("extraApis",{})]),ql=function(t){var r=Qe("Sketcher for "+t.name,Xl,t),t=be(r.apis,jn),n=be(r.extraApis,Si);return J(J({name:r.name,configFields:r.configFields,sketch:function(t){return n=r.name,e=r.configFields,o=r.factory,t=Gl(t),o(Wl(n,e,t,[],[]),t);var n,e,o}},t),n)},Kl=function(t){for(var n=[],e=function(t){n.push(t)},o=0;o<t.length;o++)t[o].each(e);return n},Jl=function(t,n){return t?$.some(n):$.none()},Ml=Object.freeze({__proto__:null,getCurrent:function(t,n,e){return n.find(t)}}),Fl=[g("find")],T=Wu({fields:Fl,name:"composing",apis:Ml}),Il=Object.freeze({__proto__:null,dehighlightAll:function(t,n,e){return bs(t,n,0,[])},dehighlight:function(t,n,e,o){xs(0,n,0,o)&&(Ri(o.element,n.highlightClass),n.onDehighlight(t,o),Y(o,Er()))},highlight:ys,highlightFirst:function(n,e,o){ws(n,e).each(function(t){ys(n,e,o,t)})},highlightLast:function(n,e,o){Ss(n,e).each(function(t){ys(n,e,o,t)})},highlightAt:function(n,e,o,t){!function(t,n,e){n=tl(t.element,"."+n.itemClass);return $.from(n[e]).fold(function(){return Z.error(new Error("No element found with index "+e))},t.getSystem().getByDom)}(n,e,t).fold(function(t){throw t},function(t){ys(n,e,o,t)})},highlightBy:function(n,e,o,t){var r=Cs(n,e);St(r,t).each(function(t){ys(n,e,o,t)})},isHighlighted:xs,getHighlighted:function(n,t,e){return ua(n.element,"."+t.highlightClass).bind(function(t){return n.getSystem().getByDom(t).toOptional()})},getFirst:ws,getLast:Ss,getPrevious:function(t,n,e){return ks(t,n,0,-1)},getNext:function(t,n,e){return ks(t,n,0,1)},getCandidates:Cs}),ya=[g("highlightClass"),g("itemClass"),t("onHighlight"),t("onDehighlight")],$l=Wu({fields:ya,name:"highlighting",apis:Il}),Ql=[8],Zl=[9],tf=[13],nf=[27],ef=[32],of=[37],rf=[38],uf=[39],af=[40],s=function(n){return function(t){t=t.raw;return pt(n,t.which)}},cf=O(Bs),sf=function(t,n,e){n.exists(function(n){return e.exists(function(t){return Io(t,n)})})||q(t,kr(),{prevFocus:n,newFocus:e})},lf=function(){function o(t){return $a(t.element)}return{get:o,set:function(t,n){var e=o(t),n=(t.getSystem().triggerFocus(n,t.element),o(t));sf(t,e,n)}}},ff=function(){function o(t){return $l.getHighlighted(t).map(function(t){return t.element})}return{get:o,set:function(n,t){var e=o(n),t=(n.getSystem().getByDom(t).fold(K,function(t){$l.highlight(n,t)}),o(n));sf(n,e,t)}}};(cl=Is=Is||{}).OnFocusMode="onFocus",cl.OnEnterOrSpaceMode="onEnterOrSpace",cl.OnApiMode="onApi";function df(t,n,e,o,a){function c(n,e,t,o,r){var t=t(n,e,o,r),i=e.event;return St(t,function(t){return t.matches(i)}).map(function(t){return t.classification}).bind(function(t){return t(n,e,o,r)})}var r={schema:function(){return t.concat([b("focusManager",lf()),fo("focusInside","onFocus",Ke(function(t){return pt(["onFocus","onEnterOrSpace","onApi"],t)?Z.value(t):Z.error("Invalid value for focusInside")})),ha("handler",r),ha("state",n),ha("sendFocusIn",a)])},processKey:c,toEvents:function(i,u){var t=i.focusInside!==Is.OnFocusMode?$.none():a(i).map(function(e){return et(ir(),function(t,n){e(t,i,u),n.stop()})}),n=[et(Qo(),function(o,r){c(o,r,e,i,u).fold(function(){var n=o,e=r,t=s(ef.concat(tf))(e.event);i.focusInside===Is.OnEnterOrSpaceMode&&t&&zo(n,e)&&a(i).each(function(t){t(n,i,u),e.stop()})},function(t){r.stop()})}),et(Zo(),function(t,n){c(t,n,o,i,u).each(function(t){n.stop()})})];return Ar(t.toArray().concat(n))}};return r}function mf(t){function n(n,e,t){var o=e,r=tl(n.element,o.selector),r=yt(r,function(t){return a(o,t)});$.from(r[o.firstTabstop]).each(function(t){e.focusManager.set(n,t)})}function r(o,t,r,i){var n,u=tl(o.element,r.selector);return(n=r).focusManager.get(o).bind(function(t){return aa(t,n.selector)}).bind(function(t){return kt(u,M(Io,t)).bind(function(t){return n=o,e=r,i(u,t,function(t){return a(n=e,t=t)&&n.useTabstopAt(t);var n}).fold(function(){return e.cyclic?$.some(!0):$.none()},function(t){return e.focusManager.set(n,t),$.some(!0)});var n,e})})}var t=[p("onEscape"),p("onEnter"),b("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),b("firstTabstop",0),b("useTabstopAt",E),p("visibilitySelector")].concat([t]),a=function(t,n){t=t.visibilitySelector.bind(function(t){return aa(n,t)}).getOr(n);return 0<uu(t)},e=X([u(Ds([Bs,s(Zl)]),function(t,n,e){var o=e.cyclic?Os:_s;return r(t,0,e,o)}),u(s(Zl),function(t,n,e){var o=e.cyclic?Ts:Es;return r(t,0,e,o)}),u(s(nf),function(n,e,t){return t.onEscape.bind(function(t){return t(n,e)})}),u(Ds([cf,s(tf)]),function(n,e,t){return t.onEnter.bind(function(t){return t(n,e)})})]),o=X([]);return df(t,Oi.init,e,o,function(){return $.some(n)})}function gf(t,n,e){return vs(e)&&s(ef)(n.event)?$.none():(kn(t,e,sr()),$.some(!0))}function pf(t,n){return $.some(!0)}function hf(t,n,e){return e.execute(t,n,t.element)}function vf(){var e=tt($.none());return _i({readState:function(){return e.get().map(function(t){return{numRows:String(t.numRows),numColumns:String(t.numColumns)}}).getOr({numRows:"?",numColumns:"?"})},setGridSize:function(t,n){e.set($.some({numRows:t,numColumns:n}))},getNumRows:function(){return e.get().map(function(t){return t.numRows})},getNumColumns:function(){return e.get().map(function(t){return t.numColumns})}})}function bf(i){return function(t,n,e,o){var r=i(t.element);return yd(r,t,n,e,o)}}function yf(t,n){return t=ta(t,n),bf(t)}function xf(t,n){return n=ta(n,t),bf(n)}function wf(r){return function(t,n,e,o){return yd(r,t,n,e,o)}}function Sf(t,n){return kt(t,function(t){return Io(n,t)})}function kf(n,t,e,o){return o(Math.floor(t/e),t%e).bind(function(t){t=t.row*e+t.column;return 0<=t&&t<n.length?$.some(n[t]):$.none()})}function Cf(o,t,r,i,u){return kf(o,t,i,function(t,n){var e=t===r-1?o.length-t*i:i,n=oc(n,u,0,e-1);return $.some({row:t,column:n})})}function Of(o,t,r,i,u){return kf(o,t,i,function(t,n){var t=oc(t,u,0,r-1),e=t===r-1?o.length-t*i:i,n=Ku(n,0,e-1);return $.some({row:t,column:n})})}function _f(n,e,t){ua(n.element,e.selector).each(function(t){e.focusManager.set(n,t)})}function Tf(r){return function(t,n,e,o){return Sd(t,n,e.selector).bind(function(t){return r(t.candidates,t.index,o.getNumRows().getOr(e.initSize.numRows),o.getNumColumns().getOr(e.initSize.numColumns))})}}function Ef(t,n,e){return e.captureTab?$.some(!0):$.none()}function Df(t,n,e,r){function i(t,n,e){var o;return(n=oc(n,r,0,e.length-1))===t?$.none():(o=e[n],"button"===Pr(o)&&"disabled"===ai(o,"disabled")?i(t,n,e):$.from(e[n]))}return Sd(t,e,n).bind(function(t){var n=t.index,t=t.candidates;return i(n,n,t)})}function Bf(n,e,o){return(r=o).focusManager.get(n).bind(function(t){return aa(t,r.selector)}).bind(function(t){return o.execute(n,e,t)});var r}function Af(n,e,t){e.getInitial(n).orThunk(function(){return ua(n.element,e.selector)}).each(function(t){e.focusManager.set(n,t)})}function Mf(t,n,e){return Df(t,e.selector,n,-1)}function Ff(t,n,e){return Df(t,e.selector,n,1)}function If(r){return function(t,n,e,o){return r(t,n,e,o).bind(function(){return e.executeOnMove?Bf(t,n,e):$.some(!0)})}}function Rf(t,n,e){return e.onEscape(t,n)}function Vf(t,n,e){return $.from(t[n]).bind(function(t){return $.from(t[e]).map(function(t){return{rowIndex:n,columnIndex:e,cell:t}})})}function Pf(t,n,e,o){var r=t[n].length,e=oc(e,o,0,r-1);return Vf(t,n,e)}function Hf(t,n,e,o){return e=oc(e,o,0,t.length-1),o=t[e].length,n=Ku(n,0,o-1),Vf(t,e,n)}function zf(t,n,e,o){var r=t[n].length,e=Ku(e+o,0,r-1);return Vf(t,n,e)}function Nf(t,n,e,o){return e=Ku(e+o,0,t.length-1),o=t[e].length,n=Ku(n,0,o-1),Vf(t,e,n)}function Lf(n,e,t){e.previousSelector(n).orThunk(function(){var t=e.selectors;return ua(n.element,t.cell)}).each(function(t){e.focusManager.set(n,t)})}function jf(t,n){return function(e,o,i){var u=i.cycles?t:n;return aa(o,i.selectors.row).bind(function(t){var n=tl(t,i.selectors.cell);return Sf(n,o).bind(function(o){var r=tl(e,i.selectors.row);return Sf(r,t).bind(function(t){n=i;var n,e=k(r,function(t){return tl(t,n.selectors.cell)});return u(e,t,o).map(function(t){return t.cell})})})})}}function Uf(n,e,o){return o.focusManager.get(n).bind(function(t){return o.execute(n,e,t)})}function Wf(n,e,t){ua(n.element,e.selector).each(function(t){e.focusManager.set(n,t)})}function Gf(t,n,e){return Df(t,e.selector,n,-1)}function Xf(t,n,e){return Df(t,e.selector,n,1)}function Yf(t,n,e,o){o=t.getSystem().build(o),Vc(t,o,e)}function qf(t,n,e,o){t=Kf(t),St(t,function(t){return Io(o.element,t.element)}).each(hl)}function Kf(t,n){return t.components()}function Jf(n,t,e,r,o){var i=Kf(n);return $.from(i[r]).map(function(t){return qf(n,0,0,t),o.each(function(t){Yf(n,0,function(t,n){var e,o=n;In(e=t,r).fold(function(){ni(e,o)},function(t){ti(t,o)})},t)}),t})}function $f(t,n){n.ignore||(Ka(t.element),n.onFocus(t))}function Qf(t,n,e){(n=n.aria).update(t,n,e.get())}function Zf(n,t,e){t.toggleClass.each(function(t){(e.get()?Fi:Ri)(n.element,t)})}function td(t,n,e){nd(t,n,e,!e.get())}function nd(t,n,e,o){(o?Bd:Ad)(t,n,e)}function ed(t,n,e){nd(t,n,e,n.selected)}function od(t,n,e){ot(t.element,"aria-expanded",e)}function rd(){function t(t,n){n.stop(),Dr(t)}return[et(er(),t),et(fr(),t),An(Lo()),An(Go())]}function id(t){return Ar(Ct([t.map(function(e){return Vr(function(t,n){e(t),n.stop()})}).toArray(),rd()]))}function ud(t){($a(t.element).isNone()||lt.isFocused(t))&&(lt.isFocused(t)||lt.focus(t),q(t,Md,{item:t}))}function ad(t){q(t,Fd,{item:t})}function cd(t){return"prepared"===t.type?$.some(t.menu):$.none()}function sd(t,n){return t.x+t.width/2-n.width/2}function ld(t,n){return t.x+t.width-n.width}function fd(t,n){return t.y+t.height-n.height}function dd(t,n,e){return ba(ld(t,n),fd(t,n),e.innerSoutheast(),ka(),Ea(t,{right:0,bottom:3}),"layout-inner-se")}function md(t,n,e){return ba(t.x,fd(t,n),e.innerSouthwest(),Sa(),Ea(t,{left:1,bottom:3}),"layout-inner-sw")}function gd(t,n,e){return ba(ld(t,n),t.y,e.innerNortheast(),wa(),Ea(t,{right:0,top:2}),"layout-inner-ne")}function pd(t,n,e){return ba(t.x,t.y,e.innerNorthwest(),xa(),Ea(t,{left:1,top:2}),"layout-inner-nw")}function hd(t,n,e){return ba(sd(t,n),t.y,e.innerNorth(),Ca(),Ea(t,{top:2}),"layout-inner-n")}function vd(t,n,e){return ba(sd(t,n),fd(t,n),e.innerSouth(),Oa(),Ea(t,{bottom:3}),"layout-inner-s")}function bd(t){return $.from(t()["temporary-placeholder"]).getOr("!not found!")}var Vs=mf(mo("cyclic",d)),Fl=mf(mo("cyclic",E)),Ml=[b("execute",gf),b("useSpace",!1),b("useEnter",!0),b("useControlEnter",!1),b("useDown",!1)],ya=df(Ml,Oi.init,function(t,n,e,o){var t=e.useSpace&&!vs(t.element)?ef:[],r=e.useEnter?tf:[],i=e.useDown?af:[],t=t.concat(r).concat(i);return[u(s(t),hf)].concat(e.useControlEnter?[u(Ds([As,s(tf)]),hf)]:[])},function(t,n,e,o){return e.useSpace&&!vs(t.element)?[u(s(ef),pf)]:[]},function(){return $.none()}),Il=Object.freeze({__proto__:null,flatgrid:vf,init:function(t){return t.state(t)}}),yd=function(n,e,t,o,r){return o.focusManager.get(e).bind(function(t){return n(e.element,t,o,r)}).map(function(t){return o.focusManager.set(e,t),!0})},cl=wf,Ml=wf,xd=wf,wd=function(t){return!((t=t.dom).offsetWidth<=0&&t.offsetHeight<=0)},Sd=function(t,n,e){var o,t=tl(t,e),e=yt(t,wd);return kt(o=e,function(t){return Io(t,n)}).map(function(t){return{index:t,candidates:o}})},kd=[g("selector"),b("execute",gf),Mu("onEscape"),b("captureTab",!1),di()],Cd=Tf(function(t,n,e,o){return Cf(t,n,e,o,-1)}),Od=Tf(function(t,n,e,o){return Cf(t,n,e,o,1)}),_d=Tf(function(t,n,e,o){return Of(t,n,e,o,-1)}),Td=Tf(function(t,n,e,o){return Of(t,n,e,o,1)}),Cd=X([u(s(of),yf(Cd,Od)),u(s(uf),xf(Cd,Od)),u(s(rf),cl(_d)),u(s(af),Ml(Td)),u(Ds([Bs,s(Zl)]),Ef),u(Ds([cf,s(Zl)]),Ef),u(s(nf),function(t,n,e){return e.onEscape(t,n)}),u(s(ef.concat(tf)),function(n,e,o,t){return(r=o).focusManager.get(n).bind(function(t){return aa(t,r.selector)}).bind(function(t){return o.execute(n,e,t)});var r})]),Od=X([u(s(ef),pf)]),_d=df(kd,vf,Cd,Od,function(){return $.some(_f)}),Td=[g("selector"),b("getInitial",$.none),b("execute",gf),Mu("onEscape"),b("executeOnMove",!1),b("allowVertical",!0)],kd=X([u(s(ef),pf)]),Cd=df(Td,Oi.init,function(t,n,e,o){var r=of.concat(e.allowVertical?rf:[]),e=uf.concat(e.allowVertical?af:[]);return[u(s(r),If(yf(Mf,Ff))),u(s(e),If(xf(Mf,Ff))),u(s(tf),Bf),u(s(ef),Bf),u(s(nf),Rf)]},kd,function(){return $.some(Af)}),Od=[co("selectors",[g("row"),g("cell")]),b("cycles",!0),b("previousSelector",$.none),b("execute",gf)],Td=jf(function(t,n,e){return Pf(t,n,e,-1)},function(t,n,e){return zf(t,n,e,-1)}),kd=jf(function(t,n,e){return Pf(t,n,e,1)},function(t,n,e){return zf(t,n,e,1)}),Ed=jf(function(t,n,e){return Hf(t,e,n,-1)},function(t,n,e){return Nf(t,e,n,-1)}),Dd=jf(function(t,n,e){return Hf(t,e,n,1)},function(t,n,e){return Nf(t,e,n,1)}),Td=X([u(s(of),yf(Td,kd)),u(s(uf),xf(Td,kd)),u(s(rf),cl(Ed)),u(s(af),Ml(Dd)),u(s(ef.concat(tf)),function(n,e,o){return $a(n.element).bind(function(t){return o.execute(n,e,t)})})]),kd=X([u(s(ef),pf)]),cl=df(Od,Oi.init,Td,kd,function(){return $.some(Lf)}),Ed=[g("selector"),b("execute",gf),b("moveOnTab",!1)],Ml=X([u(s(rf),xd(Gf)),u(s(af),xd(Xf)),u(Ds([Bs,s(Zl)]),function(t,n,e,o){return e.moveOnTab?xd(Gf)(t,n,e,o):$.none()}),u(Ds([cf,s(Zl)]),function(t,n,e,o){return e.moveOnTab?xd(Xf)(t,n,e,o):$.none()}),u(s(tf),Uf),u(s(ef),Uf)]),Dd=X([u(s(ef),pf)]),Od=df(Ed,Oi.init,Ml,Dd,function(){return $.some(Wf)}),Td=[Mu("onSpace"),Mu("onEnter"),Mu("onShiftEnter"),Mu("onLeft"),Mu("onRight"),Mu("onTab"),Mu("onShiftTab"),Mu("onUp"),Mu("onDown"),Mu("onEscape"),b("stopSpaceKeyup",!1),p("focusIn")],kd=df(Td,Oi.init,function(t,n,e){return[u(s(ef),e.onSpace),u(Ds([cf,s(tf)]),e.onEnter),u(Ds([Bs,s(tf)]),e.onShiftEnter),u(Ds([Bs,s(Zl)]),e.onShiftTab),u(Ds([cf,s(Zl)]),e.onTab),u(s(rf),e.onUp),u(s(af),e.onDown),u(s(of),e.onLeft),u(s(uf),e.onRight),u(s(ef),e.onSpace),u(s(nf),e.onEscape)]},function(t,n,e){return e.stopSpaceKeyup?[u(s(ef),pf)]:[]},function(t){return t.focusIn}),Ed=Vs.schema(),Ml=Fl.schema(),Dd=Cd.schema(),Td=_d.schema(),Vs=cl.schema(),Fl=ya.schema(),Cd=Od.schema(),_d=kd.schema(),at=Gu({branchKey:"mode",branches:Object.freeze({__proto__:null,acyclic:Ed,cyclic:Ml,flow:Dd,flatgrid:Td,matrix:Vs,execution:Fl,menu:Cd,special:_d}),name:"keying",active:{events:function(t,n){return t.handler.toEvents(t,n)}},apis:{focusIn:function(n,e,o){e.sendFocusIn(e).fold(function(){n.getSystem().triggerFocus(n.element,n.element)},function(t){t(n,e,o)})},setGridSize:function(t,n,e,o,r){ke(e,"setGridSize")?e.setGridSize(o,r):console.error("Layout does not support setGridSize")}},state:Il}),ct=Wu({fields:[],name:"replacing",apis:Object.freeze({__proto__:null,append:function(t,n,e,o){Yf(t,0,ni,o)},prepend:function(t,n,e,o){Yf(t,0,Pn,o)},remove:qf,replaceAt:Jf,replaceBy:function(n,t,e,o,r){var i=Kf(n);return kt(i,o).bind(function(t){return Jf(n,0,0,t,r)})},set:function(n,t,e,o){Qa(function(){var t=k(o,n.getSystem().build);Rc(n,t)},n.element)},contents:Kf})}),st=function(t,n){return{key:t,value:{config:{},me:(t=t,n=Ar(n),Wu({fields:[g("enabled")],name:t,active:{events:X(n)}})),configAsRaw:X({}),initialConfig:{},state:Oi}}},cl=Object.freeze({__proto__:null,focus:$f,blur:function(t,n){n.ignore||t.element.dom.blur()},isFocused:function(t){return t=t.element,n=$r(t).dom,t.dom===n.activeElement;var n}}),ya=Object.freeze({__proto__:null,exhibit:function(t,n){n=n.ignore?{}:{attributes:{tabindex:"-1"}};return Ti(n)},events:function(e){return Ar([et(ir(),function(t,n){$f(t,e),n.stop()})].concat(e.stopMousedown?[et(Go(),function(t,n){n.event.prevent()})]:[]))}}),Od=[t("onFocus"),b("stopMousedown",!1),b("ignore",!1)],lt=Wu({fields:Od,name:"focusing",active:ya,apis:cl}),Bd=function(t,n,e){e.set(!0),Zf(t,n,e),Qf(t,n,e)},Ad=function(t,n,e){e.set(!1),Zf(t,n,e),Qf(t,n,e)},kd=Object.freeze({__proto__:null,onLoad:ed,toggle:td,isOn:function(t,n,e){return e.get()},on:Bd,off:Ad,set:nd}),Ed=Object.freeze({__proto__:null,exhibit:function(){return Ti({})},events:function(t,n){e=t,o=n,r=td;var e,o,r,i=Vr(function(t){r(t,e,o)}),n=Uu(t,n,ed);return Ar(Ct([t.toggleOnExecute?[i]:[],[n]]))}}),Ml=[b("selected",!1),p("toggleClass"),b("toggleOnExecute",!0),fo("aria",{mode:"none"},Xt("mode",{pressed:[b("syncWithExpanded",!1),ha("update",function(t,n,e){ot(t.element,"aria-pressed",e),n.syncWithExpanded&&od(t,0,e)})],checked:[ha("update",function(t,n,e){ot(t.element,"aria-checked",e)})],expanded:[ha("update",od)],selected:[ha("update",function(t,n,e){ot(t.element,"aria-selected",e)})],none:[ha("update",K)]}))],v=Wu({fields:Ml,name:"toggling",active:Ed,apis:kd,state:{init:function(){var n=tt(!1);return{get:function(){return n.get()},set:function(t){return n.set(t)},clear:function(){return n.set(!1)},readState:function(){return n.get()}}}}}),Md="alloy.item-hover",Fd="alloy.item-focus",Id=X(Md),Rd=X(Fd),Dd=[g("data"),g("components"),g("dom"),b("hasSubmenu",!1),p("toggling"),kl("itemBehaviours",[v,lt,at,ut]),b("ignoreFocus",!1),b("domModification",{}),ha("builder",function(t){return{dom:t.dom,domModification:J(J({},t.domModification),{attributes:J(J(J({role:t.toggling.isSome()?"menuitemcheckbox":"menuitem"},t.domModification.attributes),{"aria-haspopup":t.hasSubmenu}),t.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:Cl(t.itemBehaviours,[t.toggling.fold(v.revoke,function(t){return v.config(J({aria:{mode:"checked"}},t))}),lt.config({ignore:t.ignoreFocus,stopMousedown:t.ignoreFocus,onFocus:function(t){ad(t)}}),at.config({mode:"execution"}),ut.config({store:{mode:"memory",initialValue:t.data}}),st("item-type-events",F(rd(),[et(Ko(),ud),et(lr(),lt.focus)]))]),components:t.components,eventOrder:t.eventOrder}}),b("eventOrder",{})],Td=[g("dom"),g("components"),ha("builder",function(t){return{dom:t.dom,components:t.components,events:Ar([(t=lr(),et(t,function(t,n){n.stop()}))])}})],Vd=X("item-widget"),Pd=X([Rl({name:"widget",overrides:function(n){return{behaviours:it([ut.config({store:{mode:"manual",getValue:function(t){return n.data},setValue:K}})])}}})]),Vs=[g("uid"),g("data"),g("components"),g("dom"),b("autofocus",!1),b("ignoreFocus",!1),kl("widgetBehaviours",[ut,lt,at]),b("domModification",{}),Ul(Pd()),ha("builder",function(e){function o(t){return Ll(t,e,"widget").map(function(t){return at.focusIn(t),t})}function t(t,n){return vs(n.event.target)||e.autofocus&&n.setSource(t.element),$.none()}var n=zl(Vd(),e,Pd()),n=Nl(Vd(),e,n.internals());return{dom:e.dom,components:n,domModification:e.domModification,events:Ar([Vr(function(t,n){o(t).each(function(t){n.stop()})}),et(Ko(),ud),et(lr(),function(t,n){e.autofocus?o(t):lt.focus(t)})]),behaviours:Cl(e.widgetBehaviours,[ut.config({store:{mode:"memory",initialValue:e.data}}),lt.config({ignore:e.ignoreFocus,onFocus:function(t){ad(t)}}),at.config({mode:"special",focusIn:e.autofocus?function(t){o(t)}:Ya(),onLeft:t,onRight:t,onEscape:function(t,n){return lt.isFocused(t)||e.autofocus?(e.autofocus&&n.setSource(t.element),$.none()):(lt.focus(t),$.some(!0))}})])}})],Hd=Xt("type",{widget:Vs,item:Dd,separator:Td}),Fl=X([La({factory:{sketch:function(t){t=Qe("menu.spec item",Hd,t);return t.builder(t)}},name:"items",unit:"item",defaults:function(t,n){return n.hasOwnProperty("uid")?n:J(J({},n),{uid:vi("item")})},overrides:function(t,n){return{type:n.type,ignoreFocus:t.fakeFocus,domModification:{classes:[t.markers.item]}}}})]),Cd=X([g("value"),g("items"),g("dom"),g("components"),b("eventOrder",{}),Zc("menuBehaviours",[$l,ut,T,at]),fo("movement",{mode:"menu",moveOnTab:!0},Xt("mode",{grid:[di(),ha("config",function(t,n){return{mode:"flatgrid",selector:"."+t.markers.item,initSize:{numColumns:n.initSize.numColumns,numRows:n.initSize.numRows},focusManager:t.focusManager}})],matrix:[ha("config",function(t,n){return{mode:"matrix",selectors:{row:n.rowSelector,cell:"."+t.markers.item},focusManager:t.focusManager}}),g("rowSelector")],menu:[b("moveOnTab",!0),ha("config",function(t,n){return{mode:"menu",selector:"."+t.markers.item,moveOnTab:n.moveOnTab,focusManager:t.focusManager}})]})),ao("markers",bo()),b("fakeFocus",!1),b("focusManager",lf()),t("onHighlight")]),zd=X("alloy.menu-focus"),Nd=hs({name:"Menu",configFields:Cd(),partFields:Fl(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,markers:t.markers,behaviours:ns(t.menuBehaviours,[$l.config({highlightClass:t.markers.selectedItem,itemClass:t.markers.item,onHighlight:t.onHighlight}),ut.config({store:{mode:"memory",initialValue:t.value}}),T.config({find:$.some}),at.config(t.movement.config(t,t.movement))]),events:Ar([et(Rd(),function(n,e){var t=e.event;n.getSystem().getByDom(t.target).each(function(t){$l.highlight(n,t),e.stop(),q(n,zd(),{menu:n,item:t})})}),et(Id(),function(t,n){n=n.event.item;$l.highlight(t,n)})]),components:n,eventOrder:t.eventOrder,domModification:{attributes:{role:"menu"}}}}}),Ld=function(e,o,r,t){return B(r,t).bind(function(t){return B(e,t).bind(function(t){var n=Ld(e,o,r,t);return $.some([t].concat(n))})}).getOr([])},jd=function(){function c(t){return n(t).bind(cd)}function n(t){return B(l.get(),t)}function e(t){return B(s.get(),t)}var s=tt({}),l=tt({}),f=tt({}),d=tt($.none()),m=tt({});return{setMenuBuilt:function(t,n){var e;l.set(J(J({},l.get()),((e={})[t]={type:"prepared",menu:n},e)))},setContents:function(t,n,e,o){d.set($.some(t)),s.set(e),l.set(n),m.set(o);t=e,r={},ve(o,function(t,n){Q(t,function(t){r[t]=n})}),u=ye(i=t,function(t,n){return{k:t,v:n}}),a=be(u,function(t,n){return[n].concat(Ld(r,i,u,n))});var r,i,u,a,n=be(r,function(t){return B(a,t).getOr([t])});f.set(n)},expand:function(e){return B(s.get(),e).map(function(t){var n=B(f.get(),e).getOr([]);return[t].concat(n)})},refresh:function(t){return B(f.get(),t)},collapse:function(t){return B(f.get(),t).bind(function(t){return 1<t.length?$.some(t.slice(1)):$.none()})},lookupMenu:n,lookupItem:e,otherMenus:function(t){var n=m.get();return Et(pe(n),t)},getPrimary:function(){return d.get().bind(c)},getMenus:function(){return l.get()},clear:function(){s.set({}),l.set({}),f.set({}),d.set($.none())},isClear:function(){return d.get().isNone()},getTriggeringPath:function(t,u){var a=yt(e(t).toArray(),function(t){return c(t).isSome()});return B(f.get(),t).bind(function(t){for(var e=Tt(a.concat(t)),n=Ot(e,function(t,n){return o=t,r=u,i=e.slice(0,n+1),c(o).bind(function(n){return e=o,It(s.get(),function(t,n){return t===e}).bind(function(t){return r(t).map(function(t){return{triggeredMenu:n,triggeringItem:t,triggeringPath:i}})});var e}).fold(function(){return d.get().is(t)?[]:[$.none()]},function(t){return[$.some(t)]});var o,r,i}),o=[],r=0;r<n.length;r++){var i=n[r];if(!i.isSome())return $.none();o.push(i.getOrDie())}return $.some(o)})}}},Ud=cd,Wd=X("collapse-item"),Gd=ql({name:"TieredMenu",configFields:[Iu("onExecute"),Iu("onEscape"),Fu("onOpenMenu"),Fu("onOpenSubmenu"),t("onRepositionMenu"),t("onCollapseMenu"),b("highlightImmediately",!0),co("data",[g("primary"),g("menus"),g("expansions")]),b("fakeFocus",!1),t("onHighlight"),t("onHover"),Du(),g("dom"),b("navigateOnHover",!0),b("stayInDom",!1),Zc("tmenuBehaviours",[at,$l,T,ct]),b("eventOrder",{})],apis:{collapseMenu:function(t,n){t.collapseMenu(n)},highlightPrimary:function(t,n){t.highlightPrimary(n)},repositionMenus:function(t,n){t.repositionMenus(n)}},factory:function(c,t){function e(t){o=t,r=c.data.primary,t=c.data.menus;var o,r,t=be(t,function(t,n){function e(){return Nd.sketch(J(J({},t),{value:n,markers:c.markers,fakeFocus:c.fakeFocus,onHighlight:c.onHighlight,focusManager:(c.fakeFocus?ff:lf)()}))}return n===r?{type:"prepared",menu:o.getSystem().build(e())}:{type:"notbuilt",nbMenu:e}}),n=be(c.data.menus,function(t,n){return Ot(t.items,function(t){return"separator"===t.type?[]:[t.data.value]})});return d.setContents(c.data.primary,t,c.data.expansions,n),d.getPrimary()}function s(t,e){n=t;var n,t=u.get().getOrThunk(function(){var e={},t=tl(n.element,"."+c.markers.item),t=yt(t,function(t){return"true"===ai(t,"aria-haspopup")});return Q(t,function(t){n.getSystem().getByDom(t).each(function(t){var n=m(t);e[n]=t})}),u.set($.some(e)),e});ve(t,function(t,n){n=pt(e,n);ot(t.element,"aria-expanded",n)})}function l(e,o,r){return $.from(r[0]).bind(function(t){return o.lookupMenu(t).bind(function(t){var n;return"notbuilt"===t.type?$.none():(t=t.menu,n=g(o,r.slice(1)),Q(n,function(t){Fi(t.element,c.markers.backgroundMenu)}),Ni(t.element)||ct.append(e,ru(t)),Hi(t.element,[c.markers.backgroundMenu]),a(e,t),p(e,o,r),$.some(t))})})}function r(i,u,a){void 0===a&&(a=f.HighlightSubmenu);var t=m(u);return d.expand(t).bind(function(r){return s(i,r),$.from(r[0]).bind(function(o){return d.lookupMenu(o).bind(function(t){n=i,e=o;var n,e,t="notbuilt"!==(t=t).type?t.menu:(n=n.getSystem().build(t.nbMenu()),d.setMenuBuilt(e,n),n);return Ni(t.element)||ct.append(i,ru(t)),c.onOpenSubmenu(i,u,t,Tt(r)),a===f.HighlightSubmenu?($l.highlightFirst(t),l(i,d,r)):($l.dehighlightAll(t),$.some(u))})})})}function o(n,e){var t=m(e);return d.collapse(t).bind(function(t){return s(n,t),l(n,d,t).map(function(t){return c.onCollapseMenu(n,e,t),t})})}function n(e){return function(n,t){return aa(t.getSource(),"."+c.markers.item).bind(function(t){return n.getSystem().getByDom(t).toOptional().bind(function(t){return e(n,t).map(E)})})}}function i(t){return $l.getHighlighted(t).bind($l.getHighlighted)}var f,u=tt($.none()),d=jd(),m=function(t){return ut.getValue(t).value},a=function(n,t){$l.highlight(n,t),$l.getHighlighted(t).orThunk(function(){return $l.getFirst(t)}).each(function(t){kn(n,t.element,lr())})},g=function(n,t){return Kl(k(t,function(t){return n.lookupMenu(t).bind(function(t){return"prepared"===t.type?$.some(t.menu):$.none()})}))},p=function(n,t,e){t=g(t,t.otherMenus(e));Q(t,function(t){Hi(t.element,[c.markers.backgroundMenu]),c.stayInDom||ct.remove(n,t)})},h=(f={HighlightSubmenu:0,0:"HighlightSubmenu",HighlightParent:1,1:"HighlightParent"},Ar([et(zd(),function(n,e){var t=e.event.item;d.lookupItem(m(t)).each(function(){var t=e.event.menu,t=($l.highlight(n,t),m(e.event.item));d.refresh(t).each(function(t){return p(n,d,t)})})}),Vr(function(n,t){t=t.event.target;n.getSystem().getByDom(t).each(function(t){0===m(t).indexOf("collapse-item")&&o(n,t),r(n,t,f.HighlightSubmenu).fold(function(){c.onExecute(n,t)},K)})}),Fr(function(n,t){e(n).each(function(t){ct.append(n,ru(t)),c.onOpenMenu(n,t),c.highlightImmediately&&a(n,t)})})].concat(c.navigateOnHover?[et(Id(),function(t,n){var n=n.event.item,e=t,o=m(n);d.refresh(o).bind(function(t){return s(e,t),l(e,d,t)}),r(t,n,f.HighlightParent),c.onHover(t,n)})]:[]))),v={collapseMenu:function(n){i(n).each(function(t){o(n,t)})},highlightPrimary:function(n){d.getPrimary().each(function(t){a(n,t)})},repositionMenus:function(e){d.getPrimary().bind(function(n){return i(e).bind(function(t){var t=m(t),n=we(d.getMenus()),e=Kl(k(n,Ud));return d.getTriggeringPath(t,function(t){return n=t,Mt(e,function(t){return t.getSystem().isConnected()?(t=$l.getCandidates(t),St(t,function(t){return m(t)===n})):$.none()});var n})}).map(function(t){return{primary:n,triggeringPath:t}})}).fold(function(){var t=e;$.from(t.components()[0]).filter(function(t){return"menu"===ai(t.element,"role")}).each(function(t){c.onRepositionMenu(e,t,[])})},function(t){var n=t.primary,t=t.triggeringPath;c.onRepositionMenu(e,n,t)})}};return{uid:c.uid,dom:c.dom,markers:c.markers,behaviours:ns(c.tmenuBehaviours,[at.config({mode:"special",onRight:n(function(t,n){return vs(n.element)?$.none():r(t,n,f.HighlightSubmenu)}),onLeft:n(function(t,n){return vs(n.element)?$.none():o(t,n)}),onEscape:n(function(t,n){return o(t,n).orThunk(function(){return c.onEscape(t,n).map(function(){return t})})}),focusIn:function(n,t){d.getPrimary().each(function(t){kn(n,t.element,lr())})}}),$l.config({highlightClass:c.markers.selectedMenu,itemClass:c.markers.menu}),T.config({find:function(t){return $l.getHighlighted(t)}}),ct.config({})]),eventOrder:c.eventOrder,apis:v,events:h}},extraApis:{tieredData:function(t,n,e){return{primary:t,menus:n,expansions:e}},singleData:function(t,n){return{primary:t,menus:Ie(t,n),expansions:{}}},collapseItem:function(t){return{value:_(Wd()),meta:{text:t}}}}}),Xd=ql({name:"InlineView",configFields:[g("lazySink"),t("onShow"),t("onHide"),en("onEscape"),Zc("inlineBehaviours",[h,ut,qa]),lo("fireDismissalEventInstead",[b("event",Sr())]),lo("fireRepositionEventInstead",[b("event",vo())]),b("getRelated",$.none),b("isExtraPart",d),b("eventOrder",$.none)],factory:function(f,t){function o(t,n,e,o){r(t,n,e,function(){return o.map(ku)})}function r(t,n,e,o){var r=f.lazySink(t).getOrDie();h.openWhileCloaked(t,e,function(){return fl.positionWithinBounds(r,n,t,o())}),ut.setValue(t,$.some({mode:"position",anchor:n,getBounds:o}))}function i(t,n,e,o){r=f,i=t,u=n,a=o,c=function(){return r.lazySink(i)},s="horizontal"===e.type?{layouts:{onLtr:za,onRtl:Na}}:{},l=function(t){return 2===t.length?s:{}};var r,i,u,a,c,s,l,n=Gd.sketch({dom:{tag:"div"},data:e.data,markers:e.menu.markers,highlightImmediately:e.menu.highlightImmediately,onEscape:function(){return h.close(i),r.onEscape.map(function(t){return t(i)}),$.some(!0)},onExecute:function(){return $.some(!0)},onOpenMenu:function(t,n){fl.positionWithinBounds(c().getOrDie(),u,n,a())},onOpenSubmenu:function(t,n,e,o){var r=c().getOrDie();fl.position(r,J({anchor:"submenu",item:n},l(o)),e)},onRepositionMenu:function(t,n,e){var o=c().getOrDie();fl.positionWithinBounds(o,u,n,a()),Q(e,function(t){var n=l(t.triggeringPath);fl.position(o,J({anchor:"submenu",item:t.triggeringItem},n),t.triggeredMenu)})}});h.open(t,n),ut.setValue(t,$.some({mode:"menu",menu:n}))}function n(e){h.isOpen(e)&&ut.getValue(e).each(function(t){switch(t.mode){case"menu":h.getState(e).each(function(t){Gd.repositionMenus(t)});break;case"position":var n=f.lazySink(e).getOrDie();fl.positionWithinBounds(n,t.anchor,e,t.getBounds())}})}var e={setContent:function(t,n){h.setContent(t,n)},showAt:function(t,n,e){o(t,n,e,$.none())},showWithin:o,showWithinBounds:r,showMenuAt:function(t,n,e){i(t,n,e,function(){return $.none()})},showMenuWithinBounds:i,hide:function(t){h.isOpen(t)&&(ut.setValue(t,$.none()),h.close(t))},getContent:function(t){return h.getState(t)},reposition:n,isOpen:h.isOpen};return{uid:f.uid,dom:f.dom,behaviours:ns(f.inlineBehaviours,[h.config({isPartOf:function(t,n,e){return ca(n,e)||(o=e,f.getRelated(t).exists(function(t){return ca(t,o)}));var o},getAttachPoint:function(t){return f.lazySink(t).getOrDie()},onOpen:function(t){f.onShow(t)},onClose:function(t){f.onHide(t)}}),ut.config({store:{mode:"memory",initialValue:$.none()}}),qa.config({channels:J(J({},Xc(J({isExtraPart:t.isExtraPart},f.fireDismissalEventInstead.map(function(t){return{fireEventInstead:{event:t.event}}}).getOr({})))),Yc(J(J({},f.fireRepositionEventInstead.map(function(t){return{fireEventInstead:{event:t.event}}}).getOr({})),{doReposition:n})))})]),eventOrder:f.eventOrder,apis:e}},apis:{showAt:function(t,n,e,o){t.showAt(n,e,o)},showWithin:function(t,n,e,o,r){t.showWithin(n,e,o,r)},showWithinBounds:function(t,n,e,o,r){t.showWithinBounds(n,e,o,r)},showMenuAt:function(t,n,e,o){t.showMenuAt(n,e,o)},showMenuWithinBounds:function(t,n,e,o,r){t.showMenuWithinBounds(n,e,o,r)},hide:function(t,n){t.hide(n)},isOpen:function(t,n){return t.isOpen(n)},getContent:function(t,n){return t.getContent(n)},setContent:function(t,n,e){t.setContent(n,e)},reposition:function(t,n){t.reposition(n)}}}),Yd=tinymce.util.Tools.resolve("tinymce.util.Delay"),qd=ql({name:"Button",factory:function(t){function n(n){return B(t.dom,"attributes").bind(function(t){return B(t,n)})}var e=id(t.action),o=t.dom.tag;return{uid:t.uid,dom:t.dom,components:t.components,events:e,behaviours:Cl(t.buttonBehaviours,[lt.config({}),at.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:"button"!==o?{role:n("role").getOr("button")}:(e=n("type").getOr("button"),o=n("role").map(function(t){return{role:t}}).getOr({}),J({type:e},o))},eventOrder:t.eventOrder}},configFields:[b("uid",void 0),g("dom"),b("components",[]),kl("buttonBehaviours",[lt,at]),p("action"),p("role"),b("eventOrder",{})]}),ft=function(t){var n=void 0!==t.uid&&ke(t,"uid")?t.uid:vi("memento");return{get:function(t){return t.getSystem().getByUid(n).getOrDie()},getOpt:function(t){return t.getSystem().getByUid(n).toOptional()},asSpec:function(){return J(J({},t),{uid:n})}}},Kd=function(t,n){return $.from(n()[t.toLowerCase()]).getOrThunk(function(){return bd(n)})},Jd={success:"checkmark",error:"warning",err:"error",warning:"warning",warn:"warning",info:"info"},$d=ql({name:"Notification",factory:function(n){function e(t){return{dom:{tag:"div",classes:["tox-bar"],attributes:{style:"width: "+t+"%"}}}}function o(t){return{dom:{tag:"div",classes:["tox-text"],innerHtml:t+"%"}}}var r,i=ft({dom:{tag:"p",innerHtml:n.translationProvider(n.text)},behaviours:it([ct.config({})])}),u=ft({dom:{tag:"div",classes:n.progress?["tox-progress-bar","tox-progress-indicator"]:["tox-progress-bar"]},components:[{dom:{tag:"div",classes:["tox-bar-container"]},components:[e(0)]},o(0)],behaviours:it([ct.config({})])}),t={updateProgress:function(t,n){t.getSystem().isConnected()&&u.getOpt(t).each(function(t){ct.set(t,[{dom:{tag:"div",classes:["tox-bar-container"]},components:[e(n)]},o(n)])})},updateText:function(t,n){t.getSystem().isConnected()&&(t=i.get(t),ct.set(t,[tu(n)]))}},a=Ct([n.icon.toArray(),n.level.toArray(),n.level.bind(function(t){return $.from(Jd[t])}).toArray()]),c=ft(qd.sketch({dom:{tag:"button",classes:["tox-notification__dismiss","tox-button","tox-button--naked","tox-button--icon"]},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:Kd("close",n.iconProvider),attributes:{"aria-label":n.translationProvider("Close")}}}],action:function(t){n.onAction(t)}})),a=[{dom:{tag:"div",classes:["tox-notification__icon"],innerHtml:(r=n.iconProvider,Mt(a,function(t){return $.from(r()[t.toLowerCase()])}).getOrThunk(function(){return bd(r)}))}},{dom:{tag:"div",classes:["tox-notification__body"]},components:[i.asSpec()],behaviours:it([ct.config({})])}];return{uid:n.uid,dom:{tag:"div",attributes:{role:"alert"},classes:n.level.map(function(t){return["tox-notification","tox-notification--in","tox-notification--"+t]}).getOr(["tox-notification","tox-notification--in"])},behaviours:it([lt.config({}),st("notification-events",[et(Jo(),function(t){c.getOpt(t).each(lt.focus)})])]),components:a.concat(n.progress?[u.asSpec()]:[]).concat(n.closeButton?[c.asSpec()]:[]),apis:t}},configFields:[p("level"),g("progress"),g("icon"),g("onAction"),g("text"),g("iconProvider"),g("translationProvider"),an("closeButton",!0)],apis:{updateProgress:function(t,n,e){t.updateProgress(n,e)},updateText:function(t,n,e){t.updateText(n,e)}}});function Qd(e,o){var r=null;return{cancel:function(){null!==r&&(clearTimeout(r),r=null)},throttle:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];null!==r&&clearTimeout(r),r=setTimeout(function(){e.apply(null,t),r=null},o)}}}function Zd(e,t,n,o,r){var i=bm(e,function(t){return(n=e).isBlock(t=t)||pt(["BR","IMG","HR","INPUT"],t.nodeName)||"false"===n.getContentEditable(t);var n});return $.from(i.backwards(t,n,o,r))}function tm(t){return""!==t&&-1!==" \f\n\r\t\v".indexOf(t)}function nm(e,t){function o(t,n){q(t,Qo(),{raw:n})}t.on("keypress compositionend",e.onKeypress.throttle),t.on("remove",e.onKeypress.cancel),t.on("keydown",function(n){function t(){return e.getView().bind($l.getHighlighted)}8===n.which&&e.onKeypress.throttle(n),e.isActive()&&(27===n.which&&e.cancelIfNecessary(),e.isMenuOpen()?13===n.which?(t().each(Dr),n.preventDefault()):40===n.which?(t().fold(function(){e.getView().each($l.highlightFirst)},function(t){o(t,n)}),n.preventDefault(),n.stopImmediatePropagation()):37!==n.which&&38!==n.which&&39!==n.which||t().each(function(t){o(t,n),n.preventDefault(),n.stopImmediatePropagation()}):13!==n.which&&38!==n.which&&40!==n.which||e.cancelIfNecessary())}),t.on("NodeChange",function(t){e.isActive()&&!e.isProcessingAction()&&ym(nt.fromDom(t.element)).isNone()&&e.cancelIfNecessary()})}function em(t,n){return{container:t,offset:n}}function om(t){var n;return 3===t.nodeType?em(t,t.data.length):0<(n=t.childNodes).length?om(n[n.length-1]):em(t,n.length)}function rm(t,n){var e=t.childNodes;return 0<e.length&&n<e.length?rm(e[n],0):0<e.length&&1===t.nodeType&&e.length===n?om(e[e.length-1]):em(t,n)}function im(t){return B(zm,t).getOr(Pm)}function um(t,n,e){var o=Xm(e);return{dom:{tag:"div",classes:Ct([[o.tieredMenu]])},markers:Ym(e)}}function am(t,e){var o=[],r=[];return Q(t,function(t,n){e(t,n)&&(0<r.length&&o.push(r),r=[],!Se(t.dom,"innerHtml"))||r.push(t)}),0<r.length&&o.push(r),k(o,function(t){return{dom:{tag:"div",classes:["tox-collection__group"]},components:t}})}function cm(t,e,n){var o=tl(t.element,"."+n);return 0<o.length?(t=kt(o,function(t){var t=t.dom.getBoundingClientRect().top,n=o[0].dom.getBoundingClientRect().top;return Math.abs(t-n)>e}).getOr(o.length),$.some({numColumns:t,numRows:Math.ceil(o.length/t)})):$.none()}function sm(t,n,e){t.getSystem().broadcastOn([dg],{})}function lm(t,n,e){(n.disabled()?yg:xg)(t,n)}function fm(t,n){return!0===n.useNative&&pt(bg,Pr(t.element))}function dm(t){ot(t.element,"disabled","disabled")}function mm(t){si(t.element,"disabled")}function gm(t){ot(t.element,"aria-disabled","true")}function pm(t){ot(t.element,"aria-disabled","false")}function hm(t,n){return fm(t,n)?Nn(t.element,"disabled"):"true"===ai(t.element,"aria-disabled")}var vm,bm=tinymce.util.Tools.resolve("tinymce.dom.TextSeeker"),ym=function(t){return aa(t,"[data-mce-autocompleter]")},xm=function(t){return t.toString().replace(/\u00A0/g," ").replace(/\uFEFF/g,"")},wm=function(t,n){return t.substring(n.length)},Sm=function(t,e,o,r){var n;return void 0===r&&(r=0),e.collapsed&&3===e.startContainer.nodeType?(n=t.getParent(e.startContainer,t.isBlock)||t.getRoot(),Zd(t,e.startContainer,e.startOffset,function(t,r,n){return function(t,n){for(var e=r-1;0<=e;e--){var o=t.charAt(e);if(tm(o))return $.none();if(o===n)break}return $.some(e)}(n,o).getOr(r)},n).bind(function(t){var n=e.cloneRange();return n.setStart(t.container,t.offset),n.setEnd(e.endContainer,e.endOffset),n.collapsed||0!==(t=xm(n)).lastIndexOf(o)||wm(t,o).length<r?$.none():$.some({text:wm(t,o),range:n,triggerChar:o})})):$.none()},km=function(e,t,o,n){return void 0===n&&(n=0),ym(nt.fromDom(t.startContainer)).fold(function(){return Sm(e,t,o,n)},function(t){var n=e.createRng(),t=(n.selectNode(t.dom),xm(n));return $.some({range:n,text:wm(t,o),triggerChar:o})})},Cm=tinymce.util.Tools.resolve("tinymce.util.Promise"),Om=function(n){return function(t){t=rm(t.startContainer,t.startOffset);return!Zd(n,t.container,t.offset,function(t,n){return 0===n?-1:n},n.getRoot()).filter(function(t){t=t.container.data.charAt(t.offset-1);return!tm(t)}).isSome()}},_m=function(n,t,e,o){void 0===o&&(o={});var t=t(),r=n.selection.getRng().startContainer.nodeValue,t=yt(t.lookupByChar(e.triggerChar),function(t){return e.text.length>=t.minChars&&t.matches.getOrThunk(function(){return Om(n.dom)})(e.range,r,e.text)});return 0===t.length?$.none():(t=Cm.all(k(t,function(n){return n.fetch(e.text,n.maxResults,o).then(function(t){return{matchText:e.text,items:t,columns:n.columns,onAction:n.onAction,highlightOn:n.highlightOn}})})),$.some({lookupData:t,context:e}))},Tm=m([n("type"),nn("text")]),Em=m([b("type","autocompleteitem"),b("active",!1),b("disabled",!1),b("meta",{}),n("value"),nn("text"),nn("icon")]),Dm=m([n("type"),n("ch"),on("minChars",1),b("columns",1),on("maxResults",10),en("matches"),$t("fetch"),$t("onAction"),sn("highlightOn",[],oo)]),_d=[an("disabled",!1),nn("tooltip"),nn("icon"),nn("text"),cn("onSetup",function(){return K})],Bm=m([n("type"),$t("onAction")].concat(_d)),Am=function(t){return Je("toolbarbutton",Bm,t)},Il=[an("active",!1)].concat(_d),Mm=m(Il.concat([n("type"),$t("onAction")])),Fm=function(t){return Je("ToggleButton",Mm,t)},Od=[cn("predicate",d),un("scope","node",["node","editor"]),un("position","selection",["node","selection","line"])],ya=_d.concat([b("type","contextformbutton"),b("primary",!1),$t("onAction"),mo("original",A)]),cl=Il.concat([b("type","contextformbutton"),b("primary",!1),$t("onAction"),mo("original",A)]),Ml=_d.concat([b("type","contextformbutton")]),Ed=Il.concat([b("type","contextformtogglebutton")]),kd=Xt("type",{contextformbutton:ya,contextformtogglebutton:cl}),Im=m([b("type","contextform"),cn("initValue",function(){return""}),nn("label"),Zt("commands",kd),so("launch",Xt("type",{contextformbutton:Ml,contextformtogglebutton:Ed}))].concat(Od)),Rm=m([b("type","contexttoolbar"),n("items")].concat(Od)),Vm=(Vs={CLOSE_ON_EXECUTE:0,0:"CLOSE_ON_EXECUTE",BUBBLE_TO_SANDBOX:1,1:"BUBBLE_TO_SANDBOX"},Vs),Pm="tox-menu-nav__js",Hm="tox-collection__item",Dd="tox-swatch",zm={normal:Pm,color:Dd},Nm="tox-collection__item--enabled",Lm="tox-collection__item-label",jm="tox-collection__item-caret",Um="tox-collection__item--active",Wm="tox-collection__item-container",Gm="tox-collection__item-container--row",Xm=function(t){return{backgroundMenu:"tox-background-menu",selectedMenu:"tox-selected-menu",selectedItem:"tox-collection__item--active",hasIcons:"tox-menu--has-icons",menu:"color"===t?"tox-swatches":"tox-menu",tieredMenu:"tox-tiered-menu"}},Ym=function(t){var n=Xm(t);return{backgroundMenu:n.backgroundMenu,selectedMenu:n.selectedMenu,menu:n.menu,selectedItem:n.selectedItem,item:im(t)}},qm=[Nd.parts.items({})],Km=function(n,e){return function(t){t=V(t,e);return k(t,function(t){return{dom:n,components:t}})}},Jm=function(n,e,t){return{dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===n?["tox-collection--list"]:["tox-collection--grid"])},components:[Nd.parts.items({preprocess:function(t){return"auto"!==n&&1<n?Km({tag:"div",classes:["tox-collection__group"]},n)(t):am(t,function(t,n){return"separator"===e[n].type})}})]}},$m=function(t){return ht(t,function(t){return"icon"in t&&void 0!==t.icon})},Qm=function(t){return console.error(Ze(t)),console.log(t),$.none()},Zm=function(t,n,e,o,r){i=e;var i,u={dom:{tag:"div",classes:["tox-collection","tox-collection--horizontal"]},components:[Nd.parts.items({preprocess:function(t){return am(t,function(t,n){return"separator"===i[n].type})}})]};return{value:t,dom:u.dom,components:u.components,items:e}},tg=function(t,n,e,o,r){var i,u;return"color"===r?{value:t,dom:(i={dom:{tag:"div",classes:["tox-menu","tox-swatches-menu"]},components:[{dom:{tag:"div",classes:["tox-swatches"]},components:[Nd.parts.items({preprocess:"auto"!==o?Km({tag:"div",classes:["tox-swatches__row"]},o):A})]}]}).dom,components:i.components,items:e}:"normal"===r&&"auto"===o?{value:t,dom:(i=Jm(o,e)).dom,components:i.components,items:e}:"normal"===r&&1===o?{value:t,dom:(i=Jm(1,e)).dom,components:i.components,items:e}:"normal"===r?{value:t,dom:(i=Jm(o,e)).dom,components:i.components,items:e}:"listpreview"!==r||"auto"===o?{value:t,dom:(n=n,u=o,r=Xm(r),{tag:"div",classes:Ct([[r.menu,"tox-menu-"+u+"-column"],n?[r.hasIcons]:[]])}),components:qm,items:e}:{value:t,dom:(i={dom:{tag:"div",classes:["tox-menu","tox-collection","tox-collection--toolbar","tox-collection--toolbar-lg"]},components:[Nd.parts.items({preprocess:Km({tag:"div",classes:["tox-collection__group"]},o)})]}).dom,components:i.components,items:e}},Td=[n("type"),n("src"),nn("alt"),sn("classes",[],oo)],ng=m(Td),di=[n("type"),n("text"),nn("name"),sn("classes",["tox-collection__item-label"],oo)],eg=m(di),bo=Wt(function(){return to("type",{cardimage:ng,cardtext:eg,cardcontainer:og})}),og=m([n("type"),rn("direction","horizontal"),rn("align","left"),rn("valign","middle"),Zt("items",bo)]),Cd=[an("disabled",!1),nn("text"),nn("shortcut"),Ye("value","value",Ae(function(){return _("menuitem-value")}),no()),b("meta",{})],rg=m([n("type"),nn("label"),Zt("items",bo),cn("onSetup",function(){return K}),cn("onAction",K)].concat(Cd)),ig=m([n("type"),an("active",!1),nn("icon")].concat(Cd)),ug=m([n("type"),Jt("fancytype",["inserttable","colorswatch"]),cn("onAction",K)]),ag=m([n("type"),cn("onSetup",function(){return K}),cn("onAction",K),nn("icon")].concat(Cd)),cg=m([n("type"),$t("getSubmenuItems"),cn("onSetup",function(){return K}),nn("icon")].concat(Cd)),sg=m([n("type"),nn("icon"),an("active",!1),cn("onSetup",function(){return K}),$t("onAction")].concat(Cd)),lg=function(t,n){return it([st(t,n)])},fg=function(t){return lg(_("unnamed-events"),t)},dg=_("tooltip.exclusive"),mg=_("tooltip.show"),gg=_("tooltip.hide"),Fl=Object.freeze({__proto__:null,hideAllExclusive:sm,setComponents:function(t,n,e,o){e.getTooltip().each(function(t){t.getSystem().isConnected()&&ct.set(t,o)})}}),vo=Object.freeze({__proto__:null,events:function(r,i){function e(n){i.getTooltip().each(function(t){hl(t),r.onHide(n,t),i.clearTooltip()}),i.clearTimer()}return Ar(Ct([[et(mg,function(o){i.resetTimer(function(){var t,n,e=o;i.isShowing()||(sm(e),t=r.lazySink(e).getOrDie(),n=e.getSystem().build({dom:r.tooltipDom,components:r.tooltipComponents,events:Ar("normal"===r.mode?[et(Ko(),function(t){Y(e,mg)}),et(Yo(),function(t){Y(e,gg)})]:[]),behaviours:it([ct.config({})])}),i.setTooltip(n),gl(t,n),r.onShow(e,n),fl.position(t,r.anchor(e),n))},r.delay)}),et(gg,function(t){i.resetTimer(function(){e(t)},r.delay)}),et(cr(),function(t,n){n.universal||pt(n.channels,dg)&&e(t)}),Ir(function(t){e(t)})],"normal"===r.mode?[et(Jo(),function(t){Y(t,mg)}),et(ur(),function(t){Y(t,gg)}),et(Ko(),function(t){Y(t,mg)}),et(Yo(),function(t){Y(t,gg)})]:[et(Tr(),function(t,n){Y(t,mg)}),et(Er(),function(t){Y(t,gg)})]]))}}),Il=[g("lazySink"),g("tooltipDom"),b("exclusive",!0),b("tooltipComponents",[]),b("delay",300),un("mode","normal",["normal","follow-highlight"]),b("anchor",function(t){return{anchor:"hotspot",hotspot:t,layouts:{onLtr:X([Nu,zu,Ru,Pu,Vu,Hu]),onRtl:X([Nu,zu,Ru,Pu,Vu,Hu])}}}),t("onHide"),t("onShow")],pg=Wu({fields:Il,name:"tooltipping",active:vo,state:Object.freeze({__proto__:null,init:function(){function e(){o.get().each(function(t){clearTimeout(t)})}var o=tt($.none()),n=tt($.none()),t=X("not-implemented");return _i({getTooltip:function(){return n.get()},isShowing:function(){return n.get().isSome()},setTooltip:function(t){n.set($.some(t))},clearTooltip:function(){n.set($.none())},clearTimer:e,resetTimer:function(t,n){e(),o.set($.some(setTimeout(function(){t()},n)))},readState:t})}}),apis:Fl}),hg=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),vg=tinymce.util.Tools.resolve("tinymce.util.I18n"),bg=["input","button","textarea","select"],yg=function(n,t,e){t.disableClass.each(function(t){Fi(n.element,t)}),(fm(n,t)?dm:gm)(n),t.onDisabled(n)},xg=function(n,t,e){t.disableClass.each(function(t){Ri(n.element,t)}),(fm(n,t)?mm:pm)(n),t.onEnabled(n)},ya=Object.freeze({__proto__:null,enable:xg,disable:yg,isDisabled:hm,onLoad:lm,set:function(t,n,e,o){(o?yg:xg)(t,n)}}),cl=Object.freeze({__proto__:null,exhibit:function(t,n){return Ti({classes:n.disabled()?n.disableClass.toArray():[]})},events:function(e,t){return Ar([On(sr(),function(t,n){return hm(t,e)}),Uu(e,t,lm)])}}),kd=[cn("disabled",d),b("useNative",!0),p("disableClass"),t("onDisabled"),t("onEnabled")],dt=Wu({fields:kd,name:"disabling",active:cl,apis:ya}),wg=tinymce.util.Tools.resolve("tinymce.EditorManager"),Sg=function(t){return t.getParam("height",Math.max(t.getElement().offsetHeight,200))},kg=function(t){return t.getParam("width",hg.DOM.getStyle(t.getElement(),"width"))},Cg=function(t){return $.from(t.getParam("min_width")).filter(mt)},Og=function(t){return $.from(t.getParam("min_height")).filter(mt)},_g=function(t){return $.from(t.getParam("max_width")).filter(mt)},Tg=function(t){return $.from(t.getParam("max_height")).filter(mt)},Eg=function(t){return!1!==t.getParam("menubar",!0,"boolean")},Dg=function(t){var n=t.getParam("toolbar",!0),e=!0===n,o=y(n),n=c(n)&&0<n.length;return!Ag(t)&&(n||o||e)},Bg=function(n){var t=vt(9,function(t){return n.getParam("toolbar"+(t+1),!1,"string")}),t=yt(t,function(t){return"string"==typeof t});return 0<t.length?$.some(t):$.none()},Ag=function(t){return Bg(t).fold(function(){return 0<t.getParam("toolbar",[],"string[]").length},E)};(Ml=vm=vm||{}).default="wrap",Ml.floating="floating",Ml.sliding="sliding",Ml.scrolling="scrolling";var Mg,Fg=function(t){return t.getParam("toolbar_mode","","string")};(Ed=Mg=Mg||{}).auto="auto",Ed.top="top",Ed.bottom="bottom";function Ig(t){return dp(t).getOrThunk(function(){return Qr($r(nt.fromDom(t.getElement())))})}function Rg(t){return(t.getParam("toolbar_sticky",!1,"boolean")||t.inline)&&!mp(t)&&!gp(t)}function Vg(t,n){var e=t.outerContainer.element;n&&(t.mothership.broadcastOn([bl()],{target:e}),t.uiMothership.broadcastOn([bl()],{target:e})),t.mothership.broadcastOn([pp],{readonly:n}),t.uiMothership.broadcastOn([pp],{readonly:n})}function Pg(t,n){t.on("init",function(){t.mode.isReadOnly()&&Vg(n,!0)}),t.on("SwitchMode",function(){return Vg(n,t.mode.isReadOnly())}),t.getParam("readonly",!1,"boolean")&&t.setMode("readonly")}function Hg(t){return dt.config({disabled:t,disableClass:"tox-tbtn--disabled"})}function zg(t){return{dom:{tag:"div",classes:["tox-collection__item-icon"],innerHtml:t}}}function Ng(t){return{dom:{tag:"div",classes:[Lm]},components:[tu(vg.translate(t))]}}function Lg(t,n){return{dom:{tag:"div",classes:n,innerHtml:t}}}function jg(t,n){return{dom:{tag:"div",classes:[Lm]},components:[{dom:{tag:t.tag,styles:t.styles},components:[tu(vg.translate(n))]}]}}function Ug(t){return{dom:{tag:"div",classes:["tox-collection__item-accessory"],innerHtml:(e=Tp.mac?{alt:"&#x2325;",ctrl:"&#x2303;",shift:"&#x21E7;",meta:"&#x2318;",access:"&#x2303;&#x2325;"}:{meta:"Ctrl",access:"Shift+Alt"},t=t.split("+"),t=k(t,function(t){var n=t.toLowerCase().trim();return Se(e,n)?e[n]:t}),Tp.mac?t.join(""):t.join("+"))}};var e}function Wg(t,n){return n=n.map(function(t){return{attributes:{title:vg.translate(t)}}}).getOr({}),J({tag:"div",classes:[Pm,Hm].concat(t?["tox-collection__item-icon-rtl"]:[])},n)}function Gg(t,n){return t=vg.translate(t),t=hg.DOM.encode(t),0<n.length?(n=new RegExp(n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi"),t.replace(n,function(t){return'<span class="tox-autocompleter-highlight">'+t+"</span>"})):t}function Xg(t,i){return k(t,function(t){switch(t.type){case"cardcontainer":return e=Xg((n=t).items,i),o="vertical"===n.direction?"tox-collection__item-container--column":Gm,r="left"===n.align?"tox-collection__item-container--align-left":"tox-collection__item-container--align-right",{dom:{tag:"div",classes:[Wm,o,r,function(){switch(n.valign){case"top":return"tox-collection__item-container--valign-top";case"middle":return"tox-collection__item-container--valign-middle";case"bottom":return"tox-collection__item-container--valign-bottom"}}()]},components:e};case"cardimage":return o=t.src,{dom:{tag:"img",classes:t.classes,attributes:{src:o,alt:t.alt.getOr("")}}};case"cardtext":r=t.name.exists(function(t){return pt(i.cardText.highlightOn,t)})?$.from(i.cardText.matchText).getOr(""):"";return Lg(Gg(t.text,r),t.classes)}var n,e,o,r})}function Yg(t){return(1===(t=t.toString(16)).length?"0"+t:t).toUpperCase()}function qg(t,n,e,o){return t=parseInt(t,10),n=parseInt(n,10),e=parseInt(e,10),o=parseFloat(o),Gp(t,n,e,o)}function Kg(t,n){t.fire("ResizeContent",n)}function Jg(t){return!1!==t.getParam("custom_colors")}function $g(t){if(void 0===(t=t.getParam("color_map")))return th;var n=t,e=[],r=document.createElement("canvas");r.height=1,r.width=1;for(var i=r.getContext("2d"),u=function(t,n){n/=255;return("0"+Math.round(t*n+255*(1-n)).toString(16)).slice(-2).toUpperCase()},o=0;o<n.length;o+=2)e.push({text:n[o+1],value:function(t){if(/^[0-9A-Fa-f]{6}$/.test(t))return"#"+t.toUpperCase();i.clearRect(0,0,r.width,r.height),i.fillStyle="#FFFFFF",i.fillStyle=t,i.fillRect(0,0,1,1);var t=i.getImageData(0,0,1,1).data,n=t[0],e=t[1],o=t[2],t=t[3];return"#"+u(n,t)+u(e,t)+u(o,t)}(n[o]),type:"choiceitem"});return e}function Qg(t){nh.add(t)}function Zg(t){n=$g(t).length;var n=Math.max(5,Math.ceil(Math.sqrt(n)));return t.getParam("color_cols",n,"number")}function tp(n,e,t,o){"custom"===t?op(n)(function(t){t.each(function(t){Qg(t),n.execCommand("mceApplyTextcolor",e,t),o(t)})},"#000000"):"remove"===t?(o(""),n.execCommand("mceRemoveTextcolor",e)):(o(t),n.execCommand("mceApplyTextcolor",e,t))}function np(n,e){return function(t){t(oh(n,e))}}function ep(t,n,e){t.setIconFill("forecolor"===n?"tox-icon-text-color__color":"tox-icon-highlight-bg-color__color",e)}function op(r){return function(e,t){var o=!1;r.windowManager.open({title:"Color Picker",size:"normal",body:{type:"panel",items:[{type:"colorpicker",name:"colorpicker",label:"Color"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:{colorpicker:t},onAction:function(t,n){"hex-valid"===n.name&&(o=n.value)},onSubmit:function(t){var n=t.getData().colorpicker;o?(e($.from(n)),t.close()):r.windowManager.alert(r.translate(["Invalid hex color code: {0}",n]))},onClose:K,onCancel:function(){e($.none())}})}}function rp(t,n,e,o,r,i,u,a){var c,s,l,f,d,m,g,p=$m(n),e=(s=e,l=o,f="color"!==r?"normal":"color",d=i,m=u,g=a,Kl(k(c=n,function(n){return"choiceitem"===n.type?Je("choicemenuitem",ig,n).fold(Qm,function(t){return $.some(function(n,t,e,o,r,i,u,a){void 0===a&&(a=!0);e=Ap({presets:e,textContent:t?n.text:$.none(),htmlContent:$.none(),ariaLabel:n.text,iconContent:n.icon,shortcutContent:t?n.shortcut:$.none(),checkMark:t?$.some(Ep(u.icons)):$.none(),caret:$.none(),value:n.value},u,a);return Oe(Op({data:_p(n),disabled:n.disabled,getApi:function(n){return{setActive:function(t){v.set(n,t)},isActive:function(){return v.isOn(n)},isDisabled:function(){return dt.isDisabled(n)},setDisabled:function(t){return dt.set(n,t)}}},onAction:function(t){return o(n.value)},onSetup:function(t){return t.setActive(r),K},triggersSubmenu:!1,itemBehaviours:[]},e,i,u),{toggling:{toggleClass:Nm,toggleOnExecute:!1,selected:n.active}})}(t,1===l,f,s,m(n.value),d,g,$m(c)))}):$.none()})));return tg(t,p,e,o,r)}function ip(t,n){var e=Ym(n);return 1===t?{mode:"menu",moveOnTab:!0}:"auto"===t?{mode:"grid",selector:"."+e.item,initSize:{numColumns:1,numRows:1}}:{mode:"matrix",rowSelector:"."+("color"===n?"tox-swatches__row":"tox-collection__group")}}function up(i,t,n){for(var e=[],o=0;o<t;o++){for(var r=[],u=0;u<n;u++)r.push(function(n,e){function t(t,n){n.stop(),r(t)}var o,r=function(t){return q(t,ah,{row:n,col:e})};return ou({dom:{tag:"div",attributes:((o={role:"button"})["aria-labelledby"]=i,o)},behaviours:it([st("insert-table-picker-cell",[et(Ko(),lt.focus),et(sr(),r),et(er(),t),et(fr(),t)]),v.config({toggleClass:"tox-insert-table-picker__selected",toggleOnExecute:!1}),lt.config({onFocus:function(t){return q(t,uh,{row:n,col:e})}})])})}(o,u));e.push(r)}return e}var ap,cp,sp,lp=function(t){return t.getParam("toolbar_location",Mg.auto,"string")},fp=function(t){return lp(t)===Mg.bottom},dp=function(t){var n;return t.inline?0<(n=t.getParam("fixed_toolbar_container","","string")).length?ua(Li(),n):(n=t.getParam("fixed_toolbar_container_target"),a(n)?$.some(nt.fromDom(n)):$.none()):$.none()},mp=function(t){return t.inline&&dp(t).isSome()},gp=function(t){return t.inline&&!Eg(t)&&!Dg(t)&&!Ag(t)},pp="silver.readonly",hp=m([ao("readonly",ro)]),vp=function(){var t;return qa.config({channels:((t={})[pp]={schema:hp,onReceive:function(t,n){dt.set(t,n.readonly)}},t)})},bp=function(t){return dt.config({disabled:t})},yp=function(t){return dt.config({disabled:t,disableClass:"tox-tbtn--disabled",useNative:!1})},xp=function(t,n){var e=t.getApi(n);return function(t){t(e)}},wp=function(n,e){return Fr(function(t){xp(n,t)(function(t){t=n.onSetup(t);C(t)&&e.set(t)})})},Sp=function(n,e){return Ir(function(t){return xp(n,t)(e.get())})},kp=((Od={})[sr()]=["disabling","alloy.base.behaviour","toggling","item-events"],Od),Cp=function(t){return Ot(t,function(t){return t.toArray()})},Op=function(t,n,e,o){var r,i,u=tt(K);return{type:"item",dom:n.dom,components:Cp(n.optComponents),data:t.data,eventOrder:kp,hasSubmenu:t.triggersSubmenu,itemBehaviours:it([st("item-events",[(r=t,i=e,Vr(function(t,n){xp(r,t)(r.onAction),r.triggersSubmenu||i!==Vm.CLOSE_ON_EXECUTE||(t.getSystem().isConnected()&&Y(t,mr()),n.stop())})),wp(t,u),Sp(t,u)]),dt.config({disabled:function(){return t.disabled||o.isDisabled()},disableClass:"tox-collection__item--state-disabled"}),vp(),ct.config({})].concat(t.itemBehaviours))}},_p=function(t){return{value:t.value,meta:J({text:t.text.getOr("")},t.meta)}},Tp=tinymce.util.Tools.resolve("tinymce.Env"),Ep=function(t){return{dom:{tag:"div",classes:["tox-collection__item-checkmark"],innerHtml:Kd("checkmark",t)}}},Dp=["list-num-default","list-num-lower-alpha","list-num-lower-greek","list-num-lower-roman","list-num-upper-alpha","list-num-upper-roman"],Bp=["list-bull-circle","list-bull-default","list-bull-square"],Ap=function(t,o,n,r){void 0===r&&(r=$.none());var e,i,u,a,c,s,l=vg.isRtl()&&t.iconContent.exists(function(t){return pt(Bp,t)}),f=t.iconContent.map(function(t){return vg.isRtl()&&pt(Dp,t)?t+"-rtl":t}).map(function(t){return t=t,n=o.icons,e=r,$.from(n()[t.toLowerCase()]).or(e).getOrThunk(function(){return bd(n)});var n,e}),d=$.from(t.meta).fold(function(){return Ng},function(t){return Se(t,"style")?M(jg,t.style):Ng});return"color"===t.presets?(s=t.ariaLabel,u=t.value,a=o,{dom:(c=f.getOr(""),s={tag:"div",attributes:s.map(function(t){return{title:a.translate(t)}}).getOr({}),classes:["tox-swatch"]},J(J({},s),"custom"===u?{tag:"button",classes:F(s.classes,["tox-swatches__picker-btn"]),innerHtml:c}:"remove"===u?{classes:F(s.classes,["tox-swatch--remove"]),innerHtml:c}:{attributes:J(J({},s.attributes),{"data-mce-color":u}),styles:{"background-color":u}})),optComponents:[]}):(e=t,i=d,c=l,s=n?f.or($.some("")).map(zg):$.none(),u=e.checkMark,t=e.htmlContent.fold(function(){return e.textContent.map(i)},function(t){return $.some(Lg(t,[Lm]))}),{dom:Wg(c,e.ariaLabel),optComponents:[s,t,e.shortcutContent.map(Ug),u,e.caret]})},Mp=function(t,n){return B(t,"tooltipWorker").map(function(e){return[pg.config({lazySink:n.getSink,tooltipDom:{tag:"div",classes:["tox-tooltip-worker-container"]},tooltipComponents:[],anchor:function(t){return{anchor:"submenu",item:t,overrides:{maxHeightFunction:cc}}},mode:"follow-highlight",onShow:function(n,t){e(function(t){pg.setComponents(n,[nu({element:nt.fromDom(t)})])})}})]}).getOr([])},Fp=as(Vd(),Pd()),Ip=function(t){return{value:t}},Rp=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,Vp=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,Pp=function(t){return Rp.test(t)||Vp.test(t)},Hp=function(t){t={value:t.value.replace(Rp,function(t,n,e,o){return n+n+e+e+o+o})},t=Vp.exec(t.value);return null===t?["FFFFFF","FF","FF","FF"]:t},zp=function(t){t=Yg(t.red)+Yg(t.green)+Yg(t.blue);return Ip(t)},Np=Math.min,Lp=Math.max,jp=Math.round,Up=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/,Wp=/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d?(?:\.\d+)?)\)/,Gp=function(t,n,e,o){return{red:t,green:n,blue:e,alpha:o}},Xp=function(t){var n=parseInt(t,10);return n.toString()===t&&0<=n&&n<=255},Yp=function(t){var n,e,o,r=(t.hue||0)%360,i=t.saturation/100,t=t.value/100,i=Lp(0,Np(i,1)),t=Lp(0,Np(t,1));if(0===i)n=e=o=jp(255*t);else{var r=r/60,u=t*i,a=u*(1-Math.abs(r%2-1)),i=t-u;switch(Math.floor(r)){case 0:n=u,e=a,o=0;break;case 1:n=a,e=u,o=0;break;case 2:n=0,e=u,o=a;break;case 3:n=0,e=a,o=u;break;case 4:n=a,e=0,o=u;break;case 5:n=u,e=0,o=a;break;default:n=e=o=0}n=jp(255*(n+i)),e=jp(255*(e+i)),o=jp(255*(o+i))}return Gp(n,e,o,1)},qp=function(t){var t=Hp(t),n=parseInt(t[1],16),e=parseInt(t[2],16),t=parseInt(t[3],16);return Gp(n,e,t,1)},Kp=function(t){return"rgba("+t.red+","+t.green+","+t.blue+","+t.alpha+")"},Jp=Gp(255,0,0,1),$p=tinymce.util.Tools.resolve("tinymce.util.LocalStorage"),Qp="tinymce-custom-colors",Zp="choiceitem",th=[{type:Zp,text:"Light Green",value:"#BFEDD2"},{type:Zp,text:"Light Yellow",value:"#FBEEB8"},{type:Zp,text:"Light Red",value:"#F8CAC6"},{type:Zp,text:"Light Purple",value:"#ECCAFA"},{type:Zp,text:"Light Blue",value:"#C2E0F4"},{type:Zp,text:"Green",value:"#2DC26B"},{type:Zp,text:"Yellow",value:"#F1C40F"},{type:Zp,text:"Red",value:"#E03E2D"},{type:Zp,text:"Purple",value:"#B96AD9"},{type:Zp,text:"Blue",value:"#3598DB"},{type:Zp,text:"Dark Turquoise",value:"#169179"},{type:Zp,text:"Orange",value:"#E67E23"},{type:Zp,text:"Dark Red",value:"#BA372A"},{type:Zp,text:"Dark Purple",value:"#843FA1"},{type:Zp,text:"Dark Blue",value:"#236FA1"},{type:Zp,text:"Light Gray",value:"#ECF0F1"},{type:Zp,text:"Medium Gray",value:"#CED4D9"},{type:Zp,text:"Gray",value:"#95A5A6"},{type:Zp,text:"Dark Gray",value:"#7E8C8D"},{type:Zp,text:"Navy Blue",value:"#34495E"},{type:Zp,text:"Black",value:"#000000"},{type:Zp,text:"White",value:"#ffffff"}],nh=(void 0===(cp=10)&&(cp=10),Vs=$p.getItem(Qp),Vs=y(Vs)?JSON.parse(Vs):[],sp=cp-(Vs=Vs).length<0?Vs.slice(0,cp):Vs,{add:function(t){var n;(-1===(n=gt(sp,t))?$.none():$.some(n)).each(dh),sp.unshift(t),sp.length>cp&&sp.pop(),$p.setItem(Qp,JSON.stringify(sp))},state:function(){return sp.slice(0)}}),eh=function(i){i.addCommand("mceApplyTextcolor",function(t,n){var e,o=t,r=n;(e=i).undoManager.transact(function(){e.focus(),e.formatter.apply(o,{value:r}),e.nodeChanged()})}),i.addCommand("mceRemoveTextcolor",function(t){var n,e=t;(n=i).undoManager.transact(function(){n.focus(),n.formatter.remove(e,{value:null},null,!0),n.nodeChanged()})})},oh=function(t,n){return t.concat(k(nh.state(),function(t){return{type:Zp,text:t,value:t}}).concat((t={type:"choiceitem",text:"Remove color",icon:"color-swatch-remove-color",value:"remove"},n?[t,{type:"choiceitem",text:"Custom color",icon:"color-picker",value:"custom"}]:[t])))},rh=function(r,e,i,t,o){r.ui.registry.addSplitButton(e,{tooltip:t,presets:"color",icon:"forecolor"===e?"text-color":"highlight-bg-color",select:function(e){var n,o;return $.from((n=i,r.dom.getParents(r.selection.getStart(),function(t){(t=t.style["forecolor"===n?"color":"background-color"])&&(o=o||t)}),o)).bind(function(t){return("transparent"===(t=t)?$.some(Gp(0,0,0,0)):null!==(n=Up.exec(t))?$.some(qg(n[1],n[2],n[3],"1")):null!==(n=Wp.exec(t))?$.some(qg(n[1],n[2],n[3],n[4])):$.none()).map(function(t){t=zp(t).value;return gn(e.toLowerCase(),t)});var n}).getOr(!1)},columns:Zg(r),fetch:np($g(r),Jg(r)),onAction:function(t){null!==o.get()&&tp(r,i,o.get(),K)},onItemAction:function(t,n){tp(r,i,n,function(t){o.set(t),r.fire("TextColorChange",{name:e,color:t})})},onSetup:function(n){null!==o.get()&&ep(n,e,o.get());function t(t){t.name===e&&ep(n,t.name,t.color)}return r.on("TextColorChange",t),function(){r.off("TextColorChange",t)}}})},ih=function(n,t,e,o){n.ui.registry.addNestedMenuItem(t,{text:o,icon:"forecolor"===t?"text-color":"highlight-bg-color",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"colorswatch",onAction:function(t){tp(n,e,t.value,K)}}]}})},uh=_("cell-over"),ah=_("cell-execute"),ch={inserttable:function(o){var t=_("size-label"),s=up(t,10,10),l=ft({dom:{tag:"span",classes:["tox-insert-table-picker__label"],attributes:{id:t}},components:[tu("0x0")],behaviours:it([ct.config({})])});return{type:"widget",data:{value:_("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[Fp.widget({dom:{tag:"div",classes:["tox-insert-table-picker"]},components:Ot(s,function(t){return k(t,ru)}).concat(l.asSpec()),behaviours:it([st("insert-table-picker",[Bn(uh,function(t,n,e){for(var o=e.event.row,e=e.event.col,r=s,i=o,u=e,a=0;a<10;a++)for(var c=0;c<10;c++)v.set(r[a][c],a<=i&&c<=u);ct.set(l.get(t),[tu(e+1+"x"+(o+1))])}),Bn(ah,function(t,n,e){o.onAction({numRows:e.event.row+1,numColumns:e.event.col+1}),Y(t,mr())})]),at.config({initSize:{numRows:10,numColumns:10},mode:"flatgrid",selector:'[role="button"]'})])})]}},colorswatch:function(n,t){var e=oh(t.colorinput.getColors(),t.colorinput.hasCustomColors()),o=t.colorinput.getColorCols(),e=rp(_("menu-value"),e,function(t){n.onAction({value:t})},o,"color",Vm.CLOSE_ON_EXECUTE,d,t.shared.providers),t=J(J({},e),{markers:Ym("color"),movement:ip(o,"color")});return{type:"widget",data:{value:_("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[Fp.widget(Nd.sketch(t))]}}},sh=function(n,e,t,o,r,i,u,a){void 0===a&&(a=!0);o=Ap({presets:o,textContent:$.none(),htmlContent:t?n.text.map(function(t){return Gg(t,e)}):$.none(),ariaLabel:n.text,iconContent:n.icon,shortcutContent:$.none(),checkMark:$.none(),caret:$.none(),value:n.value},u.providers,a,n.icon);return Op({data:_p(n),disabled:n.disabled,getApi:X({}),onAction:function(t){return r(n.value,n.meta)},onSetup:X(K),triggersSubmenu:!1,itemBehaviours:Mp(n.meta,u)},o,i,u.providers)},lh=function(t){t=t.text.fold(function(){return{}},function(t){return{innerHtml:t}});return{type:"separator",dom:J({tag:"div",classes:[Hm,"tox-collection__group-heading"]},t),components:[]}},fh=function(t,n,e,o){var r={dom:Wg(!1,t.label),optComponents:[$.some({dom:{tag:"div",classes:[Wm,Gm]},components:Xg(t.items,o)})]};return Op({data:_p(J({text:$.none()},t)),disabled:t.disabled,getApi:function(e){return{isDisabled:function(){return dt.isDisabled(e)},setDisabled:function(n){dt.set(e,n),Q(tl(e.element,"*"),function(t){e.getSystem().getByDom(t).each(function(t){t.hasConfigured(dt)&&dt.set(t,n)})})}}},onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:$.from(o.itemBehaviours).getOr([])},r,n,e.providers)};function dh(t){sp.splice(t,1)}ap={ContentFocus:0,0:"ContentFocus",UiFocus:1,1:"UiFocus"};function mh(t,n,e,o,r){var i=$m(n),n=Kl(k(n,function(t){function n(t){return _h(t,e,o,r?!t.hasOwnProperty("text"):i,r)}return"nestedmenuitem"===t.type&&t.getSubmenuItems().length<=0?n(J(J({},t),{disabled:!0})):n(t)}));return(r?Zm:tg)(t,i,n,1,"normal")}function gh(t){return Gd.singleData(t.value,t)}function ph(d,m){function g(t){var n=t;r.get().map(function(t){return km(d.dom,d.selection.getRng(),t.triggerChar).bind(function(t){return _m(d,u,t,n)})}).getOrThunk(function(){return n=d,t=(e=u)(),o=n.selection.getRng(),r=n.dom,i=o,Mt(t.triggerChars,function(t){return km(r,i,t)}).bind(function(t){return _m(n,e,t)});var n,e,t,o,r,i}).fold(b,function(f){var t,e,n,o=f.context;i()||(e=d,n=o.range,t=ym(nt.fromDom(e.selection.getNode())).getOrThunk(function(){var t=nt.fromHtml('<span data-mce-autocompleter="1" data-mce-bogus="1"></span>',e.getDoc());return ni(t,nt.fromDom(n.extractContents())),n.insertNode(t.dom),Gr(t).each(function(t){return t.dom.normalize()}),Zs(t,Qs).map(function(t){var n;e.selection.setCursorLocation(t.dom,"img"===Pr(n=t)?1:Js(n).fold(function(){return qr(n).length},function(t){return t.length}))}),t}),r.set($.some({triggerChar:o.triggerChar,element:t,matchLength:o.text.length})),p.set(!1)),f.lookupData.then(function(c){r.get().map(function(t){var s,l,n,e,o,r,i,u,a=f.context;t.triggerChar===a.triggerChar&&(s=a.triggerChar,l=Mt(r=c,function(t){return $.from(t.columns)}).getOr(1),0<(r=Ot(r,function(r){var e,o,i,u,a,n,c,t=r.items;return t=t,e=r.matchText,o=function(e,o){var t=d.selection.getRng();km(d.dom,t,s).fold(function(){return console.error("Lost context. Cursor probably moved")},function(t){var t=t.range,n={hide:function(){b()},reload:function(t){v(),g(t)}};p.set(!0),r.onAction(n,t,e,o),p.set(!1)})},i=Vm.BUBBLE_TO_SANDBOX,u=m,a=r.highlightOn,c=!(n=1===l)||$m(t),Kl(k(t,function(t){switch(t.type){case"separator":return Je("Autocompleter.Separator",Tm,t).fold(Qm,function(t){return $.some(lh(t))});case"cardmenuitem":return Je("cardmenuitem",rg,t).fold(Qm,function(n){return $.some(fh(J(J({},n),{onAction:function(t){n.onAction(t),o(n.value,n.meta)}}),i,u,{itemBehaviours:Mp(n.meta,u),cardText:{matchText:e,highlightOn:a}}))});default:return Je("Autocompleter.Item",Em,t).fold(Qm,function(t){return $.some(sh(t,e,n,"normal",o,i,u,c))})}}))})).length?(e=a,o=c,r=r,(n=t).matchLength=e.text.length,e=Mt(o,function(t){return $.from(t.columns)}).getOr(1),Xd.showAt(h,{anchor:"node",root:nt.fromDom(d.getBody()),node:$.from(n.element)},Nd.sketch((o=tg("autocompleter-value",!0,r,e,"normal"),n=e,e=((r=ap.ContentFocus)===ap.ContentFocus?ff:lf)(),i=ip(n,"normal"),u=Ym("normal"),{dom:o.dom,components:o.components,items:o.items,value:o.value,markers:{selectedItem:u.selectedItem,item:u.item},movement:i,fakeFocus:r===ap.ContentFocus,focusManager:e,menuBehaviours:fg("auto"!==n?[]:[Fr(function(e,t){cm(e,4,u.item).each(function(t){var n=t.numColumns,t=t.numRows;at.setGridSize(e,t,n)})})])}))),Xd.getContent(h).each($l.highlightFirst)):(10<=a.text.length-t.matchLength?b:v)())})})})}var r=tt($.none()),p=tt(!1),h=ou(Xd.sketch({dom:{tag:"div",classes:["tox-autocompleter"]},components:[],fireDismissalEventInstead:{},inlineBehaviours:it([st("dismissAutocompleter",[et(Sr(),function(){return b()})])]),lazySink:m.getSink})),i=function(){return r.get().isSome()},v=function(){i()&&Xd.hide(h)},b=function(){var t;i()&&(t=r.get().map(function(t){return t.element}),ym(t.getOr(nt.fromDom(d.selection.getNode()))).each(Hn),v(),r.set($.none()),p.set(!1))},u=Te(function(){return t=(t=d).ui.registry.getAll().popups,t=be(t,function(t){return Je("Autocompleter",Dm,t).fold(function(t){throw new Error(Ze(t))},function(t){return t})}),e=xe(t,function(t){return t.ch}),n={},Q(e,function(t){n[t]={}}),e=pe(n),o=we(t),{dataset:t,triggerChars:e,lookupByChar:function(n){return yt(o,function(t){return t.ch===n})}};var t,n,e,o}),t={onKeypress:Qd(function(t){27!==t.which&&g()},50),cancelIfNecessary:b,isMenuOpen:function(){return Xd.isOpen(h)},isActive:i,isProcessingAction:p.get,getView:function(){return Xd.getContent(h)}};!1===d.hasPlugin("rtc")&&nm(t,d)}function hh(t,n,e){return hu(t,n,Th,e,!0)}function vh(e,o){var r=null;return{cancel:function(){null!==r&&(clearTimeout(r),r=null)},schedule:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];r=setTimeout(function(){e.apply(null,t),r=null},o)}}}function bh(t){return void 0===(t=t.raw).touches||1!==t.touches.length?$.none():$.some(t.touches[0])}function yh(){return Ao().browser.isFirefox()}function xh(n,e,o,t,r,i){return Rh(n,e,o,t,r,i).fold(E,function(t){return xh(n,e,o,t,r,i)},d)}function wh(e){function o(n){return Gr(e.element).fold(E,function(t){return Io(n,t)})}function c(t,n){return i.find(o,t,n)}function r(n){var t=i.filter(cr());Q(t,function(t){t=t.descHandler;Ei(t)(n)})}var i=Hh(),t=Mh(e.element,{triggerEvent:function(n,e){return da(n,e.target,function(t){return Ph(c,n,e,e.target,t)})}}),u={debugInfo:X("real"),triggerEvent:function(n,e,o){da(n,e,function(t){return Ph(c,n,o,e,t)})},triggerFocus:function(u,a){hi(u).fold(function(){Ka(u)},function(t){da(ir(),u,function(t){var n,e,o=c,r=ir(),i=Fh(n={originator:a,kill:K,prevent:K,target:u},e=u);return Rh(o,r,n,e,i,t),!1})})},triggerEscape:function(t,n){u.triggerEvent("keydown",t.element,n.event)},getByUid:function(t){return g(t)},getByDom:function(t){return p(t)},build:ou,addToGui:function(t){s(t)},removeFromGui:function(t){l(t)},addToWorld:function(t){n(t)},removeFromWorld:function(t){a(t)},broadcast:function(t){f(t)},broadcastOn:function(t,n){d(t,n)},broadcastEvent:function(t,n){m(t,n)},isConnected:E},n=function(t){t.connect(u),zr(t.element)||(i.register(t),Q(t.components(),n),u.triggerEvent(pr(),t.element,{target:t.element}))},a=function(t){zr(t.element)||(Q(t.components(),a),i.unregister(t)),t.disconnect()},s=function(t){gl(e,t)},l=function(t){hl(t)},f=function(t){r({universal:!0,data:t})},d=function(t,n){r({universal:!1,channels:t,data:n})},m=function(t,n){t=i.filter(t);return Vh(t,n)},g=function(t){return i.getById(t).fold(function(){return Z.error(new Error('Could not find component with uid: "'+t+'" in system.'))},Z.value)},p=function(t){t=hi(t).getOr("not found");return g(t)};return n(e),{root:e,element:e.element,destroy:function(){t.unbind(),ri(e.element)},add:s,remove:l,getByUid:g,getByDom:p,addToWorld:n,removeFromWorld:a,broadcast:f,broadcastOn:d,broadcastEvent:m}}function Sh(t){return{tag:"div",classes:["tox-form__group"].concat(t)}}function kh(i,u){function t(o){return function(n,e){aa(e.event.target,"[data-collection-item-value]").each(function(t){o(n,e,t,ai(t,"data-collection-item-value"))})}}function n(t,n){k(tl(t.element,".tox-collection__item"),n)}var e,o=i.label.map(function(t){return Wh(t,u)}),r=t(function(t,n,e,o){n.stop(),u.isDisabled()||q(t,qh,{name:i.name,value:o})}),r=[et(Ko(),t(function(t,n,e){Ka(e)})),et(er(),r),et(fr(),r),et(Jo(),t(function(t,n,e){ua(t.element,"."+Um).each(function(t){Ri(t,Um)}),Fi(e,Um)})),et($o(),t(function(t){ua(t.element,"."+Um).each(function(t){Ri(t,Um)})})),Vr(t(function(t,n,e,o){q(t,qh,{name:i.name,value:o})}))],r=x.parts.field({dom:{tag:"div",classes:["tox-collection"].concat(1!==i.columns?["tox-collection--grid"]:["tox-collection--list"])},components:[],factory:{sketch:A},behaviours:it([dt.config({disabled:u.isDisabled,onDisabled:function(t){n(t,function(t){Fi(t,"tox-collection__item--state-disabled"),ot(t,"aria-disabled",!0)})},onEnabled:function(t){n(t,function(t){Ri(t,"tox-collection__item--state-disabled"),si(t,"aria-disabled")})}}),vp(),ct.config({}),ut.config({store:{mode:"memory",initialValue:[]},onSetValue:function(e,t){var n=e,t=k(t,function(t){var n=vg.translate(t.text),e=1===i.columns?'<div class="tox-collection__item-label">'+n+"</div>":"",o='<div class="tox-collection__item-icon">'+t.icon+"</div>",r={_:" "," - ":" ","-":" "},n=n.replace(/\_| \- |\-/g,function(t){return r[t]});return'<div class="tox-collection__item'+(u.isDisabled()?" tox-collection__item--state-disabled":"")+'" tabindex="-1" data-collection-item-value="'+Lh.encodeAllRaw(t.value)+'" title="'+n+'" aria-label="'+n+'">'+o+e+"</div>"}),t="auto"!==i.columns&&1<i.columns?V(t,i.columns):[t],t=k(t,function(t){return'<div class="tox-collection__group">'+t.join("")+"</div>"});zn(n.element,t.join("")),"auto"===i.columns&&cm(e,5,"tox-collection__item").each(function(t){var n=t.numRows,t=t.numColumns;at.setGridSize(e,n,t)}),Y(e,Zh)}}),Nh.config({}),at.config(1===(e=i.columns)?{mode:"menu",moveOnTab:!1,selector:".tox-collection__item"}:"auto"===e?{mode:"flatgrid",selector:".tox-collection__item",initSize:{numColumns:1,numRows:1}}:{mode:"matrix",selectors:{row:".tox-collection__group",cell:"."+Hm}}),st("collection-events",r)]),eventOrder:((e={})[sr()]=["disabling","alloy.base.behaviour","collection-events"],e)});return jh(o,r,["tox-form__group--collection"],[])}function Ch(t){return it([lt.config({onFocus:t.selectOnFocus?function(t){var t=t.element,n=Qi(t);t.dom.setSelectionRange(0,n.length)}:K})])}function Oh(t){return{tag:t.tag,attributes:J({type:"text"},t.inputAttributes),styles:t.inputStyles,classes:t.inputClasses}}var _h=function(t,n,r,e,o){function i(t){return o?J(J({},t),{shortcut:$.none(),icon:t.text.isSome()?$.none():t.icon}):t}var u=r.shared.providers;switch(t.type){case"menuitem":return Je("menuitem",ag,t).fold(Qm,function(t){return $.some(function(t,n,e,o){void 0===o&&(o=!0);o=Ap({presets:"normal",iconContent:t.icon,textContent:t.text,htmlContent:$.none(),ariaLabel:t.text,caret:$.none(),checkMark:$.none(),shortcutContent:t.shortcut},e,o);return Op({data:_p(t),getApi:function(n){return{isDisabled:function(){return dt.isDisabled(n)},setDisabled:function(t){return dt.set(n,t)}}},disabled:t.disabled,onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},o,n,e)}(i(t),n,u,e))});case"nestedmenuitem":return Je("nestedmenuitem",cg,t).fold(Qm,function(t){return $.some(function(t,n,e,o,r){void 0===o&&(o=!0);r=(r=void 0===r?!1:r)?(r=e.icons,{dom:{tag:"div",classes:[jm],innerHtml:Kd("chevron-down",r)}}):(r=e.icons,{dom:{tag:"div",classes:[jm],innerHtml:Kd("chevron-right",r)}}),r=Ap({presets:"normal",iconContent:t.icon,textContent:t.text,htmlContent:$.none(),ariaLabel:t.text,caret:$.some(r),checkMark:$.none(),shortcutContent:t.shortcut},e,o);return Op({data:_p(t),getApi:function(n){return{isDisabled:function(){return dt.isDisabled(n)},setDisabled:function(t){return dt.set(n,t)}}},disabled:t.disabled,onAction:K,onSetup:t.onSetup,triggersSubmenu:!0,itemBehaviours:[]},r,n,e)}(i(t),n,u,e,o))});case"togglemenuitem":return Je("togglemenuitem",sg,t).fold(Qm,function(t){return $.some(function(t,n,e,o){void 0===o&&(o=!0);o=Ap({iconContent:t.icon,textContent:t.text,htmlContent:$.none(),ariaLabel:t.text,checkMark:$.some(Ep(e.icons)),caret:$.none(),shortcutContent:t.shortcut,presets:"normal",meta:t.meta},e,o);return Oe(Op({data:_p(t),disabled:t.disabled,getApi:function(n){return{setActive:function(t){v.set(n,t)},isActive:function(){return v.isOn(n)},isDisabled:function(){return dt.isDisabled(n)},setDisabled:function(t){return dt.set(n,t)}}},onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},o,n,e),{toggling:{toggleClass:Nm,toggleOnExecute:!1,selected:t.active}})}(i(t),n,u,e))});case"separator":return Je("separatormenuitem",Tm,t).fold(Qm,function(t){return $.some(lh(t))});case"fancymenuitem":return Je("fancymenuitem",ug,t).fold(Qm,function(t){return n=i(t),e=r,t=ch,o=n.fancytype,(Object.prototype.hasOwnProperty.call(t,o)?$.some(t[o]):$.none()).map(function(t){return t(n,e)});var n,e,o});default:return console.error("Unknown item in general menu",t),$.none()}},Th=E,Eh=function(t,n,e){return hu(t,n,Th,e,!1)},Dh=pu,Bh=function(t,n,e){return aa(t,n,e).isSome()},Ah=je([$t("triggerEvent"),b("stopBackspace",!0)]),Mh=function(n,t){var e,o,r,i,u,a,c=Qe("Getting GUI events settings",Ah,t),s=(o=c,r=tt($.none()),i=tt(!1),u=vh(function(t){o.triggerEvent(dr(),t),i.set(!0)},400),a=Ht([{key:Lo(),value:function(n){return bh(n).each(function(t){u.cancel();t={x:t.clientX,y:t.clientY,target:n.target};u.schedule(n),i.set(!1),r.set($.some(t))}),$.none()}},{key:jo(),value:function(t){return u.cancel(),bh(t).each(function(o){r.get().each(function(t){var n=o,e=Math.abs(n.clientX-t.x),n=Math.abs(n.clientY-t.y);(5<e||5<n)&&r.set($.none())})}),$.none()}},{key:Uo(),value:function(n){return u.cancel(),r.get().filter(function(t){return Io(t.target,n.target)}).map(function(t){return i.get()?(n.prevent(),!1):o.triggerEvent(fr(),n)})}}]),{fireIfReady:function(n,t){return B(a,t).bind(function(t){return t(n)})}}),l=k(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),function(t){return Eh(n,t,function(n){s.fireIfReady(n,t).each(function(t){t&&n.kill()}),c.triggerEvent(t,n)&&n.kill()})}),f=tt($.none()),d=Eh(n,"paste",function(n){s.fireIfReady(n,"paste").each(function(t){t&&n.kill()}),c.triggerEvent("paste",n)&&n.kill(),f.set($.some(setTimeout(function(){c.triggerEvent(ar(),n)},0)))}),m=Eh(n,"keydown",function(t){var n;c.triggerEvent("keydown",t)?t.kill():!0!==c.stopBackspace||(n=t).raw.which!==Ql[0]||pt(["input","textarea"],Pr(n.target))||Bh(n.target,'[contenteditable="true"]')||t.prevent()}),g=(t=n,e=function(t){c.triggerEvent("focusin",t)&&t.kill()},yh()?hh(t,"focus",e):Eh(t,"focusin",e)),p=tt($.none()),h=(t=n,e=function(t){c.triggerEvent("focusout",t)&&t.kill(),p.set($.some(setTimeout(function(){c.triggerEvent(ur(),t)},0)))},yh()?hh(t,"blur",e):Eh(t,"focusout",e));return{unbind:function(){Q(l,function(t){t.unbind()}),m.unbind(),g.unbind(),h.unbind(),d.unbind(),f.get().each(clearTimeout),p.get().each(clearTimeout)}}},Fh=function(t,n){t=B(t,"target").getOr(n);return tt(t)},Ih=Rt([{stopped:[]},{resume:["element"]},{complete:[]}]),Rh=function(t,o,n,e,r,i){var u,a,t=t(o,e),c=(n=n,r=r,u=tt(!1),a=tt(!1),{stop:function(){u.set(!0)},cut:function(){a.set(!0)},isStopped:u.get,isCut:a.get,event:n,setSource:r.set,getSource:r.get});return t.fold(function(){return i.logEventNoHandlers(o,e),Ih.complete()},function(n){var e=n.descHandler;return Ei(e)(c),c.isStopped()?(i.logEventStopped(o,n.element,e.purpose),Ih.stopped()):c.isCut()?(i.logEventCut(o,n.element,e.purpose),Ih.complete()):Gr(n.element).fold(function(){return i.logNoParent(o,n.element,e.purpose),Ih.complete()},function(t){return i.logEventResponse(o,n.element,e.purpose),Ih.resume(t)})})},Vh=function(t,n,e){n=n,o=tt(!1);var o,r={stop:function(){o.set(!0)},cut:K,isStopped:o.get,isCut:d,event:n,setSource:l("Cannot set source of a broadcasted event"),getSource:l("Cannot get source of a broadcasted event")};return Q(t,function(t){t=t.descHandler;Ei(t)(r)}),r.isStopped()},Ph=function(t,n,e,o,r){var i=Fh(e,o);return xh(t,n,e,o,i,r)},Hh=function(){function i(t){hi(t.element).each(function(t){delete c[t],a.unregisterId(t)})}u={};var u,a={registerId:function(o,r,t){ve(t,function(t,n){var e=void 0!==u[n]?u[n]:{};e[r]={cHandler:M.apply(void 0,[(t=t).handler].concat(o)),purpose:t.purpose},u[n]=e})},unregisterId:function(e){ve(u,function(t,n){t.hasOwnProperty(e)&&delete t[e]})},filterByType:function(t){return B(u,t).map(function(t){return xe(t,function(t,n){return{id:n,descHandler:t}})}).getOr([])},find:function(t,n,e){var r=B(u,n);return wn(e,function(t){return e=r,hi(o=t).fold(function(){return $.none()},function(n){return e.bind(function(t){return B(t,n)}).map(function(t){return{element:o,descHandler:t}})});var e,o},t)}},c={};return{find:function(t,n,e){return a.find(t,n,e)},filter:function(t){return a.filterByType(t)},register:function(t){n=(e=t).element;var e,n=hi(n).fold(function(){return t=e.element,n=_(mi+"uid-"),pi(t,n),n;var t,n},function(t){return t});if(ke(c,n)){var o=t,r=c[n];if(r!==o)throw new Error('The tagId "'+n+'" is already used by: '+Ln(r.element)+"\nCannot use it for: "+Ln(o.element)+"\nThe conflicting element is"+(Ni(r.element)?" ":" not ")+"already in the DOM");i(o)}a.registerId([t],n,t.events),c[n]=t},unregister:i,getById:function(t){return B(c,t)}}},zh=ql({name:"Container",factory:function(t){var n=t.dom,e=n.attributes,n=D(n,["attributes"]);return{uid:t.uid,dom:J({tag:"div",attributes:J({role:"presentation"},e)},n),components:t.components,behaviours:ts(t.containerBehaviours),events:t.events,domModification:t.domModification,eventOrder:t.eventOrder}},configFields:[b("components",[]),Zc("containerBehaviours",[]),b("events",{}),b("domModification",{}),b("eventOrder",{})]}),Dd=X([b("prefix","form-field"),Zc("fieldBehaviours",[T,ut])]),Td=X([Vl({schema:[g("dom")],name:"label"}),Vl({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:t.text}}}},schema:[g("text")],name:"aria-descriptor"}),Rl({factory:{sketch:function(t){e=["factory"],o={},ve(t,function(t,n){pt(e,n)||(o[n]=t)});var e,o,n=o;return t.factory.sketch(n)}},schema:[g("factory")],name:"field"})]),x=hs({name:"FormField",configFields:Dd(),partFields:Td(),factory:function(r,t,n,e){var o=ns(r.fieldBehaviours,[T.config({find:function(t){return Ll(t,r,"field")}}),ut.config({store:{mode:"manual",getValue:function(t){return T.getCurrent(t).bind(ut.getValue)},setValue:function(t,n){T.getCurrent(t).each(function(t){ut.setValue(t,n)})}}})]),i=Ar([Fr(function(t,n){var o=ls(t,r,["label","field","aria-descriptor"]);o.field().each(function(e){var n=_(r.prefix);o.label().each(function(t){ot(t.element,"for",n),ot(e.element,"id",n)}),o["aria-descriptor"]().each(function(t){var n=_(r.prefix);ot(t.element,"id",n),ot(e.element,"aria-describedby",n)})})})]);return{uid:r.uid,dom:r.dom,components:t,behaviours:o,events:i,apis:{getField:function(t){return Ll(t,r,"field")},getLabel:function(t){return Ll(t,r,"label")}}}},apis:{getField:function(t,n){return t.getField(n)},getLabel:function(t,n){return t.getLabel(n)}}}),di=Object.freeze({__proto__:null,exhibit:function(t,n){return Ti({attributes:Ht([{key:n.tabAttr,value:"true"}])})}}),bo=[b("tabAttr","data-alloy-tabstop")],Nh=Wu({fields:bo,name:"tabstopping",active:di}),Lh=tinymce.util.Tools.resolve("tinymce.html.Entities"),jh=function(t,n,e,o){t=Uh(t,n,e,o);return x.sketch(t)},Uh=function(t,n,e,o){return{dom:Sh(e),components:t.toArray().concat([n]),fieldBehaviours:it(o)}},Wh=function(t,n){return x.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}})},Gh=_("form-component-change"),Xh=_("form-close"),Yh=_("form-cancel"),qh=_("form-action"),Kh=_("form-submit"),Jh=_("form-block"),$h=_("form-unblock"),Qh=_("form-tabchange"),Zh=_("form-resize"),Il=X([p("data"),b("inputAttributes",{}),b("inputStyles",{}),b("tag","input"),b("inputClasses",[]),t("onSetValue"),b("styles",{}),b("eventOrder",{}),Zc("inputBehaviours",[ut,lt]),b("selectOnFocus",!0)]),tv=ql({name:"Input",configFields:Il(),factory:function(t,n){return{uid:t.uid,dom:Oh(t),components:[],behaviours:J(J({},Ch(e=t)),ns(e.inputBehaviours,[ut.config({store:J(J({mode:"manual"},e.data.map(function(t){return{initialValue:t}}).getOr({})),{getValue:function(t){return Qi(t.element)},setValue:function(t,n){Qi(t.element)!==n&&Kn(t.element,n)}}),onSetValue:e.onSetValue})])),eventOrder:t.eventOrder};var e}}),vo={},Fl={exports:vo},nv=vo,ev=Fl,ov=void 0;(function(t){"object"==typeof nv&&void 0!==ev?ev.exports=t():("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=t()})(function(){return function o(r,i,u){function a(n,t){if(!i[n]){if(!r[n]){var e="function"==typeof ov&&ov;if(!t&&e)return e(n,!0);if(c)return c(n,!0);t=new Error("Cannot find module '"+n+"'");throw t.code="MODULE_NOT_FOUND",t}e=i[n]={exports:{}};r[n][0].call(e.exports,function(t){return a(r[n][1][t]||t)},e,e.exports,o,r,i,u)}return i[n].exports}for(var c="function"==typeof ov&&ov,t=0;t<u.length;t++)a(u[t]);return a}({1:[function(t,n,e){var o,r,n=n.exports={};function i(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}function a(n){if(o===setTimeout)return setTimeout(n,0);if((o===i||!o)&&setTimeout)return(o=setTimeout)(n,0);try{return o(n,0)}catch(t){try{return o.call(null,n,0)}catch(t){return o.call(this,n,0)}}}try{o="function"==typeof setTimeout?setTimeout:i}catch(t){o=i}try{r="function"==typeof clearTimeout?clearTimeout:u}catch(t){r=u}var c,s=[],l=!1,f=-1;function d(){l&&c&&(l=!1,c.length?s=c.concat(s):f=-1,s.length)&&m()}function m(){if(!l){var t=a(d);l=!0;for(var n=s.length;n;){for(c=s,s=[];++f<n;)c&&c[f].run();f=-1,n=s.length}c=null,l=!1,function(n){if(r===clearTimeout)return clearTimeout(n);if((r===u||!r)&&clearTimeout)return(r=clearTimeout)(n);try{r(n)}catch(t){try{return r.call(null,n)}catch(t){return r.call(this,n)}}}(t)}}function g(t,n){this.fun=t,this.array=n}function p(){}n.nextTick=function(t){var n=new Array(arguments.length-1);if(1<arguments.length)for(var e=1;e<arguments.length;e++)n[e-1]=arguments[e];s.push(new g(t,n)),1!==s.length||l||a(m)},g.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},{}],2:[function(t,f,n){!function(n){function o(){}function i(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],l(t,this)}function r(e,o){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,i._immediateFn(function(){var t,n=1===e._state?o.onFulfilled:o.onRejected;if(null!==n){try{t=n(e._value)}catch(t){return void a(o.promise,t)}u(o.promise,t)}else(1===e._state?u:a)(o.promise,e._value)})):e._deferreds.push(o)}function u(n,t){try{if(t===n)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var e=t.then;if(t instanceof i)return n._state=3,n._value=t,c(n);if("function"==typeof e)return l((o=e,r=t,function(){o.apply(r,arguments)}),n)}n._state=1,n._value=t,c(n)}catch(t){a(n,t)}var o,r}function a(t,n){t._state=2,t._value=n,c(t)}function c(t){2===t._state&&0===t._deferreds.length&&i._immediateFn(function(){t._handled||i._unhandledRejectionFn(t._value)});for(var n=0,e=t._deferreds.length;n<e;n++)r(t,t._deferreds[n]);t._deferreds=null}function s(t,n,e){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof n?n:null,this.promise=e}function l(t,n){var e=!1;try{t(function(t){e||(e=!0,u(n,t))},function(t){e||(e=!0,a(n,t))})}catch(t){e||(e=!0,a(n,t))}}var e=setTimeout;i.prototype.catch=function(t){return this.then(null,t)},i.prototype.then=function(t,n){var e=new this.constructor(o);return r(this,new s(t,n,e)),e},i.all=function(t){var a=Array.prototype.slice.call(t);return new i(function(r,i){if(0===a.length)return r([]);for(var u=a.length,t=0;t<a.length;t++)!function n(e,t){try{if(t&&("object"==typeof t||"function"==typeof t)){var o=t.then;if("function"==typeof o)return o.call(t,function(t){n(e,t)},i),0}a[e]=t,0==--u&&r(a)}catch(t){i(t)}}(t,a[t])})},i.resolve=function(n){return n&&"object"==typeof n&&n.constructor===i?n:new i(function(t){t(n)})},i.reject=function(e){return new i(function(t,n){n(e)})},i.race=function(r){return new i(function(t,n){for(var e=0,o=r.length;e<o;e++)r[e].then(t,n)})},i._immediateFn="function"==typeof n?function(t){n(t)}:function(t){e(t,0)},i._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},i._setImmediateFn=function(t){i._immediateFn=t},i._setUnhandledRejectionFn=function(t){i._unhandledRejectionFn=t},void 0!==f&&f.exports?f.exports=i:this.Promise||(this.Promise=i)}.call(this,t("timers").setImmediate)},{timers:3}],3:[function(c,t,s){!function(t,n){var o=c("process/browser.js").nextTick,e=Function.prototype.apply,r=Array.prototype.slice,i={},u=0;function a(t,n){this._id=t,this._clearFn=n}s.setTimeout=function(){return new a(e.call(setTimeout,window,arguments),clearTimeout)},s.setInterval=function(){return new a(e.call(setInterval,window,arguments),clearInterval)},s.clearTimeout=s.clearInterval=function(t){t.close()},a.prototype.unref=a.prototype.ref=function(){},a.prototype.close=function(){this._clearFn.call(window,this._id)},s.enroll=function(t,n){clearTimeout(t._idleTimeoutId),t._idleTimeout=n},s.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},s._unrefActive=s.active=function(t){clearTimeout(t._idleTimeoutId);var n=t._idleTimeout;0<=n&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},n))},s.setImmediate="function"==typeof t?t:function(t){var n=u++,e=!(arguments.length<2)&&r.call(arguments,1);return i[n]=!0,o(function(){i[n]&&(e?t.apply(null,e):t.call(null),s.clearImmediate(n))}),n},s.clearImmediate="function"==typeof n?n:function(t){delete i[t]}}.call(this,c("timers").setImmediate,c("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(t,n,e){var t=t("promise-polyfill"),o="undefined"!=typeof window?window:Function("return this;")();n.exports={boltExport:o.Promise||t}},{"promise-polyfill":2}]},{},[4])(4)});function rv(t){function o(t){n()?e(t):i.push(t)}function n(){return r.isSome()}function e(n){r.each(function(t){setTimeout(function(){n(t)},0)})}var r=$.none(),i=[];return t(function(t){n()||(r=$.some(t),Q(i,e),i=[])}),{get:o,map:function(e){return rv(function(n){o(function(t){n(e(t))})})},isReady:n}}function iv(t){setTimeout(function(){throw t},0)}function uv(t){return t=Pr(t),pt(vv,t)}function av(t,n){var e=n.getRoot(t).getOr(t.element);Ri(e,n.invalidClass),n.notify.each(function(n){uv(t.element)&&ot(t.element,"aria-invalid",!1),n.getContainer(t).each(function(t){zn(t,n.validHtml)}),n.onValid(t)})}function cv(n,t,e,o){var r=t.getRoot(n).getOr(n.element);Fi(r,t.invalidClass),t.notify.each(function(t){uv(n.element)&&ot(n.element,"aria-invalid",!0),t.getContainer(n).each(function(t){zn(t,o)}),t.onInvalid(n,o)})}function sv(n,t,e){return t.validator.fold(function(){return hv(Z.value(!0))},function(t){return t.validate(n)})}function lv(n,e,t){return e.notify.each(function(t){t.onValidate(n)}),sv(n,e).map(function(t){return n.getSystem().isConnected()?t.fold(function(t){return cv(n,e,0,t),Z.error(t)},function(t){return av(n,e),Z.value(t)}):Z.error("No longer in system")})}var fv,dv=Fl.exports.boltExport,mv=rv,gv=function(e){function t(t){e().then(t,iv)}return{map:function(t){return gv(function(){return e().then(t)})},bind:function(n){return gv(function(){return e().then(function(t){return n(t).toPromise()})})},anonBind:function(t){return gv(function(){return e().then(function(){return t.toPromise()})})},toLazy:function(){return mv(t)},toCached:function(){var t=null;return gv(function(){return t=null===t?e():t})},toPromise:e,get:t}},pv=function(t){return gv(function(){return new dv(t)})},hv=function(t){return gv(function(){return dv.resolve(t)})},vv=["input","textarea"],kd=Object.freeze({__proto__:null,markValid:av,markInvalid:cv,query:sv,run:lv,isInvalid:function(t,n){t=n.getRoot(t).getOr(t.element);return Vi(t,n.invalidClass)}}),cl=Object.freeze({__proto__:null,events:function(n,t){return n.validator.map(function(t){return Ar([et(t.onEvent,function(t){lv(t,n).get(A)})].concat(t.validateOnLoad?[Fr(function(t){lv(t,n).get(K)})]:[]))}).getOr({})}}),ya=[g("invalidClass"),b("getRoot",$.none),lo("notify",[b("aria","alert"),b("getContainer",$.none),b("validHtml",""),t("onValid"),t("onInvalid"),t("onValidate")]),lo("validator",[g("validate"),b("onEvent","input"),b("validateOnLoad",!0)])],bv=Wu({fields:ya,name:"invalidating",active:cl,apis:kd,extra:{validation:function(n){return function(t){t=ut.getValue(t);return hv(n(t))}}}}),Ml=Object.freeze({__proto__:null,getCoupled:function(t,n,e,o){return e.getOrCreate(t,n,o)}}),Ed=[ao("others",Gt(Z.value,no()))],yv=Wu({fields:Ed,name:"coupling",apis:Ml,state:Object.freeze({__proto__:null,init:function(){var r={},t=X({});return _i({readState:t,getOrCreate:function(n,e,o){var t=pe(e.others);if(t)return B(r,o).getOrThunk(function(){var t=B(e.others,o).getOrDie("No information found for coupled component: "+o)(n),t=n.getSystem().build(t);return r[o]=t});throw new Error("Cannot find coupled component: "+o+". Known coupled components: "+JSON.stringify(t,null,2))}})}})}),xv=X("sink"),Od=X(Vl({name:xv(),overrides:X({dom:{tag:"div"},behaviours:it([fl.config({useFixed:E})]),events:Ar([An(Qo()),An(Go()),An(er())])})}));(Vs=fv=fv||{})[Vs.HighlightFirst=0]="HighlightFirst",Vs[Vs.HighlightNone=1]="HighlightNone";function wv(t,n,e,o,r,i,u){var a,c=Pb(t,e),s=o,l=r,f=u,r=n,n=(a=e,(0,(u=t).fetch)(a).map(r)),d=Hb(a,u);return n.map(function(t){return t.bind(function(t){return $.from(Gd.sketch(J(J({},l.menu()),{uid:vi(""),data:t,highlightImmediately:f===fv.HighlightFirst,onOpenMenu:function(t,n){var e=d().getOrDie();fl.position(e,c,n),h.decloak(s)},onOpenSubmenu:function(t,n,e){var o=d().getOrDie();fl.position(o,{anchor:"submenu",item:n},e),h.decloak(s)},onRepositionMenu:function(t,n,e){var o=d().getOrDie();fl.position(o,c,n),Q(e,function(t){fl.position(o,{anchor:"submenu",item:t.triggeringItem},t.triggeredMenu)})},onEscape:function(){return lt.focus(a),h.close(s),$.some(!0)}})))})}).map(function(t){return t.fold(function(){h.isOpen(o)&&h.close(o)},function(t){h.cloak(o),h.open(o,t),i(o)}),o})}function Sv(t,n,e,o,r,i,u){return h.close(o),hv(o)}function kv(t,n,e,o,r,i){var u=yv.getCoupled(e,"sandbox");return(h.isOpen(u)?Sv:wv)(t,n,e,u,o,r,i)}function Cv(t){h.getState(t).each(function(t){Gd.repositionMenus(t)})}function Ov(u,a,c){var s=Eu(),t=Hb(a,u);return{dom:{tag:"div",classes:u.sandboxClasses,attributes:{id:s.id,role:"listbox"}},behaviours:Cl(u.sandboxBehaviours,[ut.config({store:{mode:"memory",initialValue:a}}),h.config({onOpen:function(t,n){var e=Pb(u,a);{var o,r,i;s.link(a.element),u.matchWidth&&(o=e.hotspot,r=n,i=u.useMinWidth,r=T.getCurrent(r).getOr(r),o=mu(o.element),i?rt(r.element,"min-width",o+"px"):(i=r.element,du.set(i,o)))}u.onOpen(e,t,n),void 0!==c&&void 0!==c.onOpen&&c.onOpen(t,n)},onClose:function(t,n){s.unlink(a.element),void 0!==c&&void 0!==c.onClose&&c.onClose(t,n)},isPartOf:function(t,n,e){return ca(n,e)||ca(a,e)},getAttachPoint:function(){return t().getOrDie()}}),T.config({find:function(t){return h.getState(t).bind(function(t){return T.getCurrent(t)})}}),qa.config({channels:J(J({},Xc({isExtraPart:d})),Yc({doReposition:Cv}))})])}}function _v(t){t=yv.getCoupled(t,"sandbox"),Cv(t)}function Tv(){return[b("sandboxClasses",[]),kl("sandboxBehaviours",[T,qa,h,ut])]}function Ev(e,n,o){function r(t,n){q(t,jb,{value:n})}var i,u,t=x.parts.field({factory:tv,inputClasses:["tox-textfield"],onSetValue:function(t){return bv.run(t).get(K)},inputBehaviours:it([dt.config({disabled:n.providers.isDisabled}),vp(),Nh.config({}),bv.config({invalidClass:"tox-textbox-field-invalid",getRoot:function(t){return Gr(t.element)},notify:{onValid:function(t){var n=ut.getValue(t);q(t,Lb,{color:n})}},validator:{validateOnLoad:!1,validate:function(t){var n=ut.getValue(t);return 0===n.length?hv(Z.value(!0)):(t=nt.fromTag("span"),rt(t,"background-color",n),t=Ki(t,"background-color").fold(function(){return Z.error("blah")},function(t){return Z.value(n)}),hv(t))}}})]),selectOnFocus:!1}),a=e.label.map(function(t){return Wh(t,n.providers)}),c=ft((i={dom:{tag:"span",attributes:{"aria-label":n.providers.translate("Color swatch")}},layouts:{onRtl:function(){return[Vu,Ru,Nu]},onLtr:function(){return[Ru,Vu,Nu]}},components:[],fetch:np(o.getColors(),o.hasCustomColors()),columns:o.getColorCols(),presets:"color",onItemAction:function(t,e){c.getOpt(t).each(function(n){"custom"===e?o.colorPicker(function(t){t.fold(function(){return Y(n,Ub)},function(t){r(n,t),Qg(t)})},"#ffffff"):r(n,"remove"===e?"":e)})}},zb.sketch({dom:i.dom,components:i.components,toggleClass:"mce-active",dropdownBehaviours:it([bp((u=n).providers.isDisabled),vp(),Nb.config({}),Nh.config({})]),layouts:i.layouts,sandboxClasses:["tox-dialog__popups"],lazySink:u.getSink,fetch:function(n){return pv(function(t){return i.fetch(t)}).map(function(t){return $.from(gh(Oe(rp(_("menu-value"),t,function(t){i.onItemAction(n,t)},i.columns,i.presets,Vm.CLOSE_ON_EXECUTE,d,u.providers),{movement:ip(i.columns,i.presets)})))})},parts:{menu:um(0,0,i.presets)}})));return x.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:a.toArray().concat([{dom:{tag:"div",classes:["tox-color-input"]},components:[t,c.asSpec()]}]),fieldBehaviours:it([st("form-field-events",[et(Lb,function(t,n){c.getOpt(t).each(function(t){rt(t.element,"background-color",n.event.color)}),q(t,Gh,{name:e.name})}),et(jb,function(n,e){x.getField(n).each(function(t){ut.setValue(t,e.event.value),T.getCurrent(n).each(lt.focus)})}),et(Ub,function(n,t){x.getField(n).each(function(t){T.getCurrent(n).each(lt.focus)})})])])})}function Dv(n){return Vl({name:n+"-edge",overrides:function(t){return t.model.manager.edgeActions[n].fold(function(){return{}},function(o){return{events:Ar([Tn(Lo(),function(t,n,e){return o(t,e)},[t]),Tn(Go(),function(t,n,e){return o(t,e)},[t]),Tn(Xo(),function(t,n,e){e.mouseIsDown.get()&&o(t,e)},[t])])}})}})}function Bv(t){return-1===(t=t.event.raw).type.indexOf("touch")?void 0!==t.clientX?$.some(t).map(function(t){return cu(t.clientX,t.clientY)}):$.none():void 0!==t.touches&&1===t.touches.length?$.some(t.touches[0]).map(function(t){return cu(t.clientX,t.clientY)}):$.none()}function Av(t){return t.model.minX-1}function Mv(t){return t.model.minY-1}function Fv(t){return t.model.maxX+1}function Iv(t){return t.model.maxY+1}function Rv(t){return Kb(t,Yb,Gb)}function Vv(t){return Kb(t,qb,Xb)}function Pv(t){return Rv(t)/2}function Hv(t){return Vv(t)/2}function zv(t){return t.stepSize}function Nv(t){return t.snapToGrid}function Lv(t){return t.snapStart}function jv(t){return t.rounded}function Uv(t){return Jb(t,"left")}function Wv(t){return Jb(t,"right")}function Gv(t){return Jb(t,"top")}function Xv(t){return Jb(t,"bottom")}function Yv(t){return t.model.value.get()}function qv(t,n){return{x:t,y:n}}function Kv(t,n){q(t,Wb(),{value:n})}function Jv(t){var r,n,i,u,e=t.min,o=t.max,a=t.range,c=t.value,s=t.step,l=t.snap,f=t.snapStart,d=t.rounded,m=t.hasMinEdge,g=t.hasMaxEdge,p=t.minBound,h=t.maxBound,t=t.screenRange,m=m?e-1:e,g=g?o+1:o;return c<p?m:h<c?g:(p=p,h=Math.min(h,Math.max(c,p))-p,c=Zb(h/t*a+e,m,g),l&&e<=c&&c<=o?(r=c,n=e,i=o,u=s,f.fold(function(){var t=Math.round((r-n)/u)*u;return Zb(n+t,n-1,i+1)},function(t){var n=Math.round((r-t)%u/u),e=Math.floor((r-t)/u),o=Math.floor((i-t)/u),o=t+Math.min(o,e+n)*u;return Math.max(t,o)})):d?Math.round(c):c)}function $v(t){var n=t.min,e=t.max,o=t.range,r=t.value,i=t.hasMinEdge,u=t.hasMaxEdge,a=t.maxBound,c=t.maxOffset,s=t.centerMinEdge,t=t.centerMaxEdge;return r<n?i?0:s:e<r?u?a:t:(r-n)/o*c}function Qv(t){return t=ny(t),ey(t,ty)}function Zv(t){return t=ny(t),ey(t,"right")}function tb(t){return t=ny(t),ey(t,"top")}function nb(t){return t=ny(t),ey(t,"bottom")}function eb(t){return t=ny(t),ey(t,"width")}function ob(t){return t=ny(t),ey(t,"height")}function rb(t,n){var t=ny(t),n=ny(n),e=ey(t,ty),t=ey(t,"right"),n=ey(n,ty);return oy(e,t,n)}function ib(t,n){var t=ny(t),n=ny(n),e=ey(t,"top"),t=ey(t,"bottom"),n=ey(n,"top");return oy(e,t,n)}function ub(t,n){q(t,Wb(),{value:n})}function ab(t,n,e){return e={min:Gb(n),max:Yb(n),range:Rv(n),value:e,step:zv(n),snap:Nv(n),snapStart:Lv(n),rounded:jv(n),hasMinEdge:Uv(n),hasMaxEdge:Wv(n),minBound:Qv(t),maxBound:Zv(t),screenRange:eb(t)},Jv(e)}function cb(e){return function(t,n){return t=t,n=(0<e?Qb:$b)(Yv(n=n).x,Gb(n),Yb(n),zv(n)),ub(t,{x:n}),$.some(n).map(E)}}function sb(t,n,e,o,r,i){i=i,e=e,o=o,r=r,a=eb(u=n),o=o.bind(function(t){return $.some(rb(t,u))}).getOr(0),r=r.bind(function(t){return $.some(rb(t,u))}).getOr(a),e={min:Gb(i),max:Yb(i),range:Rv(i),value:e,hasMinEdge:Uv(i),hasMaxEdge:Wv(i),minBound:Qv(u),minOffset:0,maxBound:Zv(u),maxOffset:a,centerMinEdge:o,centerMaxEdge:r};var u,a,i=$v(e);return Qv(n)-Qv(t)+i}function lb(t,n){q(t,Wb(),{value:n})}function fb(t,n,e){return e={min:Xb(n),max:qb(n),range:Vv(n),value:e,step:zv(n),snap:Nv(n),snapStart:Lv(n),rounded:jv(n),hasMinEdge:Gv(n),hasMaxEdge:Xv(n),minBound:tb(t),maxBound:nb(t),screenRange:ob(t)},Jv(e)}function db(e){return function(t,n){return t=t,n=(0<e?Qb:$b)(Yv(n=n).y,Xb(n),qb(n),zv(n)),lb(t,{y:n}),$.some(n).map(E)}}function mb(t,n,e,o,r,i){i=i,e=e,o=o,r=r,a=ob(u=n),o=o.bind(function(t){return $.some(ib(t,u))}).getOr(0),r=r.bind(function(t){return $.some(ib(t,u))}).getOr(a),e={min:Xb(i),max:qb(i),range:Vv(i),value:e,hasMinEdge:Gv(i),hasMaxEdge:Xv(i),minBound:tb(u),minOffset:0,maxBound:nb(u),maxOffset:a,centerMinEdge:o,centerMaxEdge:r};var u,a,i=$v(e);return tb(n)-tb(t)+i}function gb(t,n){q(t,Wb(),{value:n})}function pb(t,n){return{x:t,y:n}}function hb(i,u){return function(t,n){return t=t,n=n,e=0<i?Qb:$b,o=(r=u)?Yv(n).x:e(Yv(n).x,Gb(n),Yb(n),zv(n)),r=r?e(Yv(n).y,Xb(n),qb(n),zv(n)):Yv(n).y,gb(t,pb(o,r)),$.some(o).map(E);var e,o,r}}function vb(t){return zp(Yp(t))}function bb(t){return"<alloy.field."+t+">"}function yb(o,t){return{uid:o.uid,dom:o.dom,components:t,behaviours:ns(o.formBehaviours,[ut.config({store:{mode:"manual",getValue:function(t){t=fs(t,o);return be(t,function(t,o){return t().bind(function(t){var n=T.getCurrent(t),e=new Error("Cannot find a current component to extract the value from for form part '"+o+"': "+Ln(t.element));return n.fold(function(){return Z.error(e)},Z.value)}).map(ut.getValue)})},setValue:function(e,t){ve(t,function(n,t){Ll(e,o,t).each(function(t){T.getCurrent(t).each(function(t){ut.setValue(t,n)})})})}}})]),apis:{getField:function(t,n){return Ll(t,o,n).bind(T.getCurrent)}}}}function xb(d,m,g,p){function h(t,n,e,o,r){var i,u,a=d(py+"range"),e=[x.parts.label({dom:{tag:"label",innerHtml:e,attributes:{"aria-label":o}}}),x.parts.field({data:r,factory:tv,inputAttributes:J({type:"text"},"hex"===n?{"aria-live":"polite"}:{}),inputClasses:[m("textfield")],inputBehaviours:it([(i=n,u=t,bv.config({invalidClass:m("invalid"),notify:{onValidate:function(t){q(t,gy,{type:i})},onValid:function(t){q(t,dy,{type:i,value:ut.getValue(t)})},onInvalid:function(t){q(t,my,{type:i,value:ut.getValue(t)})}},validator:{validate:function(t){t=ut.getValue(t),t=u(t)?Z.value(!0):Z.error(d("aria.input.invalid"));return hv(t)},validateOnLoad:!1}})),Nh.config({})]),onSetValue:function(t){bv.isInvalid(t)&&bv.run(t).get(K)}})],o="hex"!==n?[x.parts["aria-descriptor"]({text:a})]:[];return{dom:{tag:"div",attributes:{role:"presentation"}},components:e.concat(o)}}function v(t,n){var e=n.red,o=n.green,n=n.blue;ut.setValue(t,{red:e,green:o,blue:n})}function b(t,n){y.getOpt(t).each(function(t){rt(t.element,"background-color","#"+n.value)})}var y=ft({dom:{tag:"div",classes:[m("rgba-preview")],styles:{"background-color":"white"},attributes:{role:"presentation"}}});return ql({factory:function(){function r(t){return o[t].get()}function n(t,n){"hex"!==(n=n.event).type?i(n.type,$.none()):p(t)}function e(t,n){var e,o,r;"hex"===(n=n.event).type?(e=t,o=n.value,g(e),r=Ip(o),i("hex",$.some(o)),o=qp(r),v(e,o),u(o),q(e,ay,{hex:r}),b(e,r)):a(t,n.type,n.value)}function t(t){return{label:d(py+t+".label"),description:d(py+t+".description")}}var o={red:tt($.some(255)),green:tt($.some(255)),blue:tt($.some(255)),hex:tt($.some("ffffff"))},i=function(t,n){o[t].set(n)},u=function(t){var n=t.red,e=t.green,t=t.blue;i("red",$.some(n)),i("green",$.some(e)),i("blue",$.some(t))},a=function(o,t,n){n=parseInt(n,10);i(t,$.some(n)),r("red").bind(function(e){return r("green").bind(function(n){return r("blue").map(function(t){return Gp(e,n,t,1)})})}).each(function(t){n=o,e=zp(t),fy.getField(n,"hex").each(function(t){lt.isFocused(t)||ut.setValue(n,{hex:e.value})});var n,e,t=e;q(o,ay,{hex:t}),b(o,t)})},c=t("red"),s=t("green"),l=t("blue"),f=t("hex");return Oe(fy.sketch(function(t){return{dom:{tag:"form",classes:[m("rgb-form")],attributes:{"aria-label":d("aria.color.picker")}},components:[t.field("red",x.sketch(h(Xp,"red",c.label,c.description,255))),t.field("green",x.sketch(h(Xp,"green",s.label,s.description,255))),t.field("blue",x.sketch(h(Xp,"blue",l.label,l.description,255))),t.field("hex",x.sketch(h(Pp,"hex",f.label,f.description,"ffffff"))),y.asSpec()],formBehaviours:it([bv.config({invalidClass:m("form-invalid")}),st("rgb-form-events",[et(dy,e),et(my,n),et(gy,n)])])}}),{apis:{updateHex:function(t,n){var e,o;ut.setValue(t,{hex:n.value}),e=t,o=qp(n),v(e,o),u(o),b(t,n)}}})},name:"RgbForm",configFields:[],apis:{updateHex:function(t,n,e){t.updateHex(n,e)}},extraApis:{}})}function wb(t,o){function r(t,n){var e=t.width,o=t.height;null!==(t=t.getContext("2d"))&&(t.fillStyle=n,t.fillRect(0,0,e,o),(n=t.createLinearGradient(0,0,e,0)).addColorStop(0,"rgba(255,255,255,1)"),n.addColorStop(1,"rgba(255,255,255,0)"),t.fillStyle=n,t.fillRect(0,0,e,o),(n=t.createLinearGradient(0,0,0,o)).addColorStop(0,"rgba(0,0,0,0)"),n.addColorStop(1,"rgba(0,0,0,1)"),t.fillStyle=n,t.fillRect(0,0,e,o))}var i=ry.parts.spectrum({dom:{tag:"canvas",attributes:{role:"presentation"},classes:[o("sv-palette-spectrum")]}}),u=ry.parts.thumb({dom:{tag:"div",attributes:{role:"presentation"},classes:[o("sv-palette-thumb")],innerHtml:"<div class="+o("sv-palette-inner-thumb")+' role="presentation"></div>'}});return ql({factory:function(t){var n=X({x:0,y:0}),e=it([T.config({find:$.some}),lt.config({})]);return ry.sketch({dom:{tag:"div",attributes:{role:"presentation"},classes:[o("sv-palette")]},model:{mode:"xy",getInitialValue:n},rounded:!1,components:[i,u],onChange:function(t,n,e){q(t,sy,{value:e})},onInit:function(t,n,e,o){r(e.element.dom,Kp(Jp))},sliderBehaviours:e})},name:"SaturationBrightnessPalette",configFields:[],apis:{setHue:function(t,n,e){n=n.components()[0].element.dom,e=iy(e,100,100),e=Yp(e);r(n,Kp(e))},setThumb:function(t,n,e){e=uy(qp(e));ry.setValue(n,{x:e.saturation,y:100-e.value})}},extraApis:{}})}function Sb(h,v){return ql({name:"ColourPicker",configFields:[g("dom"),b("onValidHex",K),b("onInvalidHex",K)],factory:function(t){function n(t,n,e){g.getOpt(t).each(function(t){f.setHue(t,e)})}function e(t,n){p.getOpt(t).each(function(t){l.updateHex(t,n)})}function o(n,e,o,t){var r=o,i=qp(e);d.paletteRgba.set(i),d.paletteHue.set(r),Q(t,function(t){t(n,e,o)})}var r,i,u,a,c,s,l=xb(h,v,t.onValidHex,t.onInvalidHex),f=wb(0,v),d={paletteRgba:tt(Jp),paletteHue:tt(0)},m=ft((i=ry.parts.spectrum({dom:{tag:"div",classes:[(r=v)("hue-slider-spectrum")],attributes:{role:"presentation"}}}),u=ry.parts.thumb({dom:{tag:"div",classes:[r("hue-slider-thumb")],attributes:{role:"presentation"}}}),ry.sketch({dom:{tag:"div",classes:[r("hue-slider")],attributes:{role:"presentation"}},rounded:!1,model:{mode:"y",getInitialValue:X({y:0})},components:[i,u],sliderBehaviours:it([lt.config({})]),onChange:function(t,n,e){q(t,cy,{value:e})}}))),g=ft(f.sketch({})),p=ft(l.sketch({}));return{uid:t.uid,dom:t.dom,components:[g.asSpec(),m.asSpec(),p.asSpec()],behaviours:it([st("colour-picker-events",[et(ay,(s=[n,function(t,n,e){m.getOpt(t).each(function(t){ry.setValue(t,{y:100-e/360*100})})},function(t,n){g.getOpt(t).each(function(t){f.setThumb(t,n)})}],function(t,n){var n=n.event.hex,e=uy(qp(n));o(t,n,e.hue,s)})),et(sy,(c=[e],function(t,n){var n=n.event.value,e=d.paletteHue.get(),n=iy(e,n.x,100-n.y),n=vb(n);o(t,n,e,c)})),et(cy,(a=[n,e],function(t,n){var n=(100-n.event.value.y)/100*360,e=d.paletteRgba.get(),e=uy(e),e=iy(n,e.saturation,e.value),e=vb(e);o(t,e,n,a)}))]),T.config({find:function(t){return p.getOpt(t)}}),at.config({mode:"acyclic"})])}}})}function kb(){return T.config({find:$.some})}function Cb(t){return T.config({find:function(n){return In(n.element,t).bind(function(t){return n.getSystem().getByDom(t).toOptional()})}})}function Ob(t){return hy[t]}function _b(t){return n=ii,e=zn,xy(t,function(t){return n(t.element)},function(t,n){return e(t.element,n)});var n,e}function Tb(o,r){function n(t,n){n.stop()}function e(t){return function(n,e){Q(t,function(t){t(n,e)})}}function i(t,n){dt.isDisabled(t)||(n=n.event.raw,a(t,n.dataTransfer.files))}function u(t,n){n=n.event.raw.target,a(t,n.files)}function a(t,n){var e;ut.setValue(t,(n=n,e=by.explode(r.getSetting("images_file_types","jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp","string")),yt(At(n),function(n){return ht(e,function(t){return pn(n.name.toLowerCase(),"."+t.toLowerCase())})}))),q(t,Gh,{name:o.name})}var c=ft({dom:{tag:"input",attributes:{type:"file",accept:"image/*"},styles:{display:"none"}},behaviours:it([st("input-file-events",[An(er()),An(fr())])])}),t=o.label.map(function(t){return Wh(t,r)}),s=x.parts.field({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",classes:["tox-dropzone-container"]},behaviours:it([Sy([]),kb(),dt.config({}),v.config({toggleClass:"dragenter",toggleOnExecute:!1}),st("dropzone-events",[et("dragenter",e([n,v.toggle])),et("dragleave",e([n,v.toggle])),et("dragover",n),et("drop",e([n,i])),et(nr(),u)])]),components:[{dom:{tag:"div",classes:["tox-dropzone"],styles:{}},components:[{dom:{tag:"p",innerHtml:r.translate("Drop an image here")}},qd.sketch({dom:{tag:"button",innerHtml:r.translate("Browse for an image"),styles:{position:"relative"},classes:["tox-button","tox-button--secondary"]},components:[c.asSpec()],action:function(t){c.get(t).element.dom.click()},buttonBehaviours:it([Nh.config({}),bp(r.isDisabled),vp()])})]}]}}}});return jh(t,s,["tox-form__group--stretched"],[])}function Eb(t){return{dom:{tag:"div",styles:{width:"1px",height:"1px",outline:"none"},attributes:{tabindex:"0"},classes:t},behaviours:it([lt.config({ignore:!0}),Nh.config({})])}}function Db(t,n){q(t,Qo(),{raw:{which:9,shiftKey:n}})}function Bb(t,n){n=n.element,Vi(n,ky)?Db(t,!0):Vi(n,Cy)&&Db(t,!1)}function Ab(t){var n=Ey(t.width,t.height);return Dy(n).drawImage(t,0,0),n}var Mb,Fb,Ib,Rb,Vb,Pb=function(t,n){var e=t.getHotspot(n).getOr(n),o=t.getAnchorOverrides();return t.layouts.fold(function(){return{anchor:"hotspot",hotspot:e,overrides:o}},function(t){return{anchor:"hotspot",hotspot:e,overrides:o,layouts:t}})},Hb=function(n,t){return n.getSystem().getByUid(t.uid+"-"+xv()).map(function(t){return function(){return Z.value(t)}}).getOrThunk(function(){return t.lazySink.fold(function(){return function(){return Z.error(new Error("No internal sink is specified, nor could an external sink be found"))}},function(t){return function(){return t(n)}})})},Dd=X([g("dom"),g("fetch"),t("onOpen"),Mu("onExecute"),b("getHotspot",$.some),b("getAnchorOverrides",X({})),mc(),Zc("dropdownBehaviours",[v,yv,at,lt]),g("toggleClass"),b("eventOrder",{}),p("lazySink"),b("matchWidth",!1),b("useMinWidth",!1),p("role")].concat(Tv())),Td=X([js({schema:[Du()],name:"menu",defaults:function(t){return{onExecute:t.onExecute}}}),Od()]),zb=hs({name:"Dropdown",configFields:Dd(),partFields:Td(),factory:function(n,t,e,o){function r(t){h.getState(t).each(function(t){Gd.highlightPrimary(t)})}function i(t,n){return Dr(t),$.some(!0)}var u={expand:function(t){v.isOn(t)||kv(n,function(t){return t},t,o,K,fv.HighlightNone).get(K)},open:function(t){v.isOn(t)||kv(n,function(t){return t},t,o,K,fv.HighlightFirst).get(K)},isOpen:v.isOn,close:function(t){v.isOn(t)&&kv(n,function(t){return t},t,o,K,fv.HighlightFirst).get(K)},repositionMenus:function(t){v.isOn(t)&&_v(t)}};return{uid:n.uid,dom:n.dom,components:t,behaviours:ns(n.dropdownBehaviours,[v.config({toggleClass:n.toggleClass,aria:{mode:"expanded"}}),yv.config({others:{sandbox:function(t){return Ov(n,t,{onOpen:function(){return v.on(t)},onClose:function(){return v.off(t)}})}}}),at.config({mode:"special",onSpace:i,onEnter:i,onDown:function(t,n){var e;return zb.isOpen(t)?(e=yv.getCoupled(t,"sandbox"),r(e)):zb.open(t),$.some(!0)},onEscape:function(t,n){return zb.isOpen(t)?(zb.close(t),$.some(!0)):$.none()}}),lt.config({})]),events:id($.some(function(t){kv(n,function(t){return t},t,o,r,fv.HighlightFirst).get(K)})),eventOrder:J(J({},n.eventOrder),((t={})[sr()]=["disabling","toggling","alloy.base.behaviour"],t)),apis:u,domModification:{attributes:J(J({"aria-haspopup":"true"},n.role.fold(function(){return{}},function(t){return{role:t}})),"button"===n.dom.tag?{type:B(n.dom,"attributes").bind(function(t){return B(t,"type")}).getOr("button")}:{})}}},apis:{open:function(t,n){return t.open(n)},expand:function(t,n){return t.expand(n)},close:function(t,n){return t.close(n)},isOpen:function(t,n){return t.isOpen(n)},repositionMenus:function(t,n){return t.repositionMenus(n)}}}),Nb=Wu({fields:[],name:"unselecting",active:Object.freeze({__proto__:null,events:function(){return Ar([On(rr(),E)])},exhibit:function(){return Ti({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})}})}),Lb=_("color-input-change"),jb=_("color-swatch-change"),Ub=_("color-picker-cancel"),bo=Vl({schema:[g("dom")],name:"label"}),di=Dv("top-left"),vo=Dv("top"),Fl=Dv("top-right"),ya=Dv("right"),cl=Dv("bottom-right"),kd=Dv("bottom"),Ed=Dv("bottom-left"),Ml=[bo,Dv("left"),ya,vo,kd,di,Fl,Ed,cl,Rl({name:"thumb",defaults:X({dom:{styles:{position:"absolute"}}}),overrides:function(t){return{events:Ar([Dn(Lo(),t,"spectrum"),Dn(jo(),t,"spectrum"),Dn(Uo(),t,"spectrum"),Dn(Go(),t,"spectrum"),Dn(Xo(),t,"spectrum"),Dn(qo(),t,"spectrum")])}}}),Rl({schema:[mo("mouseIsDown",function(){return tt(!1)})],name:"spectrum",overrides:function(e){function o(n,t){return r.getValueFromEvent(t).map(function(t){return r.setValueFrom(n,e,t)})}var r=e.model.manager;return{behaviours:it([at.config({mode:"special",onLeft:function(t){return r.onLeft(t,e)},onRight:function(t){return r.onRight(t,e)},onUp:function(t){return r.onUp(t,e)},onDown:function(t){return r.onDown(t,e)}}),lt.config({})]),events:Ar([et(Lo(),o),et(jo(),o),et(Go(),o),et(Xo(),function(t,n){e.mouseIsDown.get()&&o(t,n)})])}}})],Wb=X("slider.change.value"),Gb=function(t){return t.model.minX},Xb=function(t){return t.model.minY},Yb=function(t){return t.model.maxX},qb=function(t){return t.model.maxY},Kb=function(t,n,e){return n(t)-e(t)},Jb=function(t,n){return void 0!==t[n+"-edge"]},$b=function(t,n,e,o){return t<n?t:e<t?e:t===n?n-1:Math.max(n,t-o)},Qb=function(t,n,e,o){return e<t?t:t<n?n:t===e?e+1:Math.min(e,t+o)},Zb=function(t,n,e){return Math.max(n,Math.min(e,t))},ty="left",ny=function(t){return t.element.dom.getBoundingClientRect()},ey=function(t,n){return t[n]},oy=function(t,n,e){return(t+n)/2-e},Vs=cb(-1),Dd=cb(1),Td=$.none,bo=$.none,ya={"top-left":$.none(),top:$.none(),"top-right":$.none(),right:$.some(function(t,n){Kv(t,{x:Fv(n)})}),"bottom-right":$.none(),bottom:$.none(),"bottom-left":$.none(),left:$.some(function(t,n){Kv(t,{x:Av(n)})})},vo=Object.freeze({__proto__:null,setValueFrom:function(t,n,e){n=ab(t,n,e);return ub(t,{x:n}),n},setToMin:function(t,n){n=Gb(n);ub(t,{x:n})},setToMax:function(t,n){n=Yb(n);ub(t,{x:n})},findValueOfOffset:ab,getValueFromEvent:function(t){return Bv(t).map(function(t){return t.left})},findPositionOfValue:sb,setPositionFromValue:function(t,n,e,o){var r=Yv(e),r=sb(t,o.getSpectrum(t),r.x,o.getLeftEdge(t),o.getRightEdge(t),e),o=mu(n.element)/2;rt(n.element,"left",r-o+"px")},onLeft:Vs,onRight:Dd,onUp:Td,onDown:bo,edgeActions:ya}),kd=$.none,di=$.none,Fl=db(-1),Ed=db(1),cl={"top-left":$.none(),top:$.some(function(t,n){Kv(t,{y:Mv(n)})}),"top-right":$.none(),right:$.none(),"bottom-right":$.none(),bottom:$.some(function(t,n){Kv(t,{y:Iv(n)})}),"bottom-left":$.none(),left:$.none()},Vs=Object.freeze({__proto__:null,setValueFrom:function(t,n,e){n=fb(t,n,e);return lb(t,{y:n}),n},setToMin:function(t,n){n=Xb(n);lb(t,{y:n})},setToMax:function(t,n){n=qb(n);lb(t,{y:n})},findValueOfOffset:fb,getValueFromEvent:function(t){return Bv(t).map(function(t){return t.top})},findPositionOfValue:mb,setPositionFromValue:function(t,n,e,o){var r=Yv(e),r=mb(t,o.getSpectrum(t),r.y,o.getTopEdge(t),o.getBottomEdge(t),e),o=uu(n.element)/2;rt(n.element,"top",r-o+"px")},onLeft:kd,onRight:di,onUp:Fl,onDown:Ed,edgeActions:cl}),Dd=Bv,Td=hb(-1,!1),bo=hb(1,!1),ya=hb(-1,!0),kd=hb(1,!0),di={"top-left":$.some(function(t,n){Kv(t,qv(Av(n),Mv(n)))}),top:$.some(function(t,n){Kv(t,qv(Pv(n),Mv(n)))}),"top-right":$.some(function(t,n){Kv(t,qv(Fv(n),Mv(n)))}),right:$.some(function(t,n){Kv(t,qv(Fv(n),Hv(n)))}),"bottom-right":$.some(function(t,n){Kv(t,qv(Fv(n),Iv(n)))}),bottom:$.some(function(t,n){Kv(t,qv(Pv(n),Iv(n)))}),"bottom-left":$.some(function(t,n){Kv(t,qv(Av(n),Iv(n)))}),left:$.some(function(t,n){Kv(t,qv(Av(n),Hv(n)))})},Fl=Object.freeze({__proto__:null,setValueFrom:function(t,n,e){var o=ab(t,n,e.left),n=fb(t,n,e.top),e=pb(o,n);return gb(t,e),e},setToMin:function(t,n){var e=Gb(n),n=Xb(n);gb(t,pb(e,n))},setToMax:function(t,n){var e=Yb(n),n=qb(n);gb(t,pb(e,n))},getValueFromEvent:Dd,setPositionFromValue:function(t,n,e,o){var r=Yv(e),i=sb(t,o.getSpectrum(t),r.x,o.getLeftEdge(t),o.getRightEdge(t),e),r=mb(t,o.getSpectrum(t),r.y,o.getTopEdge(t),o.getBottomEdge(t),e),o=mu(n.element)/2,t=uu(n.element)/2;rt(n.element,"left",i-o+"px"),rt(n.element,"top",r-t+"px")},onLeft:Td,onRight:bo,onUp:ya,onDown:kd,edgeActions:di}),ry=hs({name:"Slider",configFields:[b("stepSize",1),b("onChange",K),b("onChoose",K),b("onInit",K),b("onDragStart",K),b("onDragEnd",K),b("snapToGrid",!1),b("rounded",!0),p("snapStart"),ao("model",Xt("mode",{x:[b("minX",0),b("maxX",100),mo("value",function(t){return tt(t.mode.minX)}),g("getInitialValue"),ha("manager",vo)],y:[b("minY",0),b("maxY",100),mo("value",function(t){return tt(t.mode.minY)}),g("getInitialValue"),ha("manager",Vs)],xy:[b("minX",0),b("maxX",100),b("minY",0),b("maxY",100),mo("value",function(t){return tt({x:t.mode.minX,y:t.mode.minY})}),g("getInitialValue"),ha("manager",Fl)]})),Zc("sliderBehaviours",[at,ut]),mo("mouseIsDown",function(){return tt(!1)})],partFields:Ml,factory:function(r,t,n,e){function i(t){return jl(t,r,"thumb")}function u(t,n){h.setPositionFromValue(t,n,r,{getLeftEdge:f,getRightEdge:d,getTopEdge:m,getBottomEdge:g,getSpectrum:l})}function o(t,n){p.value.set(n),n=i(t),u(t,n)}function a(e){var t=r.mouseIsDown.get();r.mouseIsDown.set(!1),t&&Ll(e,r,"thumb").each(function(t){var n=p.value.get();r.onChoose(e,t,n)})}function c(t,n){n.stop(),r.mouseIsDown.set(!0),r.onDragStart(t,i(t))}function s(t,n){n.stop(),r.onDragEnd(t,i(t)),a(t)}var l=function(t){return jl(t,r,"spectrum")},f=function(t){return Ll(t,r,"left-edge")},d=function(t){return Ll(t,r,"right-edge")},m=function(t){return Ll(t,r,"top-edge")},g=function(t){return Ll(t,r,"bottom-edge")},p=r.model,h=p.manager;return{uid:r.uid,dom:r.dom,components:t,behaviours:ns(r.sliderBehaviours,[at.config({mode:"special",focusIn:function(t){return Ll(t,r,"spectrum").map(at.focusIn).map(E)}}),ut.config({store:{mode:"manual",getValue:function(t){return p.value.get()}}}),qa.config({channels:((t={})[xl()]={onReceive:a},t)})]),events:Ar([et(Wb(),function(t,n){var e;t=t,n=n.event.value,o(t,n),e=i(t),r.onChange(t,e,n),$.some(!0)}),Fr(function(t,n){var e=p.getInitialValue(),e=(p.value.set(e),i(t)),o=(u(t,e),l(t));r.onInit(t,e,o,p.value.get())}),et(Lo(),c),et(Uo(),s),et(Go(),c),et(qo(),s)]),apis:{resetToMin:function(t){h.setToMin(t,r)},resetToMax:function(t){h.setToMax(t,r)},setValue:o,refresh:u},domModification:{styles:{position:"relative"}}}},apis:{setValue:function(t,n,e){t.setValue(n,e)},resetToMin:function(t,n){t.resetToMin(n)},resetToMax:function(t,n){t.resetToMax(n)},refresh:function(t,n){t.refresh(n)}}}),iy=function(t,n,e){return{hue:t,saturation:n,value:e}},uy=function(t){var n=0,e=t.red/255,o=t.green/255,t=t.blue/255,r=Math.min(e,Math.min(o,t)),i=Math.max(e,Math.max(o,t));return r===i?iy(0,0,100*(n=r)):(o=60*((e===r?3:t===r?1:5)-(e===r?o-t:t===r?e-o:t-e)/(i-r)),t=(i-r)/i,n=i,iy(Math.round(o),Math.round(100*t),Math.round(100*n)))},ay=_("rgb-hex-update"),cy=_("slider-update"),sy=_("palette-update"),ly=[Zc("formBehaviours",[ut])],fy={getField:jn(function(t,n,e){return t.getField(n,e)}),sketch:function(t){e=[];var e,n={field:function(t,n){return e.push(t),cs("form",bb(t),n)},record:function(){return e}},t=t(n),n=n.record(),n=k(n,function(t){return Rl({name:t,pname:bb(t)})});return ps("form",ly,n,yb,t)}},dy=_("valid-input"),my=_("invalid-input"),gy=_("validating-input"),py="colorcustom.rgb.",hy={"colorcustom.rgb.red.label":"R","colorcustom.rgb.red.description":"Red component","colorcustom.rgb.green.label":"G","colorcustom.rgb.green.description":"Green component","colorcustom.rgb.blue.label":"B","colorcustom.rgb.blue.description":"Blue component","colorcustom.rgb.hex.label":"#","colorcustom.rgb.hex.description":"Hex color code","colorcustom.rgb.range":"Range 0 to 255","colorcustom.sb.saturation":"Saturation","colorcustom.sb.brightness":"Brightness","colorcustom.sb.picker":"Saturation and Brightness Picker","colorcustom.sb.palette":"Saturation and Brightness Palette","colorcustom.sb.instructions":"Use arrow keys to select saturation and brightness, on x and y axes","colorcustom.hue.hue":"Hue","colorcustom.hue.slider":"Hue Slider","colorcustom.hue.palette":"Hue Palette","colorcustom.hue.instructions":"Use arrow keys to select a hue","aria.color.picker":"Color Picker","aria.input.invalid":"Invalid input"},vy=tinymce.util.Tools.resolve("tinymce.Resource"),by=tinymce.util.Tools.resolve("tinymce.util.Tools"),yy=m([b("preprocess",A),b("postprocess",A)]),xy=function(t,n,e){return ut.config(Oe({store:{mode:"manual",getValue:n,setValue:e}},t.map(function(t){return{store:{initialValue:t}}}).getOr({})))},wy=xy,Sy=function(t){return ut.config({store:{mode:"memory",initialValue:t}})},ky=_("alloy-fake-before-tabstop"),Cy=_("alloy-fake-after-tabstop"),Oy=function(t){return{dom:{tag:"div",classes:["tox-navobj"]},components:[Eb([ky]),t,Eb([Cy])],behaviours:it([Cb(1)])}},_y=function(t){return Bh(t,["."+ky,"."+Cy].join(","),d)},Ty=!(Ao().browser.isIE()||Ao().browser.isEdge()),Ey=function(t,n){return e=document.createElement("canvas"),n=n,e.width=t,e.height=n,e;var e},Dy=function(t){return t.getContext("2d")},By=function(t){return t.naturalWidth||t.width},Ay=function(t){return t.naturalHeight||t.height},My=window.Promise||(Mb=function(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],Vb(t,Ib(Iy,this),Ib(Ry,this))},Ed=window,Fb=Mb.immediateFn||"function"==typeof Ed.setImmediate&&Ed.setImmediate||function(t){return setTimeout(t,1)},Ib=function(e,o){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.apply(o,t)}},Rb=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},Vb=function(t,n,e){var o=!1;try{t(function(t){o||(o=!0,n(t))},function(t){o||(o=!0,e(t))})}catch(t){o||(o=!0,e(t))}},Mb.prototype.catch=function(t){return this.then(null,t)},Mb.prototype.then=function(e,o){var r=this;return new Mb(function(t,n){Fy.call(r,new Py(e,o,t,n))})},Mb.all=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var a=Array.prototype.slice.call(1===t.length&&Rb(t[0])?t[0]:t);return new Mb(function(o,r){if(0===a.length)return o([]);for(var i=a.length,u=function(n,t){try{if(t&&("object"==typeof t||"function"==typeof t)){var e=t.then;if("function"==typeof e)return void e.call(t,function(t){u(n,t)},r)}a[n]=t,0==--i&&o(a)}catch(t){r(t)}},t=0;t<a.length;t++)u(t,a[t])})},Mb.resolve=function(n){return n&&"object"==typeof n&&n.constructor===Mb?n:new Mb(function(t){t(n)})},Mb.reject=function(e){return new Mb(function(t,n){n(e)})},Mb.race=function(r){return new Mb(function(t,n){for(var e=0,o=r;e<o.length;e++)o[e].then(t,n)})},Mb);function Fy(e){var o=this;null!==this._state?Fb(function(){var t,n=o._state?e.onFulfilled:e.onRejected;if(null!==n){try{t=n(o._value)}catch(t){return void e.reject(t)}e.resolve(t)}else(o._state?e.resolve:e.reject)(o._value)}):this._deferreds.push(e)}function Iy(t){try{if(t===this)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if("function"==typeof n)return void Vb(Ib(n,t),Ib(Iy,this),Ib(Ry,this))}this._state=!0,this._value=t,Vy.call(this)}catch(t){Ry.call(this,t)}}function Ry(t){this._state=!1,this._value=t,Vy.call(this)}function Vy(){for(var t=0,n=this._deferreds;t<n.length;t++){var e=n[t];Fy.call(this,e)}this._deferreds=[]}function Py(t,n,e,o){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof n?n:null,this.resolve=e,this.reject=o}function Hy(t,n,e){return t="string"==typeof t?parseFloat(t):t,e<t?t=e:t<n&&(t=n),t}function zy(){return[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1]}function Ny(t,n){for(var e,o=[],r=new Array(25),i=0;i<5;i++){for(var u=0;u<5;u++)o[u]=n[u+5*i];for(u=0;u<5;u++){for(var a=e=0;a<5;a++)e+=t[u+5*a]*o[a];r[u+5*i]=e}}return r}function Ly(r,i){return r.toCanvas().then(function(t){return t=t,n=r.getType(),o=i,e=Dy(t),o=function(t,n){for(var e,o,r,i,u=t.data,a=n[0],c=n[1],s=n[2],l=n[3],f=n[4],d=n[5],m=n[6],g=n[7],p=n[8],h=n[9],v=n[10],b=n[11],y=n[12],x=n[13],w=n[14],S=n[15],k=n[16],C=n[17],O=n[18],_=n[19],T=0;T<u.length;T+=4)e=u[T],o=u[T+1],r=u[T+2],i=u[T+3],u[T]=e*a+o*c+r*s+i*l+f,u[T+1]=e*d+o*m+r*g+i*p+h,u[T+2]=e*v+o*b+r*y+i*x+w,u[T+3]=e*S+o*k+r*C+i*O+_;return t}(e.getImageData(0,0,t.width,t.height),o),e.putImageData(o,0,0),ox(t,n);var n,e,o})}function jy(e){return function(t,n){return Ly(t,e(zy(),n))}}function Uy(t,n,e){var u,a,c,o=By(t),r=Ay(t),i=!1,t=(((o=n/o)<.5||2<o)&&(o=o<.5?.5:2,i=!0),((r=e/r)<.5||2<r)&&(r=r<.5?.5:2,i=!0),u=t,a=o,c=r,new My(function(t){var n=By(u),e=Ay(u),o=Math.floor(n*a),r=Math.floor(e*c),i=Ey(o,r);Dy(i).drawImage(u,0,0,n,e,0,0,o,r),t(i)}));return i?t.then(function(t){return Uy(t,n,e)}):t}function Wy(t,n){return void 0===n&&(n=2),n=Math.pow(10,n),t=Math.round(t*n),Math.ceil(t/n)}function Gy(t,n){return yx(Kd(t,n),{behaviours:it([ct.config({})])})}function Xy(n,e,o){function t(t,n){return t=ut.getValue(t),lt.focus(t),q(t,"keydown",{raw:n.event.raw}),zb.close(t),$.some(!0)}var r=tt(K),i=n.text.map(function(t){return ft(wx(t,e,o.providers))}),u=n.icon.map(function(t){return ft(Gy(t,o.providers.icons))}),a=n.role.fold(function(){return{}},function(t){return{role:t}}),c=n.tooltip.fold(function(){return{}},function(t){t=o.providers.translate(t);return{title:t,"aria-label":t}});return ft(zb.sketch(J(J(J({},n.uid?{uid:n.uid}:{}),a),{dom:{tag:"button",classes:[e,e+"--select"].concat(k(n.classes,function(t){return e+"--"+t})),attributes:J({},c)},components:Cp([u.map(function(t){return t.asSpec()}),i.map(function(t){return t.asSpec()}),$.some({dom:{tag:"div",classes:[e+"__select-chevron"],innerHtml:Kd("chevron-down",o.providers.icons)}})]),matchWidth:!0,useMinWidth:!0,dropdownBehaviours:it(F(n.dropdownBehaviours,[bp(function(){return n.disabled||o.providers.isDisabled()}),vp(),Nb.config({}),ct.config({}),st("dropdown-events",[wp(n,r),Sp(n,r)]),st("menubutton-update-display-text",[et(Cx,function(n,e){i.bind(function(t){return t.getOpt(n)}).each(function(t){ct.set(t,[tu(o.providers.translate(e.event.text))])})}),et(Ox,function(n,e){u.bind(function(t){return t.getOpt(n)}).each(function(t){ct.set(t,[Gy(e.event.icon,o.providers.icons)])})})])])),eventOrder:Oe(kx,{mousedown:["focusing","alloy.base.behaviour","item-type-events","normal-dropdown-events"]}),sandboxBehaviours:it([at.config({mode:"special",onLeft:t,onRight:t})]),lazySink:o.getSink,toggleClass:e+"--active",parts:{menu:um(0,n.columns,n.presets)},fetch:function(t){return pv(M(n.fetch,t))}}))).asSpec()}function Yy(t,o){return t=Ex(y(t)?t.split(" "):t,o),xt(t,function(t,n){var e=_x(n=n)?n:(e=B(n,"value").getOrThunk(function(){return _("generated-menu-item")}),Oe({value:e},n)),n=Dx(e,o);return{menus:Oe(t.menus,n.menus),items:[n.item].concat(t.items),expansions:Oe(t.expansions,n.expansions)}},{menus:{},expansions:{},items:[]})}function qy(e){return{isDisabled:function(){return dt.isDisabled(e)},setDisabled:function(t){return dt.set(e,t)},setActive:function(t){var n=e.element;t?(Fi(n,"tox-tbtn--enabled"),ot(n,"aria-pressed",!0)):(Ri(n,"tox-tbtn--enabled"),si(n,"aria-pressed"))},isActive:function(){return Vi(e.element,"tox-tbtn--enabled")}}}function Ky(n,t,e){var o,r,i;return"menu"===t?(r=J(J({},r=n),{onSetup:function(t){return t.setDisabled(n.disabled),K},fetch:Mx(r.items,function(){return o},e)}),(o=ft(Ax(r,"tox-tbtn",e,$.none()))).asSpec()):"custom"===t||"cancel"===t||"submit"===t?(r=Hx(n.name,t),i=J(J({},n),{borderless:!1}),Px(i,r,e.shared.providers,[])):void console.error("Unknown footer button type: ",t)}function Jy(t,n){return Rl({factory:x,name:t,overrides:function(o){return{fieldBehaviours:it([st("coupled-input-behaviour",[et(tr(),function(e){Ll(e,o,n).bind(T.getCurrent).each(function(n){Ll(e,o,"lock").each(function(t){v.isOn(t)&&o.onLockedChange(e,n,t)})})})])])}}})}function $y(o,a){function t(t,n,e,o){return ft(Px({name:t,text:t,disabled:e,primary:o,icon:$.none(),borderless:!1},n,a))}function n(t,n,e,o){return ft(Rx({name:t,icon:$.some(t),tooltip:$.some(n),disabled:o,primary:!1,borderless:!1},e,a))}function c(t,n){t.map(function(t){t=t.get(n);t.hasConfigured(dt)&&dt.disable(t)})}function s(t,n){t.map(function(t){t=t.get(n);t.hasConfigured(dt)&&dt.enable(t)})}function e(t){return function(){R.getOpt(t).each(function(t){ct.set(t,[I])})}}function i(t,n){h(t),p(t,Wx.transformApply(),{transform:n,swap:e(t)}),v(t)}function r(){return ft({dom:{tag:"div",classes:["tox-spacer"]},behaviours:it([dt.config({})])})}function u(t,n){h(t=t),p(t,Wx.tempTransform(),{transform:n}),v(t)}function l(t,n,e,o,r){t=t,n=n,e=e,o=o,r=r;var i,u=[y(),(i=n,E(t,function(t,n,e){e=_(i,e.x/100);b(t,e)},e,o,r)),x()];return zh.sketch({dom:m,components:u.map(function(t){return t.asSpec()}),containerBehaviours:it([st("image-tools-filter-panel-buttons-events",[et(Gx.disable(),function(t,n){c(u,t)}),et(Gx.enable(),function(t,n){s(u,t)})])])})}function f(t){return E(t,function(c,t,n){var e=B.getOpt(c),o=M.getOpt(c),r=A.getOpt(c);e.each(function(a){o.each(function(u){r.each(function(t){var n,e,o,r=ut.getValue(a).x/100,t=ut.getValue(t).x/100,i=ut.getValue(u).x/100;n=r,e=t,o=i;b(c,function(t){return dx(t,n,e,o)})})})})},0,100,200)}function d(n,e,o){return function(t){p(t,Wx.swap(),{transform:e,swap:function(){R.getOpt(t).each(function(t){ct.set(t,[n]),o(t)})}})}}var m={tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools-edit-panel"]},g=K,p=function(t,n,e){q(t,n,e)},h=function(t){return Y(t,Gx.disable())},v=function(t){return Y(t,Gx.enable())},b=function(t,n){h(t),p(t,Wx.transform(),{transform:n}),v(t)},y=function(){return t("Back",function(t){return p(t,Wx.back(),{swap:e(t)})},!1,!1)},x=function(){return t("Apply",function(t){return p(t,Wx.apply(),{swap:e(t)})},!0,!0)},w=[y(),r(),t("Apply",function(t){i(t,function(t){var n=o.getRect();return hx(t,n.x,n.y,n.w,n.h)}),o.hideCrop()},!1,!0)],S=zh.sketch({dom:m,components:w.map(function(t){return t.asSpec()}),containerBehaviours:it([st("image-tools-crop-buttons-events",[et(Gx.disable(),function(t,n){c(w,t)}),et(Gx.enable(),function(t,n){s(w,t)})])])}),k=ft(Ux({name:"size",label:$.none(),constrain:!0,disabled:!1},a)),C=[y(),r(),k,r(),t("Apply",function(r){k.getOpt(r).each(function(t){var n,e,t=ut.getValue(t),o=parseInt(t.width,10),t=parseInt(t.height,10);n=o,e=t;i(r,function(t){return vx(t,n,e)})})},!1,!0)],O=zh.sketch({dom:m,components:C.map(function(t){return t.asSpec()}),containerBehaviours:it([st("image-tools-resize-buttons-events",[et(Gx.disable(),function(t,n){c(C,t)}),et(Gx.enable(),function(t,n){s(C,t)})])])}),_=function(n,e){return function(t){return n(t,e)}},V=_(px,"h"),P=_(px,"v"),H=_(bx,-90),z=_(bx,90),T=[y(),r(),n("flip-horizontally","Flip horizontally",function(t){u(t,V)},!1),n("flip-vertically","Flip vertically",function(t){u(t,P)},!1),n("rotate-left","Rotate counterclockwise",function(t){u(t,H)},!1),n("rotate-right","Rotate clockwise",function(t){u(t,z)},!1),r(),x()],N=zh.sketch({dom:m,components:T.map(function(t){return t.asSpec()}),containerBehaviours:it([st("image-tools-fliprotate-buttons-events",[et(Gx.disable(),function(t,n){c(T,t)}),et(Gx.enable(),function(t,n){s(T,t)})])])}),E=function(t,n,e,o,r){var t=ry.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:a.translate(t)}}),i=ry.parts.spectrum({dom:{tag:"div",classes:["tox-slider__rail"],attributes:{role:"presentation"}}}),u=ry.parts.thumb({dom:{tag:"div",classes:["tox-slider__handle"],attributes:{role:"presentation"}}});return ft(ry.sketch({dom:{tag:"div",classes:["tox-slider"],attributes:{role:"presentation"}},model:{mode:"x",minX:e,maxX:r,getInitialValue:X({x:o})},components:[t,i,u],sliderBehaviours:it([lt.config({})]),onChoose:n}))},D=[y(),r(),x()],D=zh.sketch({dom:m,components:D.map(function(t){return t.asSpec()})}),L=l("Brightness",mx,-100,0,100),j=l("Contrast",gx,-100,0,100),U=l("Gamma",fx,-100,0,100),B=f("R"),A=f("G"),M=f("B"),F=[y(),B,A,M,x()],F=zh.sketch({dom:m,components:F.map(function(t){return t.asSpec()})}),W=$.some(lx),G=$.some(sx),S=[n("crop","Crop",d(S,$.none(),function(t){o.showCrop()}),!1),n("resize","Resize",d(O,$.none(),function(t){k.getOpt(t).each(function(t){var n=o.getMeasurements(),e=n.width,n=n.height;ut.setValue(t,{width:e,height:n})})}),!1),n("orientation","Orientation",d(N,$.none(),g),!1),n("brightness","Brightness",d(L,$.none(),g),!1),n("sharpen","Sharpen",d(D,W,g),!1),n("contrast","Contrast",d(j,$.none(),g),!1),n("color-levels","Color levels",d(F,$.none(),g),!1),n("gamma","Gamma",d(U,$.none(),g),!1),n("invert","Invert",d(D,G,g),!1)],I=zh.sketch({dom:m,components:S.map(function(t){return t.asSpec()})}),O=zh.sketch({dom:{tag:"div"},components:[I],containerBehaviours:it([ct.config({})])}),R=ft(O);return{memContainer:R,getApplyButton:function(t){return R.getOpt(t).map(function(t){t=t.components()[0];return t.components()[t.components().length-1]})}}}function Qy(t){var n,e;if(t.changedTouches)for(n="screenX screenY pageX pageY clientX clientY".split(" "),e=0;e<n.length;e++)t[n[e]]=t.changedTouches[0][n[e]]}var Zy,tx=function(t,o,r){return o=o||"image/png",C(HTMLCanvasElement.prototype.toBlob)?new My(function(n,e){t.toBlob(function(t){t?n(t):e()},o,r)}):(d=t.toDataURL(o,r),new My(function(t,n){!function(){var t=d.split(","),n=/data:([^;]+)/.exec(t[0]);if(!n)return $.none();for(var n=n[1],t=t[1],e=atob(t),o=e.length,r=Math.ceil(o/1024),i=new Array(r),u=0;u<r;++u){for(var a=1024*u,c=Math.min(1024+a,o),s=new Array(c-a),l=a,f=0;l<c;++f,++l)s[f]=e[l].charCodeAt(0);i[u]=new Uint8Array(s)}return $.some(new Blob(i,{type:n}))}().fold(function(){n("uri is not base64: "+d)},t)}));var d},nx=function(t){return a=t,new My(function(t,n){function e(){u(),t(i)}function o(){u(),n("Unable to load data of type "+a.type+": "+r)}var r=URL.createObjectURL(a),i=new Image,u=function(){i.removeEventListener("load",e),i.removeEventListener("error",o)};i.addEventListener("load",e),i.addEventListener("error",o),i.src=r,i.complete&&setTimeout(e,0)}).then(function(t){URL.revokeObjectURL(t.src);var n=Ey(By(t),Ay(t));return Dy(n).drawImage(t,0,0),n});var a},ex=function(t,n,e){function o(n,e){return t.then(function(t){return t.toDataURL(n||"image/png",e)})}var r=n.type,r=X(r),i=X(e);return{getType:r,toBlob:function(){return My.resolve(n)},toDataURL:i,toBase64:function(){return e.split(",")[1]},toAdjustedBlob:function(n,e){return t.then(function(t){return tx(t,n,e)})},toAdjustedDataURL:o,toAdjustedBase64:function(t,n){return o(t,n).then(function(t){return t.split(",")[1]})},toCanvas:function(){return t.then(Ab)}}},ox=function(n,t){return tx(n,t).then(function(t){return ex(My.resolve(n),t,n.toDataURL())})},rx=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10],ix=(Zy=[-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0,0,0,0,0,1],jy(function(t,n){return n=Hy(255*n,-255,255),Ny(t,[1,0,0,0,n,0,1,0,0,n,0,0,1,0,n,0,0,0,1,0,0,0,0,0,1])})),ux=jy(function(t,n){var e;return n=Hy(n,-1,1),e=(n*=100)<0?127+n/100*127:127*(0==(e=n%1)?rx[n]:rx[Math.floor(n)]*(1-e)+rx[Math.floor(n)+1]*e)+127,Ny(t,[e/127,0,0,0,.5*(127-e),0,e/127,0,0,.5*(127-e),0,0,e/127,0,.5*(127-e),0,0,0,1,0,0,0,0,0,1])}),ax=[0,-1,0,-1,5,-1,0,-1,0],cx=function(t,n){return 255*Math.pow(t/255,1-n)},sx=function(t){return Ly(t,Zy)},lx=function(t){return i=ax,(r=t).toCanvas().then(function(t){return t=t,n=r.getType(),e=i,o=Dy(t),e=function(t,n,e){for(var o=function(t,n,e){return e<t?t=e:t<n&&(t=n),t},r=Math.round(Math.sqrt(e.length)),i=Math.floor(r/2),u=t.data,a=n.data,c=t.width,s=t.height,l=0;l<s;l++)for(var f=0;f<c;f++){for(var d=0,m=0,g=0,p=0;p<r;p++)for(var h=0;h<r;h++){var v=o(f+h-i,0,c-1),v=4*(o(l+p-i,0,s-1)*c+v),b=e[p*r+h];d+=u[v]*b,m+=u[1+v]*b,g+=u[2+v]*b}var y=4*(l*c+f);a[y]=o(d,0,255),a[1+y]=o(m,0,255),a[2+y]=o(g,0,255)}return n}(o.getImageData(0,0,t.width,t.height),o.getImageData(0,0,t.width,t.height),e),o.putImageData(e,0,0),ox(t,n);var n,e,o});var r,i},fx=function(a,c){return a.toCanvas().then(function(t){for(var n=a.getType(),e=c,o=Dy(t),r=new Array(256),i=0;i<r.length;i++)r[i]=cx(i,e);var u=function(t,n){for(var e=t.data,o=0;o<e.length;o+=4)e[o]=n[e[o]],e[o+1]=n[e[o+1]],e[o+2]=n[e[o+2]];return t}(o.getImageData(0,0,t.width,t.height),r);return o.putImageData(u,0,0),ox(t,n)})},dx=function(t,n,e,o){return Ly(t,(t=zy(),e=e,o=o,n=Hy(n,0,2),e=Hy(e,0,2),o=Hy(o,0,2),Ny(t,[n,0,0,0,0,0,e,0,0,0,0,0,o,0,0,0,0,0,1,0,0,0,0,0,1])))},mx=function(t,n){return ix(t,n)},gx=function(t,n){return ux(t,n)},px=function(t,n){return u=n,(i=t).toCanvas().then(function(t){return t=t,n=i.getType(),e=u,o=Ey(t.width,t.height),r=Dy(o),"v"===e?(r.scale(1,-1),r.drawImage(t,0,-o.height)):(r.scale(-1,1),r.drawImage(t,-o.width,0)),ox(o,n);var n,e,o,r});var i,u},hx=function(t,n,e,o,r){return u=n,a=e,c=o,s=r,(i=t).toCanvas().then(function(t){var n=i.getType(),e=u,o=a,r=c;return r=Ey(r,s),Dy(r).drawImage(t,-e,-o),ox(r,n)});var i,u,a,c,s},vx=function(t,n,e){return r=n,i=e,(o=t).toCanvas().then(function(t){return Uy(t,r,i).then(function(t){return ox(t,o.getType())})});var o,r,i},bx=function(t,n){return l=n,(s=t).toCanvas().then(function(t){return t=t,n=s.getType(),e=((e=l)<0?360+e:e)*Math.PI/180,o=t.width,r=t.height,i=Math.sin(e),u=Math.cos(e),a=Wy(Math.abs(o*u)+Math.abs(r*i)),i=Wy(Math.abs(o*i)+Math.abs(r*u)),u=Ey(a,i),(c=Dy(u)).translate(a/2,i/2),c.rotate(e),c.drawImage(t,-o/2,-r/2),ox(u,n);var n,e,o,r,i,u,a,c});var s,l},yx=function(t,n){return J({dom:{tag:"span",innerHtml:t,classes:["tox-icon","tox-tbtn__icon-wrap"]}},n)},xx=function(t,n){return yx(Kd(t,n),{})},wx=function(t,n,e){return{dom:{tag:"span",innerHtml:e.translate(t),classes:[n+"__select-label"]},behaviours:it([ct.config({})])}},Sx=_("toolbar.button.execute"),kx=((cl={})[sr()]=["disabling","alloy.base.behaviour","toggling","toolbar-button-events"],cl),Cx=_("update-menu-text"),Ox=_("update-menu-icon"),_x=function(t){return"separator"===t.type},Tx={type:"separator"},Ex=function(t,e){t=wt(t,function(t,n){return y(n)?""===n?t:"|"===n?0<t.length&&!_x(t[t.length-1])?t.concat([Tx]):t:Se(e,n.toLowerCase())?t.concat([e[n.toLowerCase()]]):t:t.concat([n])},[]);return 0<t.length&&_x(t[t.length-1])&&t.pop(),t},Dx=function(t,n){return Se(t,"getSubmenuItems")?(n=n,o=(e=t).getSubmenuItems(),o=Yy(o,n),{item:e,menus:Oe(o.menus,Ie(e.value,o.items)),expansions:Oe(o.expansions,Ie(e.value,e.value))}):{item:t,menus:{},expansions:{}};var e,o},Bx=function(t,e,o,n){var r,i=_("primary-menu"),t=Yy(t,o.shared.providers.menuItems());return 0===t.items.length?$.none():(n=mh(i,t.items,e,o,n),r=be(t.menus,function(t,n){return mh(n,t,e,o,!1)}),r=Oe(r,Ie(i,n)),$.from(Gd.tieredData(i,r,t.expansions)))},Ax=function(e,t,o,n){return Xy({text:e.text,icon:e.icon,tooltip:e.tooltip,role:n,fetch:function(t,n){e.fetch(function(t){n(Bx(t,Vm.CLOSE_ON_EXECUTE,o,!1))})},onSetup:e.onSetup,getApi:qy,columns:1,presets:"normal",classes:[],dropdownBehaviours:[Nh.config({})]},t,o.shared)},Mx=function(n,r,i){return function(t){t(k(n,function(t){var n,e,o=t.text.fold(function(){return{}},function(t){return{text:t}});return J(J({type:t.type,active:!1},o),{onAction:function(t){var n=!t.isActive();t.setActive(n),e.storage.set(n),i.shared.getSink().each(function(t){r().getOpt(t).each(function(t){Ka(t.element),q(t,qh,{name:e.name,value:e.storage.get()})})})},onSetup:(n=e=t,function(t){t.setActive(n.storage.get())})})}))}},Fx=function(t,n,e,o,r,i){void 0===e&&(e=[]);n=n.fold(function(){return{}},function(t){return{action:t}}),e=J({buttonBehaviours:it([bp(function(){return t.disabled||i.isDisabled()}),vp(),Nh.config({}),st("button press",[_n("click"),_n("mousedown")])].concat(e)),eventOrder:{click:["button press","alloy.base.behaviour"],mousedown:["button press","alloy.base.behaviour"]}},n),n=Oe(e,{dom:o});return Oe(n,{components:r})},Ix=function(t,n,e,o){void 0===o&&(o=[]);var r={tag:"button",classes:["tox-tbtn"],attributes:t.tooltip.map(function(t){return{"aria-label":e.translate(t),title:e.translate(t)}}).getOr({})},i=t.icon.map(function(t){return xx(t,e.icons)}),i=Cp([i]);return Fx(t,n,o,r,i,e)},Rx=function(t,n,e,o){void 0===o&&(o=[]);t=Ix(t,$.some(n),e,o);return qd.sketch(t)},Vx=function(t,n,e,o,r){void 0===o&&(o=[]),void 0===r&&(r=[]);var i=e.translate(t.text),u=t.icon?t.icon.map(function(t){return xx(t,e.icons)}):$.none(),a=u.isSome()?Cp([u]):[],c=u.isSome()?{}:{innerHtml:i},u=F(t.primary||t.borderless?["tox-button"]:["tox-button","tox-button--secondary"],u.isSome()?["tox-button--icon"]:[],t.borderless?["tox-button--naked"]:[],r),r=J(J({tag:"button",classes:u},c),{attributes:{title:i}});return Fx(t,n,o,r,a,e)},Px=function(t,n,e,o,r){void 0===o&&(o=[]),void 0===r&&(r=[]);t=Vx(t,$.some(n),e,o,r);return qd.sketch(t)},Hx=function(n,e){return function(t){"custom"===e?q(t,qh,{name:n,value:{}}):"submit"===e?Y(t,Kh):"cancel"===e?Y(t,Yh):console.error("Unknown button type: ",e)}},Dd=X([b("field1Name","field1"),b("field2Name","field2"),Fu("onLockedChange"),Bu(["lockClass"]),b("locked",!1),kl("coupledFieldBehaviours",[T,ut])]),Td=X([Jy("field1","field2"),Jy("field2","field1"),Rl({factory:qd,schema:[g("dom")],name:"lock",overrides:function(t){return{buttonBehaviours:it([v.config({selected:t.locked,toggleClass:t.markers.lockClass,aria:{mode:"pressed"}})])}}})]),zx=hs({name:"FormCoupledInputs",configFields:Dd(),partFields:Td(),factory:function(e,t,n,o){return{uid:e.uid,dom:e.dom,components:t,behaviours:Cl(e.coupledFieldBehaviours,[T.config({find:$.some}),ut.config({store:{mode:"manual",getValue:function(t){var t=ms(t,e,["field1","field2"]),n={};return n[e.field1Name]=ut.getValue(t.field1()),n[e.field2Name]=ut.getValue(t.field2()),n},setValue:function(t,n){t=ms(t,e,["field1","field2"]);ke(n,e.field1Name)&&ut.setValue(t.field1(),n[e.field1Name]),ke(n,e.field2Name)&&ut.setValue(t.field2(),n[e.field2Name])}}})]),apis:{getField1:function(t){return Ll(t,e,"field1")},getField2:function(t){return Ll(t,e,"field2")},getLock:function(t){return Ll(t,e,"lock")}}}},apis:{getField1:function(t,n){return t.getField1(n)},getField2:function(t,n){return t.getField2(n)},getLock:function(t,n){return t.getLock(n)}}}),Nx=function(t){var n=/^\s*(\d+(?:\.\d+)?)\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\s*$/.exec(t);return null===n?Z.error(t):(t=parseFloat(n[1]),n=n[2],Z.value({value:t,unit:n}))},Lx=function(t,n){function e(t){return Object.prototype.hasOwnProperty.call(o,t)}var o={"":96,px:96,pt:72,cm:2.54,pc:12,mm:25.4,in:1};return t.unit===n?$.some(t.value):e(t.unit)&&e(n)?o[t.unit]===o[n]?$.some(t.value):$.some(t.value/o[t.unit]*o[n]):$.none()},jx=function(t){return $.none()},Ux=function(o,n){function t(t){return{dom:{tag:"div",classes:["tox-form__group"]},components:t}}function e(e){return x.parts.field({factory:tv,inputClasses:["tox-textfield"],inputBehaviours:it([dt.config({disabled:function(){return o.disabled||n.isDisabled()}}),vp(),Nh.config({}),st("size-input-events",[et(Jo(),function(t,n){q(t,u,{isField1:e})}),et(nr(),function(t,n){q(t,Gh,{name:o.name})})])]),selectOnFocus:!1})}function r(t){return{dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}}}var i=jx,u=_("ratio-event"),a=zx.parts.lock({dom:{tag:"button",classes:["tox-lock","tox-button","tox-button--naked","tox-button--icon"],attributes:{title:n.translate(o.label.getOr("Constrain proportions"))}},components:[{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__lock"],innerHtml:Kd("lock",n.icons)}},{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__unlock"],innerHtml:Kd("unlock",n.icons)}}],buttonBehaviours:it([dt.config({disabled:function(){return o.disabled||n.isDisabled()}}),vp(),Nh.config({})])}),c=zx.parts.field1(t([x.parts.label(r("Width")),e(!0)])),s=zx.parts.field2(t([x.parts.label(r("Height")),e(!1)]));return zx.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:[c,s,t([r("&nbsp;"),a])]}],field1Name:"width",field2Name:"height",locked:!0,markers:{lockClass:"tox-locked"},onLockedChange:function(t,o,n){Nx(ut.getValue(t)).each(function(t){i(t).each(function(t){var n,e;ut.setValue(o,(e=-1!==(e=(t=t).value.toFixed((n=t.unit)in(e={"":0,px:0,pt:1,mm:1,pc:2,ex:2,em:2,ch:2,rem:2,cm:3,in:4,"%":4})?e[n]:1)).indexOf(".")?e.replace(/\.?0*$/,""):e)+t.unit)})})},coupledFieldBehaviours:it([dt.config({disabled:function(){return o.disabled||n.isDisabled()},onDisabled:function(t){zx.getField1(t).bind(x.getField).each(dt.disable),zx.getField2(t).bind(x.getField).each(dt.disable),zx.getLock(t).each(dt.disable)},onEnabled:function(t){zx.getField1(t).bind(x.getField).each(dt.enable),zx.getField2(t).bind(x.getField).each(dt.enable),zx.getLock(t).each(dt.enable)}}),vp(),st("size-input-events2",[et(u,function(t,n){var n=n.event.isField1,e=n?zx.getField1(t):zx.getField2(t),n=n?zx.getField2(t):zx.getField1(t),t=e.map(ut.getValue).getOr(""),e=n.map(ut.getValue).getOr("");n=e,e=Nx(e=t).toOptional(),n=Nx(n).toOptional(),t=function(t,o){return Lx(t,o.unit).map(function(t){return o.value/t}).map(function(t){return n=t,e=o.unit,function(t){return Lx(t,e).map(function(t){return{value:t*n,unit:e}})};var n,e}).getOr(jx)},i=((e=e).isSome()&&n.isSome()?$.some(t(e.getOrDie(),n.getOrDie())):$.none()).getOr(jx)})])])})},Wx={undo:X(_("undo")),redo:X(_("redo")),zoom:X(_("zoom")),back:X(_("back")),apply:X(_("apply")),swap:X(_("swap")),transform:X(_("transform")),tempTransform:X(_("temp-transform")),transformApply:X(_("transform-apply"))},bo=X("save-state"),ya=X("disable"),kd=X("enable"),Gx={formActionEvent:qh,saveState:bo,disable:ya,enable:kd},Xx=tinymce.util.Tools.resolve("tinymce.geom.Rect"),Yx=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),qx=tinymce.util.Tools.resolve("tinymce.util.Observable"),Kx=tinymce.util.Tools.resolve("tinymce.util.VK");function Jx(n){function u(t,s){c.getOpt(t).each(function(t){var e=f.get(),o=mu(t.element),r=uu(t.element),i=s.dom.naturalWidth*e,u=s.dom.naturalHeight*e,a=Math.max(0,o/2-i/2),c=Math.max(0,r/2-u/2),n={left:a.toString()+"px",top:c.toString()+"px",width:i.toString()+"px",height:u.toString()+"px",position:"absolute"};Gi(s,n),l.getOpt(t).each(function(t){Gi(t.element,n)}),d.get().each(function(t){var n=m.get();t.setRect({x:n.x*e+a,y:n.y*e+c,w:n.w*e,h:n.h*e}),t.setClampRect({x:a,y:c,w:i,h:u}),t.setViewPortRect({x:0,y:0,w:o,h:r})})})}function e(t,n){var e,i=nt.fromTag("img");return ot(i,"src",n),e=i.dom,new Cm(function(t){var n=function(){e.removeEventListener("load",n),t(e)};e.complete?t(e):e.addEventListener("load",n)}).then(function(){return c.getOpt(t).map(function(t){var n=nu({element:i}),n=(ct.replaceAt(t,1,$.some(n)),a.get()),e={x:0,y:0,w:i.dom.naturalWidth,h:i.dom.naturalHeight};a.set(e);var r,o=Xx.inflate(e,-20,-20);return m.set(o),n.w===e.w&&n.h===e.h||(r=i,c.getOpt(t).each(function(t){var n=mu(t.element),t=uu(t.element),e=r.dom.naturalWidth,o=r.dom.naturalHeight,n=Math.min(n/e,t/o);1<=n?f.set(1):f.set(n)})),u(t,i),i})})}var l=ft({dom:{tag:"div",classes:["tox-image-tools__image-bg"],attributes:{role:"presentation"}}}),f=tt(1),d=tt($.none()),m=tt({x:0,y:0,w:1,h:1}),a=tt({x:0,y:0,w:1,h:1}),t=zh.sketch({dom:{tag:"div",classes:["tox-image-tools__image"]},components:[l.asSpec(),{dom:{tag:"img",attributes:{src:n}}},{dom:{tag:"div"},behaviours:it([st("image-panel-crop-events",[Fr(function(t){c.getOpt(t).each(function(t){t=t.element.dom,t=iw({x:10,y:10,w:100,h:100},{x:0,y:0,w:200,h:200},{x:0,y:0,w:200,h:200},t,K);t.toggleVisibility(!1),t.on("updateRect",function(t){var t=t.rect,n=f.get(),t={x:Math.round(t.x/n),y:Math.round(t.y/n),w:Math.round(t.w/n),h:Math.round(t.h/n)};m.set(t)}),d.set($.some(t))})})])])}],containerBehaviours:it([ct.config({}),st("image-panel-events",[Fr(function(t){e(t,n)})])])}),c=ft(t);return{memContainer:c,updateSrc:e,zoom:function(t,n){var e=f.get(),n=0<n?Math.min(2,e+.1):Math.max(.1,e-.1);f.set(n),c.getOpt(t).each(function(t){var n=t.components()[1].element;u(t,n)})},showCrop:function(){d.get().each(function(t){t.toggleVisibility(!0)})},hideCrop:function(){d.get().each(function(t){t.toggleVisibility(!1)})},getRect:function(){return m.get()},getMeasurements:function(){var t=a.get();return{width:t.w,height:t.h}}}}function $x(t,n,e,o,r){return Rx({name:t,icon:$.some(n),disabled:e,tooltip:$.some(t),primary:!1,borderless:!1},o,r)}function Qx(t,n){n?dt.enable(t):dt.disable(t)}function Zx(t){function e(t){l.set(t)}function o(t){return{blob:t,url:URL.createObjectURL(t)}}function r(t){URL.revokeObjectURL(t.url)}function n(){f.get().each(r),f.set($.none())}function i(t){t=o(t),e(t);var n=d.add(t).removed;return by.each(n,r),t.url}var u,a,c,s,l=tt(t),f=tt($.none()),d=(a=-1,{data:u=[],add:function(t){var n=u.splice(++a);return u.push(t),{state:t,removed:n}},undo:function(){if(c())return u[--a]},redo:function(){if(s())return u[++a]},canUndo:c=function(){return 0<a},canRedo:s=function(){return-1!==a&&a<u.length-1}});return d.add(t),{getBlobState:function(){return l.get()},setBlobState:e,addBlobState:i,getTempState:function(){return f.get().fold(function(){return l.get()},function(t){return t})},updateTempState:function(t){t=o(t);return n(),f.set($.some(t)),t.url},addTempState:function(t){t=o(t);return f.set($.some(t)),t.url},applyTempState:function(n){return f.get().fold(K,function(t){i(t.blob),n()})},destroyTempState:n,undo:function(){var t=d.undo();return e(t),t.url},redo:function(){var t=d.redo();return e(t),t.url},getHistoryStates:function(){return{undoEnabled:d.canUndo(),redoEnabled:d.canRedo()}}}}function t0(t,n){function r(n,t,e,o,r){return f(n),u=i=t,new My(function(t){var n=new FileReader;n.onloadend=function(){t(n.result)},n.readAsDataURL(u)}).then(function(t){return ex(nx(i),i,t)}).then(e).then(l).then(o).then(function(t){return m(n,t).then(function(t){return s(n),r(),d(n),t})}).catch(function(t){return console.log(t),d(n),t});var i,u}function i(t,n,e){var o=c.getBlobState().blob;r(t,o,n,function(t){return c.updateTempState(t)},e)}function u(t){var n=c.getBlobState().url;return c.destroyTempState(),s(t),n}var o,a,c=Zx(t.currentState),s=function(t){var n=c.getHistoryStates();p.updateButtonUndoStates(t,n.undoEnabled,n.redoEnabled),q(t,Gx.formActionEvent,{name:Gx.saveState(),value:n.undoEnabled})},l=function(t){return t.toBlob()},f=function(t){q(t,Gx.formActionEvent,{name:Gx.disable(),value:{}})},d=function(t){e.getApplyButton(t).each(function(t){dt.enable(t)}),q(t,Gx.formActionEvent,{name:Gx.enable(),value:{}})},m=function(t,n){return f(t),g.updateSrc(t,n)},g=Jx(t.currentState.url),p=(o=ft($x("Undo","undo",!0,function(t){q(t,Wx.undo(),{direction:1})},t=n)),a=ft($x("Redo","redo",!0,function(t){q(t,Wx.redo(),{direction:1})},t)),{container:zh.sketch({dom:{tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools__sidebar"]},components:[o.asSpec(),a.asSpec(),$x("Zoom in","zoom-in",!1,function(t){q(t,Wx.zoom(),{direction:1})},t),$x("Zoom out","zoom-out",!1,function(t){q(t,Wx.zoom(),{direction:-1})},t)]}),updateButtonUndoStates:function(t,n,e){o.getOpt(t).each(function(t){Qx(t,n)}),a.getOpt(t).each(function(t){Qx(t,e)})}}),e=$y(g,n);return{dom:{tag:"div",attributes:{role:"presentation"}},components:[e.memContainer.asSpec(),g.memContainer.asSpec(),p.container],behaviours:it([ut.config({store:{mode:"manual",getValue:function(){return c.getBlobState()}}}),st("image-tools-events",[et(Wx.undo(),function(n,t){var e=c.undo();m(n,e).then(function(t){d(n),s(n)})}),et(Wx.redo(),function(n,t){var e=c.redo();m(n,e).then(function(t){d(n),s(n)})}),et(Wx.zoom(),function(t,n){n=n.event.direction;g.zoom(t,n)}),et(Wx.back(),function(t,n){var e,t=u(e=t);m(e,t).then(function(t){d(e)}),(0,n.event.swap)(),g.hideCrop()}),et(Wx.apply(),function(t,n){c.applyTempState(function(){u(t),(0,n.event.swap)()})}),et(Wx.transform(),function(t,n){return i(t,n.event.transform,K)}),et(Wx.tempTransform(),function(t,n){var n=n.event.transform,e=c.getTempState().blob;r(t,e,n,function(t){return c.addTempState(t)},K)}),et(Wx.transformApply(),function(t,n){var e=t,t=n.event.transform,n=n.event.swap,o=c.getBlobState().blob;r(e,o,t,function(t){t=c.addBlobState(t);return u(e),t},n)}),et(Wx.swap(),function(n,t){p.updateButtonUndoStates(n,!1,!1);var e=t.event.transform,o=t.event.swap;e.fold(function(){o()},function(t){i(n,t,o)})})]),kb()])}}function n0(t){return!Se(t,"items")}function e0(n,e,t,o){return k(t,function(t){return n0(t)?{type:"togglemenuitem",text:t.text,value:t.value,active:t.value===o,onAction:function(){ut.setValue(n,t.value),q(n,Gh,{name:e}),lt.focus(n)}}:{type:"nestedmenuitem",text:t.text,getSubmenuItems:function(){return e0(n,e,t.items,o)}}})}function o0(t,n){return Mt(t,function(t){return n0(t)?Jl(t.value===n,t):o0(t.items,n)})}function r0(e,n){var t=e.label.map(function(t){return Wh(t,n)}),o=[dt.config({disabled:function(){return e.disabled||n.isDisabled()}}),vp(),at.config({mode:"execution",useEnter:!0!==e.multiline,useControlEnter:!0===e.multiline,execute:function(t){return Y(t,Kh),$.some(!0)}}),st("textfield-change",[et(tr(),function(t,n){q(t,Gh,{name:e.name})}),et(ar(),function(t,n){q(t,Gh,{name:e.name})})]),Nh.config({})],r=e.validation.map(function(e){return bv.config({getRoot:function(t){return Gr(t.element)},invalidClass:"tox-invalid",validator:{validate:function(t){var t=ut.getValue(t),n=e.validator(t);return hv(!0===n?Z.value(t):Z.error(n))},validateOnLoad:e.validateOnLoad}})}).toArray(),i=e.placeholder.fold(X({}),function(t){return{placeholder:n.translate(t)}}),u=e.inputMode.fold(X({}),function(t){return{inputmode:t}}),i=J(J({},i),u),u=x.parts.field({tag:!0===e.multiline?"textarea":"input",inputAttributes:i,inputClasses:[e.classname],inputBehaviours:it(Ct([o,r])),selectOnFocus:!1,factory:tv}),i=(e.flex?["tox-form__group--stretched"]:[]).concat(e.maximized?["tox-form-group--maximize"]:[]),o=[dt.config({disabled:function(){return e.disabled||n.isDisabled()},onDisabled:function(t){x.getField(t).each(dt.disable)},onEnabled:function(t){x.getField(t).each(dt.enable)}}),vp()];return jh(t,u,i,o)}function i0(t){var n=tt(null);return _i({readState:function(){return{timer:null!==n.get()?"set":"unset"}},setTimer:function(t){n.set(t)},cancel:function(){var t=n.get();null!==t&&t.cancel()}})}function u0(t,n,e){e=ut.getValue(e),ut.setValue(n,e),sw(n)}function a0(t,n){var t=t.element,e=Qi(t),o=t.dom;"number"!==ai(t,"type")&&n(o,e)}function c0(t){return{type:"menuitem",value:t.url,text:t.title,meta:{attach:t.attach},onAction:K}}function s0(i,n,u){function r(t){t=ut.getValue(t),u.addToHistory(t.value,i.filetype)}var t,e,a=n.shared.providers,o=x.parts.field({factory:fw,dismissOnBlur:!0,inputClasses:["tox-textfield"],sandboxClasses:["tox-dialog__popups"],inputAttributes:{"aria-errormessage":bw,type:"url"},minChars:0,responseTime:0,fetch:function(t){e=i.filetype,t=t,o=u,t=ut.getValue(t),r=void 0!==t.meta.text?t.meta.text:t.value;var e,o,r,t=o.getLinkInformation().fold(function(){return[]},function(t){var n=vw(r,(n=o.getHistory(e),k(n,function(t){return pw(t,t)})));return"file"===e?(t=[n,vw(r,hw("header",t.targets)),vw(r,Ct([$.from(t.anchorTop).map(function(t){return pw("<top>",t)}).toArray(),hw("anchor",t.targets),$.from(t.anchorBottom).map(function(t){return pw("<bottom>",t)}).toArray()]))],wt(t,function(t,n){return 0===t.length||0===n.length?t.concat(n):t.concat(gw,n)},[])):n}),t=Bx(t,Vm.BUBBLE_TO_SANDBOX,n,!1);return hv(t)},getHotspot:function(t){return m.getOpt(t)},onSetValue:function(t,n){t.hasConfigured(bv)&&bv.run(t).get(K)},typeaheadBehaviours:it(Ct([u.getValidationHandler().map(function(o){return bv.config({getRoot:function(t){return Gr(t.element)},invalidClass:"tox-control-wrap--status-invalid",notify:{onInvalid:function(t,n){s.getOpt(t).each(function(t){ot(t.element,"title",a.translate(n))})}},validator:{validate:function(t){var n=ut.getValue(t);return mw(function(e){o({type:i.filetype,url:n.value},function(t){var n;"invalid"===t.status?(n=Z.error(t.message),e(n)):(n=Z.value(t.message),e(n))})})},validateOnLoad:!1}})}).toArray(),[dt.config({disabled:function(){return i.disabled||a.isDisabled()}}),Nh.config({}),st("urlinput-events",Ct(["file"===i.filetype?[et(tr(),function(t){q(t,Gh,{name:i.name})})]:[],[et(nr(),function(t){q(t,Gh,{name:i.name}),r(t)}),et(ar(),function(t){q(t,Gh,{name:i.name}),r(t)})]]))]])),eventOrder:((o={})[tr()]=["streaming","urlinput-events","invalidating"],o),model:{getDisplayText:function(t){return t.value},selectsOver:!1,populateFromBrowse:!1},markers:{openClass:"tox-textfield--popup-open"},lazySink:n.shared.getSink,parts:{menu:um(0,0,"normal")},onExecute:function(t,n,e){q(n,Kh,{})},onItemExecute:function(t,n,e,o){r(t),q(t,Gh,{name:i.name})}}),c=i.label.map(function(t){return Wh(t,a)}),s=ft((l="invalid",t=$.some(bw),void 0===e&&(e=l),{dom:{tag:"div",classes:["tox-icon","tox-control-wrap__status-icon-"+l],innerHtml:Kd("warning",a.icons),attributes:J({title:a.translate(e),"aria-live":"polite"},t.fold(function(){return{}},function(t){return{id:t}}))}})),l=ft({dom:{tag:"div",classes:["tox-control-wrap__status-icon-wrap"]},components:[s.asSpec()]}),f=u.getUrlPicker(i.filetype),d=_("browser.url.event"),m=ft({dom:{tag:"div",classes:["tox-control-wrap"]},components:[o,l.asSpec()],behaviours:it([dt.config({disabled:function(){return i.disabled||a.isDisabled()}})])}),g=ft(Px({name:i.name,icon:$.some("browse"),text:i.label.getOr(""),disabled:i.disabled,primary:!1,borderless:!0},function(t){return Y(t,d)},a,[],["tox-browse-url"]));return x.sketch({dom:Sh([]),components:c.toArray().concat([{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:Ct([[m.asSpec()],f.map(function(){return g.asSpec()}).toArray()])}]),fieldBehaviours:it([dt.config({disabled:function(){return i.disabled||a.isDisabled()},onDisabled:function(t){x.getField(t).each(dt.disable),g.getOpt(t).each(dt.disable)},onEnabled:function(t){x.getField(t).each(dt.enable),g.getOpt(t).each(dt.enable)}}),vp(),st("url-input-events",[et(d,function(o){T.getCurrent(o).each(function(n){var t=ut.getValue(n),e=J({fieldname:i.name},t);f.each(function(t){t(e).get(function(t){ut.setValue(n,t),q(o,Gh,{name:i.name})})})})})])])})}function l0(r){return function(n,e,o){return B(e,"name").fold(function(){return r(e,o)},function(t){return n.field(t,r(e,o))})}}function f0(n,t,e){var o=Oe(e,{shared:{interpreter:function(t){return ww(n,t,o)}}});return ww(n,t,o)}function d0(e){return function(t){if(a(n=t)&&1===n.nodeType){if(t.contentEditable===e)return!0;if(t.getAttribute("data-mce-contenteditable")===e)return!0}var n;return!1}}function m0(t,n,e,o,r){return{type:t,title:n,url:e,level:o,attach:r}}function g0(t){return t.innerText||t.textContent}function p0(t){return t&&"A"===t.nodeName&&void 0!==(t.id||t.name)&&v0(t)}function h0(t){return t&&/^(H[1-6])$/.test(t.nodeName)}function v0(t){return function(t){for(;t=t.parentNode;){var n=t.contentEditable;if(n&&"inherit"!==n)return Aw(t)}return!1}(t)&&!Mw(t)}function b0(t){return h0(t)&&v0(t)}function y0(t){var n,e=t.id?t.id:_("h");return m0("header",g0(t),"#"+e,h0(n=t)?parseInt(n.nodeName.substr(1),10):0,function(){t.id=e})}function x0(t){var n=t.id||t.name,t=g0(t);return m0("anchor",t||"#"+n,"#"+n,0,K)}function w0(t){return 0<Bw(t.title).length}function S0(t){return t=k(tl(nt.fromDom(t),"h1,h2,h3,h4,h5,h6,a:not([href])"),function(t){return t.dom}),yt(k(yt(t,b0),y0).concat(k(yt(t,p0),x0)),w0)}function k0(t){return y(t)&&/^https?/.test(t)}function C0(t){return w(t)&&It(t,function(t){return!(c(t=t)&&t.length<=5&&_t(t,k0))}).isNone()}function O0(){var t,n=$p.getItem(Fw);if(null===n)return{};try{t=JSON.parse(n)}catch(t){if(t instanceof SyntaxError)return console.log("Local storage "+Fw+" was not valid JSON",t),{};throw t}return C0(t)?t:(console.log("Local storage "+Fw+" was not valid format",t),{})}function _0(t){var n=O0();return Object.prototype.hasOwnProperty.call(n,t)?n[t]:[]}function T0(n,t){var e,o;if(k0(n)){e=O0(),o=Object.prototype.hasOwnProperty.call(e,t)?e[t]:[],o=yt(o,function(t){return t!==n}),e[t]=[n].concat(o).slice(0,5);t=e;if(!C0(t))throw new Error("Bad format for history:\n"+JSON.stringify(t));$p.setItem(Fw,JSON.stringify(t))}}function E0(t){return!!t}function D0(t){return be(by.makeMap(t,/[, ]/),E0)}function B0(t){return $.from(t.getParam("file_picker_callback")).filter(C)}function A0(t){return $.from(t).filter(y).getOrUndefined()}function M0(t,n,e){var o,r,i,u,a,c,s,l,f,d=tt(!1),m={isPositionedAtTop:function(){return"top"===o.get()},getDockingMode:(o=tt(fp(n)?"bottom":"top")).get,setDockingMode:o.set},g={shared:{providers:{icons:function(){return n.ui.registry.getAll().icons},menuItems:function(){return n.ui.registry.getAll().menuItems},translate:vg.translate,isDisabled:function(){return n.mode.isReadOnly()||n.ui.isDisabled()},getSetting:n.getParam.bind(n)},interpreter:function(t){return ww(xw,t,g)},anchors:kw(n,e,m.isPositionedAtTop),header:m,getSink:function(){return Z.value(t)}},urlinput:Iw(n),styleselect:(i=n,u=function(t){var n=t.items;return void 0!==n&&0<n.length?Ot(n,u):[t.format]},a=tt([]),c=tt([]),s=tt([]),l=tt([]),f=tt(!1),i.on("PreInit",function(t){var n=Tw(i),n=Dw(i,n,p,h);a.set(n),c.set(Ot(n,u))}),i.on("addStyleModifications",function(t){var n=Dw(i,t.items,p,h);s.set(n),f.set(t.replace),l.set(Ot(n,u))}),{getData:function(){var t=f.get()?[]:a.get(),n=s.get();return t.concat(n)},getFlattenedKeys:function(){var t=f.get()?[]:c.get(),n=l.get();return t.concat(n)}}),colorinput:Cw(n),dialog:{isDraggableModal:(r=n,function(){return r.getParam("draggable_modal",!1,"boolean")})},isContextMenuOpen:function(){return d.get()},setContextMenuState:function(t){return d.set(t)}};function p(t){return function(){return i.formatter.match(t)}}function h(n){return function(){var t=i.formatter.get(n);return void 0!==t?$.some({tag:0<t.length&&(t[0].inline||t[0].block)||"div",styles:i.dom.parseStyle(i.formatter.getCssText(n))}):$.none()}}return g}function F0(t,n,e){return{within:t,extra:n,withinWidth:e}}function I0(t,n,o){e=function(t,n){var e=o(t);return $.some({element:t,start:n,finish:n+e,width:e})};var e,t=wt(t,function(n,t){return e(t,n.len).fold(X(n),function(t){return{len:t.finish,list:n.list.concat([t])}})},{len:0,list:[]}).list,r=yt(t,function(t){return t.finish<=n}),i=xt(r,function(t,n){return t+n.width},0);return{within:r,extra:t.slice(r.length),withinWidth:i}}function R0(t){return k(t,function(t){return t.element})}function V0(t,n){t=yv.getCoupled(t,"toolbarSandbox"),h.isOpen(t)?h.close(t):h.open(t,n.toolbar())}function P0(t,n,e,o){var r=e.getBounds.map(function(t){return t()}),e=e.lazySink(t).getOrDie();fl.positionWithinBounds(e,{anchor:"hotspot",hotspot:t,layouts:o,overrides:{maxWidthFunction:Rw()}},n,r)}function H0(t,n,e,o,r){Pw.setGroups(n,r),P0(t,n,e,o),v.on(t)}function z0(t){return k(t,function(t){return ru(t)})}function N0(t,e,o){Nw(t,o,function(n){o.overflowGroups.set(n),e.getOpt(t).each(function(t){Lw.setGroups(t,z0(n))})})}function L0(t,n){Ri(t.element,n.closedClass),Fi(t.element,n.openClass),Ji(t.element,Gw(n))}function j0(t,n,e,o){o=o.getOrThunk(function(){return Xw(n,t.element)}),e.setCollapsed(),rt(t.element,Gw(n),o),$i(t.element),e=Ww(t,n),Ri(e,n.growingClass),Fi(e,n.shrinkingClass),qw(t,n),n.onStartShrink(t)}function U0(t,n,e){return t=Ww(t,n),!0===Vi(t,n.growingClass)}function W0(t,n,e){return t=Ww(t,n),!0===Vi(t,n.shrinkingClass)}function G0(n,e){Ll(n,e,"overflow-button").bind(function(){return Ll(n,e,"overflow")}).each(function(t){X0(n,e),Qw.toggleGrow(t)})}function X0(t,e){Ll(t,e,"overflow").each(function(n){Nw(t,e,function(t){t=k(t,function(t){return ru(t)});Pw.setGroups(n,t)}),Ll(t,e,"overflow-button").each(function(t){Qw.hasGrown(n)&&v.on(t)}),Qw.refresh(n)})}function Y0(t){var n=t.cyclicKeying?"cyclic":"acyclic";return{uid:t.uid,dom:{tag:"div",classes:["tox-toolbar-overlord"]},parts:{"overflow-group":nS({title:$.none(),items:[]}),"overflow-button":Ix({name:"more",icon:$.some("more-drawer"),disabled:!1,tooltip:$.some("More..."),primary:!1,borderless:!1},$.none(),t.providers)},splitToolbarBehaviours:oS(t,n)}}function q0(t){return Je("menubutton",uS,t)}function K0(n){return{isDisabled:function(){return dt.isDisabled(n)},setDisabled:function(t){return dt.set(n,t)}}}function J0(n){return{setActive:function(t){v.set(n,t)},isActive:function(){return v.isOn(n)},isDisabled:function(){return dt.isDisabled(n)},setDisabled:function(t){return dt.set(n,t)}}}function $0(t,n,e){var o,r=tt(K),i=gS(t.icon,t.text,t.tooltip,$.none(),$.none(),e);return qd.sketch({dom:i.dom,components:i.components,eventOrder:kx,buttonBehaviours:it([st("toolbar-button-events",[(o={onAction:t.onAction,getApi:n.getApi},Vr(function(n,t){xp(o,n)(function(t){q(n,Sx,{buttonApi:t}),o.onAction(t)})})),wp(n,r),Sp(n,r)]),yp(function(){return t.disabled||e.isDisabled()}),vp()].concat(n.toolbarButtonBehaviours))})}function Q0(n,t){function e(e){return{isDisabled:function(){return dt.isDisabled(e)},setDisabled:function(t){return dt.set(e,t)},setIconFill:function(t,n){ua(e.element,'svg path[id="'+t+'"], rect[id="'+t+'"]').each(function(t){ot(t,"fill",n)})},setIconStroke:function(t,n){ua(e.element,'svg path[id="'+t+'"], rect[id="'+t+'"]').each(function(t){ot(t,"stroke",n)})},setActive:function(n){e.getSystem().isConnected()&&(ot(e.element,"aria-pressed",n),ua(e.element,"span").each(function(t){e.getSystem().getByDom(t).each(function(t){return v.set(t,n)})}))},isActive:function(){return ua(e.element,"span").exists(function(t){return!!e.getSystem().isConnected()&&e.getSystem().getByDom(t).exists(v.isOn)})}}}var o,r,i,u=_("channel-update-split-dropdown-display"),a=tt(K),c={getApi:e,onSetup:n.onSetup};return sS.sketch({dom:{tag:"div",classes:["tox-split-button"],attributes:J({"aria-pressed":!1},lS(n.tooltip,t.providers))},onExecute:function(t){n.onAction(e(t))},onItemExecute:function(t,n,e){},splitDropdownBehaviours:it([Hg(t.providers.isDisabled),vp(),st("split-dropdown-events",[et(fS,lt.focus),wp(c,a),Sp(c,a)]),Nb.config({})]),eventOrder:((c={})[xr()]=["alloy.base.behaviour","split-dropdown-events"],c),toggleClass:"tox-tbtn--enabled",lazySink:t.getSink,fetch:(o=e,r=n,i=t.providers,function(n){return pv(function(t){return r.fetch(t)}).map(function(t){return $.from(gh(Oe(rp(_("menu-value"),t,function(t){r.onItemAction(o(n),t)},r.columns,r.presets,Vm.CLOSE_ON_EXECUTE,r.select.getOr(d),i),{movement:ip(r.columns,r.presets),menuBehaviours:fg("auto"!==r.columns?[]:[Fr(function(e,t){cm(e,4,im(r.presets)).each(function(t){var n=t.numRows,t=t.numColumns;at.setGridSize(e,n,t)})})])})))})}),parts:{menu:um(0,n.columns,n.presets)},components:[sS.parts.button(gS(n.icon,n.text,$.none(),$.some(u),$.some([v.config({toggleClass:"tox-tbtn--enabled",toggleOnExecute:!1})]),t.providers)),sS.parts.arrow({dom:{tag:"button",classes:["tox-tbtn","tox-split-button__chevron"],innerHtml:Kd("chevron-down",t.providers.icons)},buttonBehaviours:it([Hg(t.providers.isDisabled),vp()])}),sS.parts["aria-descriptor"]({text:t.providers.translate("To open the popup, press Shift+Enter")})]})}function Z0(n,t){return t=yt(t,function(t){return t.predicate(n.dom)}),{contextToolbars:(t=bt(t,function(t){return"contexttoolbar"===t.type})).pass,contextForms:t.fail}}function tw(t,n,e){var i,u,r,a,c,o=e.dataset,s="basic"===o.type?function(){return k(o.data,function(t){return Ew(t,e.isSelectedFor,e.getPreviewFor)})}:o.getData;return{items:(i=n,u=e,r=function(t,n,e,o){var r=i.shared.providers.translate(t.title);return"separator"===t.type?$.some({type:"separator",text:r}):"submenu"!==t.type?$.some(J({type:"togglemenuitem",text:r,icon:t.icon,active:t.isSelected(o),disabled:e,onAction:u.onAction(t)},t.getStylePreview().fold(function(){return{}},function(t){return{meta:{style:t}}}))):(e=Ot(t.getStyleItems(),function(t){return a(t,n,o)}),0===n&&e.length<=0?$.none():$.some({type:"nestedmenuitem",text:r,disabled:e.length<=0,getSubmenuItems:function(){return Ot(t.getStyleItems(),function(t){return a(t,n,o)})}}))},a=function(t,n,e){var o="formatter"===t.type&&u.isInvalid(t);return 0===n?o?[]:r(t,n,!1,e).toArray():r(t,n,o,e).toArray()},{validateItems:c=function(t){var n=u.getCurrentValue(),e=u.shouldHide?0:1;return Ot(t,function(t){return a(t,e,n)})},getFetch:function(o,r){return function(t,n){var e=r(),e=c(e);n(Bx(e,Vm.CLOSE_ON_EXECUTE,o,!1))}}}),getStyleItems:s}}function nw(e,t,o){var n=(r=tw(0,t,o)).items,r=r.getStyleItems;return Xy({text:o.icon.isSome()?$.none():$.some(""),icon:o.icon,tooltip:$.from(o.tooltip),role:$.none(),fetch:n.getFetch(t,r),onSetup:function(n){function t(){var t=n.getComponent();t.getSystem().isConnected()&&o.updateText(t)}return t(),e.on("NodeChange",t),function(){e.off("NodeChange",t)}},getApi:function(t){return{getComponent:X(t)}},columns:1,presets:"normal",classes:o.icon.isSome()?[]:["bespoke"],dropdownBehaviours:[]},"tox-tbtn",t.shared)}var ew,ow,rw=0,iw=function(a,e,c,o,r){function s(t,n){return{x:n.x-t.x,y:n.y-t.y,w:n.w,h:n.h}}function u(t,n,e,o){var r=n.x,i=n.y,u=n.w,n=n.h;r+=e*t.deltaX,i+=o*t.deltaY,(u+=e*t.deltaW)<20&&(u=20),(n+=o*t.deltaH)<20&&(n=20),a=Xx.clamp({x:r,y:i,w:u,h:n},c,"move"===t.name),e=s(c,a),g.fire("updateRect",{rect:e}),l(e)}function n(n){function t(t,n){n.h<0&&(n.h=0),n.w<0&&(n.w=0),Yx("#"+b+"-"+t,o).css({left:n.x,top:n.y,width:n.w,height:n.h})}by.each(f,function(t){Yx("#"+b+"-"+t.name,o).css({left:n.w*t.xMul+n.x,top:n.h*t.yMul+n.y})}),t("top",{x:e.x,y:e.y,w:e.w,h:n.y-e.y}),t("right",{x:n.x+n.w,y:n.y,w:e.w-n.x-n.w+e.x,h:n.h}),t("bottom",{x:e.x,y:n.y+n.h,w:e.w,h:e.h-n.y-n.h+e.y}),t("left",{x:e.x,y:n.y,w:n.x-e.x,h:n.h}),t("move",n)}function l(t){var n;m((n=c,{x:t.x+n.x,y:t.y+n.y,w:t.w,h:t.h}))}var t,i="tox-",b="tox-crid-"+rw++,f=[{name:"move",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:0,deltaH:0,label:"Crop Mask"},{name:"nw",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:-1,deltaH:-1,label:"Top Left Crop Handle"},{name:"ne",xMul:1,yMul:0,deltaX:0,deltaY:1,deltaW:1,deltaH:-1,label:"Top Right Crop Handle"},{name:"sw",xMul:0,yMul:1,deltaX:1,deltaY:0,deltaW:-1,deltaH:1,label:"Bottom Left Crop Handle"},{name:"se",xMul:1,yMul:1,deltaX:0,deltaY:0,deltaW:1,deltaH:1,label:"Bottom Right Crop Handle"}],d=["top","right","bottom","left"],m=function(t){n(a=t)},g=(Yx('<div id="'+b+'" class="'+i+'croprect-container" role="grid" aria-dropeffect="execute">').appendTo(o),by.each(d,function(t){Yx("#"+b,o).append('<div id="'+b+"-"+t+'"class="'+i+'croprect-block" style="display: none" data-mce-bogus="all">')}),by.each(f,function(t){Yx("#"+b,o).append('<div id="'+b+"-"+t.name+'" class="'+i+"croprect-handle "+i+"croprect-handle-"+t.name+'"style="display: none" data-mce-bogus="all" role="gridcell" tabindex="-1" aria-label="'+t.label+'" aria-grabbed="false" title="'+t.label+'">')}),t=by.map(f,function(n){var e,t,s,l,f,d,m,g,p,h,v;return t=b,s={document:o.ownerDocument,handle:b+"-"+n.name,start:function(){e=a},drag:function(t){u(n,e,t.deltaX,t.deltaY)}},g=s.document||document,p=g.getElementById(s.handle||t),h=function(t){if(Qy(t),t.button!==f)return v(t);t.deltaX=t.screenX-d,t.deltaY=t.screenY-m,t.preventDefault(),s.drag(t)},v=function(t){Qy(t),Yx(g).off("mousemove touchmove",h).off("mouseup touchend",v),l.remove(),s.stop&&s.stop(t)},Yx(p).on("mousedown touchstart",function(t){n=Math.max,e=g.documentElement,o=g.body,u=n(e.scrollWidth,o.scrollWidth),c=n(e.clientWidth,o.clientWidth),a=n(e.offsetWidth,o.offsetWidth),r=n(e.scrollHeight,o.scrollHeight),i=n(e.clientHeight,o.clientHeight);var n,e,o,r,i,u,a={width:u<a?c:u,height:r<n(e.offsetHeight,o.offsetHeight)?i:r},c=(Qy(t),t.preventDefault(),f=t.button,p);d=t.screenX,m=t.screenY,u=window.getComputedStyle?window.getComputedStyle(c,null).getPropertyValue("cursor"):c.runtimeStyle.cursor,l=Yx("<div></div>").css({position:"absolute",top:0,left:0,width:a.width,height:a.height,zIndex:2147483647,opacity:1e-4,cursor:u}).appendTo(g.body),Yx(g).on("mousemove touchmove",h).on("mouseup touchend",v),s.start(t)}),{destroy:function(){Yx(p).off()}}}),n(a),Yx(o).on("focusin focusout",function(t){Yx(t.target).attr("aria-grabbed","focus"===t.type?"true":"false")}),Yx(o).on("keydown",function(n){function t(t,n,e,o,r){t.stopPropagation(),t.preventDefault(),u(i,e,o,r)}var i;by.each(f,function(t){if(n.target.id===b+"-"+t.name)return i=t,!1});switch(n.keyCode){case Kx.LEFT:t(n,0,a,-10,0);break;case Kx.RIGHT:t(n,0,a,10,0);break;case Kx.UP:t(n,0,a,0,-10);break;case Kx.DOWN:t(n,0,a,0,10);break;case Kx.ENTER:case Kx.SPACEBAR:n.preventDefault(),r()}}),by.extend({toggleVisibility:function(t){var n=by.map(f,function(t){return"#"+b+"-"+t.name}).concat(by.map(d,function(t){return"#"+b+"-"+t})).join(",");t?Yx(n,o).show():Yx(n,o).hide()},setClampRect:function(t){c=t,n(a)},setRect:m,getInnerRect:function(){return s(c,a)},setInnerRect:l,setViewPortRect:function(t){e=t,n(a)},destroy:function(){by.each(t,function(t){t.destroy()}),t=[]}},qx));return g},uw="data-value",aw=ql({name:"HtmlSelect",configFields:[g("options"),Zc("selectBehaviours",[lt,ut]),b("selectClasses",[]),b("selectAttributes",{}),p("data")],factory:function(e,t){var n=k(e.options,function(t){return{dom:{tag:"option",value:t.value,innerHtml:t.text}}}),o=e.data.map(function(t){return Ie("initialValue",t)}).getOr({});return{uid:e.uid,dom:{tag:"select",classes:e.selectClasses,attributes:e.selectAttributes},components:n,behaviours:ns(e.selectBehaviours,[lt.config({}),ut.config({store:J({mode:"manual",getValue:function(t){return Qi(t.element)},setValue:function(t,n){St(e.options,function(t){return t.value===n}).isSome()&&Kn(t.element,n)}},o)})])}}}),di=Object.freeze({__proto__:null,events:function(t,n){var e=t.stream.streams.setup(t,n);return Ar([et(t.event,e),Ir(function(){return n.cancel()})].concat(t.cancelEvent.map(function(t){return[et(t,function(){return n.cancel()})]}).getOr([])))}}),vo=Object.freeze({__proto__:null,throttle:i0,init:function(t){return t.stream.streams.state(t)}}),Vs=[ao("stream",Xt("mode",{throttle:[g("delay"),b("stopEvent",!0),ha("streams",{setup:function(t,n){var e=t.stream,o=Qd(t.onStream,e.delay);return n.setTimer(o),function(t,n){o.throttle(t,n),e.stopEvent&&n.stop()}},state:i0})]})),b("event","input"),p("cancelEvent"),Fu("onStream")],cw=Wu({fields:Vs,name:"streaming",active:di,state:vo}),sw=function(t){a0(t,function(t,n){t.setSelectionRange(n.length,n.length)})},lw=X("alloy.typeahead.itemexecute"),Fl=X([p("lazySink"),g("fetch"),b("minChars",5),b("responseTime",1e3),t("onOpen"),b("getHotspot",$.some),b("getAnchorOverrides",X({})),b("layouts",$.none()),b("eventOrder",{}),ln("model",{},[b("getDisplayText",function(t){return void 0!==t.meta&&void 0!==t.meta.text?t.meta.text:t.value}),b("selectsOver",!0),b("populateFromBrowse",!0)]),t("onSetValue"),Mu("onExecute"),t("onItemExecute"),b("inputClasses",[]),b("inputAttributes",{}),b("inputStyles",{}),b("matchWidth",!0),b("useMinWidth",!1),b("dismissOnBlur",!0),Bu(["openClass"]),p("initialData"),Zc("typeaheadBehaviours",[lt,ut,cw,at,v,yv]),mo("previewing",function(){return tt(!0)})].concat(Il()).concat(Tv())),Ml=X([js({schema:[Du()],name:"menu",overrides:function(a){return{fakeFocus:!0,onHighlight:function(e,u){a.previewing.get()?e.getSystem().getByUid(a.uid).each(function(t){var n,o,r,i;n=a.model,o=t,r=u,(n.selectsOver&&(t=ut.getValue(o),i=n.getDisplayText(t),t=ut.getValue(r),0===n.getDisplayText(t).indexOf(i))?$.some(function(){var e;u0(0,o,r),e=i.length,a0(o,function(t,n){t.setSelectionRange(e,n.length)})}):$.none()).fold(function(){return $l.dehighlight(e,u)},function(t){return t()})}):e.getSystem().getByUid(a.uid).each(function(t){a.model.populateFromBrowse&&u0(a.model,t,u)}),a.previewing.set(!1)},onExecute:function(t,n){return t.getSystem().getByUid(a.uid).toOptional().map(function(t){return q(t,lw(),{item:n}),!0})},onHover:function(t,n){a.previewing.set(!1),t.getSystem().getByUid(a.uid).each(function(t){a.model.populateFromBrowse&&u0(a.model,t,n)})}}}})]),fw=hs({name:"Typeahead",configFields:Fl(),partFields:Ml(),factory:function(r,t,n,i){function e(t,n,e){r.previewing.set(!1);var o=yv.getCoupled(t,"sandbox");h.isOpen(o)?T.getCurrent(o).each(function(t){$l.getHighlighted(t).fold(function(){e(t)},function(){Cn(o,t.element,"keydown",n)})}):wv(r,u(t),t,o,i,function(t){T.getCurrent(t).each(e)},fv.HighlightFirst).get(K)}function u(e){return function(t){return t.map(function(t){var n=we(t.menus),n=Ot(n,function(t){return yt(t.items,function(t){return"item"===t.type})});return ut.getState(e).update(k(n,function(t){return t.data})),t})}}var o=Ch(r),a=[lt.config({}),ut.config({onSetValue:r.onSetValue,store:J({mode:"dataset",getDataKey:function(t){return Qi(t.element)},getFallbackEntry:function(t){return{value:t,meta:{}}},setValue:function(t,n){Kn(t.element,r.model.getDisplayText(n))}},r.initialData.map(function(t){return Ie("initialValue",t)}).getOr({}))}),cw.config({stream:{mode:"throttle",delay:r.responseTime,stopEvent:!1},onStream:function(t,n){var e,o=yv.getCoupled(t,"sandbox");lt.isFocused(t)&&Qi(t.element).length>=r.minChars&&(e=T.getCurrent(o).bind(function(t){return $l.getHighlighted(t).map(ut.getValue)}),r.previewing.set(!0),wv(r,u(t),t,o,i,function(t){T.getCurrent(o).each(function(t){e.fold(function(){r.model.selectsOver&&$l.highlightFirst(t)},function(n){$l.highlightBy(t,function(t){return ut.getValue(t).value===n.value}),$l.getHighlighted(t).orThunk(function(){return $l.highlightFirst(t),$.none()})})})},fv.HighlightFirst).get(K))},cancelEvent:gr()}),at.config({mode:"special",onDown:function(t,n){return e(t,n,$l.highlightFirst),$.some(!0)},onEscape:function(t){t=yv.getCoupled(t,"sandbox");return h.isOpen(t)?(h.close(t),$.some(!0)):$.none()},onUp:function(t,n){return e(t,n,$l.highlightLast),$.some(!0)},onEnter:function(n){var t,e=yv.getCoupled(n,"sandbox"),o=h.isOpen(e);return o&&!r.previewing.get()?T.getCurrent(e).bind(function(t){return $l.getHighlighted(t)}).map(function(t){return q(n,lw(),{item:t}),!0}):(t=ut.getValue(n),Y(n,gr()),r.onExecute(e,n,t),o&&h.close(e),$.some(!0))}}),v.config({toggleClass:r.markers.openClass,aria:{mode:"expanded"}}),yv.config({others:{sandbox:function(t){return Ov(r,t,{onOpen:function(){return v.on(t)},onClose:function(){return v.off(t)}})}}}),st("typeaheadevents",[Vr(function(t){kv(r,u(t),t,i,K,fv.HighlightFirst).get(K)}),et(lw(),function(t,n){var e=yv.getCoupled(t,"sandbox");u0(r.model,t,n.event.item),Y(t,gr()),r.onItemExecute(t,e,n.event.item,ut.getValue(t)),h.close(e),sw(t)})].concat(r.dismissOnBlur?[et(ur(),function(t){t=yv.getCoupled(t,"sandbox");$a(t.element).isNone()&&h.close(t)})]:[]))];return{uid:r.uid,dom:Oh(Oe(r,{inputAttributes:{role:"combobox","aria-autocomplete":"list","aria-haspopup":"true"}})),behaviours:J(J({},o),ns(r.typeaheadBehaviours,a)),eventOrder:r.eventOrder}}}),dw=function(i){return J(J({},i),{toCached:function(){return dw(i.toCached())},bindFuture:function(n){return dw(i.bind(function(t){return t.fold(function(t){return hv(Z.error(t))},function(t){return n(t)})}))},bindResult:function(n){return dw(i.map(function(t){return t.bind(n)}))},mapResult:function(n){return dw(i.map(function(t){return t.map(n)}))},mapError:function(n){return dw(i.map(function(t){return t.mapError(n)}))},foldResult:function(n,e){return i.map(function(t){return t.fold(n,e)})},withTimeout:function(t,r){return dw(pv(function(n){var e=!1,o=setTimeout(function(){e=!0,n(Z.error(r()))},t);i.get(function(t){e||(clearTimeout(o),n(t))})}))}})},mw=function(t){return dw(pv(t))},gw={type:"separator"},pw=function(t,n){return{type:"menuitem",value:n,text:t,meta:{attach:void 0},onAction:K}},hw=function(t,n){return e=t,t=yt(n,function(t){return t.type===e}),k(t,c0);var e},vw=function(t,n){var e=t.toLowerCase();return yt(n,function(t){var n=(void 0!==t.meta&&void 0!==t.meta.text?t.meta:t).text;return gn(n.toLowerCase(),e)||gn(t.value.toLowerCase(),e)})},bw=_("aria-invalid"),yw={bar:l0(function(t,n){return n=n.shared,{dom:{tag:"div",classes:["tox-bar","tox-form__controls-h-stack"]},components:k(t.items,n.interpreter)}}),collection:l0(function(t,n){return kh(t,n.shared.providers)}),alertbanner:l0(function(t,n){return n=n.shared.providers,zh.sketch({dom:{tag:"div",attributes:{role:"alert"},classes:["tox-notification","tox-notification--in","tox-notification--"+(e=t).level]},components:[{dom:{tag:"div",classes:["tox-notification__icon"]},components:[qd.sketch({dom:{tag:"button",classes:["tox-button","tox-button--naked","tox-button--icon"],innerHtml:Kd(e.icon,n.icons),attributes:{title:n.translate(e.iconTooltip)}},action:function(t){q(t,qh,{name:"alert-banner",value:e.url})}})]},{dom:{tag:"div",classes:["tox-notification__body"],innerHtml:n.translate(e.text)}}]});var e}),input:l0(function(t,n){return n=n.shared.providers,r0({name:(t=t).name,multiline:!1,label:t.label,inputMode:t.inputMode,placeholder:t.placeholder,flex:!1,disabled:t.disabled,classname:"tox-textfield",validation:$.none(),maximized:t.maximized},n)}),textarea:l0(function(t,n){return n=n.shared.providers,r0({name:(t=t).name,multiline:!0,label:t.label,inputMode:$.none(),placeholder:t.placeholder,flex:!0,disabled:t.disabled,classname:"tox-textarea",validation:$.none(),maximized:t.maximized},n)}),label:l0(function(t,n){return e={dom:{tag:"label",innerHtml:(n=n.shared).providers.translate((t=t).label),classes:["tox-label"]}},t=k(t.items,n.interpreter),{dom:{tag:"div",classes:["tox-form__group"]},components:[e].concat(t),behaviours:it([kb(),ct.config({}),_b($.none()),at.config({mode:"acyclic"})])};var e}),iframe:(ew=function(t,n){return t=t,e=n.shared.providers,n=Ty&&t.sandboxed,i=J(J({},t.label.map(function(t){return{title:t}}).getOr({})),n?{sandbox:"allow-scripts allow-same-origin"}:{}),o=n,r=tt(""),u={getValue:function(t){return r.get()},setValue:function(t,n){o?ot(t.element,"srcdoc",n):(ot(t.element,"src","javascript:''"),(t=t.element.dom.contentWindow.document).open(),t.write(n),t.close()),r.set(n)}},n=t.label.map(function(t){return Wh(t,e)}),t=x.parts.field({factory:{sketch:function(t){return Oy({uid:t.uid,dom:{tag:"iframe",attributes:i},behaviours:it([Nh.config({}),lt.config({}),wy($.none(),u.getValue,u.setValue)])})}}}),jh(n,t,["tox-form__group--stretched"],[]);var e,o,r,i,u},function(t,n,e){n=Oe(n,{source:"dynamic"});return l0(ew)(t,n,e)}),button:l0(function(t,n){return t=t,n=n.shared.providers,e=Hx(t.name,"custom"),o=$.none(),t=x.parts.field(J({factory:qd},Vx(t,$.some(e),n,[Sy(""),kb()]))),jh(o,t,[],[]);var e,o}),checkbox:l0(function(t,n){return e=t,o=n.shared.providers,t=ut.config({store:{mode:"manual",getValue:function(t){return t.element.dom.checked},setValue:function(t,n){t.element.dom.checked=n}}}),n=function(t){return t.element.dom.click(),$.some(!0)},t=x.parts.field({factory:{sketch:A},dom:{tag:"input",classes:["tox-checkbox__input"],attributes:{type:"checkbox"}},behaviours:it([kb(),dt.config({disabled:function(){return e.disabled||o.isDisabled()}}),Nh.config({}),lt.config({}),t,at.config({mode:"special",onEnter:n,onSpace:n,stopSpaceKeyup:!0}),st("checkbox-events",[et(nr(),function(t,n){q(t,Gh,{name:e.name})})])])}),n=x.parts.label({dom:{tag:"span",classes:["tox-checkbox__label"],innerHtml:o.translate(e.label)},behaviours:it([Nb.config({})])}),r=ft({dom:{tag:"div",classes:["tox-checkbox__icons"]},components:[(r=function(t){return{dom:{tag:"span",classes:["tox-icon","tox-checkbox-icon__"+t],innerHtml:Kd("checked"===t?"selected":"unselected",o.icons)}}})("checked"),r("unchecked")]}),x.sketch({dom:{tag:"label",classes:["tox-checkbox"]},components:[t,r.asSpec(),n],fieldBehaviours:it([dt.config({disabled:function(){return e.disabled||o.isDisabled()},disableClass:"tox-checkbox--disabled",onDisabled:function(t){x.getField(t).each(dt.disable)},onEnabled:function(t){x.getField(t).each(dt.enable)}}),vp()])});var e,o,r}),colorinput:l0(function(t,n){return Ev(t,n.shared,n.colorinput)}),colorpicker:l0(function(t){var n=Sb(Ob,function(t){return"tox-"+t}),o=ft(n.sketch({dom:{tag:"div",classes:["tox-color-picker-container"],attributes:{role:"presentation"}},onValidHex:function(t){q(t,qh,{name:"hex-valid",value:!0})},onInvalidHex:function(t){q(t,qh,{name:"hex-valid",value:!1})}}));return{dom:{tag:"div"},components:[o.asSpec()],behaviours:it([ut.config({store:{mode:"manual",getValue:function(t){t=o.get(t);return T.getCurrent(t).bind(function(t){return ut.getValue(t).hex}).map(function(t){return"#"+t}).getOr("")},setValue:function(t,n){var e=/^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/.exec(n),n=o.get(t);T.getCurrent(n).fold(function(){console.log("Can not find form")},function(t){ut.setValue(t,{hex:$.from(e[1]).getOr("")}),fy.getField(t,"hex").each(function(t){Y(t,tr())})})}}}),kb()])}}),dropzone:l0(function(t,n){return Tb(t,n.shared.providers)}),grid:l0(function(t,n){return n=n.shared,{dom:{tag:"div",classes:["tox-form__grid","tox-form__grid--"+t.columns+"col"]},components:k(t.items,n.interpreter)}}),listbox:l0(function(t,n){return e=t,r=(o=n).shared.providers,i=H(e.items).filter(n0),t=e.label.map(function(t){return Wh(t,r)}),n={dom:{tag:"div",classes:["tox-listboxfield"]},components:[x.parts.field({dom:{},factory:{sketch:function(t){return Xy({uid:t.uid,text:i.map(function(t){return t.text}),icon:$.none(),tooltip:e.label,role:$.none(),fetch:function(t,n){t=e0(t,e.name,e.items,ut.getValue(t));n(Bx(t,Vm.CLOSE_ON_EXECUTE,o,!1))},onSetup:X(K),getApi:X({}),columns:1,presets:"normal",classes:[],dropdownBehaviours:[Nh.config({}),ut.config({store:{mode:"manual",initialValue:i.map(function(t){return t.value}).getOr(""),getValue:function(t){return ai(t.element,uw)},setValue:function(n,t){o0(e.items,t).each(function(t){ot(n.element,uw,t.value),q(n,Cx,{text:t.text})})}}})]},"tox-listbox",o.shared)}}})]},x.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:Ct([t.toArray(),[n]]),fieldBehaviours:it([dt.config({disabled:X(e.disabled),onDisabled:function(t){x.getField(t).each(dt.disable)},onEnabled:function(t){x.getField(t).each(dt.enable)}})])});var e,o,r,i}),selectbox:l0(function(t,n){return e=t,o=n.shared.providers,t=k(e.items,function(t){return{text:o.translate(t.text),value:t.value}}),n=e.label.map(function(t){return Wh(t,o)}),t=x.parts.field({dom:{},selectAttributes:{size:e.size},options:t,factory:aw,selectBehaviours:it([dt.config({disabled:function(){return e.disabled||o.isDisabled()}}),Nh.config({}),st("selectbox-change",[et(nr(),function(t,n){q(t,Gh,{name:e.name})})])])}),r=1<e.size?$.none():$.some({dom:{tag:"div",classes:["tox-selectfield__icon-js"],innerHtml:Kd("chevron-down",o.icons)}}),t={dom:{tag:"div",classes:["tox-selectfield"]},components:Ct([[t],r.toArray()])},x.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:Ct([n.toArray(),[t]]),fieldBehaviours:it([dt.config({disabled:function(){return e.disabled||o.isDisabled()},onDisabled:function(t){x.getField(t).each(dt.disable)},onEnabled:function(t){x.getField(t).each(dt.enable)}}),vp()])});var e,o,r}),sizeinput:l0(function(t,n){return Ux(t,n.shared.providers)}),urlinput:l0(function(t,n){return s0(t,n,n.urlinput)}),customeditor:l0(function(e){var o=tt($.none()),n=ft({dom:{tag:e.tag}}),r=tt($.none());return{dom:{tag:"div",classes:["tox-custom-editor"]},behaviours:it([st("custom-editor-events",[Fr(function(t){n.getOpt(t).each(function(n){(Object.prototype.hasOwnProperty.call(e,"init")?e.init(n.element.dom):vy.load(e.scriptId,e.scriptUrl).then(function(t){return t(n.element.dom,e.settings)})).then(function(n){r.get().each(function(t){n.setValue(t)}),r.set($.none()),o.set($.some(n))})})})]),ut.config({store:{mode:"manual",getValue:function(){return o.get().fold(function(){return r.get().getOr("")},function(t){return t.getValue()})},setValue:function(t,n){o.get().fold(function(){r.set($.some(n))},function(t){return t.setValue(n)})}}}),kb()]),components:[n.asSpec()]}}),htmlpanel:l0(function(t){return"presentation"===t.presets?zh.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:t.html}}):zh.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:t.html,attributes:{role:"document"}},containerBehaviours:it([Nh.config({}),lt.config({})])})}),imagetools:l0(function(t,n){return t0(t,n.shared.providers)}),table:l0(function(t,n){return e=n.shared.providers,r=function(t){return{dom:{tag:"td",innerHtml:e.translate(t)}}},n=function(t){return{dom:{tag:"tr"},components:k(t,r)}},{dom:{tag:"table",classes:["tox-dialog__table"]},components:[(o=(t=t).header,{dom:{tag:"thead"},components:[{dom:{tag:"tr"},components:k(o,function(t){return{dom:{tag:"th",innerHtml:e.translate(t)}}})}]}),(o=t.cells,{dom:{tag:"tbody"},components:k(o,n)})],behaviours:it([Nh.config({}),lt.config({})])};var e,o,r}),panel:l0(function(t,n){return{dom:{tag:"div",classes:t.classes},components:k(t.items,n.shared.interpreter)}})},xw={field:function(t,n){return n}},ww=function(n,e,o){return B(yw,e.type).fold(function(){return console.error('Unknown factory type "'+e.type+'", defaulting to container: ',e),e},function(t){return t(n,e,o)})},Sw={valignCentre:[],alignCentre:[],alignLeft:[],alignRight:[],right:[],left:[],bottom:[],top:[]},kw=function(t,n,e){function o(){return nt.fromDom(t.getContentAreaContainer())}function r(){return h||!e()}var i,u,a,c,s,l,f,d,m,g,p,h=mp(t);return{inlineDialog:(f=o,d=n,m=r,g=lc(-12,12,Sw),p={maxHeightFunction:cc()},function(){return m()?{anchor:"node",root:Qr(f()),node:$.from(f()),bubble:g,layouts:{onRtl:function(){return[pd]},onLtr:function(){return[gd]}},overrides:p}:{anchor:"hotspot",hotspot:d(),bubble:g,layouts:{onRtl:function(){return[Ru]},onLtr:function(){return[Vu]}},overrides:p}}),banner:(c=o,s=n,l=r,function(){return l()?{anchor:"node",root:Qr(c()),node:$.from(c()),layouts:{onRtl:function(){return[hd]},onLtr:function(){return[hd]}}}:{anchor:"hotspot",hotspot:s(),layouts:{onRtl:function(){return[Nu]},onLtr:function(){return[Nu]}}}}),cursor:(u=t,function(){return{anchor:"selection",root:a(),getSelection:function(){var t=u.selection.getRng();return $.some(Ws.range(nt.fromDom(t.startContainer),t.startOffset,nt.fromDom(t.endContainer),t.endOffset))}}}),node:(i=a=function(){return nt.fromDom(t.getBody())},function(t){return{anchor:"node",root:i(),node:t}})}},Cw=function(t){return{colorPicker:function(t,n){op(r)(t,n)},hasCustomColors:function(){return Jg(o)},getColors:function(){return $g(e)},getColorCols:(n=e=o=r=t,function(){return Zg(n)})};var n,e,o,r},Ow=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",format:"bold"},{title:"Italic",format:"italic"},{title:"Underline",format:"underline"},{title:"Strikethrough",format:"strikethrough"},{title:"Superscript",format:"superscript"},{title:"Subscript",format:"subscript"},{title:"Code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Align",items:[{title:"Left",format:"alignleft"},{title:"Center",format:"aligncenter"},{title:"Right",format:"alignright"},{title:"Justify",format:"alignjustify"}]}],_w=function(t){return wt(t,function(t,n){var e;return Se(n,"items")?(e=_w(n.items),{customFormats:t.customFormats.concat(e.customFormats),formats:t.formats.concat([{title:n.title,items:e.formats}])}):Se(n,"inline")||Se(n,"block")||Se(n,"selector")?(e="custom-"+(y(n.name)?n.name:n.title.toLowerCase()),{customFormats:t.customFormats.concat([{name:e,format:n}]),formats:t.formats.concat([{title:n.title,format:e,icon:n.icon}])}):J(J({},t),{formats:t.formats.concat(n)})},{customFormats:[],formats:[]})},Tw=function(r){return $.from(r.getParam("style_formats")).filter(c).map(function(t){n=r,e=_w(t),o=function(t){Q(t,function(t){n.formatter.has(t.name)||n.formatter.register(t.name,t.format)})},n.formatter?o(e.customFormats):n.on("init",function(){o(e.customFormats)});var n,e,o,t=e.formats;return r.getParam("style_formats_merge",!1,"boolean")?Ow.concat(t):t}).getOr(Ow)},Ew=function(t,n,e){n={type:"formatter",isSelected:n(t.format),getStylePreview:e(t.format)};return Oe(t,n)},Dw=function(r,t,i,u){function a(t){return k(t,function(t){var n,e,o=pe(t);return ke(t,"items")?(e=a(t.items),Oe(Oe(t,{type:"submenu"}),{getStyleItems:function(){return e}})):ke(t,"format")?Ew(t,i,u):1===o.length&&pt(o,"title")?Oe(t,{type:"separator"}):(n={type:"formatter",format:n="custom-"+(t=y((o=t).name)?o.name:_(o.title)),isSelected:i(n),getStylePreview:u(n)},o=Oe(o,n),r.formatter.register(t,o),o)})}return a(t)},Bw=by.trim,Aw=d0("true"),Mw=d0("false"),Fw="tinymce-url-history",Iw=function(c){return{getHistory:_0,addToHistory:T0,getLinkInformation:function(){return!1===(t=c).getParam("typeahead_urls")?$.none():$.some({targets:S0(t.getBody()),anchorTop:A0(t.getParam("anchor_top","#top")),anchorBottom:A0(t.getParam("anchor_bottom","#bottom"))});var t},getValidationHandler:function(){return t=c,$.from(void 0===(n=(t=c).getParam("file_picker_validator_handler",void 0,"function"))?t.getParam("filepicker_validator_handler",void 0,"function"):n);var t,n},getUrlPicker:function(t){return n=u=c,t=a=t,i=$.some((e=n).getParam("file_picker_types")).filter(E0),o=$.some(e.getParam("file_browser_callback_types")).filter(E0),r=i.or(o).map(D0),i=B0(e).fold(d,function(t){return r.fold(E,function(t){return 0<pe(t).length&&t})}),(S(i)?i?B0(n):$.none():i[t]?B0(n):$.none()).map(function(o){return function(n){return pv(function(e){var t=J({filetype:a,fieldname:n.fieldname},$.from(n.meta).getOr({}));o.call(u,function(t,n){if(!y(t))throw new Error("Expected value to be string");if(void 0!==n&&!w(n))throw new Error("Expected meta to be a object");e({value:t,meta:n})},n.value,t)})}});var n,e,o,r,i,u,a}}},Rw=X(function(t,n){n=Math.floor(n),n=du.max(t,n,["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"]);rt(t,"max-width",n+"px")}),Vw="contexttoolbar-hide",Ed=X([g("dom"),b("shell",!0),Zc("toolbarBehaviours",[ct])]),cl=X([Vl({name:"groups",overrides:function(){return{behaviours:it([ct.config({})])}}})]),Pw=hs({name:"Toolbar",configFields:Ed(),partFields:cl(),factory:function(e,t,n,o){t=e.shell?{behaviours:[ct.config({})],components:[]}:{behaviours:[],components:t};return{uid:e.uid,dom:e.dom,components:t.components,behaviours:ns(e.toolbarBehaviours,t.behaviours),apis:{setGroups:function(t,n){t=t,(e.shell?$.some(t):Ll(t,e,"groups")).fold(function(){throw console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")},function(t){ct.set(t,n)})}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)}}}),Hw=function(t,n,e,o){var r,i,u=(0===(u=I0(n,t,e)).extra.length?$.some(u):$.none()).getOrThunk(function(){return I0(n,t-e(o),e)}),a=u.within,c=u.extra,u=u.withinWidth;return 1===c.length&&c[0].width<=e(o)?(r=u,i=R0(a.concat(c)),F0(i,[],r)):1<=c.length?(i=c,r=o,c=u,r=R0(a).concat([r]),F0(r,R0(i),c)):(r=u,F0(R0(a),[],r))},zw=function(t,n){n=k(n,function(t){return ru(t)});Pw.setGroups(t,n)},Nw=function(t,n,e){var o=jl(t,n,"primary"),t=yv.getCoupled(t,"overflowGroup"),r=(rt(o.element,"visibility","hidden"),n.builtGroups.get().concat([t])),i=Mt(r,function(n){return $a(n.element).bind(function(t){return n.getSystem().getByDom(t).toOptional()})}),r=(e([]),zw(o,r),mu(o.element)),r=Hw(r,n.builtGroups.get(),function(t){return mu(t.element)},t);0===r.extra.length?(ct.remove(o,t),e([])):(zw(o,r.within),e(r.extra)),Ji(o.element,"visibility"),$i(o.element),i.each(lt.focus)},Dd=X([Zc("splitToolbarBehaviours",[yv]),mo("builtGroups",function(){return tt([])})]),Td=X([Bu(["overflowToggledClass"]),en("getOverflowBounds"),g("lazySink"),mo("overflowGroups",function(){return tt([])})].concat(Dd())),bo=X([Rl({factory:Pw,schema:Ed(),name:"primary"}),js({schema:Ed(),name:"overflow"}),js({name:"overflow-button"}),js({name:"overflow-group"})]),ya=X([Bu(["toggledClass"]),g("lazySink"),$t("fetch"),en("getBounds"),lo("fireDismissalEventInstead",[b("event",Sr())]),mc()]),kd=X([js({name:"button",overrides:function(t){return{dom:{attributes:{"aria-haspopup":"true"}},buttonBehaviours:it([v.config({toggleClass:t.markers.toggledClass,aria:{mode:"expanded"},toggleOnExecute:!1})])}}}),js({factory:Pw,schema:Ed(),name:"toolbar",overrides:function(n){return{toolbarBehaviours:it([at.config({mode:"cyclic",onEscape:function(t){return Ll(t,n,"button").each(lt.focus),$.none()}})])}}})]),Lw=hs({name:"FloatingToolbarButton",factory:function(u,t,a,n){return J(J({},qd.sketch(J(J({},n.button()),{action:function(t){V0(t,n)},buttonBehaviours:Cl({dump:n.button().buttonBehaviours},[yv.config({others:{toolbarSandbox:function(t){return o=t,e=a,r=u,{dom:{tag:"div",attributes:{id:(i=Eu()).id}},behaviours:it([at.config({mode:"special",onEscape:function(t){return h.close(t),$.some(!0)}}),h.config({onOpen:function(t,n){r.fetch().get(function(t){H0(o,n,r,e.layouts,t),i.link(o.element),at.focusIn(n)})},onClose:function(){v.off(o),lt.focus(o),i.unlink(o.element)},isPartOf:function(t,n,e){return ca(n,e)||ca(o,e)},getAttachPoint:function(){return r.lazySink(o).getOrDie()}}),qa.config({channels:J(J({},Xc(J({isExtraPart:d},r.fireDismissalEventInstead.map(function(t){return{fireEventInstead:{event:t.event}}}).getOr({})))),Yc({doReposition:function(){h.getState(yv.getCoupled(o,"toolbarSandbox")).each(function(t){P0(o,t,r,e.layouts)})}}))})])};var o,e,r,i}}})])}))),{apis:{setGroups:function(n,e){h.getState(yv.getCoupled(n,"toolbarSandbox")).each(function(t){H0(n,t,u,a.layouts,e)})},reposition:function(n){h.getState(yv.getCoupled(n,"toolbarSandbox")).each(function(t){P0(n,t,u,a.layouts)})},toggle:function(t){V0(t,n)},getToolbar:function(t){return h.getState(yv.getCoupled(t,"toolbarSandbox"))},isOpen:function(t){return h.isOpen(yv.getCoupled(t,"toolbarSandbox"))}}})},configFields:ya(),partFields:kd(),apis:{setGroups:function(t,n,e){t.setGroups(n,e)},reposition:function(t,n){t.reposition(n)},toggle:function(t,n){t.toggle(n)},getToolbar:function(t,n){return t.getToolbar(n)},isOpen:function(t,n){return t.isOpen(n)}}}),Vs=X([g("items"),Bu(["itemSelector"]),Zc("tgroupBehaviours",[at])]),di=X([La({name:"items",unit:"item"})]),jw=hs({name:"ToolbarGroup",configFields:Vs(),partFields:di(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,components:n,behaviours:ns(t.tgroupBehaviours,[at.config({mode:"flow",selector:t.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}}}),Uw=hs({name:"SplitFloatingToolbar",configFields:Td(),partFields:bo(),factory:function(e,t,n,o){var r=ft(Lw.sketch({fetch:function(){return pv(function(t){t(z0(e.overflowGroups.get()))})},layouts:{onLtr:function(){return[Vu,Ru]},onRtl:function(){return[Ru,Vu]},onBottomLtr:function(){return[Hu,Pu]},onBottomRtl:function(){return[Pu,Hu]}},getBounds:n.getOverflowBounds,lazySink:e.lazySink,fireDismissalEventInstead:{},markers:{toggledClass:e.markers.overflowToggledClass},parts:{button:o["overflow-button"](),toolbar:o.overflow()}}));return{uid:e.uid,dom:e.dom,components:t,behaviours:ns(e.splitToolbarBehaviours,[yv.config({others:{overflowGroup:function(){return jw.sketch(J(J({},o["overflow-group"]()),{items:[r.asSpec()]}))}}})]),apis:{setGroups:function(t,n){e.builtGroups.set(k(n,t.getSystem().build)),N0(t,r,e)},refresh:function(t){return N0(t,r,e)},toggle:function(t){r.getOpt(t).each(function(t){Lw.toggle(t)})},isOpen:function(t){return r.getOpt(t).map(Lw.isOpen).getOr(!1)},reposition:function(t){r.getOpt(t).each(function(t){Lw.reposition(t)})},getOverflow:function(t){return r.getOpt(t).bind(Lw.getToolbar)}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)},refresh:function(t,n){t.refresh(n)},reposition:function(t,n){t.reposition(n)},toggle:function(t,n){t.toggle(n)},isOpen:function(t,n){return t.isOpen(n)},getOverflow:function(t,n){return t.getOverflow(n)}}}),Ww=function(n,t){return t.getAnimationRoot.fold(function(){return n.element},function(t){return t(n)})},Gw=function(t){return t.dimension.property},Xw=function(t,n){return t.dimension.getDimension(n)},Yw=function(t,n){t=Ww(t,n);Hi(t,[n.shrinkingClass,n.growingClass])},qw=function(t,n){Ri(t.element,n.openClass),Fi(t.element,n.closedClass),rt(t.element,Gw(n),"0px"),$i(t.element)},Kw=function(t,n,e,o){e.setCollapsed(),rt(t.element,Gw(n),Xw(n,t.element)),$i(t.element),Yw(t,n),qw(t,n),n.onStartShrink(t),n.onShrunk(t)},Jw=function(t,n,e){var o=Xw(n,t.element);("0px"===o?Kw:j0)(t,n,e,$.some(o))},$w=function(t,n,e){var o=Ww(t,n),r=Vi(o,n.shrinkingClass),i=Xw(n,t.element),u=(L0(t,n),Xw(n,t.element));(r?function(){rt(t.element,Gw(n),i),$i(t.element)}:function(){qw(t,n)})(),Ri(o,n.shrinkingClass),Fi(o,n.growingClass),L0(t,n),rt(t.element,Gw(n),u),e.setExpanded(),n.onStartGrow(t)},vo=Object.freeze({__proto__:null,refresh:function(t,n,e){e.isExpanded()&&(Ji(t.element,Gw(n)),e=Xw(n,t.element),rt(t.element,Gw(n),e))},grow:function(t,n,e){e.isExpanded()||$w(t,n,e)},shrink:function(t,n,e){e.isExpanded()&&Jw(t,n,e)},immediateShrink:function(t,n,e){e.isExpanded()&&Kw(t,n,e,$.none())},hasGrown:function(t,n,e){return e.isExpanded()},hasShrunk:function(t,n,e){return e.isCollapsed()},isGrowing:U0,isShrinking:W0,isTransitioning:function(t,n,e){return U0(t,n)||W0(t,n)},toggleGrow:function(t,n,e){(e.isExpanded()?Jw:$w)(t,n,e)},disableTransitions:Yw}),Il=Object.freeze({__proto__:null,exhibit:function(t,n,e){var o=n.expanded;return Ti(o?{classes:[n.openClass],styles:{}}:{classes:[n.closedClass],styles:Ie(n.dimension.property,"0px")})},events:function(e,o){return Ar([Mr(or(),function(t,n){n.event.raw.propertyName===e.dimension.property&&(Yw(t,e),o.isExpanded()&&Ji(t.element,e.dimension.property),(o.isExpanded()?e.onGrown:e.onShrunk)(t))})])}}),Fl=[g("closedClass"),g("openClass"),g("shrinkingClass"),g("growingClass"),p("getAnimationRoot"),t("onShrunk"),t("onStartShrink"),t("onGrown"),t("onStartGrow"),b("expanded",!1),ao("dimension",Xt("property",{width:[ha("property","width"),ha("getDimension",function(t){return mu(t)+"px"})],height:[ha("property","height"),ha("getDimension",function(t){return uu(t)+"px"})]}))],Qw=Wu({fields:Fl,name:"sliding",active:Il,apis:vo,state:Object.freeze({__proto__:null,init:function(t){var n=tt(t.expanded);return _i({isExpanded:function(){return!0===n.get()},isCollapsed:function(){return!1===n.get()},setCollapsed:M(n.set,!1),setExpanded:M(n.set,!0),readState:function(){return"expanded: "+n.get()}})}})}),Ml=X([Bu(["closedClass","openClass","shrinkingClass","growingClass","overflowToggledClass"]),t("onOpened"),t("onClosed")].concat(Dd())),cl=X([Rl({factory:Pw,schema:Ed(),name:"primary"}),Rl({factory:Pw,schema:Ed(),name:"overflow",overrides:function(n){return{toolbarBehaviours:it([Qw.config({dimension:{property:"height"},closedClass:n.markers.closedClass,openClass:n.markers.openClass,shrinkingClass:n.markers.shrinkingClass,growingClass:n.markers.growingClass,onShrunk:function(t){Ll(t,n,"overflow-button").each(function(t){v.off(t),lt.focus(t)}),n.onClosed(t)},onGrown:function(t){at.focusIn(t),n.onOpened(t)},onStartGrow:function(t){Ll(t,n,"overflow-button").each(v.on)}}),at.config({mode:"acyclic",onEscape:function(t){return Ll(t,n,"overflow-button").each(lt.focus),$.some(!0)}})])}}}),js({name:"overflow-button",overrides:function(t){return{buttonBehaviours:it([v.config({toggleClass:t.markers.overflowToggledClass,aria:{mode:"pressed"},toggleOnExecute:!1})])}}}),js({name:"overflow-group"})]),Zw=hs({name:"SplitSlidingToolbar",configFields:Ml(),partFields:cl(),factory:function(e,t,n,o){var r="alloy.toolbar.toggle";return{uid:e.uid,dom:e.dom,components:t,behaviours:ns(e.splitToolbarBehaviours,[yv.config({others:{overflowGroup:function(n){return jw.sketch(J(J({},o["overflow-group"]()),{items:[qd.sketch(J(J({},o["overflow-button"]()),{action:function(t){Y(n,r)}}))]}))}}}),st("toolbar-toggle-events",[et(r,function(t){G0(t,e)})])]),apis:{setGroups:function(t,n){n=k(n,t.getSystem().build);e.builtGroups.set(n),X0(t,e)},refresh:function(t){return X0(t,e)},toggle:function(t){return G0(t,e)},isOpen:function(t){return Ll(t,e,"overflow").map(Qw.hasGrown).getOr(!1)}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)},refresh:function(t,n){t.refresh(n)},toggle:function(t,n){t.toggle(n)},isOpen:function(t,n){return t.isOpen(n)}}}),tS=X(_("toolbar-height-change")),nS=function(t){var n=t.title.fold(function(){return{}},function(t){return{attributes:{title:t}}});return{dom:J({tag:"div",classes:["tox-toolbar__group"]},n),components:[jw.parts.items({})],items:t.items,markers:{itemSelector:"*:not(.tox-split-button) > .tox-tbtn:not([disabled]), .tox-split-button:not([disabled]), .tox-toolbar-nav-js:not([disabled])"},tgroupBehaviours:it([Nh.config({}),lt.config({})])}},eS=function(t){return jw.sketch(nS(t))},oS=function(e,t){var n=Fr(function(t){var n=k(e.initGroups,eS);Pw.setGroups(t,n)});return it([yp(e.providers.isDisabled),vp(),at.config({mode:t,onEscape:e.onEscape,selector:".tox-toolbar__group"}),st("toolbar-events",[n])])},rS=function(t){var n=t.cyclicKeying?"cyclic":"acyclic";return Pw.sketch({uid:t.uid,dom:{tag:"div",classes:["tox-toolbar"].concat(t.type===vm.scrolling?["tox-toolbar--scrolling"]:[])},components:[Pw.parts.groups({})],toolbarBehaviours:oS(t,n)})},iS=m([n("type"),ao("items",Lt([Ut([n("name"),Zt("items",oo)]),oo]))].concat(_d)),ya=[nn("text"),nn("tooltip"),nn("icon"),$t("fetch"),cn("onSetup",function(){return K})],uS=m(F([n("type")],ya)),aS=m([n("type"),nn("tooltip"),nn("icon"),nn("text"),en("select"),$t("fetch"),cn("onSetup",function(){return K}),un("presets","normal",["normal","color","listpreview"]),b("columns",1),$t("onAction"),$t("onItemAction")]),kd=Object.freeze({__proto__:null,events:function(o,r){function i(n,e){o.updateState.each(function(t){t=t(n,e);r.set(t)}),o.renderComponents.each(function(t){t=t(e,r.get()),t=k(t,n.getSystem().build);Rc(n,t)})}return Ar([et(cr(),function(t,n){var e;n.universal||(e=o.channel,pt(n.channels,e)&&i(t,n.data))}),Fr(function(n,t){o.initialData.each(function(t){i(n,t)})})])}}),Vs=Object.freeze({__proto__:null,getState:function(t,n,e){return e}}),di=[g("channel"),p("renderComponents"),p("updateState"),p("initialData")],cS=Wu({fields:di,name:"reflecting",active:kd,apis:Vs,state:Object.freeze({__proto__:null,init:function(){var n=tt($.none());return{readState:function(){return n.get().fold(function(){return"none"},function(t){return t})},get:function(){return n.get()},set:function(t){return n.set(t)},clear:function(){return n.set($.none())}}}})}),Td=X([g("toggleClass"),g("fetch"),Fu("onExecute"),b("getHotspot",$.some),b("getAnchorOverrides",X({})),mc(),Fu("onItemExecute"),p("lazySink"),g("dom"),t("onOpen"),Zc("splitDropdownBehaviours",[yv,at,lt]),b("matchWidth",!1),b("useMinWidth",!1),b("eventOrder",{}),p("role")].concat(Tv())),bo=Rl({factory:qd,schema:[g("dom")],name:"arrow",defaults:function(){return{buttonBehaviours:it([lt.revoke()])}},overrides:function(n){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(t){t.getSystem().getByUid(n.uid).each(Dr)},buttonBehaviours:it([v.config({toggleOnExecute:!1,toggleClass:n.toggleClass})])}}}),Fl=Rl({factory:qd,schema:[g("dom")],name:"button",defaults:function(){return{buttonBehaviours:it([lt.revoke()])}},overrides:function(e){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(n){n.getSystem().getByUid(e.uid).each(function(t){e.onExecute(t,n)})}}}}),Il=X([bo,Fl,Vl({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:t.text}}}},schema:[g("text")],name:"aria-descriptor"}),js({schema:[Du()],name:"menu",defaults:function(o){return{onExecute:function(n,e){n.getSystem().getByUid(o.uid).each(function(t){o.onItemExecute(t,n,e)})}}}}),Od()]),sS=hs({name:"SplitDropdown",configFields:Td(),partFields:Il(),factory:function(o,t,n,e){function r(t){T.getCurrent(t).each(function(t){$l.highlightFirst(t),at.focusIn(t)})}function i(t){kv(o,function(t){return t},t,e,r,fv.HighlightFirst).get(K)}function u(t){return t=jl(t,o,"button"),Dr(t),$.some(!0)}var a=J(J({},Ar([Fr(function(e,t){Ll(e,o,"aria-descriptor").each(function(t){var n=_("aria");ot(t.element,"id",n),ot(e.element,"aria-describedby",n)})})])),id($.some(i)));return{uid:o.uid,dom:o.dom,components:t,apis:{repositionMenus:function(t){v.isOn(t)&&_v(t)}},eventOrder:J(J({},o.eventOrder),((t={})[sr()]=["disabling","toggling","alloy.base.behaviour"],t)),events:a,behaviours:ns(o.splitDropdownBehaviours,[yv.config({others:{sandbox:function(t){var n=jl(t,o,"arrow");return Ov(o,t,{onOpen:function(){v.on(n),v.on(t)},onClose:function(){v.off(n),v.off(t)}})}}}),at.config({mode:"special",onSpace:u,onEnter:u,onDown:function(t){return i(t),$.some(!0)}}),lt.config({}),v.config({toggleOnExecute:!1,aria:{mode:"expanded"}})]),domModification:{attributes:{role:o.role.getOr("button"),"aria-haspopup":!0}}}},apis:{repositionMenus:function(t,n){return t.repositionMenus(n)}}}),lS=function(t,n){return t.map(function(t){return{"aria-label":n.translate(t),title:n.translate(t)}}).getOr({})},fS=_("focus-button"),dS=["checklist","ordered-list"],mS=["indent","outdent","table-insert-column-after","table-insert-column-before","unordered-list"],gS=function(n,e,t,o,r,i){function u(t){return vg.isRtl()&&pt(dS,t)?t+"-rtl":t}var a=vg.isRtl()&&n.exists(function(t){return pt(mS,t)});return{dom:{tag:"button",classes:["tox-tbtn"].concat(e.isSome()?["tox-tbtn--select"]:[]).concat(a?["tox-tbtn__icon-rtl"]:[]),attributes:lS(t,i)},components:Cp([n.map(function(t){return xx(u(t),i.icons)}),e.map(function(t){return wx(t,"tox-tbtn",i)})]),eventOrder:((a={})[Go()]=["focusing","alloy.base.behaviour","common-button-display-events"],a),buttonBehaviours:it([yp(i.isDisabled),vp(),st("common-button-display-events",[et(Go(),function(t,n){n.event.prevent(),Y(t,fS)})])].concat(o.map(function(t){return cS.config({channel:t,initialData:{icon:n,text:e},renderComponents:function(t,n){return Cp([t.icon.map(function(t){return xx(u(t),i.icons)}),t.text.map(function(t){return wx(t,"tox-tbtn",i)})])}})}).toArray()).concat(r.getOr([])))}},pS=function(t,n,e){return $0(t,{toolbarButtonBehaviours:[].concat(0<e.length?[st("toolbarButtonWith",e)]:[]),getApi:K0,onSetup:t.onSetup},n)},hS=function(t,n,e){return Oe($0(t,{toolbarButtonBehaviours:[ct.config({}),v.config({toggleClass:"tox-tbtn--enabled",aria:{mode:"pressed"},toggleOnExecute:!1})].concat(0<e.length?[st("toolbarToggleButtonWith",e)]:[]),getApi:J0,onSetup:t.onSetup},n))},vS=function(o,r){return et(Sx,function(t,n){var e=o.get(t);r.onAction({hide:function(){return Y(e,mr())},getValue:function(){return ut.getValue(e)}},n.event.buttonApi)})},bS=function(t,n){var a,o,c,r,e=t.label.fold(function(){return{}},function(t){return{"aria-label":t}}),e=ft(tv.sketch({inputClasses:["tox-toolbar-textfield","tox-toolbar-nav-js"],data:t.initValue(),inputAttributes:e,selectOnFocus:!0,inputBehaviours:it([at.config({mode:"special",onEnter:function(t){return i.findPrimary(t).map(function(t){return Dr(t),!0})},onLeft:function(t,n){return n.cut(),$.none()},onRight:function(t,n){return n.cut(),$.none()}})])})),i=(a=e,o=t.commands,c=n,r=k(o,function(t){return ft((n=a,e={backstage:{shared:{providers:e=c}}},"contextformtogglebutton"===(t=t).type?(o=n,i=e,(u=(r=t).original).primary,u=D(u,["primary"]),u=$e(Fm(J(J({},u),{type:"togglebutton",onAction:K}))),hS(u,i.backstage.shared.providers,[vS(o,r)])):(u=n,i=e,(r=(o=t).original).primary,n=D(r,["primary"]),e=$e(Am(J(J({},n),{type:"button",onAction:K}))),pS(e,i.backstage.shared.providers,[vS(u,o)]))));var n,e,o,r,i,u}),{asSpecs:function(){return k(r,function(t){return t.asSpec()})},findPrimary:function(e){return Mt(o,function(t,n){return t.primary?$.from(r[n]).bind(function(t){return t.getOpt(e)}).filter(O(dt.isDisabled)):$.none()})}});return[{title:$.none(),items:[e.asSpec()]},{title:$.none(),items:i.asSpecs()}]},yS=function(t,n){var e=ee(window),o=ku(nt.fromDom(t.getContentAreaContainer())),r=Eg(t)||Dg(t)||Ag(t),i=(u=o,a=e,i=Math.max(a.x,u.x),u=u.right-i,a=a.width-(i-a.x),{x:i,width:Math.min(u,a)}),u=i.x,a=i.width;return t.inline&&!r?Su(u,e.y,a,e.height):(i=t,r=o,t=e,o=n.header.isPositionedAtTop(),e=nt.fromDom(i.getContainer()),n=ua(e,".tox-editor-header").getOr(e),n=ku(n),r=n.y>=r.bottom,o=o&&!r,i=i.inline&&o?{y:Math.max(n.bottom,t.y),bottom:t.bottom}:i.inline&&!o?{y:t.y,bottom:Math.min(n.y,t.bottom)}:(r=ku(e),o?{y:Math.max(n.bottom,t.y),bottom:Math.min(r.bottom,t.bottom)}:{y:Math.max(r.y,t.y),bottom:Math.min(n.y,t.bottom)}),Su(u,e=i.y,a,i.bottom-e))},xS=function(t,n,e){var o,r,i,n=Z0(t,n);return 0<n.contextForms.length?$.some({elem:t,toolbars:[n.contextForms[0]]}):0<(e=Z0(t,e)).contextForms.length?$.some({elem:t,toolbars:[e.contextForms[0]]}):0<n.contextToolbars.length||0<e.contextToolbars.length?(e=(o=n.contextToolbars.concat(e.contextToolbars)).length<=1?o:(n=function(n){return yt(o,function(t){return t.position===n})},r=(e=function(n){return ht(o,function(t){return t.position===n})})("selection"),e=e("node"),r||e?e&&r?(e=n("node"),i=k(n("selection"),function(t){return J(J({},t),{position:"node"})}),e.concat(i)):n(r?"selection":"node"):n("line")),$.some({elem:t,toolbars:e})):$.none()},wS=function(t,n,i){return t(n)?$.none():Ho(n,function(t){var e,n,o=Z0(t,i.inNodeScope),r=o.contextToolbars,o=o.contextForms,o=0<o.length?o:(e=r).length<=1?e:(n=function(n){return St(e,function(t){return t.position===n})})("selection").orThunk(function(){return n("node")}).orThunk(function(){return n("line")}).map(function(t){return t.position}).fold(function(){return[]},function(n){return yt(e,function(t){return t.position===n})});return 0<o.length?$.some({elem:t,toolbars:o}):$.none()},t)},SS=function(a,c){var s={},l=[],f=[],d={},m={},t=pe(a);return Q(t,function(t){var n,e,o,r,i,u=a[t];"contextform"===u.type?(o=t,i=$e(Je("ContextForm",Im,r=u)),(s[o]=i).launch.map(function(t){d["form:"+o]=J(J({},r.launch),{type:"contextformtogglebutton"===t.type?"togglebutton":"button",onAction:function(){c(i)}})}),("editor"===i.scope?f:l).push(i),m[o]=i):"contexttoolbar"===u.type&&(n=t,Je("ContextToolbar",Rm,e=u).each(function(t){("editor"===e.scope?f:l).push(t),m[n]=t}))}),{forms:s,inNodeScope:l,inEditorScope:f,lookupTable:m,formNavigators:d}},kS=_("forward-slide"),CS=_("backward-slide"),OS=_("change-slide-event"),_S="tox-pop--resizing";(vo=ow=ow||{})[vo.SemiColon=0]="SemiColon",vo[vo.Space=1]="Space";function TS(t,n,e,o){return{type:"basic",data:(t=t.getParam(n,e,"string"),n=o===ow.SemiColon?t.replace(/;$/,"").split(";"):t.split(" "),k(n,function(t){var n=t,e=t,t=t.split("=");return 1<t.length&&(n=t[0],e=t[1]),{title:n,format:e}}))}}function ES(e){var t={type:"basic",data:nC};return{tooltip:"Align",icon:$.some("align-left"),isSelectedFor:function(t){return function(){return e.formatter.match(t)}},getCurrentValue:$.none,getPreviewFor:function(t){return function(){return $.none()}},onAction:function(n){return function(){return St(nC,function(t){return t.format===n.format}).each(function(t){return e.execCommand(t.command)})}},updateText:function(t){var n=St(nC,function(t){return e.formatter.match(t.format)}).fold(function(){return"left"},function(t){return t.title.toLowerCase()});q(t,Ox,{icon:"align-"+n})},dataset:t,shouldHide:!1,isInvalid:function(t){return!e.formatter.canApply(t.format)}}}function DS(r){function i(){function n(t){return t?oC(t)[0]:""}var t=r.queryCommandValue("FontName"),e=u.data,o=t?t.toLowerCase():"";return{matchOpt:St(e,function(t){t=t.format;return t.toLowerCase()===o||n(t).toLowerCase()===n(o).toLowerCase()}).orThunk(function(){return 0===(t=o).indexOf("-apple-system")&&(n=oC(t.toLowerCase()),_t(eC,function(t){return-1<n.indexOf(t.toLowerCase())}))?$.from({title:"System Font",format:o}):$.none();var t,n}),font:t}}var u=TS(r,"font_formats","Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats",ow.SemiColon);return{tooltip:"Fonts",icon:$.none(),isSelectedFor:function(n){return function(t){return t.exists(function(t){return t.format===n})}},getCurrentValue:function(){return i().matchOpt},getPreviewFor:function(t){return function(){return $.some({tag:"div",styles:-1===t.indexOf("dings")?{"font-family":t}:{}})}},onAction:function(t){return function(){r.undoManager.transact(function(){r.focus(),r.execCommand("FontName",!1,t.format)})}},updateText:function(t){var n=i(),e=n.matchOpt,o=n.font,n=e.fold(function(){return o},function(t){return t.title});q(t,Cx,{text:n})},dataset:u,shouldHide:!1,isInvalid:d}}function BS(e){function r(){var i=$.none(),u=o.data,a=e.queryCommandValue("FontSize");if(a)for(var t=function(t){t=t;var n,e,o=/[0-9.]+px$/.test(n=a)?(e=72*parseInt(n,10)/96,t=Math.pow(10,t||0),Math.round(e*t)/t+"pt"):B(iC,n).getOr(n),r=B(rC,o).getOr("");i=St(u,function(t){return t.format===a||t.format===o||t.format===r})},n=3;i.isNone()&&0<=n;n--)t(n);return{matchOpt:i,size:a}}var t=X($.none),o=TS(e,"fontsize_formats","8pt 10pt 12pt 14pt 18pt 24pt 36pt",ow.Space);return{tooltip:"Font sizes",icon:$.none(),isSelectedFor:function(n){return function(t){return t.exists(function(t){return t.format===n})}},getPreviewFor:t,getCurrentValue:function(){return r().matchOpt},onAction:function(t){return function(){e.undoManager.transact(function(){e.focus(),e.execCommand("FontSize",!1,t.format)})}},updateText:function(t){var n=r(),e=n.matchOpt,o=n.size,n=e.fold(function(){return o},function(t){return t.title});q(t,Cx,{text:n})},dataset:o,shouldHide:!1,isInvalid:d}}function AS(t,n){var e=n(),n=k(e,function(t){return t.format});return $.from(t.formatter.closest(n)).bind(function(n){return St(e,function(t){return t.format===n})}).orThunk(function(){return Jl(t.formatter.match("p"),{title:"Paragraph",format:"p"})})}function MS(){return uC(function(t){return t.destroy()})}function FS(){return uC(function(t){return t.unbind()})}function IS(n){return function(t){return function(){n.undoManager.transact(function(){n.focus(),n.execCommand("mceToggleFormat",!1,t.format)})}}}function RS(e){var o=TS(e,"block_formats","Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre",ow.SemiColon);return{tooltip:"Blocks",icon:$.none(),isSelectedFor:function(t){return function(){return e.formatter.match(t)}},getCurrentValue:$.none,getPreviewFor:function(n){return function(){var t=e.formatter.get(n);return $.some({tag:0<t.length&&(t[0].inline||t[0].block)||"div",styles:e.dom.parseStyle(e.formatter.getCssText(n))})}},onAction:IS(e),updateText:function(t){var n=AS(e,function(){return o.data}).fold(function(){return"Paragraph"},function(t){return t.title});q(t,Cx,{text:n})},dataset:o,shouldHide:!1,isInvalid:function(t){return!e.formatter.canApply(t.format)}}}function VS(r,t){return{tooltip:"Formats",icon:$.none(),isSelectedFor:function(t){return function(){return r.formatter.match(t)}},getCurrentValue:$.none,getPreviewFor:function(n){return function(){var t=r.formatter.get(n);return void 0!==t?$.some({tag:0<t.length&&(t[0].inline||t[0].block)||"div",styles:r.dom.parseStyle(r.formatter.getCssText(n))}):$.none()}},onAction:IS(r),updateText:function(t){var e=function(t){var n=t.items;return void 0!==n&&0<n.length?Ot(n,e):[{title:t.title,format:t.format}]},n=Ot(Tw(r),e),o=AS(r,function(){return n}).fold(function(){return"Paragraph"},function(t){return t.title});q(t,Cx,{text:o})},shouldHide:r.getParam("style_formats_autohide",!1,"boolean"),isInvalid:function(t){return!r.formatter.canApply(t.format)},dataset:t}}function PS(o,r){return function(t,n,e){t=o(t).mapError(function(t){return Ze(t)}).getOrDie();return r(t,n,e)}}function HS(i,t,e,r){function u(){var t,n,e,o;return!((!d()||!r.backstage.isContextMenuOpen())&&(t=v.get().filter(function(t){return Ni(nt.fromDom(t))}).map(function(t){return t.getBoundingClientRect()}).getOrThunk(function(){return i.selection.getRng().getBoundingClientRect()}),o=i.inline?bu().top:Cu(nt.fromDom(i.getBody())).y,t={y:t.top+o,bottom:t.bottom+o},o=g(),n=t.bottom,e=o.y,o=o.bottom,Math.max(t.y,e)<=Math.min(n,o)))}function n(){Xd.hide(m)}function o(){h.get().each(function(t){var n=m.element;Ji(n,"display"),u()?rt(n,"display","none"):fl.positionWithinBounds(e,t,m,$.some(g()))})}function a(t){return{dom:{tag:"div",classes:["tox-pop__dialog"]},components:[t],behaviours:it([at.config({mode:"acyclic"}),st("pop-dialog-wrap-events",[Fr(function(t){i.shortcuts.add("ctrl+F9","focus statusbar",function(){return at.focusIn(t)})}),Ir(function(t){i.shortcuts.remove("ctrl+F9")})])])}}function c(){var t,n,e,o,r;i.hasFocus()&&(n=y(),t=n,e=nt.fromDom((n=i).getBody()),o=function(t){return Io(t,e)},r=nt.fromDom(n.selection.getNode()),(o(n=r)||Vo(e,n)?xS(r,t.inNodeScope,t.inEditorScope).orThunk(function(){return wS(o,r,t)}):$.none()).fold(p,function(t){w(t.toolbars,$.some(t.elem.dom))}))}function s(){S(),b.set(Yd.setEditorTimeout(i,c,0))}var l,f,d=Ao().deviceType.isTouch,m=ou((l={sink:e,onEscape:function(){return i.focus(),$.some(!0)}},f=tt([]),Xd.sketch({dom:{tag:"div",classes:["tox-pop"]},fireDismissalEventInstead:{event:"doNotDismissYet"},onShow:function(t){f.set([]),Xd.getContent(t).each(function(t){Ji(t.element,"visibility")}),Ri(t.element,_S),Ji(t.element,"width")},inlineBehaviours:it([st("context-toolbar-events",[Mr(or(),function(t,n){Ri(t.element,_S),Ji(t.element,"width")}),et(OS,function(t,n){var e=t.element,o=(Ji(e,"width"),mu(e)),r=(Xd.setContent(t,n.event.contents),Fi(e,_S),mu(e));rt(e,"width",o+"px"),Xd.getContent(t).each(function(t){n.event.focus.bind(function(t){return Ka(t),$a(e)}).orThunk(function(){return at.focusIn(t),Ja($r(e))})}),Yd.setTimeout(function(){rt(t.element,"width",r+"px")},0)}),et(kS,function(n,t){Xd.getContent(n).each(function(t){f.set(f.get().concat([{bar:t,focus:Ja($r(n.element))}]))}),q(n,OS,{contents:t.event.forwardContents,focus:$.none()})}),et(CS,function(n,t){Bt(f.get()).each(function(t){f.set(f.get().slice(0,f.get().length-1)),q(n,OS,{contents:ru(t.bar),focus:t.focus})})})]),at.config({mode:"special",onEscape:function(n){return Bt(f.get()).fold(function(){return l.onEscape()},function(t){return Y(n,CS),$.some(!0)})}})]),lazySink:function(){return Z.value(l.sink)}}))),g=function(){return yS(i,r.backstage.shared)},p=function(){h.set($.none()),Xd.hide(m)},h=tt($.none()),v=tt($.none()),b=tt(null),y=Te(function(){return SS(t,function(t){t=x([t]);q(m,kS,{forwardContents:a(t)})})}),x=function(t){var n=i.ui.registry.getAll().buttons,e=y(),o=J(J({},n),e.formNavigators),n=Fg(i)===vm.scrolling?vm.scrolling:vm.default,e=Ct(k(t,function(t){return"contexttoolbar"===t.type?fC(i,{buttons:o,toolbar:t.items,allowToolbarGroups:!1},r,$.some(["form:"])):(n=r.backstage.shared.providers,bS(t,n));var n}));return rS({type:n,uid:_("context-toolbar"),initGroups:e,onEscape:$.none,cyclicKeying:!0,providers:r.backstage.shared.providers})},w=(i.on("contexttoolbar-show",function(n){var t=y();B(t.lookupTable,n.toolbarKey).each(function(t){w([t],n.target===i?$.none():$.some(n)),Xd.getContent(m).each(at.focusIn)})}),function(t,n){var e,o;S(),d()&&r.backstage.isContextMenuOpen()||(e=x(t),o=n.map(nt.fromDom),t=t[0].position,o=o,o="node"===t?r.backstage.shared.anchors.node(o):r.backstage.shared.anchors.cursor(),o=Oe(o,(o=t,t=d(),"line"===o?{bubble:lc(12,0,dC),layouts:{onLtr:function(){return[Ra]},onRtl:function(){return[Va]}},overrides:mC}:{bubble:lc(0,12,dC),layouts:t?pC:gC,overrides:mC})),h.set($.some(o)),v.set(n),t=m.element,Ji(t,"display"),Xd.showWithinBounds(m,o,a(e),function(){return $.some(g())}),u()&&rt(t,"display","none"))}),S=function(){var t=b.get();null!==t&&(Yd.clearTimeout(t),b.set(null))};i.on("init",function(){i.on(Vw,n),i.on("ScrollContent ScrollWindow longpress",o),i.on("click keyup focus SetContent ObjectResized ResizeEditor",function(){s()}),i.on("focusout",function(t){Yd.setEditorTimeout(i,function(){$a(e.element).isNone()&&$a(m.element).isNone()&&p()},0)}),i.on("SwitchMode",function(){i.mode.isReadOnly()&&p()}),i.on("AfterProgressState",function(t){t.state?p():i.hasFocus()&&s()}),i.on("NodeChange",function(t){$a(m.element).fold(s,K)})})}function zS(t){return(Ki(t,"position").is("fixed")?$.none():Yr(t)).orThunk(function(){var n=nt.fromTag("span");return Gr(t).bind(function(t){ni(t,n);t=Yr(n);return ri(n),t})})}function NS(e,t,o,r,i){void 0===i&&(i=!1),t.contextual.each(function(n){n.lazyContext(e).each(function(t){t=t.y<r.bottom&&t.bottom>r.y;t!==o.isVisible()&&(o.setVisible(t),i&&!t?(Pi(e.element,[n.fadeOutClass]),n.onHide(e)):(t?SC:kC)(e,n))})})}function LS(t,n,e){var o,r,i,u,a;e.isDocked()&&(r=n,n=e,a=(o=t).element,n.setDocked(!1),u=o.element,OC(u,i=n).bind(function(t){return TC(u,t,i)}).each(function(t){t.fold(function(){return EC(o,r)},function(t){return DC(o,r,t)},K)}),n.setVisible(!0),r.contextual.each(function(t){Hi(a,[t.fadeInClass,t.fadeOutClass,t.transitionClass]),t.onShow(o)}),BC(o,r,n))}function jS(o){var r=o.element;Gr(r).each(function(t){var n,e="padding-"+AC.getModes(o)[0];AC.isDocked(o)?(n=mu(t),rt(r,"width",n+"px"),rt(t,e,au(n=r)+(parseInt(Yi(n,"margin-top"),10)||0)+(parseInt(Yi(n,"margin-bottom"),10)||0)+"px")):(Ji(r,"width"),Ji(t,e))})}function US(t,n){n?(Ri(t,MC.fadeOutClass),Pi(t,[MC.transitionClass,MC.fadeInClass])):(Ri(t,MC.fadeInClass),Pi(t,[MC.fadeOutClass,MC.transitionClass]))}function WS(t,n){t=nt.fromDom(t.getContainer()),n?(Fi(t,FC),Ri(t,IC)):(Fi(t,IC),Ri(t,FC))}function GS(r,t){function e(n){o().each(function(t){return n(t.element)})}function n(t){r.inline||jS(t),WS(r,AC.isDocked(t)),t.getSystem().broadcastOn([yl()],{}),o().each(function(t){return t.getSystem().broadcastOn([yl()],{})})}var i=tt($.none()),o=t.getSink,u=r.inline?[]:[qa.config({channels:((u={})[tS()]={onReceive:jS},u)})];return F([lt.config({}),AC.config({contextual:J({lazyContext:function(t){var n=au(t.element),e=r.inline?r.getContentAreaContainer():r.getContainer(),e=ku(nt.fromDom(e)),o=e.height-n,t=e.y+(pt(AC.getModes(t),"top")?0:n);return $.some(Su(e.x,t,e.width,o))},onShow:function(){e(function(t){return US(t,!0)})},onShown:function(r){e(function(t){return Hi(t,[MC.transitionClass,MC.fadeInClass])}),i.get().each(function(t){var n,e=r.element,o=jr(n=t);Ja(o).filter(function(t){return!Io(n,t)}).filter(function(t){return Io(t,nt.fromDom(o.dom.body))||Vo(e,t)}).each(function(){return Ka(n)}),i.set($.none())})},onHide:function(t){var n;i.set((t=t.element,n=o,$a(t).orThunk(function(){return n().toOptional().bind(function(t){return $a(t.element)})}))),e(function(t){return US(t,!1)})},onHidden:function(){e(function(t){return Hi(t,[MC.transitionClass])})}},MC),modes:[t.header.getDockingMode()],onDocked:n,onUndocked:n})],u)}function XS(t){return"<alloy.field."+t+">"}function YS(r,t){function e(t){return ds(r)}function n(e,o){return function(t,n){return Ll(t,r,n).map(function(t){return e(t,n)}).getOr(o)}}function o(t,n){return"true"!==ai(t.element,"aria-hidden")}var i,u=n(o,!1),a=n(function(t,n){var e;o(t)&&(e=t.element,rt(e,"display","none"),ot(e,"aria-hidden","true"),q(t,Cr(),{name:n,visible:!1}))}),c=n(function(t,n){var e;o(t)||(e=t.element,Ji(e,"display"),si(e,"aria-hidden"),q(t,Cr(),{name:n,visible:!0}))}),u={getSlotNames:e,getSlot:function(t,n){return Ll(t,r,n)},isShowing:u,hideSlot:i=a,hideAllSlots:function(t){var n;n=t,t=e(),Q(t,function(t){return i(n,t)})},showSlot:c};return{uid:r.uid,dom:r.dom,components:t,behaviours:ts(r.slotBehaviours),apis:u}}function qS(t,e){T.getCurrent(t).each(function(t){return ct.set(t,[(n=e,zC.sketch(function(t){return{dom:{tag:"div",classes:["tox-sidebar__pane-container"]},components:(e=t,r=k(pe(o=n),function(t){var n=o[t],n=$e(Je("sidebar",NC,n));return{name:t,getApi:LC,onSetup:n.onSetup,onShow:n.onShow,onHide:n.onHide}}),k(r,function(t){var n=tt(K);return e.slot(t.name,{dom:{tag:"div",classes:["tox-sidebar__pane"]},behaviours:fg([wp(t,n),Sp(t,n),et(Cr(),function(n,t){var e=t.event;St(r,function(t){return t.name===e.name}).each(function(t){(e.visible?t.onShow:t.onHide)(t.getApi(n))})})])})})),slotBehaviours:fg([Fr(function(t){return zC.hideAllSlots(t)})])};var e,o,r}))]);var n})}function KS(t){return T.getCurrent(t).bind(function(t){return Qw.isGrowing(t)||Qw.hasGrown(t)?T.getCurrent(t).bind(function(n){return St(zC.getSlotNames(n),function(t){return zC.isShowing(n,t)})}):$.none()})}function JS(t){return"string"==typeof t?t.split(" "):t}function $S(r,i){var u=J(J({},XC),i.menus),n=0<pe(i.menus).length,t=void 0===i.menubar||!0===i.menubar?JS("file edit view insert format tools table help"):JS(!1===i.menubar?"":i.menubar),t=yt(t,function(t){return n&&i.menus.hasOwnProperty(t)&&i.menus[t].hasOwnProperty("items")||XC.hasOwnProperty(t)}),t=k(t,function(t){var t=u[t],n={title:t.title,items:JS(t.items)},e=i,o=r.getParam("removed_menuitems","").split(/[ ,]/);return{text:n.title,getItems:function(){return Ot(n.items,function(t){var n=t.toLowerCase();return 0===n.trim().length||ht(o,function(t){return t===n})?[]:"separator"===n||"|"===n?[{type:"separator"}]:e.menuItems[n]?[e.menuItems[n]]:[]})}}});return yt(t,function(t){return 0<t.getItems().length&&ht(t.getItems(),function(t){return"separator"!==t.type})})}function QS(t){function n(){t._skinLoaded=!0,t.fire("SkinLoaded")}return function(){t.initialized?n():t.on("init",n)}}function ZS(t,n){r=(u=n).getParam("skin"),i=u.getParam("skin_url"),!1!==r&&(r=r||"oxide",i=i?u.documentBaseURI.toAbsolute(i):wg.baseURL+"/skins/ui/"+r);var e,o,r,i,u=i;u&&n.contentCSS.push(u+(t?"/content.inline":"/content")+".min.css"),0==(!1===n.getParam("skin"))&&y(u)?Cm.all([YC(n,u+"/skin.min.css",n.ui.styleSheetLoader),(r=n,i=u,t=nt.fromDom(r.getElement()),Zr(t).isSome()?YC(r,i+"/skin.shadowdom.min.css",hg.DOM.styleSheetLoader):Cm.resolve())]).then(QS(n),(e=n,o="Skin could not be loaded",function(){return e.fire("SkinLoadError",{message:o})})):QS(n)()}function tk(n,t,e,o){var t=t.outerContainer,r=e.toolbar,i=e.buttons;f(r,y)?(r=r.map(function(t){t={toolbar:t,buttons:i,allowToolbarGroups:e.allowToolbarGroups};return fC(n,t,{backstage:o},$.none())}),GC.setToolbars(t,r)):GC.setToolbar(t,fC(n,e,{backstage:o},$.none()))}function nk(e,t){function n(){var t=c.get();t.left===u.innerWidth&&t.top===u.innerHeight||(c.set(cu(u.innerWidth,u.innerHeight)),Kg(e))}function o(){var t=e.getDoc().documentElement,n=s.get();n.left===t.offsetWidth&&n.top===t.offsetHeight||(s.set(cu(t.offsetWidth,t.offsetHeight)),Kg(e))}function r(t){return e.fire("ScrollContent",t)}var i=e.dom,u=e.getWin(),a=e.getDoc().documentElement,c=tt(cu(u.innerWidth,u.innerHeight)),s=tt(cu(a.offsetWidth,a.offsetHeight)),l=(i.bind(u,"resize",n),i.bind(u,"scroll",r),hh(nt.fromDom(e.getBody()),"load",o)),f=t.uiMothership.element;e.on("hide",function(){rt(f,"display","none")}),e.on("show",function(){Ji(f,"display")}),e.on("NodeChange",o),e.on("remove",function(){l.unbind(),i.unbind(u,"resize",n),i.unbind(u,"scroll",r),u=null})}function ek(t){return mt(t)?t+"px":t}function ok(t){var n=kg(t),e=Cg(t),o=_g(t);return QC(n).map(function(t){return ZC(t,e,o)})}function rk(r,i,t,n,o){function u(t){var n,e;void 0===t&&(t=!1),v()&&(l||(e=d.getOrThunk(function(){var t=QC(Yi(Li(),"margin-left")).getOr(0);return mu(Li())-lu(i).left+t}),rt(o.get().element,"max-width",e+"px")),p&&GC.refreshToolbar(c),l||(e=GC.getToolbar(c),e=b(e),n=ku(i),e=g()?Math.max(n.y-uu(o.get().element)+e,0):n.bottom,Gi(c.element,{position:"absolute",top:Math.round(e)+"px",left:Math.round(n.x)+"px"})),f&&(e=o.get(),t?AC.reset(e):AC.refresh(e)),y())}function e(t){var n,e;void 0===t&&(t=!0),!l&&f&&v()&&(n=m.getDockingMode(),(e=function(t){switch(lp(r)){case Mg.auto:var n,e=GC.getToolbar(c),e=b(e),e=uu(t.element)-e,o=ku(i);return o.y>e?"top":(n=Fn(i),n=Math.max(n.dom.scrollHeight,uu(n)),o.bottom<n-e||Ou().bottom<o.bottom-e?"bottom":"top");case Mg.bottom:return"bottom";default:Mg.top;return"top"}}(o.get()))!==n)&&(n=e,e=o.get(),AC.setModes(e,[n]),m.setDockingMode(n),n=g()?ea.TopToBottom:ea.BottomToTop,ot(e.element,Rs,n),t)&&u(!0)}var a=t.uiMothership,c=t.outerContainer,s=hg.DOM,l=mp(r),f=Rg(r),d=_g(r).or(ok(r)),m=n.shared.header,g=m.isPositionedAtTop,p=(n=Fg(r))===vm.sliding||n===vm.floating,h=tt(!1),v=function(){return h.get()&&!r.removed},b=function(t){return p?t.fold(function(){return 0},function(t){return 1<t.components().length?uu(t.components()[1].element):0}):0},y=function(){a.broadcastOn([yl()],{})};return{isVisible:v,isPositionedAtTop:g,show:function(){h.set(!0),rt(c.element,"display","flex"),s.addClass(r.getBody(),"mce-edit-focus"),Ji(a.element,"display"),e(!1),u()},hide:function(){h.set(!1),t.outerContainer&&(rt(c.element,"display","none"),s.removeClass(r.getBody(),"mce-edit-focus")),rt(a.element,"display","none")},update:u,updateMode:e,repositionPopups:y}}function ik(t,n){return t=ku(t),{pos:n?t.y:t.bottom,bounds:t}}function uk(t){return o=["fixed","relative","empty"],$.from(o1.exec(t)).bind(function(t){var n=Number(t[1]),t=t[2],e=t;return ht(o,function(t){return ht(e1[t],function(t){return e===t})})?$.some({value:n,unit:t}):$.none()}).map(function(t){return t.value+t.unit}).getOr(t);var o}function ak(o){function r(){var t=uk(o.queryCommandValue("LineHeight"));$.from(u.get(t)).fold(function(){return a.clear()},function(t){a.set({destroy:function(){t.setActive(!1)}}),t.setActive(!0)})}var i=o.getParam("lineheight_formats","1 1.1 1.2 1.3 1.4 1.5 2","string").split(" "),u=new Map,a=MS();return o.on("nodeChange",r),k(i,function(n,e){return{type:"togglemenuitem",text:n,onSetup:function(t){return u.set(uk(n),t),e+1===i.length&&r(),function(){0===e&&(o.off("nodeChange",r),a.clear())}},onAction:function(){return o.execCommand("LineHeight",!1,n)}}})}function ck(t,n){return function(){t.execCommand("mceToggleFormat",!1,n)}}function sk(t,n,e){function o(){return!!n.undoManager&&n.undoManager[e]()}function r(){t.setDisabled(n.mode.isReadOnly()||!o())}return t.setDisabled(!o()),n.on("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",r),function(){return n.off("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",r)}}function lk(t,n){var e,r,i,o,u,a=t;by.each([{name:"alignleft",text:"Align left",cmd:"JustifyLeft",icon:"align-left"},{name:"aligncenter",text:"Align center",cmd:"JustifyCenter",icon:"align-center"},{name:"alignright",text:"Align right",cmd:"JustifyRight",icon:"align-right"},{name:"alignjustify",text:"Justify",cmd:"JustifyFull",icon:"align-justify"}],function(t){a.ui.registry.addToggleButton(t.name,{tooltip:t.text,onAction:function(){return a.execCommand(t.cmd)},icon:t.icon,onSetup:aC(a,t.name)})}),a.ui.registry.addButton("alignnone",{tooltip:"No alignment",onAction:function(){return a.execCommand("JustifyNone")},icon:"align-none"}),i1(t),n1(t,n),u1(t),eh(n=t),o=tt(null),u=tt(null),rh(n,"forecolor","forecolor","Text color",o),rh(n,"backcolor","hilitecolor","Background color",u),ih(n,"forecolor","forecolor","Text color"),ih(n,"backcolor","hilitecolor","Background color"),(e=o=t).ui.registry.addButton("visualaid",{tooltip:"Visual aids",text:"Visual aids",onAction:function(){return e.execCommand("mceToggleVisualAid")}}),(r=o).ui.registry.addToggleMenuItem("visualaid",{text:"Visual aids",onSetup:function(t){var n=t,e=r;function o(t){n.setActive(t.hasVisual)}return n.setActive(e.hasVisual),e.on("VisualAid",o),function(){return e.off("VisualAid",o)}},onAction:function(){r.execCommand("mceToggleVisualAid")}}),(i=t).ui.registry.addButton("outdent",{tooltip:"Decrease indent",icon:"outdent",onSetup:function(t){var n=t,e=i;function o(){n.setDisabled(!e.queryCommandState("outdent"))}return n.setDisabled(!e.queryCommandState("outdent")),e.on("NodeChange",o),function(){return e.off("NodeChange",o)}},onAction:function(){return i.execCommand("outdent")}}),i.ui.registry.addButton("indent",{tooltip:"Increase indent",icon:"indent",onAction:function(){return i.execCommand("indent")}}),r1(t)}function fk(t,n){return{anchor:"makeshift",x:t,y:n}}function dk(t){return"longpress"===t.type||0===t.type.indexOf("touch")}function mk(t,n){return"contextmenu"===n.type||"longpress"===n.type?t.inline?dk(o=n)?(r=o.touches[0],fk(r.pageX,r.pageY)):fk(o.pageX,o.pageY):(r=t.getContentAreaContainer(),n=dk(o=n)?(n=o.touches[0],fk(n.clientX,n.clientY)):fk(o.clientX,o.clientY),r=hg.DOM.getPos(r),e=r.x,r=r.y,fk(n.x+e,n.y+r)):{anchor:"selection",root:nt.fromDom(t.selection.getNode())};var e,o,r}function gk(t){return{anchor:"node",node:$.some(nt.fromDom(t.selection.getNode())),root:nt.fromDom(t.getBody())}}function pk(t){return"string"==typeof t?t.split(/[ ,]/):t}function hk(u,t,o){function n(t){return Xd.hide(a)}function e(i){var t,n,e;f1(u)&&i.preventDefault(),i.ctrlKey&&!f1(u)||!1===u.getParam("contextmenu")||(n=i,e=(t=u).getParam("contextmenu_avoid_overlap","","string"),n=!!v1(t,n)||!!e&&(t=b1(t,n),Bh(nt.fromDom(t),e)),(r()?l1:a1)(u,i,function(){var t=b1(u,i),n=u.ui.registry.getAll(),e=d1(u),o=n.contextMenus,r=t;return 0<(n=wt(e,function(n,t){return B(o,t.toLowerCase()).map(function(t){var t=t.update(r);return y(t)?h1(n,t.split(" ")):0<t.length?(t=k(t,p1),h1(n,t)):n}).getOrThunk(function(){return n.concat([t])})},[])).length&&m1(n[n.length-1])&&n.pop(),n},o,a,n))}var r=Ao().deviceType.isTouch,a=ou(Xd.sketch({dom:{tag:"div"},lazySink:t,onEscape:function(){return u.focus()},onShow:function(){return o.setContextMenuState(!0)},onHide:function(){return o.setContextMenuState(!1)},fireDismissalEventInstead:{},inlineBehaviours:it([st("dismissContextMenu",[et(Sr(),function(t,n){h.close(t),u.focus()})])])}));u.on("init",function(){var t="ResizeEditor ScrollContent ScrollWindow longpresscancel"+(r()?"":" ResizeWindow");u.on(t,n),u.on("longpress contextmenu",e)})}function vk(t,n,e){return t.fold(w1([x1(e),y1(n)]),w1([y1(n)]),w1([]))}function bk(t,n,e){return t.fold(w1([]),w1([y1(e)]),w1([x1(n),y1(e)]))}function yk(t,n){return void 0===(t=ai(t,n))?NaN:parseInt(t,10)}function xk(t,n,e,o,r,i){c=n,u=e,a=o,e=(e=t).element,o=yk(e,(c=n).leftAttr),e=yk(e,c.topAttr);var u,a,c=(isNaN(o)||isNaN(e)?$.none():$.some(cu(o,e))).fold(function(){return u},function(t){return T1(t.left+a.left,t.top+a.top)}),o=(n.mustSnap?wk:Sk)(t,n,c,r,i),s=vk(c,r,i),e=n,c=s,r=t.element;return ot(r,e.leftAttr,c.left+"px"),ot(r,e.topAttr,c.top+"px"),o.fold(function(){return{coord:T1(s.left,s.top),extra:$.none()}},function(t){return{coord:t.output,extra:t.extra}})}function wk(t,n,a,c,s){var e=n.getSnapPoints(t);return D1(e,a,c,s).orThunk(function(){return wt(e,function(n,e){o=e.sensor,e.range.left,e.range.top,t=S1(a,r=c,i=s),o=S1(o,r,i),r=Math.abs(t.left-o.left),i=Math.abs(t.top-o.top);var t,o,r,i,u=cu(r,i);return n.deltas.fold(function(){return{deltas:$.some(u),snap:$.some(e)}},function(t){return(u.left+u.top)/2<=(t.left+t.top)/2?{deltas:$.some(u),snap:$.some(e)}:n})},{deltas:$.none(),snap:$.none()}).snap.map(function(t){return{output:C1(t.output,a,c,s),extra:t.extra}})})}function Sk(t,n,e,o,r){return n=n.getSnapPoints(t),D1(n,e,o,r)}function kk(t,n){var e;t.getSystem().addToGui(n),Gr((e=n).element).filter(Hr).each(function(n){Ki(n,"z-index").each(function(t){ot(n,B1,t)}),rt(n,"z-index",Yi(e.element,"z-index"))})}function Ck(t,n,e){return t.getSystem().build(zh.sketch({dom:{styles:{left:"0px",top:"0px",width:"100%",height:"100%",position:"fixed","z-index":"1000000000000000"},classes:[n]},events:e}))}function Ok(c,s,t,n,e){var n=t.update(n,e),l=t.getStartData().getOrThunk(function(){return I1(s,c)});n.each(function(t){var n,e,o,r,i=c,u=l,a=(n=s).getTarget(i.element);n.repositionTarget&&(r=jr(i.element),r=bu(r),e=xC(a),o=M1(a),o=F1(i,n.snaps,o,r,e,t,u),r=k1(o,0,e),Xi(a,r)),n.onDrag(i,a,t)})}function _k(n,t,e,o){t.each(A1),e.snaps.each(function(t){E1(n,t)}),t=e.getTarget(n.element),o.reset(),e.onDrop(n,t)}function Tk(t){return function(n,e){function o(t){e.setStartData(I1(n,t))}return Ar(F([et(br(),function(t){e.getStartData().each(function(){return o(t)})})],t(n,e,o)))}}function Ek(i,u,a){return[et(Go(),function(n,t){var e,o,r;0===t.event.raw.button&&(t.stop(),t={drop:t=function(){return _k(n,$.some(o),i,u)},delayDrop:(e=vh(t,200)).schedule,forceDrop:t,move:function(t){e.cancel(),Ok(n,i,u,R1,t)}},o=Ck(n,i.blockerClass,(r=t,Ar([et(Go(),r.forceDrop),et(qo(),r.drop),et(Xo(),function(t,n){r.move(n.event)}),et(Yo(),r.delayDrop)]))),a(n),kk(n,o))})]}function Dk(r,i,u){var a=tt($.none());return[et(Lo(),function(n,t){t.stop();function e(){_k(n,a.get(),r,i),a.set($.none())}var o,t={drop:e,delayDrop:K,forceDrop:e,move:function(t){Ok(n,r,i,V1,t)}},t=Ck(n,r.blockerClass,(o=t,Ar([et(Lo(),o.forceDrop),et(Uo(),o.drop),et(Wo(),o.drop),et(jo(),function(t,n){o.move(n.event)})])));a.set($.some(t)),u(n),kk(n,t)}),et(jo(),function(t,n){n.stop(),Ok(t,r,i,V1,n.event)}),et(Uo(),function(t,n){n.stop(),_k(t,a.get(),r,i),a.set($.none())}),et(Wo(),function(t){_k(t,a.get(),r,i),a.set($.none())})]}function Bk(i,e){function n(t){var n=Cu(t);return H1(g.getOpt(e),t,n.x,n.y,n.width,n.height)}function o(t){var n=Cu(t);return H1(p.getOpt(e),t,n.right,n.bottom,n.width,n.height)}function r(t,n,e,o){var r,e=e(n);P1.snapTo(t,e),e=t,t=n.dom.getBoundingClientRect(),Ji(e.element,"display"),n=Wr(nt.fromDom(i.getBody())).dom.innerHeight,r=t[o]<0,t=t[o]>n,(r||t)&&rt(e.element,"display","none")}function u(t){return r(h,t,n,"top")}function a(t){return r(v,t,o,"bottom")}var c=tt([]),s=tt([]),t=tt(!1),l=tt($.none()),f=tt($.none()),d=z1(function(){return k(c.get(),n)},l,function(n){f.get().each(function(t){i.fire("TableSelectorChange",{start:n,finish:t})})}),m=z1(function(){return k(s.get(),o)},f,function(n){l.get().each(function(t){i.fire("TableSelectorChange",{start:t,finish:n})})}),g=N1(d),p=N1(m),h=ou(g.asSpec()),v=ou(p.asSpec());Ao().deviceType.isTouch()&&(i.on("TableSelectionChange",function(n){t.get()||(gl(e,h),gl(e,v),t.set(!0)),l.set($.some(n.start)),f.set($.some(n.finish)),n.otherCells.each(function(t){c.set(t.upOrLeftCells),s.set(t.downOrRightCells),u(n.start),a(n.finish)})}),i.on("ResizeEditor ResizeWindow ScrollContent",function(){l.get().each(u),f.get().each(a)}),i.on("TableSelectionClear",function(){t.get()&&(hl(h),hl(v),t.set(!1)),l.set($.none()),f.set($.none())}))}function Ak(t,n,e){var o,r=nt.fromDom(t.getContainer()),i=t,u=uu(r),a=mu(r);(o={}).height=ZC(u+n.top,Og(i),Tg(i)),e===Zk.Both&&(o.width=ZC(a+n.left,Cg(i),_g(i))),ve(o,function(t,n){return rt(r,n,ek(t)),0}),t.fire("ResizeEditor")}function Mk(t,n,e,o){return e=cu(20*e,20*o),Ak(t,e,n),$.some(!0)}function Fk(m){function g(){return i.bind(GC.getHeader)}function p(){return Z.value(v)}function V(){return i.bind(function(t){return GC.getThrobber(t)}).getOrDie("Could not find throbber element")}var t,o,r,n,e=m.inline,P=e?t1:$C,h=Rg(m)?RC:yC,i=$.none(),u=(a=Ao()).browser.isIE()?["tox-platform-ie"]:[],a=a.deviceType.isTouch()?["tox-platform-touch"]:[],c=fp(m),s=Ig(m),l=vg.isRtl()?{attributes:{dir:"rtl"}}:{},f={attributes:((f={})[Rs]=c?ea.BottomToTop:ea.TopToBottom,f)},v=ou((s=Io(Li(),s)&&"grid"===Yi(s,"display"),l={dom:J({tag:"div",classes:["tox","tox-silver-sink","tox-tinymce-aux"].concat(u).concat(a)},l),behaviours:it([fl.config({useFixed:function(){return h.isDocked(g)}})])},x={dom:{styles:{width:document.body.clientWidth+"px"}},events:Ar([et(yr(),function(){rt(E.element,"width",document.body.clientWidth+"px")})])},Oe(l,s?x:{}))),d=ft({dom:{tag:"div",classes:["tox-anchorbar"]}}),b=M0(v,m,function(){return i.bind(function(t){return d.getOpt(t)}).getOrDie("Could not find a anchor bar element")}),l=GC.parts.menubar({dom:{tag:"div",classes:["tox-menubar"]},backstage:b,onEscape:function(){m.focus()}}),y=Fg(m),s=GC.parts.toolbar(J({dom:{tag:"div",classes:["tox-toolbar"]},getSink:p,providers:b.shared.providers,onEscape:function(){m.focus()},type:y,lazyToolbar:function(){return i.bind(function(t){return GC.getToolbar(t)}).getOrDie("Could not find more toolbar element")},lazyHeader:function(){return g().getOrDie("Could not find header element")}},f)),x=GC.parts["multiple-toolbar"]({dom:{tag:"div",classes:["tox-toolbar-overlord"]},providers:b.shared.providers,onEscape:function(){m.focus()},type:y}),w=GC.parts.socket({dom:{tag:"div",classes:["tox-edit-area"]}}),S=GC.parts.sidebar({dom:{tag:"div",classes:["tox-sidebar"]}}),H=GC.parts.throbber({dom:{tag:"div",classes:["tox-throbber"]},backstage:b}),k=m.getParam("statusbar",!0,"boolean")&&!e?$.some((k=m,C=b.shared.providers,{dom:{tag:"div",classes:["tox-statusbar"]},components:(O=[],k.getParam("elementpath",!0,"boolean")&&O.push(L1(k,{},C)),k.hasPlugin("wordcount")&&O.push((t=k,o=C,r=function(t,n,e){return ct.set(t,[tu(o.translate(["{0} "+e,n[e]]))])},qd.sketch({dom:{tag:"button",classes:["tox-statusbar__wordcount"]},components:[],buttonBehaviours:it([bp(o.isDisabled),vp(),Nh.config({}),ct.config({}),ut.config({store:{mode:"memory",initialValue:{mode:"words",count:{words:0,characters:0}}}}),st("wordcount-events",[Vr(function(t){var n=ut.getValue(t),e="words"===n.mode?"characters":"words";ut.setValue(t,{mode:e,count:n.count}),r(t,n.count,e)}),Fr(function(e){t.on("wordCountUpdate",function(t){var n=ut.getValue(e).mode;ut.setValue(e,{mode:n,count:t.wordCount}),r(e,t.wordCount,n)})})])]),eventOrder:((n={})[sr()]=["disabling","alloy.base.behaviour","wordcount-events"],n)}))),k.getParam("branding",!0,"boolean")&&O.push({dom:{tag:"span",classes:["tox-statusbar__branding"],innerHtml:'<a href="https://www.tiny.cloud/?utm_campaign=editor_referral&amp;utm_medium=poweredby&amp;utm_source=tinymce&amp;utm_content=v5" rel="noopener" target="_blank" tabindex="-1" aria-label="'+(n=vg.translate(["Powered by {0}","Tiny"]))+'">'+n+"</a>"}}),n=0<O.length?[{dom:{tag:"div",classes:["tox-statusbar__text-container"]},components:O}]:[],O=j1(k,C),n.concat(O.toArray()))})):$.none(),C={dom:{tag:"div",classes:["tox-sidebar-wrap"]},components:[w,S]},O=Ag(m),w=Dg(m),S=Eg(m),f=GC.parts.header({dom:J({tag:"div",classes:["tox-editor-header"]},f),components:Ct([S?[l]:[],O?[x]:w?[s]:[],mp(m)?[]:[d.asSpec()]]),sticky:Rg(m),editor:m,sharedBackstage:b.shared}),S=Ct([c?[]:[f],e?[]:[C],c?[f]:[]]),l=Ct([[{dom:{tag:"div",classes:["tox-editor-container"]},components:S}],e?[]:k.toArray(),[H]]),x=gp(m),w=J(J({role:"application"},vg.isRtl()?{dir:"rtl"}:{}),x?{"aria-hidden":"true"}:{}),_=ou(GC.sketch({dom:{tag:"div",classes:["tox","tox-tinymce"].concat(e?["tox-tinymce-inline"]:[]).concat(c?["tox-tinymce--toolbar-bottom"]:[]).concat(a).concat(u),styles:J({visibility:"hidden"},x?{opacity:"0",border:"0"}:{}),attributes:w},components:l,behaviours:it([vp(),dt.config({disableClass:"tox-tinymce--disabled"}),at.config({mode:"cyclic",selector:".tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a, .tox-statusbar__resize-handle"})])})),i=$.some(_);function z(){var t,n,e,o=ek((t=Sg(o=r=m),n=Og(o),e=Tg(o),QC(t).map(function(t){return ZC(t,n,e)}).getOr(Sg(r)))),r=ek(ok(t=m).getOr(kg(t)));return m.inline||(qn("div","width",r)&&rt(_.element,"width",r),qn("div","height",o)?rt(_.element,"height",o):rt(_.element,"height","200px")),o}m.shortcuts.add("alt+F9","focus menubar",function(){GC.focusMenubar(_)}),m.shortcuts.add("alt+F10","focus toolbar",function(){GC.focusToolbar(_)}),m.addCommand("ToggleToolbarDrawer",function(){GC.toggleToolbarDrawer(_)}),m.addQueryStateHandler("ToggleToolbarDrawer",function(){return GC.isToolbarDrawerToggled(_)});var T=wh(_),E=wh(v),D=m,B=T,A=E,M=function(n,e){Q([B,A],function(t){t.broadcastEvent(n,e)})},F=function(n,e){Q([B,A],function(t){t.broadcastOn([n],e)})},s=function(t){return F(bl(),{target:t.target})},N=Eh(nt.fromDom(document),"touchstart",s),L=Eh(nt.fromDom(document),"touchmove",function(t){return M(hr(),t)}),j=Eh(nt.fromDom(document),"touchend",function(t){return M(vr(),t)}),U=Eh(nt.fromDom(document),"mousedown",s),W=Eh(nt.fromDom(document),"mouseup",function(t){0===t.raw.button&&F(xl(),{target:t.target})}),I=function(t){return F(bl(),{target:nt.fromDom(t.target)})},R=function(t){0===t.button&&F(xl(),{target:nt.fromDom(t.target)})},G=function(t){return M(br(),Dh(t))},X=function(t){F(yl(),{}),M(yr(),Dh(t))},Y=function(){return F(yl(),{})},q=function(t){t.state&&F(bl(),{target:nt.fromDom(D.getContainer())})};return D.on("PostRender",function(){D.on("click",I),D.on("tap",I),D.on("mouseup",R),D.on("ScrollWindow",G),D.on("ResizeWindow",X),D.on("ResizeEditor",Y),D.on("AfterProgressState",q)}),D.on("remove",function(){D.off("click",I),D.off("tap",I),D.off("mouseup",R),D.off("ScrollWindow",G),D.off("ResizeWindow",X),D.off("ResizeEditor",Y),D.off("AfterProgressState",q),U.unbind(),N.unbind(),L.unbind(),j.unbind(),W.unbind()}),D.on("detach",function(){zc(B),zc(A),B.destroy(),A.destroy()}),{mothership:T,uiMothership:E,backstage:b,renderUI:function(){var o,r,i,u,a,c,e,s;h.setup(m,b.shared,g),lk(m,b),hk(m,p,b),r=(o=m).ui.registry.getAll().sidebars,Q(pe(r),function(n){function e(){return $.from(o.queryCommandValue("ToggleSidebar")).is(n)}var t=r[n];o.ui.registry.addToggleButton(n,{icon:t.icon,tooltip:t.tooltip,onAction:function(t){o.execCommand("ToggleSidebar",!1,n),t.setActive(e())},onSetup:function(t){function n(){return t.setActive(e())}return o.on("ToggleSidebar",n),function(){o.off("ToggleSidebar",n)}}})}),i=m,u=V,a=b.shared,c=tt(!1),e=tt($.none()),s=function(t){var n,e,o;t!==c.get()&&(n=u(),e=a.providers,o=n.element,!0===t?(ct.set(n,[{dom:{tag:"div",attributes:{"aria-label":e.translate("Loading...")},classes:["tox-throbber__busy-spinner"]},components:[{dom:WC('<div class="tox-spinner"><div></div><div></div><div></div></div>')}],behaviours:it([at.config({mode:"special",onTab:function(){return $.some(!0)},onShiftTab:function(){return $.some(!0)}}),lt.config({})])}]),Ji(o,"display"),si(o,"aria-hidden")):(ct.set(n,[]),rt(o,"display","none"),ot(o,"aria-hidden","true")),c.set(t),i.fire("AfterProgressState",{state:t}))},i.on("ProgressState",function(t){var n;e.get().each(Yd.clearTimeout),mt(t.time)?(n=Yd.setEditorTimeout(i,function(){return s(t.state)},t.time),e.set($.some(n))):(s(t.state),e.set($.none()))}),be(m.getParam("toolbar_groups",{},"object"),function(t,n){m.ui.registry.addGroupToolbarButton(n,t)});var t=m.ui.registry.getAll(),n=t.buttons,l=t.menuItems,f=t.contextToolbars,t=t.sidebars,d=Bg(m),l={menuItems:l,menus:(l=m.getParam("menu"))?be(l,function(t){return J(J({},t),{items:t.items})}):{},menubar:m.getParam("menubar"),toolbar:d.getOrThunk(function(){return m.getParam("toolbar",!0)}),allowToolbarGroups:y===vm.floating,buttons:n,sidebar:t},d=(HS(m,f,v,{backstage:b}),Bk(m,v),m.getElement()),n=z();return P.render(m,{mothership:T,uiMothership:E,outerContainer:_},l,b,{targetNode:d,height:n})},getUi:function(){return{channels:{broadcastAll:E.broadcast,broadcastOn:E.broadcastOn,register:K}}}}}function Ik(n){return Ye("items","items",De(),Ue(Ke(function(t){return Je("Checking item of "+n,dO,t).fold(function(t){return Z.error(Ze(t))},function(t){return Z.value(t)})})))}function Rk(t){return{internalDialog:$e(Je("dialog",gO,t)),dataValidator:function(t){t=yt(hO(t),vO),t=Ot(t,function(n){return $.from(bO[n.type]).fold(function(){return[]},function(t){return[ao(n.name,t)]})});return m(t)}(t),initialData:t.initialData}}function Vk(t){var e=[],o={};return ve(t,function(t,n){t.fold(function(){e.push(n)},function(t){o[n]=t})}),0<e.length?Z.error(e):Z.value(o)}function Pk(t,n){rt(t,"height",n+"px"),Ao().browser.isIE()?Ji(t,"flex-basis"):rt(t,"flex-basis",n+"px")}function Hk(t,a,n){ia(t,'[role="dialog"]').each(function(u){ua(u,'[role="tablist"]').each(function(i){n.get().map(function(t){return rt(a,"height","0"),rt(a,"flex-basis","0"),Math.min(t,(t=a,o=i,r=Fn(n=u).dom,e=ia(n,".tox-dialog-wrap").getOr(n),e="fixed"===Yi(e,"position")?Math.max(r.clientHeight,window.innerHeight):Math.max(r.offsetHeight,r.scrollHeight),r=uu(t),t=t.dom.offsetLeft>=o.dom.offsetLeft+mu(o)?Math.max(uu(o),r):r,o=parseInt(Yi(n,"margin-top"),10)||0,r=parseInt(Yi(n,"margin-bottom"),10)||0,e-(uu(n)+o+r-t)));var n,e,o,r}).each(function(t){Pk(a,t)})})})}function zk(t){return ua(t,'[role="tabpanel"]')}function Nk(t,n){return{dom:{tag:"div",styles:{display:"none"},classes:["tox-dialog__header"]},components:[t,n]}}function Lk(t,n){return W1.parts.close(qd.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":n.translate("Close")}},action:t,buttonBehaviours:it([Nh.config({})])}))}function jk(){return W1.parts.title({dom:{tag:"div",classes:["tox-dialog__title"],innerHtml:"",styles:{display:"none"}}})}function Uk(t,n){return W1.parts.body({dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[{dom:WC("<p>"+n.translate(t)+"</p>")}]}]})}function Wk(t){return W1.parts.footer({dom:{tag:"div",classes:["tox-dialog__footer"]},components:t})}function Gk(t,n){return[zh.sketch({dom:{tag:"div",classes:["tox-dialog__footer-start"]},components:t}),zh.sketch({dom:{tag:"div",classes:["tox-dialog__footer-end"]},components:n})]}function Xk(n){var t="tox-dialog",e=t+"-wrap",o=e+"__backdrop",r=t+"__disable-scroll";return W1.sketch({lazySink:n.lazySink,onEscape:function(t){return n.onEscape(t),$.some(!0)},useTabstopAt:function(t){return!_y(t)},dom:{tag:"div",classes:[t].concat(n.extraClasses),styles:J({position:"relative"},n.extraStyles)},components:F([n.header,n.body],n.footer.toArray()),parts:{blocker:{dom:WC('<div class="'+e+'"></div>'),components:[{dom:{tag:"div",classes:BO?[o,o+"--opaque"]:[o]}}]}},dragBlockClass:e,modalBehaviours:it(F([lt.config({}),st("dialog-events",n.dialogEvents.concat([Mr(Jo(),function(t,n){at.focusIn(t)})])),st("scroll-lock",[Fr(function(){Fi(Li(),r)}),Ir(function(){Ri(Li(),r)})])],n.extraBehaviours)),eventOrder:J(((t={})[sr()]=["dialog-events"],t[xr()]=["scroll-lock","dialog-events","alloy.base.behaviour"],t[wr()]=["alloy.base.behaviour","dialog-events","scroll-lock"],t),n.eventOrder)})}function Yk(t,e){return[Bn(Jo(),Bb),t(Xh,function(t,n){e.onClose(),n.onClose()}),t(Yh,function(t,n,e,o){n.onCancel(t),Y(o,Xh)}),et($h,function(t,n){return e.onUnblock()}),et(Jh,function(t,n){return e.onBlock(n.event)})]}function qk(t,n){function e(t,n){return zh.sketch({dom:{tag:"div",classes:["tox-dialog__footer-"+t]},components:k(n,function(t){return t.memento.asSpec()})})}return n=n.map(function(t){return t.footerButtons}).getOr([]),n=bt(n,function(t){return"start"===t.align}),[e("start",n.pass),e("end",n.fail)]}function Kk(t,e){return{dom:WC('<div class="tox-dialog__footer"></div>'),components:[],behaviours:it([cS.config({channel:TO,initialData:t,updateState:function(t,n){var r=k(n.buttons,function(t){var n=ft(Ky(t,t.type,e));return{name:t.name,align:t.align,memento:n}});return $.some({lookupByName:function(t,n){return e=t,o=n,St(r,function(t){return t.name===o}).bind(function(t){return t.memento.getOpt(e)});var e,o},footerButtons:r})},renderComponents:qk})])}}function Jk(n,e){var o;return n.getRoot().getSystem().isConnected()?(o=T.getCurrent(n.getFormWrapper()).getOr(n.getFormWrapper()),fy.getField(o,e).fold(function(){var t=n.getFooter();return cS.getState(t).get().bind(function(t){return t.lookupByName(o,e)})},function(t){return $.some(t)})):$.none()}function $k(u,t,a,n){var e,o,r=IO(u.title,n),i=(i={dom:{tag:"div",classes:["tox-dialog__content-js"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-iframe"]},components:[Oy({dom:{tag:"iframe",attributes:{src:u.url}},behaviours:it([Nh.config({}),lt.config({})])})]}],behaviours:it([at.config({mode:"acyclic",useTabstopAt:O(_y)})])},W1.parts.body(i)),c=u.buttons.bind(function(t){return 0===t.length?$.none():$.some(UO({buttons:t},n))}),t=NO(function(){return h},VO(function(){return p},n.shared.providers,t)),s=J(J({},u.height.fold(function(){return{}},function(t){return{height:t+"px","max-height":t+"px"}})),u.width.fold(function(){return{}},function(t){return{width:t+"px","max-width":t+"px"}})),l=u.width.isNone()&&u.height.isNone()?["tox-dialog--width-lg"]:[],f=new GO(u.url,{base_uri:new GO(window.location.href)}),d=f.protocol+"://"+f.host+(f.port?":"+f.port:""),m=tt($.none()),g=[st("messages",[Fr(function(){var t=Eh(nt.fromDom(window),"message",function(t){var n;if(f.isSameOrigin(new GO(t.raw.origin)))if(t=t.raw.data,YO(t)){var e=a,o=h,r=t;switch(r.mceAction){case"insertContent":e.insertContent(r.content);break;case"setContent":e.setContent(r.content);break;case"execCommand":var i=!!S(r.ui)&&r.ui;e.execCommand(r.cmd,i,r.value);break;case"close":o.close();break;case"block":o.block(r.message);break;case"unblock":o.unblock()}}else!YO(n=t)&&w(n)&&Se(n,"mceAction")&&u.onMessage(h,t)});m.set($.some(t))}),Ir(function(){m.get().each(function(t){return t.unbind()})})]),qa.config({channels:((g={})[EO]={onReceive:function(t,n){ua(t.element,"iframe").each(function(t){t.dom.contentWindow.postMessage(n,d)})}},g)})],p=PO({header:r,body:i,footer:c,extraClasses:l,extraBehaviours:g,extraStyles:s},u,t,n),h=(o=function(t){e.getSystem().isConnected()&&t(e)},{block:function(n){if(!y(n))throw new Error("The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument");o(function(t){q(t,Jh,{message:n})})},unblock:function(){o(function(t){Y(t,$h)})},close:function(){o(function(t){Y(t,Xh)})},sendMessage:function(n){o(function(t){t.getSystem().broadcastOn([EO],n)})}});return{dialog:e=p,instanceApi:h}}function Qk(t){function o(t,m){return yO.open(function(t,n,e){o={dataValidator:e,initialData:n,internalDialog:t},e={redial:yO.redial,closeWindow:function(){W1.hide(d.dialog),m(d.instanceApi)}},t=k,r=IO(o.internalDialog.title,t),u={body:o.internalDialog.body},i=t,u=DO(u,$.none(),i,!1),i=W1.parts.body(u),u=HO(o.internalDialog.buttons),a=zO(u),u=UO({buttons:u},t),c=LO(function(){return f},VO(function(){return l},t.shared.providers,e),t.shared.getSink),s=function(){switch(o.internalDialog.size){case"large":return["tox-dialog--width-lg"];case"medium":return["tox-dialog--width-md"];default:return[]}}(),r={header:r,body:i,footer:$.some(u),extraClasses:s,extraBehaviours:[],extraStyles:{}},l=PO(r,o,c,t),f=WO({getRoot:function(){return l},getBody:function(){return W1.getBody(l)},getFooter:function(){return W1.getFooter(l)},getFormWrapper:function(){var t=W1.getBody(l);return T.getCurrent(t).getOr(t)}},e.redial,a);var o,r,i,u,a,c,s,l,f,d={dialog:l,instanceApi:f};return W1.show(d.dialog),d.instanceApi.setData(n),d.instanceApi},t)}function r(t,x,w,S){return yO.open(function(t,n,e){function o(){return h.on(function(t){Xd.reposition(t),AC.refresh(t)})}var r,i,u,a,c,s,l,f,d,m,g,p,n=$e(Je("data",e,n)),h=(r=tt($.none()),{clear:function(){return r.set($.none())},set:function(t){return r.set($.some(t))},isSet:function(){return r.get().isSome()},on:function(t){return r.get().each(t)}}),v=k.shared.header.isPositionedAtTop(),b=(e={dataValidator:e,initialData:n,internalDialog:t},u={redial:yO.redial,closeWindow:function(){h.on(Xd.hide),C.off("ResizeEditor",o),h.clear(),w(b.instanceApi)}},a=k,t=S,c=_("dialog-label"),y=_("dialog-content"),s=ft((s={title:e.internalDialog.title,draggable:!0},f=c,d=a.shared.providers,zh.sketch({dom:WC('<div class="tox-dialog__header"></div>'),components:[MO(s,$.some(f),d),FO(),AO(d)],containerBehaviours:it([P1.config({mode:"mouse",blockerClass:"blocker",getTarget:function(t){return aa(t,'[role="dialog"]').getOrDie()},snaps:{getSnapPoints:function(){return[]},leftAttr:"data-drag-left",topAttr:"data-drag-top"}})])}))),l=ft((f={body:e.internalDialog.body},d=a,t=t,DO(f,$.some(y),d,t))),f=HO(e.internalDialog.buttons),d=zO(f),m=ft(jO({buttons:f},a)),t=LO(function(){return p},{onBlock:function(e){U1.block(g,function(t,n){return RO(e.message,n,a.shared.providers)})},onUnblock:function(){U1.unblock(g)},onClose:function(){return u.closeWindow()}},a.shared.getSink),g=ou({dom:{tag:"div",classes:["tox-dialog","tox-dialog-inline"],attributes:((f={role:"dialog"})["aria-labelledby"]=c,f["aria-describedby"]=""+y,f)},eventOrder:((c={})[cr()]=[cS.name(),qa.name()],c[sr()]=["execute-on-form"],c[xr()]=["reflecting","execute-on-form"],c),behaviours:it([at.config({mode:"cyclic",onEscape:function(t){return Y(t,Xh),$.some(!0)},useTabstopAt:function(t){return!_y(t)&&("button"!==Pr(t)||"disabled"!==ai(t,"disabled"))}}),cS.config({channel:CO,updateState:function(t,n){return $.some(n)},initialData:e}),lt.config({}),st("execute-on-form",t.concat([Mr(Jo(),function(t,n){at.focusIn(t)})])),U1.config({getRoot:function(){return $.some(g)}}),ct.config({}),Sy({})]),components:[s.asSpec(),l.asSpec(),m.asSpec()]}),p=WO({getRoot:function(){return g},getFooter:function(){return m.get(g)},getBody:function(){return l.get(g)},getFormWrapper:function(){var t=l.get(g);return T.getCurrent(t).getOr(t)}},u.redial,d),{dialog:g,instanceApi:p}),y=ou(Xd.sketch(J(J({lazySink:k.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:{}},v?{}:{fireRepositionEventInstead:{}}),{inlineBehaviours:it(F([st("window-manager-inline-events",[et(Sr(),function(t,n){Y(b.dialog,Yh)})])],(i=C,O&&v?[]:[AC.config({contextual:{lazyContext:function(){return $.some(ku(nt.fromDom(i.getContentAreaContainer())))},fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},modes:["top"]})]))),isExtraPart:function(t,n){return Bh(n=n,".tox-alert-dialog")||Bh(n,".tox-confirm-dialog")}})));return h.set(y),Xd.showWithin(y,x,ru(b.dialog),$.some(Li())),O&&v||(AC.refresh(y),C.on("ResizeEditor",o)),b.instanceApi.setData(n),at.focusIn(b.dialog),b.instanceApi},t)}var a,c,s,l,k=t.backstage,C=t.editor,O=Rg(C),e=(c=(a=t).backstage.shared,{open:function(t,n){function e(){W1.hide(u),n()}var o=ft(Ky({name:"close-alert",text:"OK",primary:!0,align:"end",disabled:!1,icon:$.none()},"cancel",a.backstage)),r=jk(),i=Lk(e,c.providers),u=ou(Xk({lazySink:function(){return c.getSink()},header:Nk(r,i),body:Uk(t,c.providers),footer:$.some(Wk(Gk([],[o.asSpec()]))),onEscape:e,extraClasses:["tox-alert-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[et(Yh,e)],eventOrder:{}})),r=(W1.show(u),o.get(u));lt.focus(r)}}),i=(l=(s=t).backstage.shared,{open:function(t,n){function e(t){W1.hide(a),n(t)}var o=ft(Ky({name:"yes",text:"Yes",primary:!0,align:"end",disabled:!1,icon:$.none()},"submit",s.backstage)),r=Ky({name:"no",text:"No",primary:!1,align:"end",disabled:!1,icon:$.none()},"cancel",s.backstage),i=jk(),u=Lk(function(){return e(!1)},l.providers),a=ou(Xk({lazySink:function(){return l.getSink()},header:Nk(i,u),body:Uk(t,l.providers),footer:$.some(Wk(Gk([],[r,o.asSpec()]))),onEscape:function(){return e(!1)},extraClasses:["tox-confirm-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[et(Yh,function(){return e(!1)}),et(Kh,function(){return e(!0)})],eventOrder:{}})),i=(W1.show(a),o.get(a));lt.focus(i)}});return{open:function(t,n,e){return void 0!==n&&"toolbar"===n.inline?r(t,k.shared.anchors.inlineDialog(),e,n.ariaAttrs):void 0!==n&&"cursor"===n.inline?r(t,k.shared.anchors.cursor(),e,n.ariaAttrs):o(t,e)},openUrl:function(t,n){return e=n,yO.openUrl(function(t){var n=$k(t,{closeWindow:function(){W1.hide(n.dialog),e(n.instanceApi)}},C,k);return W1.show(n.dialog),n.instanceApi},t);var e},alert:function(t,n){e.open(t,function(){n()})},close:function(t){t.close()},confirm:function(t,n){i.open(t,function(t){n(t)})}}}var Zk,tC,nC=[{title:"Left",icon:"align-left",format:"alignleft",command:"JustifyLeft"},{title:"Center",icon:"align-center",format:"aligncenter",command:"JustifyCenter"},{title:"Right",icon:"align-right",format:"alignright",command:"JustifyRight"},{title:"Justify",icon:"align-justify",format:"alignjustify",command:"JustifyFull"}],eC=["-apple-system","Segoe UI","Roboto","Helvetica Neue","sans-serif"],oC=function(t){t=t.split(/\s*,\s*/);return k(t,function(t){return t.replace(/^['"]+|['"]+$/g,"")})},rC={"8pt":"1","10pt":"2","12pt":"3","14pt":"4","18pt":"5","24pt":"6","36pt":"7"},iC={"xx-small":"7pt","x-small":"8pt",small:"10pt",medium:"12pt",large:"14pt","x-large":"18pt","xx-large":"24pt"},uC=function(t){function n(){e.get().each(t)}var e=tt($.none());return{clear:function(){n(),e.set($.none())},isSet:function(){return e.get().isSome()},set:function(t){n(),e.set($.some(t))}}},aC=function(o,r){return function(n){function t(){n.setActive(o.formatter.match(r));var t=o.formatter.formatChanged(r,n.setActive);e.set(t)}var e=FS();return o.initialized?t():o.on("init",t),e.clear}},cC=[{name:"history",items:["undo","redo"]},{name:"styles",items:["styleselect"]},{name:"formatting",items:["bold","italic"]},{name:"alignment",items:["alignleft","aligncenter","alignright","alignjustify"]},{name:"indentation",items:["outdent","indent"]},{name:"permanent pen",items:["permanentpen"]},{name:"comments",items:["addcomment"]}],sC={button:PS(Am,function(t,n){return n=n.backstage.shared.providers,pS(t,n,[])}),togglebutton:PS(Fm,function(t,n){return n=n.backstage.shared.providers,hS(t,n,[])}),menubutton:PS(q0,function(t,n){return Ax(t,"tox-tbtn",n.backstage,$.none())}),splitbutton:PS(function(t){return Je("SplitButton",aS,t)},function(t,n){return Q0(t,n.backstage.shared)}),grouptoolbarbutton:PS(function(t){return Je("GroupToolbarButton",iS,t)},function(t,n,e){var o,r,i,u,a=e.ui.registry.getAll().buttons;(u={})[Rs]=n.backstage.shared.header.isPositionedAtTop()?ea.TopToBottom:ea.BottomToTop;if(Fg(e)!==vm.floating)throw new Error("Toolbar groups are only supported when using floating toolbar mode");return i=n.backstage,r=function(t){return fC(e,{buttons:a,toolbar:t,allowToolbarGroups:!1},n,$.none())},u=u,i=i.shared,Lw.sketch({lazySink:i.getSink,fetch:function(){return pv(function(t){t(k(r(o.items),eS))})},markers:{toggledClass:"tox-tbtn--enabled"},parts:{button:gS((o=t).icon,o.text,o.tooltip,$.none(),$.none(),i.providers),toolbar:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:u}}}})}),styleSelectButton:function(t,n){return t=t,n=n.backstage,e=J({type:"advanced"},n.styleselect),nw(t,n,VS(t,e));var e},fontsizeSelectButton:function(t,n){return n=n.backstage,nw(t,n,BS(t))},fontSelectButton:function(t,n){return n=n.backstage,nw(t,n,DS(t))},formatButton:function(t,n){return n=n.backstage,nw(t,n,RS(t))},alignMenuButton:function(t,n){return n=n.backstage,nw(t,n,ES(t))}},lC={styleselect:sC.styleSelectButton,fontsizeselect:sC.fontsizeSelectButton,fontselect:sC.fontSelectButton,formatselect:sC.formatButton,align:sC.alignMenuButton},fC=function(o,c,s,l){n=(t=c).toolbar,t=t.buttons;var e,t=!1===n?[]:void 0===n||!0===n?(e=t,t=k(cC,function(t){var n=yt(t.items,function(t){return Se(e,t)||Se(lC,t)});return{name:t.name,items:n}}),yt(t,function(t){return 0<t.items.length})):y(n)?(t=n.split("|"),k(t,function(t){return{items:t.trim().split(" ")}})):f(n,function(t){return Se(t,"name")&&Se(t,"items")})?n:(console.error("Toolbar type should be string, string[], boolean or ToolbarGroup[]"),[]),n=k(t,function(t){var n=Ot(t.items,function(t){return 0===t.trim().length?[]:(r=o,n=c.buttons,i=t,u=c.allowToolbarGroups,a=s,e=l,B(n,i.toLowerCase()).orThunk(function(){return e.bind(function(t){return Mt(t,function(t){return B(n,t+i.toLowerCase())})})}).fold(function(){return B(lC,i.toLowerCase()).map(function(t){return t(r,a)}).orThunk(function(){return $.none()})},function(t){return"grouptoolbarbutton"!==t.type||u?(e=a,o=r,B(sC,(n=t).type).fold(function(){return console.error("skipping button defined by",n),$.none()},function(t){return $.some(t(n,e,o))})):(console.warn("Ignoring the '"+i+"' toolbar button. Group toolbar buttons are only supported when using floating toolbar mode and cannot be nested."),$.none());var n,e,o}).toArray());var r,n,i,u,a,e});return{title:$.from(o.translate(t.name)),items:n}});return yt(n,function(t){return 0<t.items.length})},dC={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},mC={maxHeightFunction:cc(),maxWidthFunction:Rw()},gC={onLtr:function(){return[zu,Nu,Pu,Ru,Hu,Vu,hd,vd,gd,dd,pd,md]},onRtl:function(){return[zu,Nu,Hu,Vu,Pu,Ru,hd,vd,pd,md,gd,dd]}},pC={onLtr:function(){return[Nu,Ru,Vu,Pu,Hu,zu,hd,vd,gd,dd,pd,md]},onRtl:function(){return[Nu,Vu,Ru,Hu,Pu,zu,hd,vd,pd,md,gd,dd]}},hC=Al,Dd=Ps,Ed=X([b("shell",!1),g("makeItem"),b("setupItem",K),kl("listBehaviours",[ct])]),Ml=Vl({name:"items",overrides:function(){return{behaviours:it([ct.config({})])}}}),cl=X([Ml]),vC=hs({name:X("CustomList")(),configFields:Ed(),partFields:cl(),factory:function(u,t,n,e){t=u.shell?{behaviours:[ct.config({})],components:[]}:{behaviours:[],components:t};return{uid:u.uid,dom:u.dom,components:t.components,behaviours:ns(u.listBehaviours,t.behaviours),apis:{setItems:function(r,i){var t;t=r,(u.shell?$.some(t):Ll(t,u,"items")).fold(function(){throw console.error("Custom List was defined to not be a shell, but no item container was specified in components"),new Error("Custom List was defined to not be a shell, but no item container was specified in components")},function(n){var t=ct.contents(n),e=i.length,o=e-t.length,o=0<o?vt(o,function(){return u.makeItem()}):[],t=t.slice(e),e=(Q(t,function(t){return ct.remove(n,t)}),Q(o,function(t){return ct.append(n,t)}),ct.contents(n));Q(e,function(t,n){u.setupItem(r,t,i[n],n)})})}}}},apis:{setItems:function(t,n,e){t.setItems(n,e)}}}),bC=X([]),yC=Object.freeze({__proto__:null,setup:K,isDocked:d,getBehaviours:bC}),xC=function(t){return zS(t).map(lu).getOrThunk(function(){return cu(0,0)})},wC=Rt([{static:[]},{absolute:["positionCss"]},{fixed:["positionCss"]}]),SC=function(t,n){var e=t.element;Fi(e,n.transitionClass),Ri(e,n.fadeOutClass),Fi(e,n.fadeInClass),n.onShow(t)},kC=function(t,n){var e=t.element;Fi(e,n.transitionClass),Ri(e,n.fadeInClass),Fi(e,n.fadeOutClass),n.onHide(t)},CC=function(t,n,e){return _t(t,function(t){switch(t){case"bottom":return n.bottom<=e.bottom;case"top":return n.y>=e.y}})},OC=function(n,t){return t.getInitialPosition().map(function(t){return Su(t.bounds.x,t.bounds.y,mu(n),uu(n))})},_C=function(r,t,n){n.setInitialPosition($.some({style:function(){var t={},n=r.dom;if(zi(n))for(var e=0;e<n.style.length;e++){var o=n.style.item(e);t[o]=n.style[o]}return t}(),position:Yi(r,"position")||"static",bounds:t}))},TC=function(e,o,r){return r.getInitialPosition().bind(function(t){switch(r.setInitialPosition($.none()),t.position){case"static":return $.some(wC.static());case"absolute":var n=zS(e).map(ku).getOrThunk(function(){return ku(Li())});return $.some(wC.absolute(Za("absolute",B(t.style,"left").map(function(t){return o.x-n.x}),B(t.style,"top").map(function(t){return o.y-n.y}),B(t.style,"right").map(function(t){return n.right-o.right}),B(t.style,"bottom").map(function(t){return n.bottom-o.bottom}))));default:return $.none()}})},EC=function(n,t){Q(["left","right","top","bottom","position"],function(t){return Ji(n.element,t)}),t.onUndocked(n)},DC=function(t,n,e){tc(t.element,e),("fixed"===e.position?n.onDocked:n.onUndocked)(t)},BC=function(t,n,e){var o,r,i,u,a;t.getSystem().isConnected()&&(i=e,u=(r=n).lazyViewport(o=t),(a=i.isDocked())&&NS(o,r,i,u),function(t,n,e){var o,r,i,t=t.element;if(Ki(t,"position").is("fixed"))return r=n,OC(o=t,i=e).filter(function(t){return CC(i.getModes(),t,r)}).bind(function(t){return TC(o,t,i)});var u=ku(t=t);if(CC(e.getModes(),u,n))return $.none();_C(t,u,e);var t=Ou(),e=u.x-t.x,a=n.y-t.y,t=t.bottom-n.bottom,u=u.y<=n.y;return $.some(wC.fixed(Za("fixed",$.some(e),u?$.some(a):$.none(),$.none(),u?$.none():$.some(t))))}(o,u,i).each(function(t){i.setDocked(!a),t.fold(function(){return EC(o,r)},function(t){return DC(o,r,t)},function(t){NS(o,r,i,u,!0),DC(o,r,t)})}))},_d=Object.freeze({__proto__:null,refresh:BC,reset:LS,isDocked:function(t,n,e){return e.isDocked()},getModes:function(t,n,e){return e.getModes()},setModes:function(t,n,e,o){return e.setModes(o)}}),ya=Object.freeze({__proto__:null,events:function(o,r){return Ar([Mr(or(),function(n,e){o.contextual.each(function(t){Vi(n.element,t.transitionClass)&&(Hi(n.element,[t.transitionClass,t.fadeInClass]),(r.isVisible()?t.onShown:t.onHidden)(n)),e.stop()})}),et(br(),function(t,n){BC(t,o,r)}),et(yr(),function(t,n){LS(t,o,r)})])}}),di=[lo("contextual",[n("fadeInClass"),n("fadeOutClass"),n("transitionClass"),$t("lazyContext"),t("onShow"),t("onShown"),t("onHide"),t("onHidden")]),cn("lazyViewport",Ou),sn("modes",["top","bottom"],oo),t("onDocked"),t("onUndocked")],AC=Wu({fields:di,name:"docking",active:ya,apis:_d,state:Object.freeze({__proto__:null,init:function(t){var n=tt(!1),e=tt(!0),o=tt($.none()),r=tt(t.modes);return _i({isDocked:n.get,setDocked:n.set,getInitialPosition:o.get,setInitialPosition:o.set,isVisible:e.get,setVisible:e.set,getModes:r.get,setModes:r.set,readState:function(){return"docked:  "+n.get()+", visible: "+e.get()+", modes: "+r.get().join(",")}})}})}),MC={fadeInClass:"tox-editor-dock-fadein",fadeOutClass:"tox-editor-dock-fadeout",transitionClass:"tox-editor-dock-transition"},FC="tox-tinymce--toolbar-sticky-on",IC="tox-tinymce--toolbar-sticky-off",RC=Object.freeze({__proto__:null,setup:function(t,n,e){t.inline||(n.header.isPositionedAtTop()||t.on("ResizeEditor",function(){e().each(AC.reset)}),t.on("ResizeWindow ResizeEditor",function(){e().each(jS)}),t.on("SkinLoaded",function(){e().each(function(t){AC.isDocked(t)?AC.reset(t):AC.refresh(t)})}),t.on("FullscreenStateChanged",function(){e().each(AC.reset)})),t.on("AfterScrollIntoView",function(f){e().each(function(t){AC.refresh(t);var n,e,o,r,i,u,a,c,s,l,t=t.element;wd(t)&&(r=f,e=(n=jr(t=t)).dom.defaultView.innerHeight,o=bu(n),r=nt.fromDom(r.elm),i=Cu(r),r=uu(r),u=(i=i.y)+r,a=lu(t),t=uu(t),c=(a=a.top)+t,s=Math.abs(a-o.top)<2,l=Math.abs(c-(o.top+e))<2,s&&i<c?ne(o.left,i-t,n):l&&a<u&&ne(o.left,i-e+r+t,n))})}),t.on("PostRender",function(){WS(t,!1)})},isDocked:function(t){return t().map(AC.isDocked).getOr(!1)},getBehaviours:GS}),VC=ql({factory:function(n,e){var t={focus:at.focusIn,setMenus:function(t,n){n=k(n,function(n){var t={type:"menubutton",text:n.text,fetch:function(t){t(n.getItems())}},t=q0(t).mapError(function(t){return Ze(t)}).getOrDie();return Ax(t,"tox-mbtn",e.backstage,$.some("menuitem"))});ct.set(t,n)}};return{uid:n.uid,dom:n.dom,components:[],behaviours:it([ct.config({}),st("menubar-events",[Fr(function(t){n.onSetup(t)}),et(Ko(),function(e,t){ua(e.element,".tox-mbtn--active").each(function(n){aa(t.event.target,".tox-mbtn").each(function(t){Io(n,t)||e.getSystem().getByDom(n).each(function(n){e.getSystem().getByDom(t).each(function(t){zb.expand(t),zb.close(n),lt.focus(t)})})})})}),et(kr(),function(e,t){t.event.prevFocus.bind(function(t){return e.getSystem().getByDom(t).toOptional()}).each(function(n){t.event.newFocus.bind(function(t){return e.getSystem().getByDom(t).toOptional()}).each(function(t){zb.isOpen(n)&&(zb.expand(t),zb.close(n))})})})]),at.config({mode:"flow",selector:".tox-mbtn",onEscape:function(t){return n.onEscape(t),$.some(!0)}}),Nh.config({})]),apis:t,domModification:{attributes:{role:"menubar"}}}},name:"silver.Menubar",configFields:[g("dom"),g("uid"),g("onEscape"),g("backstage"),b("onSetup",K)],apis:{focus:function(t,n){t.focus(n)},setMenus:function(t,n,e){t.setMenus(n,e)}}}),PC="container",HC=[Zc("slotBehaviours",[])],kd=be({getSlotNames:function(t,n){return t.getSlotNames(n)},getSlot:function(t,n,e){return t.getSlot(n,e)},isShowing:function(t,n,e){return t.isShowing(n,e)},hideSlot:function(t,n,e){return t.hideSlot(n,e)},hideAllSlots:function(t,n){return t.hideAllSlots(n)},showSlot:function(t,n,e){return t.showSlot(n,e)}},jn),zC=J(J({},kd),{sketch:function(t){e=[];var e,n={slot:function(t,n){return e.push(t),cs(PC,XS(t),n)},record:function(){return e}},t=t(n),n=n.record(),n=k(n,function(t){return Rl({name:t,pname:XS(t)})});return ps(PC,HC,n,YS,t)}}),NC=m([nn("icon"),nn("tooltip"),cn("onShow",K),cn("onHide",K),cn("onSetup",function(){return K})]),LC=function(t){return{element:function(){return t.element.dom}}},jC=_("FixSizeEvent"),UC=_("AutoSizeEvent"),WC=function(t){var t=nt.fromHtml(t),n=qr(t),e=(e=void 0!==t.dom.attributes?t.dom.attributes:[],wt(e,function(t,n){return"class"===n.name?t:J(J({},t),((t={})[n.name]=n.value,t))},{})),o=Array.prototype.slice.call(t.dom.classList,0),n=0===n.length?{}:{innerHtml:ii(t)};return J({tag:Pr(t),classes:o,attributes:e},n)},Vs=Dd.optional({factory:VC,name:"menubar",schema:[g("backstage")]}),bo=Dd.optional({factory:{sketch:function(t){return vC.sketch({uid:t.uid,dom:t.dom,listBehaviours:it([at.config({mode:"acyclic",selector:".tox-toolbar"})]),makeItem:function(){return rS({type:t.type,uid:_("multiple-toolbar-item"),cyclicKeying:!1,initGroups:[],providers:t.providers,onEscape:function(){return t.onEscape(),$.some(!0)}})},setupItem:function(t,n,e,o){Pw.setGroups(n,e)},shell:!0})}},name:"multiple-toolbar",schema:[g("dom"),g("onEscape")]}),Fl=Dd.optional({factory:{sketch:function(t){return(t.type===vm.sliding?function(t){var n=Zw.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}}),e=Zw.parts.overflow({dom:{tag:"div",classes:["tox-toolbar__overflow"]}}),t=Y0(t);return Zw.sketch(J(J({},t),{components:[n,e],markers:{openClass:"tox-toolbar__overflow--open",closedClass:"tox-toolbar__overflow--closed",growingClass:"tox-toolbar__overflow--growing",shrinkingClass:"tox-toolbar__overflow--shrinking",overflowToggledClass:"tox-tbtn--enabled"},onOpened:function(t){t.getSystem().broadcastOn([tS()],{type:"opened"})},onClosed:function(t){t.getSystem().broadcastOn([tS()],{type:"closed"})}}))}:t.type===vm.floating?function(o){var t=Y0(o),n=Uw.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}});return Uw.sketch(J(J({},t),{lazySink:o.getSink,getOverflowBounds:function(){var t=o.moreDrawerData.lazyHeader().element,n=Cu(t),t=Fn(t),e=Cu(t),t=Math.max(t.dom.scrollHeight,e.height);return Su(n.x+4,e.y,n.width-8,t)},parts:J(J({},t.parts),{overflow:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:o.attributes}}}),components:[n],markers:{overflowToggledClass:"tox-tbtn--enabled"}}))}:rS)({type:t.type,uid:t.uid,onEscape:function(){return t.onEscape(),$.some(!0)},cyclicKeying:!1,initGroups:[],getSink:t.getSink,providers:t.providers,moreDrawerData:{lazyToolbar:t.lazyToolbar,lazyMoreButton:t.lazyMoreButton,lazyHeader:t.lazyHeader},attributes:t.attributes})}},name:"toolbar",schema:[g("dom"),g("onEscape"),g("getSink")]}),Od=Dd.optional({factory:{sketch:function(t){var n=t.editor,e=t.sticky?GS:bC;return{uid:t.uid,dom:t.dom,components:t.components,behaviours:it(e(n,t.sharedBackstage))}}},name:"header",schema:[g("dom")]}),Td=Dd.optional({name:"socket",schema:[g("dom")]}),Il=Dd.optional({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",classes:["tox-sidebar"],attributes:{role:"complementary"}},components:[{dom:{tag:"div",classes:["tox-sidebar__slider"]},components:[],behaviours:it([Nh.config({}),lt.config({}),Qw.config({dimension:{property:"width"},closedClass:"tox-sidebar--sliding-closed",openClass:"tox-sidebar--sliding-open",shrinkingClass:"tox-sidebar--sliding-shrinking",growingClass:"tox-sidebar--sliding-growing",onShrunk:function(t){T.getCurrent(t).each(zC.hideAllSlots),Y(t,UC)},onGrown:function(t){Y(t,UC)},onStartGrow:function(t){q(t,jC,{width:Ki(t.element,"width").getOr("")})},onStartShrink:function(t){q(t,jC,{width:mu(t.element)+"px"})}}),ct.config({}),T.config({find:function(t){t=ct.contents(t);return H(t)}})])}],behaviours:it([Cb(0),st("sidebar-sliding-events",[et(jC,function(t,n){rt(t.element,"width",n.event.width)}),et(UC,function(t,n){Ji(t.element,"width")})])])}}},name:"sidebar",schema:[g("dom")]}),vo=Dd.optional({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",attributes:{"aria-hidden":"true"},classes:["tox-throbber"],styles:{display:"none"}},behaviours:it([ct.config({})]),components:[]}}},name:"throbber",schema:[g("dom")]}),GC=hs({name:"OuterContainer",factory:function(e,t,n){return{uid:e.uid,dom:e.dom,components:t,apis:{getSocket:function(t){return hC.getPart(t,e,"socket")},setSidebar:function(t,n){hC.getPart(t,e,"sidebar").each(function(t){return qS(t,n)})},toggleSidebar:function(t,n){hC.getPart(t,e,"sidebar").each(function(t){var e=n;T.getCurrent(t).each(function(n){T.getCurrent(n).each(function(t){Qw.hasGrown(n)?zC.isShowing(t,e)?Qw.shrink(n):(zC.hideAllSlots(t),zC.showSlot(t,e)):(zC.hideAllSlots(t),zC.showSlot(t,e),Qw.grow(n))})})})},whichSidebar:function(t){return hC.getPart(t,e,"sidebar").bind(KS).getOrNull()},getHeader:function(t){return hC.getPart(t,e,"header")},getToolbar:function(t){return hC.getPart(t,e,"toolbar")},setToolbar:function(t,n){hC.getPart(t,e,"toolbar").each(function(t){t.getApis().setGroups(t,n)})},setToolbars:function(t,n){hC.getPart(t,e,"multiple-toolbar").each(function(t){vC.setItems(t,n)})},refreshToolbar:function(t){hC.getPart(t,e,"toolbar").each(function(t){return t.getApis().refresh(t)})},toggleToolbarDrawer:function(t){hC.getPart(t,e,"toolbar").each(function(n){var t=n.getApis().toggle;null!=t?$.some(function(t){return t(n)}(t)):$.none()})},isToolbarDrawerToggled:function(t){return hC.getPart(t,e,"toolbar").bind(function(n){return $.from(n.getApis().isOpen).map(function(t){return t(n)})}).getOr(!1)},getThrobber:function(t){return hC.getPart(t,e,"throbber")},focusToolbar:function(t){hC.getPart(t,e,"toolbar").orThunk(function(){return hC.getPart(t,e,"multiple-toolbar")}).each(function(t){at.focusIn(t)})},setMenubar:function(t,n){hC.getPart(t,e,"menubar").each(function(t){VC.setMenus(t,n)})},focusMenubar:function(t){hC.getPart(t,e,"menubar").each(function(t){VC.focus(t)})}},behaviours:e.behaviours}},configFields:[g("dom"),g("behaviours")],partFields:[Od,Vs,Fl,bo,Td,Il,vo],apis:{getSocket:function(t,n){return t.getSocket(n)},setSidebar:function(t,n,e){t.setSidebar(n,e)},toggleSidebar:function(t,n,e){t.toggleSidebar(n,e)},whichSidebar:function(t,n){return t.whichSidebar(n)},getHeader:function(t,n){return t.getHeader(n)},getToolbar:function(t,n){return t.getToolbar(n)},setToolbar:function(t,n,e){e=k(e,eS);t.setToolbar(n,e)},setToolbars:function(t,n,e){e=k(e,function(t){return k(t,eS)});t.setToolbars(n,e)},refreshToolbar:function(t,n){return t.refreshToolbar(n)},toggleToolbarDrawer:function(t,n){t.toggleToolbarDrawer(n)},isToolbarDrawerToggled:function(t,n){return t.isToolbarDrawerToggled(n)},getThrobber:function(t,n){return t.getThrobber(n)},setMenubar:function(t,n,e){t.setMenubar(n,e)},focusMenubar:function(t,n){t.focusMenubar(n)},focusToolbar:function(t,n){t.focusToolbar(n)}}}),XC={file:{title:"File",items:"newdocument restoredraft | preview | export print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed template codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor toc | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | formats blockformats fontformats fontsizes align lineheight | forecolor backcolor | removeformat"},tools:{title:"Tools",items:"spellchecker spellcheckerlanguage | a11ycheck code wordcount"},table:{title:"Table",items:"inserttable | cell row column | advtablesort | tableprops deletetable"},help:{title:"Help",items:"help"}},YC=function(e,o,r){return new Cm(function(t,n){r.load(o,t,n),e.on("remove",function(){return r.unload(o)})})},qC=M(ZS,!1),KC=M(ZS,!0),Al=Ao(),JC=Al.os.isiOS()&&Al.os.version.major<=12,$C=Object.freeze({__proto__:null,render:function(e,n,t,o,r){var i=tt(0),u=n.outerContainer;qC(e);var r=nt.fromDom(r.targetNode),a=Qr($r(r)),c=n.mothership;Hc(r,c,Vn),Pc(a,n.uiMothership),e.on("PostRender",function(){tk(e,n,t,o),i.set(e.getWin().innerWidth),GC.setMenubar(u,$S(e,t)),GC.setSidebar(u,t.sidebar),nk(e,n)});var s,l,r=GC.getSocket(u).getOrDie("Could not find expected socket element"),a=(JC&&(Gi(r.element,{overflow:"scroll","-webkit-overflow-scrolling":"touch"}),s=function(){e.fire("ScrollContent")},l=null,c=Eh(r.element,"scroll",{cancel:function(){null!==l&&(clearTimeout(l),l=null)},throttle:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];null===l&&(l=setTimeout(function(){s.apply(null,t),l=null},20))}}.throttle),e.on("remove",c.unbind)),Pg(e,n),e.addCommand("ToggleSidebar",function(t,n){GC.toggleSidebar(u,n),e.fire("ToggleSidebar")}),e.addQueryValueHandler("ToggleSidebar",function(){return GC.whichSidebar(u)}),Fg(e)),c=(a!==vm.sliding&&a!==vm.floating||e.on("ResizeWindow ResizeEditor ResizeContent",function(){var t=e.getWin().innerWidth;t!==i.get()&&(GC.refreshToolbar(n.outerContainer),i.set(t))}),{enable:function(){Vg(n,!1)},disable:function(){Vg(n,!0)},isDisabled:function(){return dt.isDisabled(u)}});return{iframeContainer:r.element.dom,editorContainer:u.element.dom,api:c}}}),QC=function(t){return/^[0-9\.]+(|px)$/i.test(""+t)?$.some(parseInt(""+t,10)):$.none()},ZC=function(n,t,e){t=t.filter(function(t){return n<t}),e=e.filter(function(t){return t<n});return t.or(e).getOr(n)},t1=Object.freeze({__proto__:null,render:function(o,r,s,l,t){function n(){var i,u,a,t,c,n;function e(t){var n=(e=ik(u,a.isPositionedAtTop())).pos,e=e.bounds,o=(r=c.get()).pos,r=r.bounds,r=e.height!==r.height||e.width!==r.width;c.set({pos:n,bounds:e}),r&&Kg(i,t),a.isVisible()&&(o!==n?a.update(!0):r&&(a.updateMode(),a.repositionPopups()))}g.get()?h.show():(g.set(GC.getHeader(m).getOrDie()),t=Ig(o),Pc(t,f),Pc(t,d),tk(o,r,s,l),GC.setMenubar(m,$S(o,s)),h.show(),i=o,t=v,c=tt(ik(u=p,(a=h).isPositionedAtTop())),t||(i.on("activate",a.show),i.on("deactivate",a.hide)),i.on("SkinLoaded ResizeWindow",function(){return a.update(!0)}),i.on("NodeChange keydown",function(t){Yd.requestAnimationFrame(function(){return e(t)})}),i.on("ScrollWindow",function(){return a.updateMode()}),(n=FS()).set(hh(nt.fromDom(i.getBody()),"load",e)),i.on("remove",function(){n.clear()}),o.nodeChanged())}var f=r.mothership,d=r.uiMothership,m=r.outerContainer,g=tt(null),p=nt.fromDom(t.targetNode),h=rk(o,p,r,l,g),v=o.getParam("toolbar_persist",!1,"boolean");KC(o);return o.on("show",n),o.on("hide",h.hide),v||(o.on("focus",n),o.on("blur",h.hide)),o.on("init",function(){(o.hasFocus()||v)&&n()}),Pg(o,r),{editorContainer:m.element.dom,api:{show:function(){h.show()},hide:function(){h.hide()},enable:function(){Vg(r,!1)},disable:function(){Vg(r,!0)},isDisabled:function(){return dt.isDisabled(m)}}}}}),n1=function(t,n){var e,o,r,i,u,a,c,s=tw(0,o=n,ES(i=t));i.ui.registry.addNestedMenuItem("align",{text:o.shared.providers.translate("Align"),getSubmenuItems:function(){return s.items.validateItems(s.getStyleItems())}}),e=tw(0,i=n,DS(o=t)),o.ui.registry.addNestedMenuItem("fontformats",{text:i.shared.providers.translate("Fonts"),getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}}),o=t,a=J({type:"advanced"},(i=n).styleselect),r=tw(0,i,VS(o,a)),o.ui.registry.addNestedMenuItem("formats",{text:"Formats",getSubmenuItems:function(){return r.items.validateItems(r.getStyleItems())}}),u=tw(0,n,RS(i=t)),i.ui.registry.addNestedMenuItem("blockformats",{text:"Blocks",getSubmenuItems:function(){return u.items.validateItems(u.getStyleItems())}}),c=tw(0,n,BS(a=t)),a.ui.registry.addNestedMenuItem("fontsizes",{text:"Font sizes",getSubmenuItems:function(){return c.items.validateItems(c.getStyleItems())}})},e1={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},o1=(Ps="[eE][+-]?[0-9]+",cl=["Infinity",(Ml="[0-9]+")+"\\."+(Ed=function(t){return"(?:"+t+")?"})(Ml)+Ed(Ps),"\\."+Ml+Ed(Ps),Ml+Ed(Ps)].join("|"),new RegExp("^([+-]?(?:"+cl+"))(.*)$")),r1=function(t){var n,e;(n=t).ui.registry.addNestedMenuItem("lineheight",{type:"nestedmenuitem",text:"Line height",getSubmenuItems:function(){return ak(n)}}),(e=t).ui.registry.addMenuButton("lineheight",{tooltip:"Line height",icon:"line-height",fetch:function(t){return t(ak(e))}})},i1=function(t){var n,e,o,r=t,i=r;by.each([{name:"bold",text:"Bold",icon:"bold"},{name:"italic",text:"Italic",icon:"italic"},{name:"underline",text:"Underline",icon:"underline"},{name:"strikethrough",text:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",icon:"superscript"}],function(t,n){i.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onSetup:aC(i,t.name),onAction:ck(i,t.name)})});for(var u=1;u<=6;u++){var a="h"+u;i.ui.registry.addToggleButton(a,{text:a.toUpperCase(),tooltip:"Heading "+u,onSetup:aC(i,a),onAction:ck(i,a)})}e=r,by.each([{name:"cut",text:"Cut",action:"Cut",icon:"cut"},{name:"copy",text:"Copy",action:"Copy",icon:"copy"},{name:"paste",text:"Paste",action:"Paste",icon:"paste"},{name:"help",text:"Help",action:"mceHelp",icon:"help"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"remove",text:"Remove",action:"Delete",icon:"remove"}],function(t){e.ui.registry.addButton(t.name,{tooltip:t.text,icon:t.icon,onAction:function(){return e.execCommand(t.action)}})}),o=r,by.each([{name:"blockquote",text:"Blockquote",action:"mceBlockQuote",icon:"quote"}],function(t){o.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onAction:function(){return o.execCommand(t.action)},onSetup:aC(o,t.name)})}),n=t,by.each([{name:"bold",text:"Bold",action:"Bold",icon:"bold",shortcut:"Meta+B"},{name:"italic",text:"Italic",action:"Italic",icon:"italic",shortcut:"Meta+I"},{name:"underline",text:"Underline",action:"Underline",icon:"underline",shortcut:"Meta+U"},{name:"strikethrough",text:"Strikethrough",action:"Strikethrough",icon:"strike-through",shortcut:""},{name:"subscript",text:"Subscript",action:"Subscript",icon:"subscript",shortcut:""},{name:"superscript",text:"Superscript",action:"Superscript",icon:"superscript",shortcut:""},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting",shortcut:""},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document",shortcut:""},{name:"cut",text:"Cut",action:"Cut",icon:"cut",shortcut:"Meta+X"},{name:"copy",text:"Copy",action:"Copy",icon:"copy",shortcut:"Meta+C"},{name:"paste",text:"Paste",action:"Paste",icon:"paste",shortcut:"Meta+V"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all",shortcut:"Meta+A"}],function(t){n.ui.registry.addMenuItem(t.name,{text:t.text,icon:t.icon,shortcut:t.shortcut,onAction:function(){return n.execCommand(t.action)}})}),n.ui.registry.addMenuItem("codeformat",{text:"Code",icon:"sourcecode",onAction:ck(n,"code")})},u1=function(t){var n,e;(n=t).ui.registry.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onSetup:function(t){return sk(t,n,"hasUndo")},onAction:function(){return n.execCommand("undo")}}),n.ui.registry.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onSetup:function(t){return sk(t,n,"hasRedo")},onAction:function(){return n.execCommand("redo")}}),(e=t).ui.registry.addButton("undo",{tooltip:"Undo",icon:"undo",onSetup:function(t){return sk(t,e,"hasUndo")},onAction:function(){return e.execCommand("undo")}}),e.ui.registry.addButton("redo",{tooltip:"Redo",icon:"redo",onSetup:function(t){return sk(t,e,"hasRedo")},onAction:function(){return e.execCommand("redo")}})},a1=function(t,n,e,o,r,i){var e=e(),u=i?gk(t):mk(t,n);Bx(e,Vm.CLOSE_ON_EXECUTE,o,!1).map(function(t){n.preventDefault(),Xd.showMenuAt(r,u,{menu:{markers:Ym("normal")},data:t})})},c1={onLtr:function(){return[Nu,Ru,Vu,Pu,Hu,zu,hd,vd,gd,dd,pd,md]},onRtl:function(){return[Nu,Vu,Ru,Hu,Pu,zu,hd,vd,pd,md,gd,dd]}},s1={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},l1=function(s,l,f,d,m,g){function u(){var n,e,o,r,t,i,u,a,c=f();n=s,e=l,c=c,o=d,r=m,i=!(v||p||h&&b),a=(t=g)?gk(n):(t=n,u=e,J({bubble:lc(0,12,s1),layouts:c1,overrides:{maxWidthFunction:Rw(),maxHeightFunction:cc()}},mk(t,u))),Bx(c,Vm.CLOSE_ON_EXECUTE,o,!0).map(function(t){e.preventDefault(),Xd.showMenuWithinBounds(r,a,{menu:{markers:Ym("normal"),highlightImmediately:i},data:t,type:"horizontal"},function(){return $.some(yS(n,o.shared))}),n.fire(Vw)})}var t,n=Ao(),p=n.os.isiOS(),h=n.os.isOSX(),v=n.os.isAndroid(),b=n.deviceType.isTouch();!h&&!p||g?(v&&!g&&s.selection.setCursorLocation(l.target,0),u()):(t=function(){function t(){Yd.setEditorTimeout(o,function(){o.selection.setRng(r)},10),i()}function n(t){t.preventDefault(),t.stopImmediatePropagation()}function e(){return i()}var o,r,i;r=(o=s).selection.getRng(),o.once("touchend",t),o.on("mousedown",n,!0),o.once("longpresscancel",e),i=function(){o.off("touchend",t),o.off("longpresscancel",e),o.off("mousedown",n)},u()},function(t,n){var e,o=t.selection;if(!(o.isCollapsed()||n.touches.length<1))return e=n.touches[0],n=o.getRng(),kc(t.getWin(),Ws.domRange(n)).exists(function(t){return t.left<=e.clientX&&t.right>=e.clientX&&t.top<=e.clientY&&t.bottom>=e.clientY})}(s,l)?t():(s.once("selectionchange",t),s.once("touchend",function(){return s.off("selectionchange",t)})))},f1=function(t){return t.getParam("contextmenu_never_use_native",!1,"boolean")},d1=function(t){return n=(t=t).ui.registry.getAll().contextMenus,$.from(t.getParam("contextmenu")).map(pk).getOrThunk(function(){return yt(pk("link linkchecker image imagetools table spellchecker configurepermanentpen"),function(t){return Se(n,t)})});var n},m1=function(t){return y(t)?"|"===t:"separator"===t.type},g1={type:"separator"},p1=function(n){function t(t){return{text:t.text,icon:t.icon,disabled:t.disabled,shortcut:t.shortcut}}var e;if(y(n))return n;switch(n.type){case"separator":return g1;case"submenu":return J(J({type:"nestedmenuitem"},t(n)),{getSubmenuItems:function(){var t=n.getSubmenuItems();return y(t)?t:k(t,p1)}});default:return J(J({type:"menuitem"},t(n)),{onAction:(e=n.onAction,function(){return e()})})}},h1=function(t,n){var e;return 0===n.length?t:(e=Bt(t).filter(function(t){return!m1(t)}).fold(function(){return[]},function(t){return[g1]}),t.concat(e).concat(n).concat([g1]))},v1=function(t,n){return"longpress"!==n.type&&(2!==n.button||n.target===t.getBody()&&""===n.pointerType)},b1=function(t,n){return v1(t,n)?t.selection.getStart(!0):n.target},di=Rt([{offset:["x","y"]},{absolute:["x","y"]},{fixed:["x","y"]}]),y1=function(n){return function(t){return t.translate(-n.left,-n.top)}},x1=function(n){return function(t){return t.translate(n.left,n.top)}},w1=function(e){return function(t,n){return wt(e,function(t,n){return n(t)},cu(t,n))}},S1=function(t,n,e){return t.fold(w1([x1(e)]),w1([]),w1([x1(n)]))},k1=function(t,n,e){t=t.fold(function(t,n){return{position:$.some("absolute"),left:$.some(t+"px"),top:$.some(n+"px")}},function(t,n){return{position:$.some("absolute"),left:$.some(t-e.left+"px"),top:$.some(n-e.top+"px")}},function(t,n){return{position:$.some("fixed"),left:$.some(t+"px"),top:$.some(n+"px")}});return J({right:$.none(),bottom:$.none()},t)},C1=function(t,i,u,a){function n(o,r){return function(t,n){var e=o(i,u,a);return r(t.getOr(e.left),n.getOr(e.top))}}return t.fold(n(bk,O1),n(S1,_1),n(vk,T1))},O1=di.offset,_1=di.absolute,T1=di.fixed,E1=function(t,n){t=t.element;si(t,n.leftAttr),si(t,n.topAttr)},D1=function(t,a,c,s){return Mt(t,function(t){var n,e,o=t.sensor,r=t.range.left,i=t.range.top,u=S1(a,n=c,e=s),o=S1(o,n,e);return Math.abs(u.left-o.left)<=r&&Math.abs(u.top-o.top)<=i?$.some({output:C1(t.output,a,c,s),extra:t.extra}):$.none()})},ya=Object.freeze({__proto__:null,snapTo:function(t,n,e,o){var r=n.getTarget(t.element);n.repositionTarget&&(n=jr(t.element),t=bu(n),n=xC(r),t={coord:C1((o=o).output,o.output,t,n),extra:o.extra},o=k1(t.coord,0,n),Xi(r,o))}}),B1="data-initial-z-index",A1=function(t){Gr(t.element).filter(Hr).each(function(n){ci(n,B1).fold(function(){return Ji(n,"z-index")},function(t){return rt(n,"z-index",t)}),si(n,B1)}),t.getSystem().removeFromGui(t)},_d=lo("snaps",[g("getSnapPoints"),t("onSensor"),g("leftAttr"),g("topAttr"),b("lazyViewport",Ou),b("mustSnap",!1)]),kd=[b("useFixed",d),g("blockerClass"),b("getTarget",A),b("onDrag",K),b("repositionTarget",!0),b("onDrop",K),cn("getBounds",Ou),_d],M1=function(n){return t=Ki(n,"left"),e=Ki(n,"top"),o=Ki(n,"position"),r=function(t,n,e){return("fixed"===e?T1:O1)(parseInt(t,10),parseInt(n,10))},(t.isSome()&&e.isSome()&&o.isSome()?$.some(r(t.getOrDie(),e.getOrDie(),o.getOrDie())):$.none()).getOrThunk(function(){var t=lu(n);return _1(t.left,t.top)});var t,e,o,r},F1=function(e,t,r,i,u,a,n){var t=t.fold(function(){e=a.left,o=a.top;var e,o,t=r.fold(function(t,n){return O1(t+e,n+o)},function(t,n){return _1(t+e,n+o)},function(t,n){return T1(t+e,n+o)}),t=vk(t,i,u);return T1(t.left,t.top)},function(n){var t=xk(e,n,r,a,i,u);return t.extra.each(function(t){n.onSensor(e,t)}),t.coord}),o=i,c=u,s=(n=n).bounds,l=S1(t,o,c),f=Ku(l.left,s.x,s.x+s.width-n.width),l=Ku(l.top,s.y,s.y+s.height-n.height),d=_1(f,l);return t.fold(function(){var t=bk(d,o,c);return O1(t.left,t.top)},function(){return d},function(){var t=vk(d,o,c);return T1(t.left,t.top)})},I1=function(t,n){return{bounds:t.getBounds(),height:au(n.element),width:gu(n.element)}},R1=Object.freeze({__proto__:null,getData:function(t){return $.from(cu(t.x,t.y))},getDelta:function(t,n){return cu(n.left-t.left,n.top-t.top)}}),Dd=F(kd,[ha("dragger",{handlers:Tk(Ek)})]),V1=Object.freeze({__proto__:null,getData:function(t){var t=t.raw.touches;return 1===t.length?(t=t[0],$.some(cu(t.clientX,t.clientY))):$.none()},getDelta:function(t,n){return cu(n.left-t.left,n.top-t.top)}}),Od=F(kd,[ha("dragger",{handlers:Tk(Dk)})]),Vs=F(kd,[ha("dragger",{handlers:Tk(function(t,n,e){return F(Ek(t,n,e),Dk(t,n,e))})})]),P1=Gu({branchKey:"mode",branches:Object.freeze({__proto__:null,mouse:Dd,touch:Od,mouseOrTouch:Vs}),name:"dragging",active:{events:function(t,n){return t.dragger.handlers(t,n)}},extra:{snap:function(t){return{sensor:t.sensor,range:t.range,output:t.output,extra:$.from(t.extra)}}},state:Object.freeze({__proto__:null,init:function(){var r=$.none(),n=$.none(),t=X({});return _i({readState:t,reset:function(){r=$.none(),n=$.none()},update:function(o,t){return o.getData(t).bind(function(t){return n=o,e=t,t=r.map(function(t){return n.getDelta(t,e)}),r=$.some(e),t;var n,e})},getStartData:function(){return n},setStartData:function(t){n=$.some(t)}})}}),apis:ya}),H1=function(t,o,r,i,n,e){return t.fold(function(){return P1.snap({sensor:_1(r-20,i-20),range:cu(n,e),output:_1($.some(r),$.some(i)),extra:{td:o}})},function(t){var n=r-20,e=i-20,t=t.element.dom.getBoundingClientRect();return P1.snap({sensor:_1(n,e),range:cu(40,40),output:_1($.some(r-t.width/2),$.some(i-t.height/2)),extra:{td:o}})})},z1=function(t,r,i){return{getSnapPoints:t,leftAttr:"data-drag-left",topAttr:"data-drag-top",onSensor:function(t,n){var n=n.td,e=r.get(),o=n;e.exists(function(t){return Io(t,o)})||(r.set($.some(n)),i(n))},mustSnap:!0}},N1=function(t){return ft(qd.sketch({dom:{tag:"div",classes:["tox-selector"]},buttonBehaviours:it([P1.config({mode:"mouseOrTouch",blockerClass:"blocker",snaps:t}),Nb.config({})]),eventOrder:{mousedown:["dragging","alloy.base.behaviour"],touchstart:["dragging","alloy.base.behaviour"]}}))},L1=function(i,o,r){return o.delimiter||(o.delimiter=""),{dom:{tag:"div",classes:["tox-statusbar__path"],attributes:{role:"navigation"}},behaviours:it([at.config({mode:"flow",selector:"div[role=button]"}),dt.config({disabled:r.isDisabled}),vp(),Nh.config({}),ct.config({}),st("elementPathEvents",[Fr(function(n,t){i.shortcuts.add("alt+F11","focus statusbar elementpath",function(){return at.focusIn(n)}),i.on("NodeChange",function(t){var e,t=function(t){for(var n=[],e=t.length;0<e--;){var o=t[e];if(1===o.nodeType&&!function(t){if(1===t.nodeType){if("BR"===t.nodeName||t.getAttribute("data-mce-bogus"))return 1;if("bookmark"===t.getAttribute("data-mce-type"))return 1}}(o)){var r=i.fire("ResolveName",{name:o.nodeName.toLowerCase(),target:o});if(r.isDefaultPrevented()||n.push({name:r.name,element:o}),r.isPropagationStopped())break}}return n}(t.parents);0<t.length?ct.set(n,(t=k(t||[],function(n,t){return qd.sketch({dom:{tag:"div",classes:["tox-statusbar__path-item"],attributes:{role:"button","data-index":t,"tab-index":-1,"aria-level":t+1},innerHtml:n.name},action:function(t){i.focus(),i.selection.select(n.element),i.nodeChanged()},buttonBehaviours:it([bp(r.isDisabled),vp()])})}),e={dom:{tag:"div",classes:["tox-statusbar__path-divider"],attributes:{"aria-hidden":!0},innerHtml:" "+o.delimiter+" "}},wt(t.slice(1),function(t,n){return t.push(e),t.push(n),t},[t[0]]))):ct.set(n,[])})})])]),components:[]}},j1=(Zk={None:0,0:"None",Both:1,1:"Both",Vertical:2,2:"Vertical"},function(o,t){n=!(e=o).hasPlugin("autoresize");var n,e,r=!1===(e=e.getParam("resize",n))?Zk.None:"both"===e?Zk.Both:Zk.Vertical;return r===Zk.None?$.none():$.some({dom:{tag:"div",classes:["tox-statusbar__resize-handle"],attributes:{title:t.translate("Resize")},innerHtml:Kd("resize-handle",t.icons)},behaviours:it([P1.config({mode:"mouse",repositionTarget:!1,onDrag:function(t,n,e){return Ak(o,e,r)},blockerClass:"tox-blocker"}),at.config({mode:"special",onLeft:function(){return Mk(o,r,-1,0)},onRight:function(){return Mk(o,r,1,0)},onUp:function(){return Mk(o,r,0,-1)},onDown:function(){return Mk(o,r,0,1)}}),Nh.config({}),lt.config({})])})}),Fl=X([g("lazySink"),p("dragBlockClass"),cn("getBounds",Ou),b("useTabstopAt",E),b("eventOrder",{}),Zc("modalBehaviours",[at]),Mu("onExecute"),Iu("onEscape")]),bo={sketch:A},Td=X([Vl({name:"draghandle",overrides:function(t,n){return{behaviours:it([P1.config({mode:"mouse",getTarget:function(t){return ia(t,'[role="dialog"]').getOr(t)},blockerClass:t.dragBlockClass.getOrDie(new Error("The drag blocker class was not specified for a dialog with a drag handle: \n"+JSON.stringify(n,null,2)).message),getBounds:t.getDragBounds})])}}}),Rl({schema:[g("dom")],name:"title"}),Rl({factory:bo,schema:[g("dom")],name:"close"}),Rl({factory:bo,schema:[g("dom")],name:"body"}),Vl({factory:bo,schema:[g("dom")],name:"footer"}),js({factory:{sketch:function(t,n){return J(J({},t),{dom:n.dom,components:n.components})}},schema:[b("dom",{tag:"div",styles:{position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px"}}),b("components",[])],name:"blocker"})]),Il=Object.freeze({__proto__:null,block:function(t,n,e,o){ot(t.element,"aria-busy",!0);var r=n.getRoot(t).getOr(t),i=it([at.config({mode:"special",onTab:function(){return $.some(!0)},onShiftTab:function(){return $.some(!0)}}),lt.config({})]),o=o(r,i),u=r.getSystem().build(o);ct.append(r,ru(u)),u.hasConfigured(at)&&at.focusIn(u),e.isBlocked()||n.onBlock(t),e.blockWith(function(){return ct.remove(r,u)})},unblock:function(t,n,e){si(t.element,"aria-busy"),e.isBlocked()&&n.onUnblock(t),e.clear()}}),vo=[cn("getRoot",$.none),t("onBlock"),t("onUnblock")],U1=Wu({fields:vo,name:"blocking",apis:Il,state:Object.freeze({__proto__:null,init:function(){var n=MS();return _i({readState:n.isSet,blockWith:function(t){n.set({destroy:t})},clear:n.clear,isBlocked:n.isSet})}})}),W1=hs({name:"ModalDialog",configFields:Fl(),partFields:Td(),factory:function(i,t,n,o){var r=tt($.none()),e=_("modal-events"),u=J(J({},i.eventOrder),((u={})[xr()]=[e].concat(i.eventOrder["alloy.system.attached"]||[]),u));return{uid:i.uid,dom:i.dom,components:t,apis:{show:function(t){r.set($.some(t));var n=i.lazySink(t).getOrDie(),e=o.blocker(),e=n.getSystem().build(J(J({},e),{components:e.components.concat([ru(t)]),behaviours:it([lt.config({}),st("dialog-blocker-events",[Mr(Jo(),function(){at.focusIn(t)})])])}));gl(n,e),at.focusIn(t)},hide:function(n){r.set($.none()),Gr(n.element).each(function(t){n.getSystem().getByDom(t).each(function(t){hl(t)})})},getBody:function(t){return jl(t,i,"body")},getFooter:function(t){return jl(t,i,"footer")},setIdle:function(t){U1.unblock(t)},setBusy:function(t,n){U1.block(t,n)}},eventOrder:u,domModification:{attributes:{role:"dialog","aria-modal":"true"}},behaviours:ns(i.modalBehaviours,[ct.config({}),at.config({mode:"cyclic",onEnter:i.onExecute,onEscape:i.onEscape,useTabstopAt:i.useTabstopAt}),U1.config({getRoot:r.get}),st(e,[Fr(function(t){var n,e=t.element,o=jl(t,i,"title").element,r=ci(e,"id").fold(function(){var t=_("dialog-label");return ot(o,"id",t),t},A);ot(e,"aria-labelledby",r),e=t.element,n=jl(t,i,"body").element,r=$.from(ai(e,"id")).fold(function(){var t=_("dialog-describe");return ot(n,"id",t),t},A),ot(e,"aria-describedby",r)})])])}},apis:{show:function(t,n){t.show(n)},hide:function(t,n){t.hide(n)},getBody:function(t,n){return t.getBody(n)},getFooter:function(t,n){return t.getFooter(n)},setBusy:function(t,n,e){t.setBusy(n,e)},setIdle:function(t,n){t.setIdle(n)}}}),Al=m([n("type"),n("name")].concat(Cd)),Ml=ro,Ed=[Ye("name","name",Ae(function(){return _("button-name")}),oo),nn("icon"),un("align","end",["start","end"]),an("primary",!1),an("disabled",!1)],Ps=F(Ed,[n("text")]),cl=F([Jt("type",["submit","cancel","custom"])],Ps),di=F([Jt("type",["menu"]),nn("text"),nn("tooltip"),nn("icon"),Zt("items",Al)],Ed),_d=Xt("type",{submit:cl,cancel:cl,custom:cl,menu:di}),kd=[n("type"),n("text"),Jt("level",["info","warn","error","success"]),n("icon"),b("url","")],G1=m(kd),Dd=[n("type"),n("text"),an("disabled",!1),an("primary",!1),Ye("name","name",Ae(function(){return _("button-name")}),oo),nn("icon"),an("borderless",!1)],X1=m(Dd),Od=[n("type"),n("name"),n("label"),an("disabled",!1)],Y1=m(Od),Vs=ro,ya=[n("type"),n("name")],bo=ya.concat([nn("label")]),js=bo.concat([b("columns","auto")]),q1=m(js),vo=Ut([n("value"),n("text"),n("icon")]),K1=m(bo),Il=oo,J1=m(bo),Fl=oo,$1=ya.concat([rn("tag","textarea"),n("scriptId"),n("scriptUrl"),fo("settings",void 0,uo)]),Q1=ya.concat([rn("tag","textarea"),$t("init")]),Z1=Ke(function(t){return Je("customeditor.old",je(Q1),t).orThunk(function(){return Je("customeditor.new",je($1),t)})}),Td=oo,tO=m(bo),Cd=Ue(qe),Al=[n("type"),n("html"),un("presets","presentation",["presentation","document"])],nO=m(Al),Ed=bo.concat([an("sandboxed",!0)]),eO=m(Ed),cl=oo,di=bo.concat([ao("currentState",m([g("blob"),n("url")]))]),oO=m(di),kd=bo.concat([nn("inputMode"),nn("placeholder"),an("maximized",!1),an("disabled",!1)]),rO=m(kd),Dd=oo,Od=[n("text"),n("value")],js=[n("text"),Zt("items",(tC=Te(function(){return iO}),{extract:function(t,n,e){return tC().extract(t,n,e)},toString:function(){return tC().toString()}}))],iO=Lt([m(Od),m(js)]),uo=bo.concat([Zt("items",iO),an("disabled",!1)]),uO=m(uo),ya=oo,qe=bo.concat([Qt("items",[n("text"),n("value")]),on("size",1),an("disabled",!1)]),aO=m(qe),Al=oo,Ed=bo.concat([an("constrain",!0),an("disabled",!1)]),cO=m(Ed),di=m([n("width"),n("height")]),kd=[n("type"),Zt("header",oo),Zt("cells",Ue(oo))],sO=m(kd),Od=bo.concat([nn("placeholder"),an("maximized",!1),an("disabled",!1)]),lO=m(Od),js=oo,uo=bo.concat([un("filetype","file",["image","media","file"]),b("disabled",!1)]),fO=m(uo),qe=m([n("value"),b("meta",{})]),dO=Wt(function(){return to("type",{alertbanner:G1,bar:m((t=Ik("bar"),[n("type"),t])),button:X1,checkbox:Y1,colorinput:K1,colorpicker:J1,dropzone:tO,grid:m((t=Ik("grid"),[n("type"),ao("columns",eo),t])),iframe:eO,input:rO,listbox:uO,selectbox:aO,sizeinput:cO,textarea:lO,urlinput:fO,customeditor:Z1,htmlpanel:nO,imagetools:oO,collection:q1,label:m((t=Ik("label"),[n("type"),n("label"),t])),table:sO,panel:mO});var t}),Ed=[n("type"),b("classes",[]),Zt("items",dO)],mO=m(Ed),kd=[Ye("name","name",Ae(function(){return _("tab-name")}),oo),n("title"),Zt("items",dO)],Od=[n("type"),Qt("tabs",kd)],bo=m(Od),uo=Ps,Ed=_d,gO=m([n("title"),ao("body",to("type",{panel:mO,tabpanel:bo})),rn("size","normal"),Zt("buttons",Ed),b("initialData",{}),cn("onAction",K),cn("onChange",K),cn("onSubmit",K),cn("onClose",K),cn("onCancel",K),b("onTabChange",K)]),Ae=m(F([Jt("type",["cancel","custom"])],uo)),pO=m([n("title"),n("url"),tn("height"),tn("width"),so("buttons",Ue(Ae)),cn("onAction",K),cn("onCancel",K),cn("onClose",K),cn("onMessage",K)]),hO=function(t){return w(t)?[t].concat(Ot(we(t),hO)):c(t)?Ot(t,hO):[]},vO=function(t){return y(t.type)&&y(t.name)},bO={checkbox:Vs,colorinput:Il,colorpicker:Fl,dropzone:Cd,input:Dd,iframe:cl,sizeinput:di,selectbox:Al,listbox:ya,size:di,textarea:js,urlinput:qe,customeditor:Td,collection:vo,togglemenuitem:Ml},yO={open:function(t,n){n=Rk(n);return t(n.internalDialog,n.initialData,n.dataValidator)},openUrl:function(t,n){return t($e(Je("dialog",pO,n)))},redial:Rk},kd=ql({name:"TabButton",configFields:[b("uid",void 0),g("value"),Ye("dom","dom",Me(function(){return{attributes:{role:"tab",id:_("aria"),"aria-selected":"false"}}}),no()),p("action"),b("domModification",{}),Zc("tabButtonBehaviours",[lt,at,ut]),g("view")],factory:function(t,n){return{uid:t.uid,dom:t.dom,components:t.components,events:id(t.action),behaviours:ns(t.tabButtonBehaviours,[lt.config({}),at.config({mode:"execution",useSpace:!0,useEnter:!0}),ut.config({store:{mode:"memory",initialValue:t.value}})]),domModification:t.domModification}}}),Od=X([g("tabs"),g("dom"),b("clickToDismiss",!1),Zc("tabbarBehaviours",[$l,at]),Bu(["tabClass","selectedClass"])]),Ps=La({factory:kd,name:"tabs",unit:"tab",overrides:function(o){return{action:function(t){var n=t.getSystem().getByUid(o.uid).getOrDie(),e=$l.isHighlighted(n,t);(e&&o.clickToDismiss?function(t,n){$l.dehighlight(t,n),q(t,_r(),{tabbar:t,button:n})}:e?K:function(t,n){$l.highlight(t,n),q(t,Or(),{tabbar:t,button:n})})(n,t)},domModification:{classes:[o.markers.tabClass]}}}}),_d=X([Ps]),xO=hs({name:"Tabbar",configFields:Od(),partFields:_d(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,components:n,"debug.sketcher":"Tabbar",domModification:{attributes:{role:"tablist"}},behaviours:ns(t.tabbarBehaviours,[$l.config({highlightClass:t.markers.selectedClass,itemClass:t.markers.tabClass,onHighlight:function(t,n){ot(n.element,"aria-selected","true")},onDehighlight:function(t,n){ot(n.element,"aria-selected","false")}}),at.config({mode:"flow",getInitial:function(t){return $l.getHighlighted(t).map(function(t){return t.element})},selector:"."+t.markers.tabClass,executeOnMove:!0})])}}}),bo=ql({name:"Tabview",configFields:[Zc("tabviewBehaviours",[ct])],factory:function(t,n){return{uid:t.uid,dom:t.dom,behaviours:ns(t.tabviewBehaviours,[ct.config({})]),domModification:{attributes:{role:"tabpanel"}}}}}),Ed=X([b("selectFirst",!0),t("onChangeTab"),t("onDismissTab"),b("tabs",[]),Zc("tabSectionBehaviours",[])]),uo=Rl({factory:xO,schema:[g("dom"),co("markers",[g("tabClass"),g("selectedClass")])],name:"tabbar",defaults:function(t){return{tabs:t.tabs}}}),Ae=Rl({factory:bo,name:"tabview"}),Vs=X([uo,Ae]),wO=hs({name:"TabSection",configFields:Ed(),partFields:Vs(),factory:function(r,t,n,e){function o(t,n){Ll(t,r,"tabbar").each(function(t){n(t).each(Dr)})}return{uid:r.uid,dom:r.dom,components:t,behaviours:ts(r.tabSectionBehaviours),events:Ar(Ct([r.selectFirst?[Fr(function(t,n){o(t,$l.getFirst)})]:[],[et(Or(),function(t,n){var e=n.event.button,o=ut.getValue(e);Ll(e,r,"tabview").each(function(n){St(r.tabs,function(t){return t.value===o}).each(function(t){t=t.view();ci(e.element,"id").each(function(t){ot(n.element,"aria-labelledby",t)}),ct.set(n,t),r.onChangeTab(n,e,t)})})}),et(_r(),function(t,n){n=n.event.button;r.onDismissTab(t,n)})]])),apis:{getViewItems:function(t){return Ll(t,r,"tabview").map(function(t){return ct.contents(t)}).getOr([])},showTab:function(t,e){o(t,function(n){var t=$l.getCandidates(n);return St(t,function(t){return ut.getValue(t)===e}).filter(function(t){return!$l.isHighlighted(n,t)})})}}}},apis:{getViewItems:function(t,n){return t.getViewItems(n)},showTab:function(t,n,e){t.showTab(n,e)}}}),SO="send-data-to-section",kO="send-data-to-view",CO=_("update-dialog"),OO=_("update-title"),_O=_("update-body"),TO=_("update-footer"),EO=_("body-send-message"),DO=function(t,n,g,e){return{dom:{tag:"div",classes:["tox-dialog__content-js"],attributes:J(J({},n.map(function(t){return{id:t}}).getOr({})),e?{"aria-live":"polite"}:{})},components:[],behaviours:it([Cb(0),cS.config({channel:_O,updateState:function(t,n){return $.some({isTabPanel:function(){return"tabpanel"===n.body.type}})},renderComponents:function(t){return"tabpanel"!==t.body.type?[(r=t.body,a=g,{dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[(m=ft(fy.sketch(function(n){return{dom:{tag:"div",classes:["tox-form"].concat(r.classes)},components:k(r.items,function(t){return f0(n,t,a)})}}))).asSpec()]}],behaviours:it([at.config({mode:"acyclic",useTabstopAt:O(_y)}),(n=m,T.config({find:n.getOpt})),(e=m,o=Qe("RepresentingConfigs.memento processors",yy,{postprocess:function(t){return Vk(t).fold(function(t){return console.error(t),{}},function(t){return t})}}),ut.config({store:{mode:"manual",getValue:function(t){t=e.get(t),t=ut.getValue(t);return o.postprocess(t)},setValue:function(t,n){n=o.preprocess(n),t=e.get(t);ut.setValue(t,n)}}}))])})]:[(n=t.body,c=g,s=tt({}),l=function(t){var t=ut.getValue(t),t=Vk(t).getOr({}),n=s.get(),n=Oe(n,t);s.set(n)},f=function(t){var n=s.get();ut.setValue(t,n)},d=tt(null),m=k(n.tabs,function(t){return{value:t.name,dom:{tag:"div",classes:["tox-dialog__body-nav-item"],innerHtml:c.shared.providers.translate(t.title)},view:function(){return[fy.sketch(function(n){return{dom:{tag:"div",classes:["tox-form"]},components:k(t.items,function(t){return f0(n,t,c)}),formBehaviours:it([at.config({mode:"acyclic",useTabstopAt:O(_y)}),st("TabView.form.events",[Fr(f),Ir(l)]),qa.config({channels:Ht([{key:SO,value:{onReceive:l}},{key:kO,value:{onReceive:f}}])})])}})]}}}),i=m,u=tt($.none()),t={extraEvents:[Fr(function(t){var o=t.element;zk(o).each(function(n){var e;rt(n,"visibility","hidden"),t.getSystem().getByDom(n).toOptional().each(function(t){o=n,r=t;var e,o,r,t=k(e=i,function(t,n){ct.set(r,e[n].view());n=o.dom.getBoundingClientRect();return ct.set(r,[]),n.height}),t=H(P(t,function(t,n){return n<t?-1:t<n?1:0}));u.set(t)}),Hk(o,n,u),Ji(n,"visibility"),e=t,H(i).each(function(t){return wO.showTab(e,t.value)}),Yd.requestAnimationFrame(function(){Hk(o,n,u)})})}),et(yr(),function(t){var n=t.element;zk(n).each(function(t){Hk(n,t,u)})}),et(Zh,function(t,n){var r=t.element;zk(r).each(function(n){var t=Ja($r(n)),e=(rt(n,"visibility","hidden"),Ki(n,"height").map(function(t){return parseInt(t,10)})),o=(Ji(n,"height"),Ji(n,"flex-basis"),n.dom.getBoundingClientRect().height);e.forall(function(t){return t<o})?(u.set($.from(o)),Hk(r,n,u)):e.each(function(t){Pk(n,t)}),Ji(n,"visibility"),t.each(Ka)})})],selectFirst:!1},wO.sketch({dom:{tag:"div",classes:["tox-dialog__body"]},onChangeTab:function(t,n,e){n=ut.getValue(n);q(t,Qh,{name:n,oldName:d.get()}),d.set(n)},tabs:m,components:[wO.parts.tabbar({dom:{tag:"div",classes:["tox-dialog__body-nav"]},components:[xO.parts.tabs({})],markers:{tabClass:"tox-tab",selectedClass:"tox-dialog__body-nav-item--active"},tabbarBehaviours:it([Nh.config({})])}),wO.parts.tabview({dom:{tag:"div",classes:["tox-dialog__body-content"]}})],selectFirst:t.selectFirst,tabSectionBehaviours:it([st("tabpanel",t.extraEvents),at.config({mode:"acyclic"}),T.config({find:function(t){return H(wO.getViewItems(t))}}),ut.config({store:{mode:"manual",getValue:function(t){return t.getSystem().broadcastOn([SO],{}),s.get()},setValue:function(t,n){s.set(n),t.getSystem().broadcastOn([kO],{})}}})])}))];var e,o,i,u,r,a,n,c,s,l,f,d,m},initialData:t})])}},BO=Tp.deviceType.isTouch(),AO=function(t){return qd.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":t.translate("Close"),title:t.translate("Close")}},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:Kd("close",t.icons)}}],action:function(t){Y(t,Yh)}})},MO=function(t,n,e){function o(t){return[tu(e.translate(t.title))]}return{dom:{tag:"div",classes:["tox-dialog__title"],attributes:J({},n.map(function(t){return{id:t}}).getOr({}))},components:o(t),behaviours:it([cS.config({channel:OO,renderComponents:o})])}},FO=function(){return{dom:WC('<div class="tox-dialog__draghandle"></div>')}},IO=function(t,n){return t={title:n.shared.providers.translate(t),draggable:n.dialog.isDraggableModal()},n=n.shared.providers,o=W1.parts.title(MO(t,$.none(),n)),e=W1.parts.draghandle(FO()),n=W1.parts.close(AO(n)),o=[o].concat(t.draggable?[e]:[]).concat([n]),zh.sketch({dom:WC('<div class="tox-dialog__header"></div>'),components:o});var e,o},RO=function(t,n,e){return{dom:{tag:"div",classes:["tox-dialog__busy-spinner"],attributes:{"aria-label":e.translate(t)},styles:{left:"0px",right:"0px",bottom:"0px",top:"0px",position:"absolute"}},behaviours:n,components:[{dom:WC('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}},VO=function(t,o,n){return{onClose:function(){return n.closeWindow()},onBlock:function(e){W1.setBusy(t(),function(t,n){return RO(e.message,n,o)})},onUnblock:function(){W1.setIdle(t())}}},PO=function(t,n,e,o){return ou(Xk(J(J({},t),{lazySink:o.shared.getSink,extraBehaviours:F([cS.config({channel:CO,updateState:function(t,n){return $.some(n)},initialData:n}),Sy({})],t.extraBehaviours),onEscape:function(t){Y(t,Yh)},dialogEvents:e,eventOrder:((o={})[cr()]=[cS.name(),qa.name()],o[xr()]=["scroll-lock",cS.name(),"messages","dialog-events","alloy.base.behaviour"],o[wr()]=["alloy.base.behaviour","dialog-events","messages",cS.name(),"scroll-lock"],o)})))},HO=function(t){return k(t,function(t){return"menu"===t.type?(e=k((n=t).items,function(t){var n=tt(!1);return J(J({},t),{storage:n})}),J(J({},n),{items:e})):t;var n,e})},zO=function(t){return wt(t,function(t,n){return"menu"!==n.type?t:wt(n.items,function(t,n){return t[n.name]=n.storage,t},t)},{})},NO=function(u,t){function n(t,i){return et(t,function(e,o){var n,r;n=e,r=function(t,n){i(u(),t,o.event,e)},cS.getState(n).get().each(function(t){r(t,n)})})}return F(Yk(n,t),[n(qh,function(t,n,e){n.onAction(t,{name:e.name})})])},LO=function(u,t,c){function n(t,i){return et(t,function(e,o){var n,r;n=e,r=function(t,n){i(u(),t,o.event,e)},cS.getState(n).get().each(function(t){r(t.internalDialog,n)})})}return F(Yk(n,t),[n(Kh,function(t,n){n.onSubmit(t)}),n(Gh,function(t,n,e){n.onChange(t,{name:e.name})}),n(qh,function(t,n,e,o){function r(){return at.focusIn(o)}function i(t){return Nn(t,"disabled")||ci(t,"aria-disabled").exists(function(t){return"true"===t})}var u=$r(o.element),a=Ja(u);n.onAction(t,{name:e.name,value:e.value}),Ja(u).fold(r,function(n){i(n)||a.exists(function(t){return Vo(n,t)&&i(t)})?r():c().toOptional().filter(function(t){return!Vo(t.element,n)}).each(r)})}),n(Qh,function(t,n,e){n.onTabChange(t,{newTabName:e.name,oldTabName:e.oldName})}),Ir(function(t){var n=u();ut.setValue(t,n.getData())})])},jO=Kk,UO=function(t,n){return W1.parts.footer(Kk(t,n))},WO=function(u,o,a){function t(t){var n=u.getRoot();n.getSystem().isConnected()&&t(n)}var c={getData:function(){var t=u.getRoot(),t=t.getSystem().isConnected()?u.getFormWrapper():t,t=ut.getValue(t),n=be(a,function(t){return t.get()});return J(J({},t),n)},setData:function(i){t(function(t){var n,e=c.getData(),o=J(J({},e),i),e=(n=o,e=u.getRoot(),cS.getState(e).get().map(function(t){return $e(Je("data",t.dataValidator,n))}).getOr(n)),r=u.getFormWrapper();ut.setValue(r,e),ve(a,function(t,n){Se(o,n)&&t.set(o[n])})})},disable:function(t){Jk(u,t).each(dt.disable)},enable:function(t){Jk(u,t).each(dt.enable)},focus:function(t){Jk(u,t).each(lt.focus)},block:function(n){if(!y(n))throw new Error("The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument");t(function(t){q(t,Jh,{message:n})})},unblock:function(){t(function(t){Y(t,$h)})},showTab:function(e){t(function(t){var n=u.getBody();cS.getState(n).get().exists(function(t){return t.isTabPanel()})&&T.getCurrent(n).each(function(t){wO.showTab(t,e)})})},redial:function(e){t(function(t){var n=o(e);t.getSystem().broadcastOn([CO],n),t.getSystem().broadcastOn([OO],n.internalDialog),t.getSystem().broadcastOn([_O],n.internalDialog),t.getSystem().broadcastOn([TO],n.internalDialog),c.setData(n.initialData)})},close:function(){t(function(t){Y(t,Xh)})}};return c},GO=tinymce.util.Tools.resolve("tinymce.util.URI"),XO=["insertContent","setContent","execCommand","close","block","unblock"],YO=function(t){return w(t)&&-1!==XO.indexOf(t.mceAction)};r.add("silver",function(t){var n=Fk(t),e=n.uiMothership,o=n.backstage,r=n.renderUI,n=n.getUi,t=(ph(t,o.shared),Qk({editor:t,backstage:o}));return{renderUI:r,getWindowManagerImpl:X(t),getNotificationManagerImpl:function(){return a=e,c=(u={backstage:o}).backstage,{open:function(t,n){function e(){n(),Xd.hide(i)}var o=!t.closeButton&&t.timeout&&(0<t.timeout||t.timeout<0),r=ou($d.sketch({text:t.text,level:pt(["success","error","warning","warn","info"],t.type)?t.type:void 0,progress:!0===t.progressBar,icon:$.from(t.icon),closeButton:!o,onAction:e,iconProvider:c.shared.providers.icons,translationProvider:c.shared.providers.translate})),i=ou(Xd.sketch(J({dom:{tag:"div",classes:["tox-notifications-container"]},lazySink:u.backstage.shared.getSink,fireDismissalEventInstead:{}},c.shared.header.isPositionedAtTop()?{}:{fireRepositionEventInstead:{}})));return a.add(i),0<t.timeout&&Yd.setTimeout(function(){e()},t.timeout),{close:e,moveTo:function(t,n){Xd.showAt(i,{anchor:"makeshift",x:t,y:n},ru(r))},moveRel:function(t,n){var e;"banner"!==n?(e=function(){switch(n){case"bc-bc":return vd;case"tc-tc":return hd;case"tc-bc":return zu;default:return Nu}}(),t={anchor:"node",root:Li(),node:$.some(nt.fromDom(t)),layouts:{onRtl:function(){return[e]},onLtr:function(){return[e]}}},Xd.showAt(i,t,ru(r))):Xd.showAt(i,u.backstage.shared.anchors.banner(),ru(r))},text:function(t){$d.updateText(r,t)},settings:t,getEl:function(){return r.element.dom},progressBar:{value:function(t){$d.updateProgress(r,t)}}}},close:function(t){t.close()},reposition:function(t){var e;Q(t,function(t){return t.moveTo(0,0)}),0<(e=t).length&&(H(e).each(function(t){return t.moveRel(null,"banner")}),Q(e,function(t,n){0<n&&t.moveRel(e[n-1].getEl(),"bc-tc")}))},getArgs:function(t){return t.settings}};var u,a,c},ui:n()}})}();